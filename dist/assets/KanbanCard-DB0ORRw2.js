import{d as H,c as F,r as k,q as G,b as J,w as S,e,i as y,j as U,z as R,O as X,U as Y,g as V,F as O,x as ee,y as te,S as W,t as r,n as v,f as A,h as x,B as Q,o as m,bg as se,a as ae,k as ie}from"./index-lr5JxJGD.js";import{_ as le}from"./DropMenu.vue_vue_type_script_setup_true_lang-DMLhChB2.js";import{u as oe,a as ne,b as re,c as de}from"./People-D8D15v6J.js";import{_ as ue}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-DtI55x--.js";import{u as me}from"./useQueryParams-BLs6_Xx1.js";import{B as ce}from"./BaseModal-WcZlps4M.js";import{g as Z}from"./index-BBhniCjd.js";import"./index-IINEE0ld.js";import"./KanbanSkeleton-uzsCW0JK.js";import"./BaseTextField.vue_vue_type_script_setup_true_lang-B7hMAW4n.js";import"./info-DjaLHeD_.js";import"./BaseEmailChip.vue_vue_type_script_setup_true_lang-DJvdOMOs.js";import"./ProgressBar.vue_vue_type_script_setup_true_lang-BGOQu7sM.js";import"./TypeChanger-BgmaVv8M.js";import"./SwitchTab-x2VknYGR.js";/* empty css                                                                  */import"./cross-DvraoB0R.js";const pe={class:"px-6 pb-2"},fe={class:"relative mb-4"},ge=["onKeydown"],be={key:0,class:"mt-3"},ve={class:"divide-y divide-border rounded-xl border border-border bg-bg-card"},ye=["onClick"],xe={class:"flex items-center gap-3 min-w-0"},ke={class:"min-w-0"},he={class:"truncate font-medium leading-tight capitalize"},_e={class:"truncate text-xs text-text-secondary leading-tight"},Ce={key:1,class:"mt-3 flex items-center gap-2"},we={class:"inline-flex items-center gap-2 rounded-full px-3 py-2 bg-bg-muted text-text-secondary"},Se={class:"flex items-center justify-between gap-3 p-6 mt-3 pb-2 border-t border-border bg-bg-body"},Ve={class:"flex gap-2 justify-between w-full"},Ae=H({__name:"AssignmentModal",props:{modelValue:{type:Boolean,default:!1},members:{default:()=>[]},directory:{default:()=>[]},placeholder:{default:"Search people by name or email"},isSubmitting:{}},emits:["update:modelValue","submit","copy-link"],setup($,{emit:d}){const u=$,_=d,c=F({get:()=>u.modelValue,set:i=>_("update:modelValue",i)}),o=k(""),n=k(""),p=k(""),f=F(()=>{const i=o.value.trim().toLowerCase();return u.directory.filter(a=>{var t;return((t=a.name)==null?void 0:t.toLowerCase().includes(i))||a.email.toLowerCase().includes(i)})}),T=i=>{n.value=i.email,o.value=""},C=()=>{n.value=""},D=()=>{o.value&&(n.value=o.value.trim(),o.value="")},M=i=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i),N=()=>{if(!n.value||!M(n.value)){p.value="Please select a valid email.";return}_("submit",{invite:{email:n.value}})},q=()=>{C(),o.value="",c.value=!1};G(()=>{c.value&&(o.value="")});function B(i){let a=0;for(let g=0;g<i.length;g++)a=a*31+i.charCodeAt(g)>>>0;return`hsl(${a%360} 80% 85%)`}return(i,a)=>(m(),J(ce,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=t=>c.value=t),size:"md"},{default:S(()=>[a[3]||(a[3]=e("div",{class:"sticky top-0 z-10 flex items-start gap-2 px-6 pb-4 mb-4 border-b border-border bg-bg-body"},[e("h2",{class:"text-xl font-semibold"},"Add team member")],-1)),e("div",pe,[e("div",fe,[R(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>o.value=t),type:"text",placeholder:"Search or add email",class:"w-full h-11 rounded-xl border border-border bg-bg-input px-3 text-sm outline-none focus:ring-2 focus:ring-primary/40",onKeydown:Y(V(D,["prevent"]),["enter"])},null,40,ge),[[X,o.value]])]),f.value.length?(m(),y("div",be,[e("ul",ve,[(m(!0),y(O,null,ee(f.value,t=>(m(),y("li",{key:t.id||t.email,class:te(["flex items-center justify-between gap-3 px-3 py-3 cursor-pointer hover:bg-bg-muted",{"bg-bg-muted":n.value===t.email}]),onClick:g=>T(t)},[e("div",xe,[e("div",{class:"h-9 w-9 bg-white capitalize rounded-full flex items-center justify-center text-xs font-semibold",style:W({backgroundColor:B(t.email)})},r(v(Z)(t.name||t.email)),5),e("div",ke,[e("div",he,r(t.name||t.email),1),e("div",_e,r(t.email),1)])])],10,ye))),128))])])):U("",!0),n.value?(m(),y("div",Ce,[e("span",we,[A(r(n.value)+" ",1),e("button",{onClick:C,class:"ml-2 text-sm text-red-500"},"✕")])])):U("",!0)]),e("div",Se,[e("div",Ve,[x(Q,{variant:"secondary",onClick:q},{default:S(()=>a[2]||(a[2]=[A("Cancel")])),_:1,__:[2]}),x(Q,{variant:"primary",disabled:!!(!n.value||i.isSubmitting),onClick:N},{default:S(()=>[A(r(i.isSubmitting?"Assigning…":"Assign"),1)]),_:1},8,["disabled"])])])]),_:1,__:[3]},8,["modelValue"]))}}),$e={class:"flex justify-between gap-2 items-start"},Te={class:"flex items-start gap-2"},De={class:"w-10 aspect-square bg-bg-surface flex justify-center items-center rounded-full"},Me={key:0,class:"fa-solid fa-user text-white"},Ne={class:"text-sm font-medium text-card-foreground leading-tight"},qe={class:"text-text-secondary text-xs"},Re=H({__name:"KanbanCard",props:{ticket:{}},setup($){const d=k(!1),u=$,{workspaceId:_}=me(),{data:c}=se(),{data:o}=oe(_.value,c),n=k([]),p=k(!1),f=ae();function T(){return[{label:"Assign User",danger:!0,action:()=>{d.value=!0},icon:{prefix:"fa-regular",iconName:"fa-user-plus"}},...u.ticket.name?[{label:"UnAssign User",danger:!0,action:()=>{g()},icon:{prefix:"fa-regular",iconName:"fa-user-minus"}}]:[],{label:"Delete Seat",danger:!0,action:()=>{p.value=!0},icon:{prefix:"fa-regular",iconName:"fa-trash"}}]}const C=()=>{},{mutate:D,isPending:M}=ne({onSuccess:()=>{f.invalidateQueries({queryKey:["people-lists"]})}}),N=()=>{D({id:u.ticket._id})},{mutate:q,isPending:B}=re({onSuccess:()=>{d.value=!1,f.invalidateQueries({queryKey:["people-lists"]})}});function i(l){const w=(l.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return w.length?w.map(h=>h.charAt(0).toUpperCase()+h.slice(1).toLowerCase()).join(" "):l}const{mutate:a}=de({onSuccess:()=>{d.value=!1,f.invalidateQueries({queryKey:["people-lists"]})}});function t(l){q({id:u.ticket._id,payload:{name:i(l.email),email:l.email}})}function g(){a({id:u.ticket._id})}return(l,s)=>{var h,z,I,j,K,E,L,P;const w=ie("AssigmentDropdown");return m(),y(O,null,[e("div",{onClick:s[2]||(s[2]=b=>l.$emit("click")),class:"bg-bg-card rounded-lg p-4 shadow-sm cursor-grab hover:shadow-md transition-all duration-200 active:cursor-grabbing",style:W({borderColor:(z=(h=l.ticket)==null?void 0:h.lane)==null?void 0:z.variables["lane-color"]})},[e("div",$e,[e("div",Te,[e("div",De,[A(r(v(Z)((I=l.ticket)==null?void 0:I.name))+" ",1),(j=l.ticket)!=null&&j.name?U("",!0):(m(),y("i",Me))]),e("div",null,[e("h3",Ne,r(((K=l.ticket)==null?void 0:K.name)??l.ticket.title??"Team Member "),1),e("p",qe,r(((E=l.ticket)==null?void 0:E.role)??"e.g. Node Developer"),1)])]),x(le,{onClick:s[0]||(s[0]=V(()=>{},["stop"])),items:T()},{trigger:S(()=>s[8]||(s[8]=[e("i",{class:"cursor-pointer fa-solid fa-ellipsis"},null,-1)])),_:1},8,["items"])]),e("div",{onClick:s[1]||(s[1]=V(()=>{},["stop"]))},[x(w,{users:n.value,onAssign:C,assigneeId:l.ticket.assigned_to},null,8,["users","assigneeId"])])],4),x(ue,{onClick:s[3]||(s[3]=V(()=>{},["stop"])),modelValue:p.value,"onUpdate:modelValue":s[4]||(s[4]=b=>p.value=b),title:"Delete Team seat",itemLabel:"Seat",itemName:l.ticket.title,requireMatchText:l.ticket.title,confirmText:"Delete Seat",cancelText:"Cancel",size:"md",loading:v(M),onConfirm:N,onCancel:s[5]||(s[5]=()=>{p.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),x(Ae,{isSubmitting:v(B),modelValue:d.value,"onUpdate:modelValue":s[6]||(s[6]=b=>d.value=b),members:(L=v(o))==null?void 0:L.people,directory:(P=v(o))==null?void 0:P.people,onSubmit:s[7]||(s[7]=({invite:b})=>t(b))},null,8,["isSubmitting","modelValue","members","directory"])],64)}}});export{Re as default};
