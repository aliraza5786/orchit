const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CreateTaskModal-CdreadMb.js","assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-Cq3FoN8L.js","assets/index-C-iqr35C.js","assets/index-U_lIj89R.css","assets/CreateSheetModal-BmWvzWkE.js","assets/IconPicker-CSqZW7Rw.js","assets/IconPicker-BPf3BB8o.css","assets/AudioRecorder.vue_vue_type_script_setup_true_lang-Di2Z938T.js","assets/CreateSheetModal-CEob18WV.css","assets/CreateVariableModal-Cz5QKvJe.js","assets/ConfirmDeleteModal-S1OH6ECx.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-C2nKiBOG.js","assets/SidePanel-jJvMe-xA.js","assets/SidePanel-M_FgJti0.css","assets/KanbanBoard-BZzOqsCN.js","assets/lodash-DOMkl3MI.js","assets/lodash-B_VDCJnj.css","assets/DropMenu.vue_vue_type_script_setup_true_lang-DCGTTLZL.js","assets/workspace-B0s5Am41.js","assets/KanbanBoard-DlFwUlEB.css"])))=>i.map(i=>d[i]);
import{d as Se,M as we,m as F,r as i,c as T,i as b,e as r,F as z,x as oe,t as Te,j as V,A as ne,I as Xe,V as Ze,b as O,aQ as et,o as u,af as tt,ap as w,W as at,$ as lt,a as st,a2 as ot,Y as rt,ad as nt,a3 as dt,a4 as ut,ae as it,aa as vt,a0 as ct,h as k,w as q,f as re,n as m,y as he,C as ke,a5 as P,g as te,a9 as pt,_ as mt,B as bt,a6 as U,p as ft,bc as Ce,G as Ve,H as yt}from"./index-C-iqr35C.js";import{u as _t}from"./workspace-B0s5Am41.js";import{l as xt,F as gt,D as De,K as wt}from"./lodash-DOMkl3MI.js";import{_ as ht}from"./SearchBar.vue_vue_type_script_setup_true_lang-DJZiKjRU.js";import{K as kt}from"./KanbanTicket-DAnOdFGi.js";import"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-C2nKiBOG.js";import"./DropMenu.vue_vue_type_script_setup_true_lang-DCGTTLZL.js";const Ct={class:"kanban-table space-y-4 px-4 h-[85vh] overflow-y-auto"},Vt={class:"w-full border-collapse border-border shadow-sm rounded-lg overflow-hidden bg-bg-body/80 h-[200px] overflow-y-auto"},Dt={class:"bg-bg-surface border-b border-border sticky top-0 z-1"},St=["onClick"],Tt=["colspan"],At=["onMouseenter"],$t=["onUpdate:modelValue","onBlur"],Lt=["colspan"],Mt=Se({__name:"TableView",props:{columns:{},rows:{}},emits:["update:rows","create"],setup(de,{emit:C}){const M=de,R=C,c=we(M.rows||[]);F(()=>M.rows,s=>{s&&c.splice(0,c.length,...s)});const d=we({id:null,field:""}),D=i(null),Q=i(null),A=T(()=>c.some(s=>d.id===s.id&&!s[d.field])),j=(s,a)=>{d.id=s.id,d.field=a,tt(()=>{var l;return(l=Q.value)==null?void 0:l.focus()})},_=()=>{d.id=null,d.field=""},x=s=>{var a;if(!((a=s[d.field])!=null&&a.trim())){const l=c.findIndex(f=>f.id===s.id);l!==-1&&c.splice(l,1)}_(),R("update:rows",c.slice()),R("create",s)},h=s=>{var l;const a={id:Date.now()};M.columns.forEach(f=>a[f.key]=""),c.splice(s,0,a),j(a,((l=M.columns[0])==null?void 0:l.key)||""),D.value=null,R("update:rows",c.slice())};function ae(s,a){if(!(!s||!a))return a.includes(".")?a.split(".").reduce((l,f)=>l==null?l:l[f],s):s[a]}function B(s,a){return a!=null&&a.accessor?a.accessor(s):ae(s,a.key)}const H=s=>{var l;const a=B(s.row,s.column);return(l=s.column)!=null&&l.render?s.column.render({row:s==null?void 0:s.row,column:s==null?void 0:s.column,value:a,index:s==null?void 0:s.index}):w("span",String(a??""))};return(s,a)=>(u(),b("div",Ct,[r("table",Vt,[r("thead",Dt,[r("tr",null,[a[4]||(a[4]=r("th",{class:"w-8 p-1"},null,-1)),(u(!0),b(z,null,oe(s.columns,l=>(u(),b("th",{key:l==null?void 0:l.key,class:"text-left p-1 font-medium"},Te(l==null?void 0:l.label),1))),128))])]),r("tbody",null,[(u(!0),b(z,null,oe(c,(l,f)=>{var y;return u(),b(z,{key:l==null?void 0:l.id},[D.value===f&&!A.value?(u(),b("tr",{key:0,class:"relative bg-bg-surface/50 transition-all cursor-pointer",onMouseleave:a[0]||(a[0]=n=>D.value=null)},[r("td",{class:"!p-0 w-8",onClick:n=>h(f)},a[5]||(a[5]=[r("span",{class:"absolute left-[-6px] top-[-6px] bg-bg-card border border-border w-6 h-6 text-sm rounded-md flex justify-center items-center shadow-sm hover:bg-bg-card/10"},"+",-1)]),8,St),r("td",{class:"!p-0",colspan:(y=s.columns)==null?void 0:y.length},null,8,Tt)],32)):V("",!0),r("tr",{onMouseenter:n=>D.value=f,class:"hover:bg-surface/50 transition-colors border-b border-border"},[a[6]||(a[6]=r("td",{class:"p-2"},null,-1)),(u(!0),b(z,null,oe(s.columns,n=>(u(),b("td",{key:n==null?void 0:n.key,class:"p-2"},[(d==null?void 0:d.id)===(l==null?void 0:l.id)&&(d==null?void 0:d.field)===(n==null?void 0:n.key)?ne((u(),b("input",{key:0,"onUpdate:modelValue":v=>l[n==null?void 0:n.key]=v,onBlur:v=>x(l),class:"w-full p-1 border border-border rounded focus:outline-none focus:ring focus:ring-blue-300",ref_for:!0,ref:v=>v&&(d==null?void 0:d.id)===(l==null?void 0:l.id)&&(d==null?void 0:d.field)===(n==null?void 0:n.key)&&(Q.value=v)},null,40,$t)),[[Ze,l[n==null?void 0:n.key]]]):Xe(s.$slots,n.key,{key:2,row:l,column:n,index:`r-${l._id}`},()=>[(u(),O(et(H),{row:l,column:n,index:l._id},null,8,["row","column","index"]))])]))),128))],40,At)],64)}),128)),A.value?V("",!0):(u(),b("tr",{key:0,class:"bg-bg-surface transition sticky bottom-0 cursor-pointer border-t border-border",onMouseenter:a[2]||(a[2]=l=>D.value=c==null?void 0:c.length),onMouseleave:a[3]||(a[3]=l=>D.value=null)},[r("td",{class:"p-2",onClick:a[1]||(a[1]=l=>h(c==null?void 0:c.length))},a[7]||(a[7]=[r("span",{class:"plus inline-flex w-5 h-5 border border-border rounded-full justify-center items-center text-secondary hover:bg-bg-surface/200 transition"},"+",-1)])),r("td",{colspan:s.columns.length,class:"p-2 text-text-secondary border-border"},"Add New Row",8,Lt)],32))])])]))}}),Et={class:"flex-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur rounded-2xl shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] flex-grow h-full bg-bg-card border border-border overflow-x-auto flex-col flex scrollbar-visible"},It={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},Pt={class:"flex gap-3 items-center"},Ut={class:"flex items-center gap-3 bg-bg-surface/50 h-[32px] px-2 rounded-md"},Ot={class:"flex overflow-x-auto gap-3 p-4 scrollbar-visible"},zt={key:0,class:"mx-auto text-text-secondary/80 m-2 w-[90%] h-full justify-center flex items-center border border-dashed border-border"},Rt={key:0,class:"bg-bg-body rounded-lg p-4"},Bt={class:"flex items-center mt-3 gap-3"},Nt=Se({__name:"Product",setup(de){const C=i("table"),M=P(()=>U(()=>import("./CreateTaskModal-CdreadMb.js"),__vite__mapDeps([0,1,2,3]))),R=P(()=>U(()=>import("./CreateSheetModal-BmWvzWkE.js"),__vite__mapDeps([4,2,3,5,6,7,8]))),c=P(()=>U(()=>import("./CreateVariableModal-Cz5QKvJe.js"),__vite__mapDeps([9,2,3]))),d=P(()=>U(()=>import("./ConfirmDeleteModal-S1OH6ECx.js"),__vite__mapDeps([10,11,2,3]))),D=P(()=>U(()=>import("./SidePanel-jJvMe-xA.js"),__vite__mapDeps([12,2,3,13]))),Q=P(()=>U(()=>import("./KanbanBoard-BZzOqsCN.js"),__vite__mapDeps([14,15,2,3,11,16,17,18,19]))),A=i(!1),j=ft(),{workspaceId:_,moduleId:x}=at(),{data:h}=lt(_.value,x.value),ae=st(),{mutate:B,isPending:H}=ot({onSuccess:()=>{ae.invalidateQueries({queryKey:["sheet-list"]}),Z.value="",E.value=!1,X.value=!1,E.value=!1}}),s=e=>{B({workspace_id:_.value,module_id:x.value,variable_id:v.value,value:e})},{data:a,refetch:l}=rt({workspace_id:_,workspace_module_id:x}),f=T(()=>{var e;return a.value?(e=a.value[0])==null?void 0:e._id:""}),y=i(f.value);F(f,()=>{y.value=f.value});const n=T(()=>{var e;return h!=null&&h.value?(e=h==null?void 0:h.value[0])==null?void 0:e._id:""}),v=i(n.value);F(n,()=>{v.value=n.value});const W=_t(),{data:G,isPending:ue}=nt(x,y,T(()=>[...W.selectedLaneIds]),v),Y=i(!1),J=i(),le=e=>{J.value=e},N=i(!1),Ae=()=>{L.value={},N.value=!N.value},$e=dt(),Le=ut();function Me(e){e.type=="column"?$e.mutate({payload:{workspace_id:_.value,workspace_module_id:x.value,variable_id:v.value,moved_value:e.meta.id,new_index:e.meta.newIndex}}):Le.mutate({payload:{workspace_id:_.value,card_id:e.meta.moved._id,group_value:e.meta.fromColumnId,group_variable_id:v.value,new_index:e.meta.newIndex,sheet_id:y.value}})}const Ee=e=>{},Ie=T(()=>(a.value||[]).map(e=>({_id:e._id,title:e==null?void 0:e.variables["sheet-title"],description:e==null?void 0:e.variables["sheet-description"],icon:e.icon,status:e==null?void 0:e.generation_status})));F(a,e=>{var t;(e==null?void 0:e.length)>0&&(y.value=(t=e[0])==null?void 0:t._id)});const X=i(!1),Z=i("");function ie(){X.value=!X.value}function ve(){const e=Z.value.trim();e&&s(e)}const Pe=e=>{B({workspace_id:j.params.id,module_id:j.params.module_id,new_value:e.title,value:e.oldTitle,variable_id:v.value})},E=i(!1),$=i(),Ue=()=>{B({value:$.value.title,workspace_id:_.value,module_id:x.value,newValue:$.value.title,variable_id:v.value,is_trash:!0})},Oe=e=>{E.value=!0,$.value=e},ze=e=>{Y.value=!0,$.value=e},K=i(!1),L=i();function Re(e){K.value=!0,L.value=e}const{mutate:Be,isPending:Ne}=it({onSuccess:()=>{l(),K.value=!1}});function Ke(){var e;Be({sheet_id:(e=L.value)==null?void 0:e._id,workspace_module_id:x.value,is_trash:!0})}function qe(e){N.value=!0,L.value=e}const ee=i(""),Fe=i("");F(ee,xt.debounce(e=>{Fe.value=e},200));const Qe=T(()=>{const e=G.value.flatMap(t=>t.cards.map(p=>({...p,columnId:t.title})));return new gt(e,{keys:["card-title","card-description"],threshold:.3})}),je=T(()=>{if(!ee.value)return G.value;const e=Qe.value.search(ee.value).map(t=>t.item);return G.value.map(t=>({...t,cards:e.filter(p=>p.columnId===t.title)}))}),He=[{key:"card-title",label:"Title",render:({row:e,value:t})=>w("input",{onFocusout:p=>{var g;se(e==null?void 0:e._id,"card-title",(g=p==null?void 0:p.target)==null?void 0:g.value)},class:"text-sm cursor-pointer text-text-primary capitalize outline-none border-none focus:border  active:bg-bg-surface focus:bg-bg-card backdrop-blur focus:border-accent p-1 rounded-md",defaultValue:t})},{key:"card-status",label:"Status",render:({row:e,value:t})=>{var S;const{data:p}=Ce(_,x,"card-status"),g=i(t);return w("div",{class:" capitalize flex items-center gap-2 "},[w(Ve,{options:ce(((S=p.value)==null?void 0:S.values)??[])||[],size:"sm",modelValue:g.value,defaultValue:g.value,onUpdate:I=>{se(e==null?void 0:e._id,"card-status",I)}})])}},{key:"card-type",label:"Type",render:({row:e,value:t})=>{var S;const{data:p}=Ce(_,x,"card-type"),g=i(t);return w("div",{class:" capitalize flex items-center gap-2 "},[w(Ve,{options:ce(((S=p.value)==null?void 0:S.values)??[])||[],size:"sm",modelValue:g.value,defaultValue:g.value,onUpdate:I=>{se(e==null?void 0:e._id,"card-type",I)}})])}},{key:"end-date",label:"Due Date",render:({value:e})=>w("div",{class:" capitalize flex items-center gap-2 "},[w("span",e)])},{key:"lane",label:"Lane",render:({value:e})=>w("div",{class:"capitalize flex items-center gap-2 "},[w("div",{class:"w-3 h-3 rounded-full  ",style:`background:${e!=null&&e.variables?e==null?void 0:e.variables["lane-color"]:""}`},""),w("span",e!=null&&e.variables?e==null?void 0:e.variables["lane-title"]:"")])}],We=T(()=>{let e=[];return(G.value??[]).forEach(t=>{e=[...e,...t==null?void 0:t.cards]}),e}),ce=e=>e.map(t=>({_id:t.value,title:t.value})),Ge=vt({onSuccess:()=>{}});function se(e,t,p){Ge.mutate({card_id:e,variables:{[t]:p.trim()}})}const{mutate:Ye}=ct({onSuccess:()=>{}});function Je(e){console.log(e,"titele");const t={sheet_list_id:"To Do",workspace_id:_.value,sheet_id:y.value,variables:{"card-title":e["card-title"].trim()},createdAt:new Date().toISOString()};Ye(t)}return(e,t)=>{var p,g,S,I,pe,me,be;return u(),b(z,null,[r("div",Et,[r("div",It,[k(De,{onEditOption:qe,modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=o=>y.value=o),onDeleteOption:Re,options:Ie.value,variant:"secondary"},{more:q(()=>[r("div",{onClick:t[0]||(t[0]=o=>Ae()),class:"capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},t[22]||(t[22]=[r("i",{class:"fa-solid fa-plus"},null,-1),re(" Add new ")]))]),_:1},8,["modelValue","options"]),r("div",Pt,[C.value=="kanban"?(u(),O(De,{key:0,actions:!1,prefix:"View by",modelValue:v.value,"onUpdate:modelValue":t[3]||(t[3]=o=>v.value=o),options:m(h),variant:"secondary"},{more:q(()=>[r("div",{onClick:t[2]||(t[2]=()=>{A.value=!0}),class:"sticky bottom-0 bg-bg-dropdown shadow-md shadow-border capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},t[23]||(t[23]=[r("i",{class:"fa-solid fa-plus"},null,-1),re(" Add new ")]))]),_:1},8,["modelValue","options"])):V("",!0),k(ht,{onOnChange:t[4]||(t[4]=o=>{ee.value=o}),placeholder:"Search in Orchit AI space"}),r("div",Ut,[r("button",{class:he(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",C.value==="kanban"?"text-accent bg-accent-text":" hover:bg-border/50 backdrop-blur-2xl  transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"List view",onClick:t[5]||(t[5]=o=>C.value="kanban")},t[24]||(t[24]=[r("i",{class:"fa-solid fa-chart-kanban"},null,-1)]),2),r("button",{onClick:t[6]||(t[6]=o=>C.value="table"),class:he(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",C.value==="table"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gallery view"},t[25]||(t[25]=[r("i",{class:"fa-solid fa-align-left"},null,-1)]),2)])])]),C.value=="kanban"?(u(),b(z,{key:0},[ne(k(wt,null,null,512),[[ke,m(ue)]]),ne(r("div",Ot,[k(m(Q),{onOnPlus:ze,board:je.value,"onDelete:column":t[7]||(t[7]=o=>Oe(o)),"onUpdate:column":t[8]||(t[8]=o=>Pe(o)),onReorder:Me,onAddColumn:s,"onSelect:ticket":le,onOnBoardUpdate:Ee,variable_id:v.value,sheet_id:y.value},{"column-footer":q(o=>{var fe,ye,_e,xe,ge;return[(ye=(fe=m(W))==null?void 0:fe.transitions)!=null&&ye.all_allowed&&!((ge=(xe=(_e=m(W))==null?void 0:_e.transitions)==null?void 0:xe.all_allowed)!=null&&ge.includes(o.column.title))&&m(W).transitions.currentColumn!=o.column.title?(u(),b("div",zt," Disbale ( you can't drop here )")):V("",!0)]}),ticket:q(({ticket:o})=>[k(kt,{selectedVar:v.value,onSelect:()=>{le(o)},ticket:o},null,8,["selectedVar","onSelect","ticket"])]),_:1},8,["board","variable_id","sheet_id"]),r("div",{class:"min-w-[328px]",onClick:t[10]||(t[10]=te(()=>{},["stop"]))},[X.value?(u(),b("div",Rt,[k(mt,{autofocus:!0,modelValue:Z.value,"onUpdate:modelValue":t[9]||(t[9]=o=>Z.value=o),placeholder:"Add New list",onKeyup:pt(ve,["enter"])},null,8,["modelValue"]),t[26]||(t[26]=r("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),r("div",Bt,[k(bt,{onClick:ve,varaint:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:q(()=>[re(Te(m(H)?"Adding...":"Add list"),1)]),_:1}),r("i",{class:"fa-solid fa-close",onClick:ie})])])):(u(),b("button",{key:1,class:"text-sm text-text-primary py-2.5 cursor-pointer font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",onClick:te(ie,["stop"])}," + Add List "))])],512),[[ke,!m(ue)]])],64)):V("",!0),C.value=="table"?(u(),O(Mt,{key:1,columns:He,rows:We.value,onCreate:Je},null,8,["rows"])):V("",!0)]),k(m(d),{onClick:t[11]||(t[11]=te(()=>{},["stop"])),modelValue:E.value,"onUpdate:modelValue":t[12]||(t[12]=o=>E.value=o),title:"Delete List",itemLabel:"list",itemName:(p=$.value)==null?void 0:p.title,requireMatchText:(g=$.value)==null?void 0:g.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:m(H),onConfirm:Ue,onCancel:t[13]||(t[13]=()=>{E.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),Y.value?(u(),O(m(M),{selectedVariable:v.value,listId:(S=$.value)==null?void 0:S.title,sheet_id:y.value,key:"createTaskModalKey",modelValue:Y.value,"onUpdate:modelValue":t[14]||(t[14]=o=>Y.value=o),onSubmit:t[15]||(t[15]=()=>{})},null,8,["selectedVariable","listId","sheet_id","modelValue"])):V("",!0),(I=J.value)!=null&&I._id?(u(),O(m(D),{key:1,details:J.value,onClose:t[16]||(t[16]=()=>{le({variables:{}})}),showPanel:!!((pe=J.value)!=null&&pe._id)},null,8,["details","showPanel"])):V("",!0),k(m(R),{size:"md",sheet:L.value,modelValue:N.value,"onUpdate:modelValue":t[17]||(t[17]=o=>N.value=o)},null,8,["sheet","modelValue"]),A.value?(u(),O(m(c),{key:2,modelValue:A.value,"onUpdate:modelValue":t[18]||(t[18]=o=>A.value=o),sheetID:y.value},null,8,["modelValue","sheetID"])):V("",!0),k(m(d),{onClick:t[19]||(t[19]=te(()=>{},["stop"])),modelValue:K.value,"onUpdate:modelValue":t[20]||(t[20]=o=>K.value=o),title:"Delete Sheet",itemLabel:"Sheet",itemName:(me=L.value)==null?void 0:me.title,requireMatchText:(be=L.value)==null?void 0:be.title,confirmText:"Delete Sheet",cancelText:"Cancel",size:"md",loading:m(Ne),onConfirm:Ke,onCancel:t[21]||(t[21]=()=>{K.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"])],64)}}}),Gt=yt(Nt,[["__scopeId","data-v-cfc87b0b"]]);export{Gt as default};
