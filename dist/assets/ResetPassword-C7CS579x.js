import{d as Y,c as r,p as G,r as m,u as N,q as I,b as Z,w as u,o as t,e as s,i as a,h as n,f as o,B as R,k as J,g as K,j as O,_ as F,y as x,t as M,l as Q}from"./index-CpwqMS23.js";import{_ as W}from"./AuthLayout.vue_vue_type_script_setup_true_lang-C9ycDgBx.js";import{c as X,d as ee}from"./auth-j8Z-3soJ.js";import"./favicon-BAFXWHLW.js";const se={class:"max-w-[500px] md:mx-auto w-full text-text-primary bg-bg-body"},te={key:0,class:"text-center py-12"},ae={key:1,class:"text-center"},re={class:"mt-6"},oe={key:2,class:"text-center"},le={key:3},ne={class:"bg-bg-card border border-border rounded-lg p-4"},ie={class:"text-xs text-text-secondary space-y-1"},ue={key:0,class:"fa-solid fa-check mr-1"},de={key:1,class:"fa-solid fa-circle text-[4px] mr-1"},me={key:0,class:"fa-solid fa-check mr-1"},ce={key:1,class:"fa-solid fa-circle text-[4px] mr-1"},fe={key:0,class:"fa-solid fa-check mr-1"},ve={key:1,class:"fa-solid fa-circle text-[4px] mr-1"},xe={key:0,class:"fa-solid fa-check mr-1"},pe={key:1,class:"fa-solid fa-circle text-[4px] mr-1"},we={key:0,class:"fa-solid fa-check mr-1"},ye={key:1,class:"fa-solid fa-circle text-[4px] mr-1"},be={key:0,class:"text-red-500 text-sm text-center mt-2"},Ce=Y({name:"ResetPasswordPage",__name:"ResetPassword",setup(ge){const T=G(),$=Q(),w=r(()=>T.query.token),l=m(""),c=m(""),i=m(""),p=m(!0),y=m(!1),B=m(!1),d={newPassword:!1,confirmPassword:!1},b=r(()=>l.value.length>=8),g=r(()=>/\d/.test(l.value)),k=r(()=>/[!@#$%^&*(),.?":{}|<>]/.test(l.value)),P=r(()=>/[A-Z]/.test(l.value)),_=r(()=>/[a-z]/.test(l.value)),h=r(()=>d.newPassword?l.value?b.value?g.value?k.value?P.value?_.value?"":"Password must contain a lowercase letter":"Password must contain an uppercase letter":"Password must contain a special character":"Password must contain a number":"Password must be at least 8 characters":"Password is required":""),A=r(()=>!!h.value),C=r(()=>d.confirmPassword?c.value?c.value!==l.value?"Passwords do not match":"":"Please confirm your password":""),S=r(()=>!!C.value),E=r(()=>!h.value&&!C.value),{mutateAsync:j}=N({mutationFn:X}),{mutateAsync:L,isPending:z}=N({mutationFn:ee}),U=r(()=>z.value||!E.value),D=r(()=>z.value?"Resetting...":"Reset password");function q(){i.value&&(i.value="")}I(async()=>{if(!w.value){y.value=!0,p.value=!1;return}try{await j({token:w.value}),p.value=!1}catch{p.value=!1,y.value=!0}});async function H(){if(i.value="",d.newPassword=!0,d.confirmPassword=!0,!E.value){i.value="Please fill all fields correctly.";return}try{await L({token:w.value,new_password:l.value,confirm_password:c.value}),B.value=!0,setTimeout(()=>{$.push("/login")},3e3)}catch(f){i.value=(f==null?void 0:f.message)||"Failed to reset password. Please try again."}}return(f,e)=>{const V=J("router-link");return t(),Z(W,null,{form:u(()=>[s("div",se,[p.value?(t(),a("div",te,e[4]||(e[4]=[s("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent mx-auto mb-4"},null,-1),s("p",{class:"text-sm text-text-secondary"},"Verifying your reset link...",-1)]))):y.value?(t(),a("div",ae,[e[7]||(e[7]=s("div",{class:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},[s("i",{class:"fa-solid fa-times text-red-600 text-2xl"})],-1)),e[8]||(e[8]=s("h2",{class:"text-2xl font-medium mb-4 text-text-primary"}," Reset link expired ",-1)),e[9]||(e[9]=s("p",{class:"text-sm text-text-secondary mb-8"},[o(" This password reset link has expired or is invalid."),s("br"),o(" Please request a new one. ")],-1)),n(V,{to:"/forgot-password"},{default:u(()=>[n(R,{size:"md",variant:"primary"},{default:u(()=>e[5]||(e[5]=[o(" Request new reset link ")])),_:1,__:[5]})]),_:1}),s("div",re,[n(V,{to:"/login",class:"text-sm text-text-secondary hover:text-text-primary"},{default:u(()=>e[6]||(e[6]=[s("i",{class:"fa-solid fa-arrow-left mr-2"},null,-1),o("Back to login ")])),_:1,__:[6]})])])):B.value?(t(),a("div",oe,[e[11]||(e[11]=s("div",{class:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},[s("i",{class:"fa-solid fa-check text-green-600 text-2xl"})],-1)),e[12]||(e[12]=s("h2",{class:"text-2xl font-medium mb-4 text-text-primary"}," Password reset successful ",-1)),e[13]||(e[13]=s("p",{class:"text-sm text-text-secondary mb-8"},[o(" Your password has been successfully reset."),s("br"),o(" You can now sign in with your new password. ")],-1)),n(V,{to:"/login"},{default:u(()=>[n(R,{size:"md",variant:"primary"},{default:u(()=>e[10]||(e[10]=[o(" Go to login ")])),_:1,__:[10]})]),_:1})])):(t(),a("div",le,[e[20]||(e[20]=s("h2",{class:"text-[32px] font-medium mb-4 text-center text-text-primary"}," Reset your password ",-1)),e[21]||(e[21]=s("p",{class:"text-sm text-text-secondary text-center mb-8"}," Enter your new password below. ",-1)),s("form",{onSubmit:K(H,["prevent"]),class:"space-y-4 w-full"},[n(F,{modelValue:l.value,"onUpdate:modelValue":[e[0]||(e[0]=v=>l.value=v),q],label:"New Password",placeholder:"Enter new password",size:"lg",type:"password",error:A.value,message:h.value,onBlur:e[1]||(e[1]=v=>d.newPassword=!0)},null,8,["modelValue","error","message"]),n(F,{modelValue:c.value,"onUpdate:modelValue":[e[2]||(e[2]=v=>c.value=v),q],label:"Confirm Password",placeholder:"Confirm new password",size:"lg",type:"password",error:S.value,message:C.value,onBlur:e[3]||(e[3]=v=>d.confirmPassword=!0)},null,8,["modelValue","error","message"]),s("div",ne,[e[19]||(e[19]=s("p",{class:"text-xs text-text-secondary mb-2"},"Password requirements:",-1)),s("ul",ie,[s("li",{class:x({"text-green-600":b.value})},[b.value?(t(),a("i",ue)):(t(),a("i",de)),e[14]||(e[14]=o(" At least 8 characters "))],2),s("li",{class:x({"text-green-600":g.value})},[g.value?(t(),a("i",me)):(t(),a("i",ce)),e[15]||(e[15]=o(" Contains a number "))],2),s("li",{class:x({"text-green-600":k.value})},[k.value?(t(),a("i",fe)):(t(),a("i",ve)),e[16]||(e[16]=o(" Contains a special character "))],2),s("li",{class:x({"text-green-600":P.value})},[P.value?(t(),a("i",xe)):(t(),a("i",pe)),e[17]||(e[17]=o(" Contains an uppercase letter "))],2),s("li",{class:x({"text-green-600":_.value})},[_.value?(t(),a("i",we)):(t(),a("i",ye)),e[18]||(e[18]=o(" Contains a lowercase letter "))],2)])]),n(R,{disabled:U.value,size:"lg",block:!0,type:"submit"},{default:u(()=>[o(M(D.value),1)]),_:1},8,["disabled"]),i.value?(t(),a("p",be,M(i.value),1)):O("",!0)],32)]))])]),_:1})}}});export{Ce as default};
