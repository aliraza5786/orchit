import{d as R,u as z,a as T,r as y,c as i,b as k,e as j,w as d,o as L,f as u,s as p,g as a,h as q,i as n,j as H,k as O,_ as I,t as E,B as U,l as P,m as W,n as J}from"./index-B6QqO5al.js";import{_ as K}from"./AuthLayout.vue_vue_type_script_setup_true_lang-V95gPazy.js";import{l as Q,s as X}from"./auth-CVBOkxG1.js";import"./favicon-BAFXWHLW.js";import"./Header-DMq0BE9c.js";import"./dark-logo-Mcb_sJlF.js";const Y={class:"max-w-[500px] md:mx-auto w-full text-text-primary bg-bg-body"},Z={class:"mt-4 w-full flex justify-center"},ee={key:0,class:"text-red-500 text-sm text-center mt-2"},te={class:"text-center mt-4"},ue=R({name:"LoginPage",__name:"Login",setup(se){const b=z(),V=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,B=T(),c=y(""),g=y(""),r=y(""),m={email:!1,password:!1},f=i(()=>m.email?c.value.trim()?V.test(c.value)?"":"Invalid email":"Email is required":""),h=i(()=>!!f.value),v=i(()=>m.password?g.value?g.value.length<6?"Password must be at least 6 characters":"":"Password is required":""),F=i(()=>!!v.value),A=i(()=>!f.value&&!v.value),x=J(),{mutateAsync:M,isPending:w}=k({mutationFn:Q}),{mutateAsync:N}=k({mutationFn:X}),$=i(()=>w.value),C=i(()=>w.value?"Signing In...":"Sign in");function _(){r.value&&(r.value="")}async function D(o){var e,s;try{const t=W(o.credential),l=await N({u_email:t.email,u_social_id:t.sub,u_social_type:"google",u_full_name:t.name});S(l)}catch(t){r.value=((s=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:s.message)||"Google Login failed. Please try again."}}async function S(o){var s;localStorage.setItem("token",(s=o==null?void 0:o.data)==null?void 0:s.token),await B.bootstrap();const e=localStorage.getItem("post_auth_intent");if(e)try{const t=JSON.parse(e);localStorage.removeItem("post_auth_intent"),t.aiResponse&&b.setWorkspace(t.aiResponse),x.push(t.path||"/dashboard");return}catch(t){console.error("Failed to parse post_auth_intent",t),localStorage.removeItem("post_auth_intent")}b.pricing?x.push("/dashboard?stripePayment=true"):x.push("/dashboard")}async function G(){var o,e;if(r.value="",m.email=!0,m.password=!0,!A.value){r.value="Please fill all fields correctly.";return}try{const s=await M({u_email:c.value,u_password:g.value});S(s)}catch(s){r.value=((e=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:e.message)||"Login failed. Please try again."}}return(o,e)=>{const s=P("GoogleLogin"),t=P("router-link");return L(),j(K,null,{form:d(()=>[u("div",Y,[e[0]||(p(-1,!0),(e[0]=u("h2",{class:"text-[32px] font-medium mb-12 text-center text-text-primary"},[e[7]||(e[7]=a(" Sign in to Orchit AI "))])).cacheIndex=0,p(1),e[0]),u("form",{onSubmit:q(G,["prevent"]),class:"space-y-4 w-full"},[n(I,{modelValue:c.value,"onUpdate:modelValue":[e[1]||(e[1]=l=>c.value=l),_],label:"Email",placeholder:"Email address",size:"lg",error:h.value,message:f.value,onBlur:e[2]||(e[2]=l=>m.email=!0)},null,8,["modelValue","error","message"]),n(I,{modelValue:g.value,"onUpdate:modelValue":[e[3]||(e[3]=l=>g.value=l),_],label:"Password",placeholder:"Enter your password",size:"lg",type:"password",error:F.value,message:v.value,onBlur:e[4]||(e[4]=l=>m.password=!0)},null,8,["modelValue","error","message"]),n(U,{disabled:$.value,size:"lg",block:!0,type:"submit"},{default:d(()=>[a(E(C.value),1)]),_:1},8,["disabled"]),u("div",Z,[n(s,{callback:D})]),r.value?(L(),H("p",ee,E(r.value),1)):O("",!0),u("div",te,[n(t,{to:"/forgot-password",class:"text-sm text-accent hover:underline"},{default:d(()=>e[8]||(e[8]=[a(" Forgot password? ")])),_:1,__:[8]})])],32),e[5]||(p(-1,!0),(e[5]=u("p",{class:"text-sm font-medium text-text-secondary text-center mt-6"},[e[11]||(e[11]=a(" By signing in, you agree to the ")),n(t,{to:"/privacy-policy",class:"text-text-primary font-bold hover:underline"},{default:d(()=>e[9]||(e[9]=[a(" Privacy Policy ")])),_:1,__:[9]}),e[12]||(e[12]=a(" and ")),n(t,{to:"/terms-of-services",class:"text-text-primary font-bold hover:underline"},{default:d(()=>e[10]||(e[10]=[a(" Terms of Service ")])),_:1,__:[10]})])).cacheIndex=5,p(1),e[5]),e[6]||(p(-1,!0),(e[6]=u("p",{class:"text-sm font-medium text-text-secondary text-center mt-8"},[e[14]||(e[14]=a(" Donâ€™t have an account? ")),n(t,{to:"/register",class:"text-text-primary font-bold underline"},{default:d(()=>e[13]||(e[13]=[a("Sign up")])),_:1,__:[13]})])).cacheIndex=6,p(1),e[6])])]),_:1})}}});export{ue as default};
