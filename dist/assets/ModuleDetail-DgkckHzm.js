import{d as T,j as d,F as p,y as _,o as r,f as e,t as n,e as q,r as v,M as J,N as W,n as X,i as x,w as h,p as o,B as U,D as y,E as L,O as Y,k as Z,P as V,l as ee,g as w,Q as te,m as se}from"./index-D8TZ_VUv.js";import{K as oe}from"./KanbanSkeleton-arKYUi6n.js";import{D as re}from"./Dropdown-CUiMvafB.js";import{u as de,a as le,b as ne,c as ae}from"./useMore-BR-mlMUq.js";import{K as ie}from"./KanbanTicket-Dcq-DKBO.js";import"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-BYh4oA3G.js";import"./DropMenu.vue_vue_type_script_setup_true_lang-B4L6ax1K.js";const ue={class:"flex sticky top-0 z-[1] bg-bg-body items-center justify-between w-full p-4 border-b border-border cursor-grab"},ce={class:"flex items-center gap-2 flex-auto max-w-[80%]"},be={class:"font-semibold overflow-ellipsis line-clamp-1 text-nowrap text-foreground px-1 py-0.5 rounded hover:bg-bg-card focus:outline-none focus:ring-1 focus:ring-border cursor-text",title:"Click to rename"},me={class:"text-xs bg-bg-card aspect-square flex justify-center items-center text-muted-foreground p-1 min-w-6 rounded-full"},xe={class:"p-4 space-y-2"},fe=T({__name:"KanbanView",props:{columns:{}},setup(Q){return(u,m)=>(r(!0),d(p,null,_(u.columns,(a,f)=>(r(),d("div",{key:f,class:"flex bg-bg-body flex-col min-w-[300px] h-[600px] overflow-y-auto w-80 rounded-lg transition-all duration-200"},[e("div",ue,[e("div",ce,[e("button",be,n(a.title||"Untitled"),1),e("span",me,n(a.cards?a.cards.length:0),1)])]),e("div",xe,[(r(!0),d(p,null,_(a==null?void 0:a.cards,(c,g)=>(r(),q(ie,{footer:!0,key:`card-${g}`,onSelect:()=>{},ticket:c},null,8,["ticket"]))),128))])]))),128))}}),pe={class:"flex flex-col w-full h-full overflow-y-auto bg-bg-card rounded-6px border border-border overflow-hidden"},_e={class:"sticky top-0 w-full z-10 bg-bg-card/80 backdrop-blur border-b border-border"},ge={class:"mx-auto px-6 py-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4"},ve={class:"flex flex-col gap-2"},he={key:0,class:"space-y-2"},ye={key:1},we={class:"text-3xl font-semibold tracking-tight mt-2 capitalize"},ke={class:"text-sm text-text-secondary max-w-4xl mt-2"},Ce={class:"text-xs text-text-secondary mt-2"},je={class:"flex items-center gap-2"},Pe={class:"mx-auto w-full p-6 pb-16"},Me={class:"flex flex-col lg:flex-row gap-4 justify-between"},$e={class:"flex-auto border overflow-x-auto border-border bg-bg-card rounded-lg min-h-[420px]"},Se={class:"flex px-4 py-2 justify-between items-center border-b border-border"},Be={key:1,class:"h-8 w-32 bg-bg-body rounded"},ze={class:"rounded-lg space-y-3 w-full"},De={class:"flex w-full overflow-x-auto gap-3 p-4 scrollbar-visible"},Ke={class:"w-full lg:w-64 min-w-[375px] border border-border bg-bg-card rounded-lg p-4 h-fit"},Ne={key:0,class:"mt-3 flex flex-wrap gap-2"},Ue={key:1,class:"mt-3 flex flex-wrap gap-2"},Le={class:"mt-12 w-full"},Te={key:0,class:"space-y-2"},qe={key:1},Qe={class:"flex justify-end mt-2"},Re={key:2,class:"mt-6 text-sm"},Ae=["src"],Ee={key:1,class:"w-8 h-8 rounded-full bg-accent/40 flex justify-center items-center"},Fe={class:"font-medium capitalize"},He={class:"text-text-secondary text-xs"},Ie={class:"mt-1 font-light text-sm"},Ve=T({__name:"ModuleDetail",setup(Q){const u=v([]),m=v(""),a=v(""),{moduleId:f,workspaceId:c}=J(),g=W(),R=se(),{data:i,isPending:b}=de(f),{data:A,isPending:k}=le(f.value,m),{mutate:E,isPending:C}=ne({onSuccess:()=>{g.invalidateQueries({queryKey:["workspaces"]}),R.push(`/workspace/more/${c==null?void 0:c.value}`)}}),{mutate:F,isPending:H}=ae({onSuccess:l=>{a.value="",u.value=[...u.value,{...l}]}}),I=()=>{var l;a.value.trim()&&F({payload:{workspace_module_id:(l=i.value)==null?void 0:l._id,comment:a.value}})};X(i,l=>{var t;l!=null&&l.comments&&(u.value=[...l.comments]),(t=l==null?void 0:l.sheets)!=null&&t.length&&(m.value=l.sheets[0]._id)},{immediate:!0});const O=()=>{var l;E({payload:{workspace_id:c.value,module_id:(l=i==null?void 0:i.value)==null?void 0:l._id}})};return(l,t)=>{var j,P,M,$,S,B,z;const G=ee("router-link");return r(),d("div",pe,[e("header",_e,[e("div",ge,[e("div",ve,[x(G,{to:`/workspace/more/${o(c)}`},{default:h(()=>t[2]||(t[2]=[e("button",{class:"text-sm text-text-secondary cursor-pointer hover:underline flex gap-2 items-center"},[e("i",{class:"fa-solid fa-arrow-left"}),w(" Back to Apps ")],-1)])),_:1,__:[2]},8,["to"]),o(b)?(r(),d("div",he,t[3]||(t[3]=[e("div",{class:"h-6 w-48 bg-bg-body rounded"},null,-1),e("div",{class:"h-4 w-96 bg-bg-body/80 rounded"},null,-1),e("div",{class:"h-3 w-32 bg-bg-body/80 rounded"},null,-1)]))):(r(),d("div",ye,[e("h1",we,n((j=o(i))==null?void 0:j.title),1),e("p",ke,n((P=o(i))==null?void 0:P.description),1),e("p",Ce,n(((M=o(i))==null?void 0:M.no_of_views)??0)+" views · "+n((($=o(i))==null?void 0:$.no_of_used)??0)+" using",1)]))]),e("div",je,[x(U,{size:"sm",disabled:o(b)||o(C),onClick:O},{default:h(()=>[w(n(o(C)?"Processing...":"Use this Module"),1)]),_:1},8,["disabled"]),t[4]||(t[4]=e("button",{class:"border border-border rounded-lg w-9 h-9 text-text-secondary hover:text-accent flex items-center justify-center"},[e("span",null,"♡")],-1))])])]),e("main",Pe,[e("div",Me,[e("div",$e,[e("div",Se,[o(b)?(r(),d("div",Be)):(r(),q(re,{key:0,modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),options:(S=o(i))==null?void 0:S.sheets,variant:"secondary"},null,8,["modelValue","options"]))]),e("div",ze,[y(x(oe,null,null,512),[[L,o(k)]]),y(e("div",De,[x(fe,{columns:(B=o(A))==null?void 0:B.groups},null,8,["columns"])],512),[[L,!o(k)]])])]),e("aside",Ke,[t[6]||(t[6]=e("h3",{class:"font-medium text-sm"},"Tags",-1)),o(b)?(r(),d("div",Ne,t[5]||(t[5]=[e("div",{class:"h-6 w-16 bg-bg-body rounded"},null,-1),e("div",{class:"h-6 w-12 bg-bg-body rounded"},null,-1),e("div",{class:"h-6 w-20 bg-bg-body rounded"},null,-1)]))):(r(),d("div",Ue,[(r(!0),d(p,null,_((z=o(i))==null?void 0:z.tags,s=>(r(),d("span",{key:s,class:"border border-border bg-bg-surface cursor-pointer rounded-md px-2 py-1 text-xs text-text-secondary hover:bg-accent/50 hover:text-white"},n(s),1))),128))])),t[7]||(t[7]=Y('<h3 class="font-medium text-sm mt-6">Share</h3><div class="mt-3 flex gap-2"><button class="border border-border rounded-lg w-9 h-9 text-text-secondary hover:text-accent flex items-center justify-center">⇪</button><button class="border border-border rounded-lg w-9 h-9 text-text-secondary hover:text-accent flex items-center justify-center">⤫</button><button class="border border-border rounded-lg w-9 h-9 text-text-secondary hover:text-accent flex items-center justify-center">Ｆ</button></div><p class="text-xs text-text-secondary mt-6">Published 3 weeks ago</p><button class="text-xs text-text-secondary underline mt-1">Report resource</button>',4))])]),e("section",Le,[t[9]||(t[9]=e("h2",{class:"font-semibold text-base mb-3"},"Comments",-1)),o(b)?(r(),d("div",Te,t[8]||(t[8]=[e("div",{class:"h-20 w-full bg-bg-body rounded"},null,-1),e("div",{class:"h-6 w-24 bg-bg-body rounded"},null,-1)]))):(r(),d("div",qe,[y(e("textarea",{class:"w-full border border-border rounded-lg bg-bg-card text-sm text-text-secondary p-3 focus:outline-none",placeholder:"Add a comment...","onUpdate:modelValue":t[1]||(t[1]=s=>a.value=s)},null,512),[[V,a.value]]),e("div",Qe,[x(U,{onClick:I,size:"sm"},{default:h(()=>[w(n(o(H)?"Posting...":"Post"),1)]),_:1})])])),o(b)?Z("",!0):(r(),d("div",Re,[e("span",null,n(u.value.length)+" comments",1),(r(!0),d(p,null,_(u.value,s=>{var D,K,N;return r(),d("div",{key:s._id,class:"flex gap-3 mt-4 border-b border-border pb-2"},[(D=s.user_id)!=null&&D.u_profile_image?(r(),d("img",{key:0,class:"w-8 h-8 bg-bg-surface rounded-full",src:s.user_id.u_profile_image},null,8,Ae)):(r(),d("div",Ee,n(o(te)(((K=s==null?void 0:s.user_id)==null?void 0:K.u_full_name)??"")),1)),e("div",null,[e("p",Fe,n((N=s==null?void 0:s.user_id)==null?void 0:N.u_full_name),1),e("p",He,n(s==null?void 0:s.time),1),e("p",Ie,n(s==null?void 0:s.comment),1)])])}),128))]))])])])}}});export{Ve as default};
