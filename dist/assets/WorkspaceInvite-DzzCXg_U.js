import{d as S,K as U,bg as Y,r as v,n as A,j as d,f as t,p as o,L as E,t as n,i as y,w as k,B as h,g as c,k as w,al as B,o as i,m as G}from"./index-CjFOheYc.js";const L={class:"min-h-[100dvh] flex items-center justify-center bg-bg-body px-4"},H={class:"w-full max-w-xl"},J={class:"rounded-2xl border border-border bg-bg-card 1F2430] shadow-sm overflow-hidden"},K={key:0,class:"p-6"},O={key:1,class:"p-6"},P={class:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-800 dark:border-red-900/50 dark:bg-red-950/40 red-200"},q={class:"text-sm leading-relaxed"},z={class:"mt-4 flex gap-2"},M={key:2,class:"p-6"},Q={class:"rounded-lg border border-emerald-200 bg-emerald-50 p-4 text-emerald-800 emerald-200"},X={class:"text-sm leading-relaxed"},Z={class:"mt-4 flex gap-2"},ee={key:3,class:"p-6"},te={class:"mt-4 flex gap-2"},se={key:4,class:"p-6"},oe={class:"flex items-start gap-4"},ae=["src"],de={class:"text-lg font-medium text-text-primary"},ie={class:"text-sm text-text-secondary text-secondary-300"},le={class:"font-medium"},re={key:0},ne={class:"font-medium text-xs"},ce={key:0,class:"text-xs text-red-500 mt-1"},ue={key:1,class:"text-xs text-text-secondary -500 text-secondary-400 mt-1"},pe={key:0,class:"mt-4 rounded-lg border p-3 text-sm text-text-secondary -700 text-secondary-200 dark:border-border 1F2430]"},ve={class:"mt-6 flex flex-wrap gap-2"},me=["disabled"],xe={key:0},be={key:1},_e={key:1,class:"mt-3 text-xs text-emerald-600 emerald-400"},ye=S({__name:"WorkspaceInvite",setup(ge){const C=G(),{token:j}=U(),{data:s,refetch:N,isPending:R}=Y(j.value),u=v(null),r=v(!1),p=v(null),I=v(null),f=v(!1),T=v(!1);function V(l){return l?l.replace(/[_-]+/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}async function $(){var l,e;if(!(!s.value||s.value.status=="expired")){r.value=!0,p.value="accepted",u.value=null;try{await B.post(`/common/invitation/accept/${encodeURIComponent(j.value)}`,{status:"accepted"}),f.value=!0}catch(a){u.value=((e=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:e.message)||"Could not accept the invitation."}finally{r.value=!1,p.value=null}}}async function D(){var l,e;if(s.value){r.value=!0,p.value="decline",u.value=null;try{await B.post(`/common/invitation/accept/${encodeURIComponent(j.value)}`,{status:"rejected"}),T.value=!0}catch(a){u.value=((e=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:e.message)||"Could not decline the invitation."}finally{r.value=!1,p.value=null}}}function W(){C.push({name:"home"}).catch(()=>{})}function F(){var l,e,a,m,x,b,_,g;(e=(l=s.value)==null?void 0:l.workspace)!=null&&e._id?(a=s.value)!=null&&a.job_id?C.push(`/workspace/peak/${(_=(b=s.value)==null?void 0:b.workspace)==null?void 0:_._id}/${(g=s.value)==null?void 0:g.job_id}`):(localStorage.removeItem("jobId"),C.push(`/workspace/peak/${(x=(m=s.value)==null?void 0:m.workspace)==null?void 0:x._id}`)):W()}return A(()=>s.value,()=>{if(s.value.status=="rejected"){T.value=!0;return}if(s.value.status=="accepted"){f.value=!0;return}}),(l,e)=>{var a,m,x,b,_,g;return i(),d("div",L,[t("div",H,[t("div",J,[e[12]||(e[12]=t("div",{class:"px-6 py-5 border-b border-border"},[t("h1",{class:"text-2xl font-semibold text-text-primary"},"Workspace invitation"),t("p",{class:"text-sm text-text-secondary text-secondary-300 mt-1"}," Accept the invite to join this workspace, or decline to ignore it. ")],-1)),o(R)?(i(),d("div",K,e[1]||(e[1]=[E('<div class="animate-pulse space-y-4"><div class="h-5 w-56 bg-bg-surface"></div><div class="h-4 w-40 bg-bg-surface"></div><div class="h-24 w-full bg-bg-surface rounded-lg"></div><div class="flex gap-2"><div class="h-10 w-28 bg-bg-surface"></div><div class="h-10 w-28 bg-bg-surface"></div></div></div>',1)]))):u.value?(i(),d("div",O,[t("div",P,[e[2]||(e[2]=t("div",{class:"font-medium mb-1"},"We couldnâ€™t open this invite.",-1)),t("p",q,n(u.value),1)]),t("div",z,[t("button",{class:"px-4 py-2 rounded-md border text-sm border-border",onClick:e[0]||(e[0]=()=>o(N)())},"Try again"),y(h,{onClick:W},{default:k(()=>e[3]||(e[3]=[c("Go to home")])),_:1,__:[3]})])])):f.value?(i(),d("div",M,[t("div",Q,[e[6]||(e[6]=t("div",{class:"font-medium mb-1"},"Youâ€™re in! ðŸŽ‰",-1)),t("p",X,[e[4]||(e[4]=c(" Youâ€™ve joined ")),t("strong",null,n((a=o(s))==null?void 0:a.workspace_title),1),e[5]||(e[5]=c(". "))])]),t("div",Z,[y(h,{onClick:F},{default:k(()=>e[7]||(e[7]=[c("Open workspace")])),_:1,__:[7]})])])):T.value?(i(),d("div",ee,[e[9]||(e[9]=t("div",{class:"rounded-lg border border-gray-200 bg-gray-50 p-4 text-text-secondary -800 dark:border-border 1F2430] dark:bg-[#171922] text-secondary-200"},[t("div",{class:"font-medium mb-1"},"Invite declined"),t("p",{class:"text-sm leading-relaxed"},"Weâ€™ve let the workspace know you wonâ€™t be joining.")],-1)),t("div",te,[y(h,{onClick:W},{default:k(()=>e[8]||(e[8]=[c("Go to home")])),_:1,__:[8]})])])):(i(),d("div",se,[t("div",oe,[t("img",{src:o(s).workspace_logo,alt:"",class:"h-12 w-12 rounded-xl object-contain border border-border"},null,8,ae),t("div",null,[t("h2",de,n((m=o(s))==null?void 0:m.workspace_title),1),t("p",ie,[e[10]||(e[10]=c(" Invited by ")),t("span",le,n(o(s).invited_by||o(s).email),1),o(s).role_title?(i(),d("span",re," for the "+n(V(o(s).role_title))+" Role",1)):w("",!0),e[11]||(e[11]=t("br",null,null,-1)),t("span",ne,n(o(s).email),1)]),(x=o(s))!=null&&x.is_expire?(i(),d("p",ce,"This invite has expired.")):(b=o(s))!=null&&b.is_expire?(i(),d("p",ue," This Invitation Link has been Expire ")):w("",!0)])]),(_=I.value)!=null&&_.message?(i(),d("div",pe," â€œ"+n(I.value.message)+"â€ ",1)):w("",!0),t("div",ve,[y(h,{disabled:o(s).is_expire||r.value,onClick:$},{default:k(()=>[c(n(r.value&&p.value==="accepted"?"Joiningâ€¦":"Accept invitation"),1)]),_:1},8,["disabled"]),t("button",{class:"px-4 py-2 rounded-md text-sm border dark:border-border 353D50] hover:bg-gray-50 dark:hover:bg-[#1a1a1f] disabled:opacity-60 disabled:cursor-not-allowed",disabled:r.value||o(s).is_expire,onClick:D},[r.value&&p.value==="decline"?(i(),d("span",xe,"Decliningâ€¦")):(i(),d("span",be,"Decline"))],8,me)]),((g=I.value)==null?void 0:g.status)==="accepted"&&!f.value?(i(),d("p",_e," Youâ€™ve already accepted this invite. ")):w("",!0)]))]),e[13]||(e[13]=t("p",{class:"text-center text-xs text-text-secondary -500 text-secondary-400 mt-4"}," If this wasnâ€™t you, you can safely ignore this page. ",-1))])])}}});export{ye as default};
