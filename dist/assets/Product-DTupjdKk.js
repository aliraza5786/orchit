const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CreateTaskModal-BLcQDgvt.js","assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-Ch4RHO4z.js","assets/index-DKO9vpWs.js","assets/index-U_lIj89R.css","assets/CreateSheetModal-B0IrfRUV.js","assets/IconPicker-CDjwoOYr.js","assets/IconPicker-BPf3BB8o.css","assets/AudioRecorder.vue_vue_type_script_setup_true_lang-ChOs4L7_.js","assets/CreateSheetModal-CEob18WV.css","assets/CreateVariableModal-Bi_ouh9v.js","assets/ConfirmDeleteModal-D01-Rc7B.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-QiQIlSIU.js","assets/SidePanel-BFvZcF7S.js","assets/SidePanel-M_FgJti0.css","assets/KanbanBoard-BTJGHvw7.js","assets/lodash-Dt_72mC4.js","assets/lodash-B_VDCJnj.css","assets/DropMenu.vue_vue_type_script_setup_true_lang-DqzadSif.js","assets/workspace-OrqjaA3b.js","assets/KanbanBoard-DlFwUlEB.css"])))=>i.map(i=>d[i]);
import{d as Se,M as we,m as Q,r as i,c as T,i as c,e as o,F as A,x as q,t as Te,j as V,A as de,I as Xe,V as Ze,b as z,aQ as et,o as d,af as tt,ap as w,W as at,$ as lt,a as st,a2 as ot,Y as rt,ad as nt,a3 as dt,a4 as ut,ae as it,aa as vt,a0 as ct,h,w as F,f as ne,n as m,y as ke,C as he,a5 as U,g as ae,a9 as pt,_ as mt,B as bt,a6 as O,p as ft,bc as Ce,G as Ve,H as yt}from"./index-DKO9vpWs.js";import{u as gt}from"./workspace-OrqjaA3b.js";import{l as xt,F as _t,D as De,K as wt}from"./lodash-Dt_72mC4.js";import{_ as kt}from"./SearchBar.vue_vue_type_script_setup_true_lang-K_iaIn0L.js";import{K as ht}from"./KanbanTicket-Brj0GIbV.js";import"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-QiQIlSIU.js";import"./DropMenu.vue_vue_type_script_setup_true_lang-DqzadSif.js";const Ct={class:"kanban-table space-y-4 px-4 h-[85vh] overflow-y-auto"},Vt={class:"w-full border-collapse border-border shadow-sm rounded-lg overflow-hidden bg-bg-body/80 h-[200px] overflow-y-auto"},Dt={class:"bg-bg-surface border-b border-border sticky top-0 z-1"},St=["onClick"],Tt=["colspan"],At=["onMouseenter"],$t=["onUpdate:modelValue","onBlur"],Lt=["colspan"],Mt=Se({__name:"TableView",props:{columns:{},rows:{},isPending:{type:Boolean}},emits:["update:rows","create"],setup(ue,{emit:C}){const E=ue,B=C,p=we(E.rows||[]);Q(()=>E.rows,s=>{s&&p.splice(0,p.length,...s)});const u=we({id:null,field:""}),D=i(null),j=i(null),$=T(()=>p.some(s=>u.id===s.id&&!s[u.field])),H=(s,a)=>{u.id=s.id,u.field=a,tt(()=>{var l;return(l=j.value)==null?void 0:l.focus()})},g=()=>{u.id=null,u.field=""},x=s=>{var a;if(!((a=s[u.field])!=null&&a.trim())){const l=p.findIndex(f=>f.id===s.id);l!==-1&&p.splice(l,1)}g(),B("update:rows",p.slice()),B("create",s)},k=s=>{var l;const a={id:Date.now()};E.columns.forEach(f=>a[f.key]=""),p.splice(s,0,a),H(a,((l=E.columns[0])==null?void 0:l.key)||""),D.value=null,B("update:rows",p.slice())};function le(s,a){if(!(!s||!a))return a.includes(".")?a.split(".").reduce((l,f)=>l==null?l:l[f],s):s[a]}function R(s,a){return a!=null&&a.accessor?a.accessor(s):le(s,a.key)}const W=s=>{var l;const a=R(s.row,s.column);return(l=s.column)!=null&&l.render?s.column.render({row:s==null?void 0:s.row,column:s==null?void 0:s.column,value:a,index:s==null?void 0:s.index}):w("span",String(a??""))};return(s,a)=>(d(),c("div",Ct,[o("table",Vt,[o("thead",Dt,[o("tr",null,[a[4]||(a[4]=o("th",{class:"w-8 p-1"},null,-1)),(d(!0),c(A,null,q(s.columns,l=>(d(),c("th",{key:l==null?void 0:l.key,class:"text-left p-1 font-medium"},Te(l==null?void 0:l.label),1))),128))])]),o("tbody",null,[s.isPending?(d(),c(A,{key:0},q(5,l=>o("tr",{key:"sk-"+l,class:"animate-pulse border-b border-border"},[a[6]||(a[6]=o("td",{class:"p-2"},[o("div",{class:"w-4 h-4 bg-bg-surface rounded"})],-1)),(d(!0),c(A,null,q(s.columns,f=>(d(),c("td",{key:f.key,class:"p-2"},a[5]||(a[5]=[o("div",{class:"w-full h-4 bg-bg-surface rounded"},null,-1)])))),128))])),64)):(d(!0),c(A,{key:1},q(p,(l,f)=>{var y;return d(),c(A,{key:l==null?void 0:l.id},[D.value===f&&!$.value?(d(),c("tr",{key:0,class:"relative bg-bg-surface/50 transition-all cursor-pointer",onMouseleave:a[0]||(a[0]=n=>D.value=null)},[o("td",{class:"!p-0 w-8",onClick:n=>k(f)},a[7]||(a[7]=[o("span",{class:"absolute left-[-6px] top-[-6px] bg-bg-card border border-border w-6 h-6 text-sm rounded-md flex justify-center items-center shadow-sm hover:bg-bg-card/10"},"+",-1)]),8,St),o("td",{class:"!p-0",colspan:(y=s.columns)==null?void 0:y.length},null,8,Tt)],32)):V("",!0),o("tr",{onMouseenter:n=>D.value=f,class:"hover:bg-surface/50 transition-colors border-b border-border"},[a[8]||(a[8]=o("td",{class:"p-2"},null,-1)),(d(!0),c(A,null,q(s.columns,n=>(d(),c("td",{key:n==null?void 0:n.key,class:"p-2"},[(u==null?void 0:u.id)===(l==null?void 0:l.id)&&(u==null?void 0:u.field)===(n==null?void 0:n.key)?de((d(),c("input",{key:0,"onUpdate:modelValue":v=>l[n==null?void 0:n.key]=v,onBlur:v=>x(l),class:"w-full p-1 border border-border rounded focus:outline-none focus:ring focus:ring-blue-300",ref_for:!0,ref:v=>v&&(u==null?void 0:u.id)===(l==null?void 0:l.id)&&(u==null?void 0:u.field)===(n==null?void 0:n.key)&&(j.value=v)},null,40,$t)),[[Ze,l[n==null?void 0:n.key]]]):Xe(s.$slots,n.key,{key:2,row:l,column:n,index:`r-${l._id}`},()=>[(d(),z(et(W),{row:l,column:n,index:l._id},null,8,["row","column","index"]))])]))),128))],40,At)],64)}),128)),$.value?V("",!0):(d(),c("tr",{key:2,class:"bg-bg-surface transition sticky bottom-0 cursor-pointer border-t border-border",onMouseenter:a[2]||(a[2]=l=>D.value=p==null?void 0:p.length),onMouseleave:a[3]||(a[3]=l=>D.value=null)},[o("td",{class:"p-2",onClick:a[1]||(a[1]=l=>k(p==null?void 0:p.length))},a[9]||(a[9]=[o("span",{class:"plus inline-flex w-5 h-5 border border-border rounded-full justify-center items-center text-secondary hover:bg-bg-surface/200 transition"},"+",-1)])),o("td",{colspan:s.columns.length,class:"p-2 text-text-secondary border-border"},"Add New Row",8,Lt)],32))])])]))}}),Et={class:"flex-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur rounded-2xl shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] flex-grow h-full bg-bg-card border border-border overflow-x-auto flex-col flex scrollbar-visible"},It={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},Pt={class:"flex gap-3 items-center"},Ut={class:"flex items-center gap-3 bg-bg-surface/50 h-[32px] px-2 rounded-md"},Ot={class:"flex overflow-x-auto gap-3 p-4 scrollbar-visible"},zt={key:0,class:"mx-auto text-text-secondary/80 m-2 w-[90%] h-full justify-center flex items-center border border-dashed border-border"},Bt={key:0,class:"bg-bg-body rounded-lg p-4"},Rt={class:"flex items-center mt-3 gap-3"},Nt=Se({__name:"Product",setup(ue){const C=i("kanban"),E=U(()=>O(()=>import("./CreateTaskModal-BLcQDgvt.js"),__vite__mapDeps([0,1,2,3]))),B=U(()=>O(()=>import("./CreateSheetModal-B0IrfRUV.js"),__vite__mapDeps([4,2,3,5,6,7,8]))),p=U(()=>O(()=>import("./CreateVariableModal-Bi_ouh9v.js"),__vite__mapDeps([9,2,3]))),u=U(()=>O(()=>import("./ConfirmDeleteModal-D01-Rc7B.js"),__vite__mapDeps([10,11,2,3]))),D=U(()=>O(()=>import("./SidePanel-BFvZcF7S.js"),__vite__mapDeps([12,2,3,13]))),j=U(()=>O(()=>import("./KanbanBoard-BTJGHvw7.js"),__vite__mapDeps([14,15,2,3,11,16,17,18,19]))),$=i(!1),H=ft(),{workspaceId:g,moduleId:x}=at(),{data:k}=lt(g.value,x.value),le=st(),{mutate:R,isPending:W}=ot({onSuccess:()=>{le.invalidateQueries({queryKey:["sheet-list"]}),ee.value="",I.value=!1,Z.value=!1,I.value=!1}}),s=e=>{R({workspace_id:g.value,module_id:x.value,variable_id:v.value,value:e})},{data:a,refetch:l}=rt({workspace_id:g,workspace_module_id:x}),f=T(()=>{var e;return a.value?(e=a.value[0])==null?void 0:e._id:""}),y=i(f.value);Q(f,()=>{y.value=f.value});const n=T(()=>{var e;return k!=null&&k.value?(e=k==null?void 0:k.value[0])==null?void 0:e._id:""}),v=i(n.value);Q(n,()=>{v.value=n.value});const G=gt(),{data:Y,isPending:se}=nt(x,y,T(()=>[...G.selectedLaneIds]),v),J=i(!1),X=i(),oe=e=>{X.value=e},N=i(!1),Ae=()=>{M.value={},N.value=!N.value},$e=dt(),Le=ut();function Me(e){e.type=="column"?$e.mutate({payload:{workspace_id:g.value,workspace_module_id:x.value,variable_id:v.value,moved_value:e.meta.id,new_index:e.meta.newIndex}}):Le.mutate({payload:{workspace_id:g.value,card_id:e.meta.moved._id,group_value:e.meta.fromColumnId,group_variable_id:v.value,new_index:e.meta.newIndex,sheet_id:y.value}})}const Ee=e=>{},Ie=T(()=>(a.value||[]).map(e=>({_id:e._id,title:e==null?void 0:e.variables["sheet-title"],description:e==null?void 0:e.variables["sheet-description"],icon:e.icon,status:e==null?void 0:e.generation_status})));Q(a,e=>{var t;(e==null?void 0:e.length)>0&&(y.value=(t=e[0])==null?void 0:t._id)});const Z=i(!1),ee=i("");function ie(){Z.value=!Z.value}function ve(){const e=ee.value.trim();e&&s(e)}const Pe=e=>{R({workspace_id:H.params.id,module_id:H.params.module_id,new_value:e.title,value:e.oldTitle,variable_id:v.value})},I=i(!1),L=i(),Ue=()=>{R({value:L.value.title,workspace_id:g.value,module_id:x.value,newValue:L.value.title,variable_id:v.value,is_trash:!0})},Oe=e=>{I.value=!0,L.value=e},ze=e=>{J.value=!0,L.value=e},K=i(!1),M=i();function Be(e){K.value=!0,M.value=e}const{mutate:Re,isPending:Ne}=it({onSuccess:()=>{l(),K.value=!1}});function Ke(){var e;Re({sheet_id:(e=M.value)==null?void 0:e._id,workspace_module_id:x.value,is_trash:!0})}function qe(e){N.value=!0,M.value=e}const te=i(""),Fe=i("");Q(te,xt.debounce(e=>{Fe.value=e},200));const Qe=T(()=>{const e=Y.value.flatMap(t=>t.cards.map(b=>({...b,columnId:t.title})));return new _t(e,{keys:["card-title","card-description"],threshold:.3})}),je=T(()=>{if(!te.value)return Y.value;const e=Qe.value.search(te.value).map(t=>t.item);return Y.value.map(t=>({...t,cards:e.filter(b=>b.columnId===t.title)}))}),He=[{key:"card-title",label:"Title",render:({row:e,value:t})=>w("input",{onFocusout:b=>{var _;re(e==null?void 0:e._id,"card-title",(_=b==null?void 0:b.target)==null?void 0:_.value)},class:"text-sm cursor-pointer text-text-primary capitalize outline-none border-none focus:border  active:bg-bg-surface focus:bg-bg-card backdrop-blur focus:border-accent p-1 rounded-md",defaultValue:t})},{key:"card-status",label:"Status",render:({row:e,value:t})=>{var S;const{data:b}=Ce(g,x,"card-status"),_=i(t);return w("div",{class:" capitalize flex items-center gap-2 "},[w(Ve,{options:ce(((S=b.value)==null?void 0:S.values)??[])||[],size:"sm",modelValue:_.value,defaultValue:_.value,onUpdate:P=>{re(e==null?void 0:e._id,"card-status",P)}})])}},{key:"card-type",label:"Type",render:({row:e,value:t})=>{var S;const{data:b}=Ce(g,x,"card-type"),_=i(t);return w("div",{class:" capitalize flex items-center gap-2 "},[w(Ve,{options:ce(((S=b.value)==null?void 0:S.values)??[])||[],size:"sm",modelValue:_.value,defaultValue:_.value,onUpdate:P=>{re(e==null?void 0:e._id,"card-type",P)}})])}},{key:"end-date",label:"Due Date",render:({value:e})=>w("div",{class:" capitalize flex items-center gap-2 "},[w("span",e)])},{key:"lane",label:"Lane",render:({value:e})=>w("div",{class:"capitalize flex items-center gap-2 "},[w("div",{class:"w-3 h-3 rounded-full  ",style:`background:${e!=null&&e.variables?e==null?void 0:e.variables["lane-color"]:""}`},""),w("span",e!=null&&e.variables?e==null?void 0:e.variables["lane-title"]:"")])}],We=T(()=>{let e=[];return(Y.value??[]).forEach(t=>{e=[...e,...t==null?void 0:t.cards]}),e}),ce=e=>e.map(t=>({_id:t.value,title:t.value})),Ge=vt({onSuccess:()=>{}});function re(e,t,b){Ge.mutate({card_id:e,variables:{[t]:b.trim()}})}const{mutate:Ye}=ct({onSuccess:()=>{}});function Je(e){const t={sheet_list_id:"To Do",workspace_id:g.value,sheet_id:y.value,variables:{"card-title":e["card-title"].trim()},createdAt:new Date().toISOString()};Ye(t)}return(e,t)=>{var b,_,S,P,pe,me,be;return d(),c(A,null,[o("div",Et,[o("div",It,[h(De,{onEditOption:qe,modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=r=>y.value=r),onDeleteOption:Be,options:Ie.value,variant:"secondary"},{more:F(()=>[o("div",{onClick:t[0]||(t[0]=r=>Ae()),class:"capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},t[22]||(t[22]=[o("i",{class:"fa-solid fa-plus"},null,-1),ne(" Add new ")]))]),_:1},8,["modelValue","options"]),o("div",Pt,[C.value=="kanban"?(d(),z(De,{key:0,actions:!1,prefix:"View by",modelValue:v.value,"onUpdate:modelValue":t[3]||(t[3]=r=>v.value=r),options:m(k),variant:"secondary"},{more:F(()=>[o("div",{onClick:t[2]||(t[2]=()=>{$.value=!0}),class:"sticky bottom-0 bg-bg-dropdown shadow-md shadow-border capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},t[23]||(t[23]=[o("i",{class:"fa-solid fa-plus"},null,-1),ne(" Add new ")]))]),_:1},8,["modelValue","options"])):V("",!0),h(kt,{onOnChange:t[4]||(t[4]=r=>{te.value=r}),placeholder:"Search in Orchit AI space"}),o("div",Ut,[o("button",{class:ke(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",C.value==="kanban"?"text-accent bg-accent-text":" hover:bg-border/50 backdrop-blur-2xl  transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"List view",onClick:t[5]||(t[5]=r=>C.value="kanban")},t[24]||(t[24]=[o("i",{class:"fa-solid fa-chart-kanban"},null,-1)]),2),o("button",{onClick:t[6]||(t[6]=r=>C.value="table"),class:ke(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",C.value==="table"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gallery view"},t[25]||(t[25]=[o("i",{class:"fa-solid fa-align-left"},null,-1)]),2)])])]),C.value=="kanban"?(d(),c(A,{key:0},[de(h(wt,null,null,512),[[he,m(se)]]),de(o("div",Ot,[h(m(j),{onOnPlus:ze,board:je.value,"onDelete:column":t[7]||(t[7]=r=>Oe(r)),"onUpdate:column":t[8]||(t[8]=r=>Pe(r)),onReorder:Me,onAddColumn:s,"onSelect:ticket":oe,onOnBoardUpdate:Ee,variable_id:v.value,sheet_id:y.value},{"column-footer":F(r=>{var fe,ye,ge,xe,_e;return[(ye=(fe=m(G))==null?void 0:fe.transitions)!=null&&ye.all_allowed&&!((_e=(xe=(ge=m(G))==null?void 0:ge.transitions)==null?void 0:xe.all_allowed)!=null&&_e.includes(r.column.title))&&m(G).transitions.currentColumn!=r.column.title?(d(),c("div",zt," Disbale ( you can't drop here )")):V("",!0)]}),ticket:F(({ticket:r})=>[h(ht,{selectedVar:v.value,onSelect:()=>{oe(r)},ticket:r},null,8,["selectedVar","onSelect","ticket"])]),_:1},8,["board","variable_id","sheet_id"]),o("div",{class:"min-w-[328px]",onClick:t[10]||(t[10]=ae(()=>{},["stop"]))},[Z.value?(d(),c("div",Bt,[h(mt,{autofocus:!0,modelValue:ee.value,"onUpdate:modelValue":t[9]||(t[9]=r=>ee.value=r),placeholder:"Add New list",onKeyup:pt(ve,["enter"])},null,8,["modelValue"]),t[26]||(t[26]=o("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),o("div",Rt,[h(bt,{onClick:ve,varaint:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:F(()=>[ne(Te(m(W)?"Adding...":"Add list"),1)]),_:1}),o("i",{class:"fa-solid fa-close",onClick:ie})])])):(d(),c("button",{key:1,class:"text-sm text-text-primary py-2.5 cursor-pointer font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",onClick:ae(ie,["stop"])}," + Add List "))])],512),[[he,!m(se)]])],64)):V("",!0),C.value=="table"?(d(),z(Mt,{key:1,isPending:m(se),columns:He,rows:We.value,onCreate:Je},null,8,["isPending","rows"])):V("",!0)]),h(m(u),{onClick:t[11]||(t[11]=ae(()=>{},["stop"])),modelValue:I.value,"onUpdate:modelValue":t[12]||(t[12]=r=>I.value=r),title:"Delete List",itemLabel:"list",itemName:(b=L.value)==null?void 0:b.title,requireMatchText:(_=L.value)==null?void 0:_.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:m(W),onConfirm:Ue,onCancel:t[13]||(t[13]=()=>{I.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),J.value?(d(),z(m(E),{selectedVariable:v.value,listId:(S=L.value)==null?void 0:S.title,sheet_id:y.value,key:"createTaskModalKey",modelValue:J.value,"onUpdate:modelValue":t[14]||(t[14]=r=>J.value=r),onSubmit:t[15]||(t[15]=()=>{})},null,8,["selectedVariable","listId","sheet_id","modelValue"])):V("",!0),(P=X.value)!=null&&P._id?(d(),z(m(D),{key:1,details:X.value,onClose:t[16]||(t[16]=()=>{oe({variables:{}})}),showPanel:!!((pe=X.value)!=null&&pe._id)},null,8,["details","showPanel"])):V("",!0),h(m(B),{size:"md",sheet:M.value,modelValue:N.value,"onUpdate:modelValue":t[17]||(t[17]=r=>N.value=r)},null,8,["sheet","modelValue"]),$.value?(d(),z(m(p),{key:2,modelValue:$.value,"onUpdate:modelValue":t[18]||(t[18]=r=>$.value=r),sheetID:y.value},null,8,["modelValue","sheetID"])):V("",!0),h(m(u),{onClick:t[19]||(t[19]=ae(()=>{},["stop"])),modelValue:K.value,"onUpdate:modelValue":t[20]||(t[20]=r=>K.value=r),title:"Delete Sheet",itemLabel:"Sheet",itemName:(me=M.value)==null?void 0:me.title,requireMatchText:(be=M.value)==null?void 0:be.title,confirmText:"Delete Sheet",cancelText:"Cancel",size:"md",loading:m(Ne),onConfirm:Ke,onCancel:t[21]||(t[21]=()=>{K.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"])],64)}}}),Gt=yt(Nt,[["__scopeId","data-v-21e11bbe"]]);export{Gt as default};
