const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CreateTaskModal-DqsxEstZ.js","assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-CKuVfURT.js","assets/index-Bj_k5aKY.js","assets/index-CalS_IDC.css","assets/ConfirmDeleteModal-CinGsOSy.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-BRQZr31-.js","assets/SidePanel-jt_L_kql.js","assets/SidePanel-U7OOMI6M.css","assets/KanbanBoard-D6fejA3E.js","assets/lodash-B3d4OLnQ.js","assets/DropMenu.vue_vue_type_script_setup_true_lang-D1unIeFQ.js","assets/KanbanBoard-Dffh696C.css"])))=>i.map(i=>d[i]);
import{R as lt,S as kt,p as g,T as De,c as T,r as y,n as z,K as tt,U as vt,d as at,V as Xt,W as bl,j as b,f as t,h as $e,z as Q,F as fe,y as ke,o as f,t as N,Q as Yt,J as Ut,O as Dl,e as pe,w as se,X as el,i as F,_ as tl,I as Ft,g as oe,B as ze,k as U,Y as ht,D as et,P as ll,N as al,M as yl,Z as xl,$ as _l,a0 as hl,a1 as kl,a2 as Sl,E as Gt,a3 as Tl,a4 as Vl,a5 as El,u as Ll,a6 as Al,a7 as Ml,a8 as Bl,a9 as Il,aa as Fl,ab as Ul,ac as Ol,ad as qe,ae as Jt,q as Nl,af as Pl,l as Kt,ag as At,A as Mt,ah as ve,ai as ql,aj as il,ak as zl,al as jl,v as Rl,am as Hl,an as dl,ao as Wl}from"./index-Bj_k5aKY.js";import{u as sl}from"./useTheme-BwfLuw4f.js";import{_ as Kl}from"./BaseTextAreaField.vue_vue_type_script_setup_true_lang-CjQW3M06.js";import{_ as ul}from"./SearchBar.vue_vue_type_script_setup_true_lang-CkhD08e2.js";import{o as Bt,_ as Ql}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-BRQZr31-.js";import{D as Qt,K as wl}from"./Dropdown-Cashjeiu.js";import{_ as Gl,a as cl,b as Jl,k as Zl}from"./TableAssigneeCell.vue_vue_type_script_setup_true_lang-DHa5EGJn.js";import{K as Xl}from"./KanbanTicket-BjN9qmwX.js";import{F as pl}from"./fuse-Ch1WBRTM.js";import{l as Yl}from"./lodash-B3d4OLnQ.js";import"./DropMenu.vue_vue_type_script_setup_true_lang-D1unIeFQ.js";const ea="data:image/svg+xml,%3csvg%20width='60'%20height='46'%20viewBox='0%200%2060%2046'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M59.7443%2034.8967L50.5682%2025.7206C50.4457%2025.5984%2050.2897%2025.5152%2050.1199%2025.4816C49.9501%2025.4479%2049.7742%2025.4653%2049.6143%2025.5315C49.4544%2025.5976%2049.3176%2025.7097%2049.2213%2025.8535C49.125%2025.9973%2049.0734%2026.1664%2049.073%2026.3394V30.517H25.9775V40.5114H49.0755V44.689C49.0759%2044.8621%2049.1275%2045.0312%2049.2238%2045.175C49.3201%2045.3187%2049.4569%2045.4308%2049.6168%2045.497C49.7767%2045.5632%2049.9527%2045.5805%2050.1224%2045.5468C50.2922%2045.5132%2050.4482%2045.43%2050.5708%2045.3078L59.7468%2036.1318C59.9095%2035.9672%2060.0005%2035.7451%2060.0001%2035.5137C59.9996%2035.2823%2059.9076%2035.0605%2059.7443%2034.8967Z'%20fill='%23C6DBA9'/%3e%3cpath%20d='M32.3149%2030.5293C30.664%2031.5967%2028.7394%2032.1633%2026.7734%2032.1609V40.5237H34.7295C39.2829%2038.5638%2042.9649%2035.0102%2045.0851%2030.5293H32.3149Z'%20fill='url(%23paint0_linear_250_16424)'/%3e%3cpath%20d='M46.2209%2020.2832C46.2317%2015.0884%2044.2448%2010.0884%2040.6714%206.3179C37.0981%202.54738%2032.2119%200.295026%2027.024%200.0269855C21.8362%20-0.241055%2016.7439%201.49574%2012.801%204.87791C8.85809%208.26009%206.36647%2013.0287%205.84178%2018.1969L2.46233%2017.8913C2.31055%2017.8782%202.15829%2017.9103%202.02467%2017.9835C1.89106%2018.0566%201.78205%2018.1677%201.71134%2018.3026C1.64063%2018.4376%201.61138%2018.5904%201.62726%2018.7419C1.64313%2018.8934%201.70343%2019.0368%201.80058%2019.1542L9.51927%2028.406C9.79205%2028.7344%2010.277%2028.7773%2010.378%2028.5045L19.6298%2020.7833C20.3876%2020.3413%2020.1173%2019.4825%2019.4328%2019.4194L15.8008%2019.091C16.0297%2017.1283%2016.8213%2015.2735%2018.0802%2013.7503C19.3391%2012.2271%2021.0115%2011.1004%2022.8961%2010.5059C24.7806%209.9114%2026.7969%209.8745%2028.7019%2010.3996C30.6069%2010.9248%2032.3195%2011.9896%2033.6332%2013.4657C34.947%2014.9419%2035.8059%2016.7664%2036.1065%2018.7195C36.4071%2020.6726%2036.1365%2022.6709%2035.3274%2024.4738C34.5183%2026.2766%2033.2051%2027.8071%2031.5462%2028.8807C29.8872%2029.9544%2027.9531%2030.5254%2025.977%2030.5251H25.9283V40.5094C31.2249%2040.4031%2036.7093%2038.2263%2040.4202%2034.4455C44.1311%2030.6648%2046.2134%2025.5808%2046.2209%2020.2832Z'%20fill='%23D7A39E'/%3e%3cpath%20d='M25.9773%2030.5293H0V40.5237H25.9773V30.5293Z'%20fill='url(%23paint1_linear_250_16424)'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_250_16424'%20x1='6.53714'%20y1='35.5252'%20x2='47.0198'%20y2='35.5252'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%236C798F'/%3e%3cstop%20offset='1'%20stop-color='%236C798F'%20stop-opacity='0.1'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_250_16424'%20x1='0'%20y1='36'%20x2='26'%20y2='36'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23E8D4D3'%20stop-opacity='0'/%3e%3cstop%20offset='1'%20stop-color='%23E2A39F'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",ta=(w,_,B={})=>kt({queryKey:T(()=>["sprint-list",g(w),g(_)]),queryFn:({signal:V})=>De({url:`sprints/${g(w)}`,method:"GET",signal:V,params:{sprintType:g(_)}}),...B}),la=(w,_={})=>kt({queryKey:["sprint-cards",w],queryFn:({signal:B})=>De({url:`sprints/${g(w)}/backlog`,method:"GET",signal:B}),..._}),aa=(w,_,B={})=>kt({queryKey:["sprint-kanban",w,_],queryFn:({signal:V})=>De({url:"workspace/cards/sprintgrouped",method:"GET",signal:V,params:{sprint_id:g(w),variable_id:"68b6c96e0a95eef7d14e6981",sheet_id:g(_)}}),...B}),sa=(w,_={})=>lt({key:["sprint-complete"]},{mutationFn:B=>De({url:`sprints/${g(w)}/complete`,method:"POST",data:B.payload}),..._}),na=(w,_={})=>kt({queryKey:["sprint-detail",w],queryFn:({signal:B})=>De({url:`sprints/detail/${g(w)}?include_cards=true`,method:"GET",signal:B}),..._}),Zt=(w,_,B=null,V={})=>kt({queryKey:["backlog-list",w,g(_),g(B)],queryFn:({signal:P})=>De({url:`sprints/workspace/${g(w)}/cards`,method:"GET",signal:P,params:{include_sprint_cards:!1,sprintType:g(_),module_id:g(B)}}),...V}),oa=(w={})=>lt({key:["add-sprint"]},{mutationFn:_=>De({url:"/sprints",method:"POST",data:_.payload}),...w}),Cl=(w={})=>lt({key:["move-card-to-sprint"]},{mutationFn:_=>De({url:`/sprints/${_.id}/cards`,method:"POST",data:_.payload}),...w}),fl=(w={})=>lt({key:["add-sprint"]},{mutationFn:_=>De({url:`/sprints/${_.id}`,method:"PUT",data:_.payload}),...w}),ra=(w={})=>lt({key:["start-sprint"]},{mutationFn:_=>De({url:`/sprints/${_.id}/start`,method:"POST",data:_.payload}),...w}),ia=(w={})=>lt({key:["delete-sprint"]},{mutationFn:_=>De({url:`/sprints/${_}`,method:"DELETE"}),...w}),da=(w={})=>lt({key:["remove-card-from-sprint"]},{mutationFn:_=>De({url:`sprints/${g(_.sprintId)}/cards/remove `,method:"POST",data:{card_ids:[_.cardId]}}),...w}),$l="jira-like:";function vl(w="id"){return`${w}_${Math.random().toString(36).slice(2,9)}`}function ml(w,_){try{localStorage.setItem($l+w,JSON.stringify(_))}catch{}}function gl(w,_){try{const B=localStorage.getItem($l+w);return B?JSON.parse(B):_}catch{return _}}function ua(w){switch(w){case"Highest":return"rounded-md bg-red-50 px-2 py-0.5 text-xs text-red-700";case"High":return"rounded-md bg-orange-50 px-2 py-0.5 text-xs text-orange-700";case"Medium":return"rounded-md bg-amber-50 px-2 py-0.5 text-xs text-amber-700";case"Low":return"rounded-md bg-gray-100 px-2 py-0.5 text-xs text-gray-600"}}function ca(){const w=y(gl("backlog",[])),_=y(gl("sprints",[]));if(_.value.length===0)_.value.push({id:vl("sprint"),name:"Sprint 1",goal:"",start:"",end:"",started:!1,tickets:[]});else if(_.value.length>1){for(let c=1;c<_.value.length;c++)w.value.push(..._.value[c].tickets);_.value=[_.value[0]]}const B=y(_.value[0].id);z([w,_],()=>{ml("backlog",w.value),ml("sprints",_.value)},{deep:!0});const V=y([]),P=tt({}),$=T(()=>w.value.length>0&&V.value.length===w.value.length),u=c=>{var r;const a=_.value.find(s=>s.id===c);return!!a&&a.tickets.length>0&&(((r=P[c])==null?void 0:r.length)||0)===a.tickets.length};function E(c,a,r){const s=a.target.checked;if(c==="backlog")V.value=s?w.value.map(v=>v.id):[];else if(r){const v=_.value.find(h=>h.id===r);P[r]=s&&v?v.tickets.map(h=>h.id):[]}}function R(c,a,r,s){const v=r.target.checked,h=c==="backlog"?V.value:P[s]||(P[s]=[]);if(v&&!h.includes(a)&&h.push(a),!v){const J=h.indexOf(a);J>=0&&h.splice(J,1)}}function H(){return _.value.find(c=>c.id===B.value)||_.value[0]}function O(){const a=[...w.value,..._.value.flatMap(s=>s.tickets)].map(s=>Number(String(s.key).replace(/[^0-9]/g,""))).filter(s=>!Number.isNaN(s));return`PRJ-${a.length?Math.max(...a)+1:1}`}const{mutate:q}=Cl({onSuccess:()=>{vt.success("Cards moved to sprint successfully")},onError:c=>{vt.error("Failed to move cards: "+(c.message||"Unknown error"))}});function K(){var s,v;const c=H();if(!c||!V.value.length)return;const a=[],r=[];for(const h of w.value)(V.value.includes(h.id)?r:a).push(h);w.value=a,c.tickets.push(...r),V.value=[],r.length>0&&q({id:c.id,payload:{card_ids:r.map(h=>h.id),priority:((v=(s=r[0])==null?void 0:s.priority)==null?void 0:v.toLowerCase())||"medium",story_points:r.reduce((h,J)=>h+(J.storyPoints||0),0)}})}function L(c){const a=_.value.find(h=>h.id===c);if(!a)return;const r=P[c]||[],s=[],v=[];for(const h of a.tickets)(r.includes(h.id)?v:s).push(h);a.tickets=s,w.value.push(...v),P[c]=[]}function I(c,a){if(c==="backlog")w.value=w.value.filter(r=>!V.value.includes(r.id)),V.value=[];else if(a){const r=P[a]||[],s=_.value.find(v=>v.id===a);if(!s)return;s.tickets=s.tickets.filter(v=>!r.includes(v.id)),P[a]=[]}}function W(c,a){const r={id:vl("T"),key:O(),createdAt:new Date().toISOString(),...a};if(c==="backlog")w.value.push(r);else{const s=H();s==null||s.tickets.push(r)}}function le(c){const a=H();a&&(a.name=c.name??a.name,a.goal=c.goal??a.goal,a.start=c.start??a.start,a.end=c.end??a.end)}function ae(){const c=H();c&&(c.started=!c.started)}function M(c){return c.tickets.reduce((a,r)=>a+(r.storyPoints||0),0)}return{backlog:w,sprints:_,activeSprintId:B,selectedBacklogIds:V,selectedSprintIds:P,allBacklogChecked:$,allSprintChecked:u,toggleAll:E,toggleOne:R,getActiveSprint:H,createTicket:W,saveSprintMeta:le,toggleStartSprint:ae,sprintPoints:M,moveSelectedToSprint:K,moveSelectedToBacklog:L,deleteSelected:I,priorityClass:ua}}const pa={class:"h-full min-h-0"},fa={key:0,class:"empty-state flex flex-col justify-center items-center h-full"},va=["disabled"],ma={key:1,class:"overflow-y-auto h-[calc(100%-50px)] tickets-scroll"},ga={class:"flex flex-col flex-1 gap-[4px] min-w-0 me-1"},ba=["onDragstart","onClick"],ya=["checked","onChange"],xa={class:"flex items-center text-[14px] font-sans font-medium capitalize text-text-secondary flex-1 min-w-0"},_a={class:"truncate"},ha={class:"flex-shrink-0"},ka={key:0,class:"flex justify-center text-gray-500 items-center text-[11px] aspect-square w-[24px] h-[24px] bg-bg-body rounded-full border-border-input border-2"},Sa={key:1,class:"w-6 h-6 rounded-full"},wa=["src"],Ca={key:2,class:"text-[11px] aspect-square w-24px flex justify-center items-center h-[24px] bg-accent/30 text-accent border-accent border rounded-full"},$a=at({__name:"BacklogTable",props:{searchQuery:{type:String,default:""},sprintType:{type:String,default:""},checkedAll:{type:Boolean,default:!1},moduleId:[String,Number,null]},emits:["ticket-dragged-to-sprint","open-ticket","ticket-moved-to-backlog","open-create-ticket"],setup(w,{emit:_}){const{theme:B}=sl(),{canCreateCard:V}=Xt(),P=_,$=w,{workspaceId:u}=bl(),E=y($.moduleId??null),{data:R,isPending:H}=Zt(u,$.sprintType,E),O=y([]),q=y(!1),K=y([]),L=y([]);z(R,r=>{r!=null&&r.cards&&(O.value=r.cards.map(s=>{var D,me,ge,Se;const v=((D=s.card)==null?void 0:D.variables)??{},h=((me=s.card)==null?void 0:me._id)??s.card_id,J=String(v["card-status"]??"").trim(),k=String(v.priority??"").trim();return{id:h,key:v["card-code"]||(h==null?void 0:h.slice(-6))||"PRJ-?",summary:v["card-title"]||"(untitled)",type:"Story",status:J,assignee:((ge=s.card)==null?void 0:ge.assigned_to)??"Unassigned",storyPoints:Number(s.story_points??0)||0,priority:W(k),createdAt:((Se=s.card)==null?void 0:Se.created_at)??new Date().toISOString(),description:v["card-description"]||""}}))},{immediate:!0}),z(O,r=>{const s=new Set(r.map(v=>v.id));L.value=L.value.filter(v=>s.has(v))});const I=T(()=>{if(console.log($.searchQuery,"this is query"),!$.searchQuery)return O.value;const r=$.searchQuery.toLowerCase();return O.value.filter(s=>{var h;const v=typeof s.assignee=="string"?s.assignee:((h=s.assignee)==null?void 0:h.u_full_name)||"";return s.key.toLowerCase().includes(r)||s.summary.toLowerCase().includes(r)||v.toLowerCase().includes(r)})});function W(r){const s=String(r??"").toLowerCase();return["highest","blocker","critical"].includes(s)?"Highest":["high","major"].includes(s)?"High":["medium","normal"].includes(s)?"Medium":"Low"}function le(r,s,v){var D;const h=L.value.includes(s.id)?[...L.value]:[s.id],J=h.map(me=>O.value.find(ge=>ge.id===me)).filter(Boolean);K.value=h;const k=JSON.stringify({id:s.id,ids:h,from:v,tickets:J});(D=r.dataTransfer)==null||D.setData("text/plain",k),r.dataTransfer&&(r.dataTransfer.effectAllowed="move")}function ae(r){var s;q.value=!1,((s=r.dataTransfer)==null?void 0:s.dropEffect)!=="none"&&K.value.length&&(O.value=O.value.filter(v=>!K.value.includes(v.id)),L.value=L.value.filter(v=>!K.value.includes(v))),K.value=[]}function M(r){var s;r.preventDefault(),q.value=!1;try{const v=(s=r.dataTransfer)==null?void 0:s.getData("text/plain");if(!v)return;const h=JSON.parse(v);if(h.from!=="sprint")return;const k=(h.tickets&&h.tickets.length?h.tickets:h.ticket?[h.ticket]:[]).filter(Boolean).filter(me=>!O.value.some(ge=>ge.id===me.id));k.length&&O.value.push(...k);const D=h.ids&&h.ids.length?h.ids:h.id?[h.id]:[];D.length&&P("ticket-moved-to-backlog",D,h.sprintId),console.log(h.sprintId,"sprintId ....")}catch(v){console.error("Drop error:",v)}}function c(r,s){s?L.value.includes(r)||L.value.push(r):L.value=L.value.filter(v=>v!==r)}function a(r,s){const v=s.target.checked;c(r,v)}return z(()=>$.checkedAll,r=>{r?(L.value=O.value.map(s=>s.id),console.log(L.value)):L.value=[]}),(r,s)=>(f(),b("section",pa,[t("div",{class:Q(["rounded-lg flex flex-col h-full",q.value?"ring-2 ring-blue-400":""]),onDragover:s[3]||(s[3]=$e(()=>{},["prevent"])),onDragenter:s[4]||(s[4]=v=>q.value=!0),onDragleave:s[5]||(s[5]=v=>q.value=!1),onDrop:s[6]||(s[6]=v=>M(v))},[!g(H)&&I.value.length===0?(f(),b("div",fa,[s[7]||(s[7]=t("img",{src:ea,class:"mb-4",alt:"backlog-plan"},null,-1)),s[8]||(s[8]=t("h6",{class:"text-sm text-text-primary font-semibold mb-1"}," Get started in the backlog ",-1)),s[9]||(s[9]=t("p",{class:"text-sm text-text-primary/90 mb-4"}," Plan and start a sprint to see issues here. ",-1)),t("button",{disabled:!g(V),onClick:s[0]||(s[0]=v=>r.$emit("open-create-ticket")),class:Q(["relative inline-flex items-center justify-center font-medium py-1.5 px-3 text-sm rounded-md focus:outline-none transition text-xs px-3 py-1.5 h-[34px] bg-accent text-white hover:bg-accent-hover border-border-input border",g(V)?"cursor-pointer":"cursor-not-allowed"])}," Create Ticket ",10,va)])):(f(),b("div",ma,[t("div",ga,[(f(!0),b(fe,null,ke(I.value,v=>{var h,J;return f(),b("div",{key:v.id,draggable:"true",class:Q(["flex items-center  gap-3 p-[8px] cursor-pointer transition-colors rounded-[8px]",L.value.includes(v.id)?"border-2 border-[#5a2d7f]":"border border-border-input",g(B)==="dark"?"bg-bg-body hover:bg-bg-surface":"bg-bg-charcoal hover:bg-bg-body"]),onDragstart:k=>le(k,v,"backlog"),onDragend:s[2]||(s[2]=k=>ae(k)),onClick:k=>r.$emit("open-ticket",v)},[t("input",{type:"checkbox",class:"custom-checkbox bg-bg-body border border-border-input flex-shrink-0",checked:L.value.includes(v.id),onClick:s[1]||(s[1]=$e(()=>{},["stop"])),onChange:k=>a(v.id,k)},null,40,ya),t("div",xa,[t("span",_a,N(v.summary),1)]),t("div",ha,[(v==null?void 0:v.assignee)==="Unassigned"?(f(),b("span",ka,"UA")):(h=v==null?void 0:v.assignee)!=null&&h.u_profile_image?(f(),b("div",Sa,[t("img",{src:v.assignee.u_profile_image,alt:""},null,8,wa)])):(f(),b("span",Ca,N(g(Yt)((J=v==null?void 0:v.assignee)==null?void 0:J.u_full_name)),1))])],42,ba)}),128))])]))],34)]))}}),Da=Ut($a,[["__scopeId","data-v-8d08899e"]]),Ta="data:image/svg+xml,%3csvg%20width='60'%20height='60'%20viewBox='0%200%2060%2060'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M9.375%2030C11.6402%2030%2013.4766%2028.1637%2013.4766%2025.8984C13.4766%2023.6332%2011.6402%2021.7969%209.375%2021.7969C7.10977%2021.7969%205.27344%2023.6332%205.27344%2025.8984C5.27344%2028.1637%207.10977%2030%209.375%2030Z'%20fill='%23AE2A19'/%3e%3cpath%20d='M26.25%2024.375C28.5152%2024.375%2030.3516%2022.5387%2030.3516%2020.2734C30.3516%2018.0082%2028.5152%2016.1719%2026.25%2016.1719C23.9848%2016.1719%2022.1484%2018.0082%2022.1484%2020.2734C22.1484%2022.5387%2023.9848%2024.375%2026.25%2024.375Z'%20fill='%23BF63F3'/%3e%3cpath%20d='M15.3931%2035.8594H11.0159V33.0938C9.93587%2033.3387%208.81469%2033.3387%207.73465%2033.0938V35.8594H1.87528C1.55115%2035.8601%201.2345%2035.9568%200.965283%2036.1373C0.696064%2036.3178%200.486343%2036.574%200.362583%2036.8736C0.238824%2037.1731%200.206573%2037.5027%200.269899%2037.8205C0.333226%2038.1384%200.489292%2038.4304%200.718404%2038.6597L7.05872%2045L0.718404%2051.3403C0.489292%2051.5696%200.333226%2051.8616%200.269899%2052.1795C0.206573%2052.4973%200.238824%2052.8269%200.362583%2053.1264C0.486343%2053.426%200.696064%2053.6822%200.965283%2053.8627C1.2345%2054.0432%201.55115%2054.1399%201.87528%2054.1406H15.3931L21.7503%2045L15.3931%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M34.4562%2035.8594H27.8937V27.4688C26.8137%2027.7138%2025.6925%2027.7138%2024.6125%2027.4688V35.8594H19.3896L25.7487%2045L19.3896%2054.1406H34.4562L40.8143%2045L34.4562%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M43.8281%2019.6875H55.3125C55.7475%2019.6873%2056.1647%2019.5143%2056.4723%2019.2067C56.7799%2018.8991%2056.9529%2018.4819%2056.9531%2018.0469V9.375C56.9529%208.93996%2056.7799%208.5228%2056.4723%208.21518C56.1647%207.90755%2055.7475%207.73462%2055.3125%207.73438H43.8281V7.5C43.8281%207.06488%2043.6553%206.64758%2043.3476%206.3399C43.0399%206.03223%2042.6226%205.85938%2042.1875%205.85938C41.7524%205.85938%2041.3351%206.03223%2041.0274%206.3399C40.7197%206.64758%2040.5469%207.06488%2040.5469%207.5V32.5781H43.8281V19.6875Z'%20fill='%23FCA700'/%3e%3cpath%20d='M59.2843%2043.8403L51.7843%2036.3403C51.6322%2036.1878%2051.4514%2036.0668%2051.2524%2035.9842C51.0534%2035.9017%2050.8401%2035.8593%2050.6246%2035.8594H38.4521L44.8121%2045L38.4531%2054.1406H50.6246C50.8401%2054.1407%2051.0534%2054.0983%2051.2524%2054.0158C51.4514%2053.9332%2051.6322%2053.8122%2051.7843%2053.6597L59.2843%2046.1597C59.4368%2046.0075%2059.5577%2045.8267%2059.6402%2045.6277C59.7228%2045.4287%2059.7652%2045.2154%2059.7652%2045C59.7652%2044.7846%2059.7228%2044.5713%2059.6402%2044.3723C59.5577%2044.1733%2059.4368%2043.9925%2059.2843%2043.8403Z'%20fill='%2382B536'/%3e%3c/g%3e%3c/svg%3e",Va={key:0,class:"overflow-y-auto h-[calc(100%-50px)] tickets-scroll"},Ea={class:"flex flex-col flex-1 gap-[4px] min-w-0 me-1"},La=["onDragstart","onClick"],Aa=["checked","onChange"],Ma={class:"flex items-center text-[14px] font-sans font-medium capitalize text-text-secondary flex-1 min-w-0"},Ba={class:"truncate"},Ia={class:"flex-shrink-0"},Fa={key:0,class:"flex justify-center text-gray-500 items-center text-[11px] aspect-square w-[24px] h-[24px] bg-bg-body rounded-full border-border-input border-2"},Ua={key:1,class:"w-6 h-6 rounded-full"},Oa=["src"],Na={key:2,class:"text-[11px] aspect-square w-[24px] flex justify-center items-center h-[24px] bg-accent/30 text-accent border-accent border rounded-full"},Pa={key:1,class:"empty-state flex flex-col justify-center items-center border-dashed border-3 p-2 border-border h-[calc(100%-50px)] min-h-0"},qa=at({__name:"SprintCard",props:{sprint:{},sprintId:{},searchQuery:{},checkedSprintAll:{type:Boolean}},emits:["edit-sprint","toggle-start","open-ticket","move-selected-to-backlog","delete-selected-sprint","refresh"],setup(w,{emit:_}){const{theme:B}=sl(),V=w,P=_,$=y([]),u=y([]);z(()=>V.sprint&&V.sprint.tickets,M=>{$.value=[...M||[]];const c=new Set($.value.map(a=>a.id));u.value=u.value.filter(a=>c.has(a))},{immediate:!0,deep:!0});const E=T(()=>{var c;const M=((c=V.searchQuery)==null?void 0:c.toLowerCase())||"";return M?$.value.filter(a=>{var s;const r=((s=a.assignee)==null?void 0:s.u_full_name)??"";return a.key.toLowerCase().includes(M)||a.summary.toLowerCase().includes(M)||r.toLowerCase().includes(M)}):$.value}),R=y(!1),H=y([]),{mutate:O}=Cl({onSuccess:()=>{vt.success("Card moved to sprint successfully"),P("refresh")},onError:M=>{vt.error("Failed to move card: "+(M.message||"Unknown error"))}});function q(M,c,a,r){var J;const s=u.value.includes(c.id)?[...u.value]:[c.id],v=s.map(k=>$.value.find(D=>D.id===k)).filter(Boolean);H.value=s;const h=JSON.stringify({id:c.id,ids:s,from:a,sprintId:r,ticket:c,tickets:v});(J=M.dataTransfer)==null||J.setData("text/plain",h),M.dataTransfer&&(M.dataTransfer.effectAllowed="move")}function K(M){var c;R.value=!1,((c=M.dataTransfer)==null?void 0:c.dropEffect)!=="none"&&H.value.length&&($.value=$.value.filter(a=>!H.value.includes(a.id)),u.value=u.value.filter(a=>!H.value.includes(a))),H.value=[]}function L(){R.value=!0}function I(){R.value=!1}function W(M){var c;M.preventDefault(),R.value=!1;try{const a=(c=M.dataTransfer)==null?void 0:c.getData("text/plain");if(!a)return;const r=JSON.parse(a);if(r.from!=="backlog")return;const v=(r.tickets&&r.tickets.length?r.tickets:r.ticket?[r.ticket]:[]).filter(Boolean).filter(h=>!$.value.some(J=>J.id===h.id));if(!v.length)return;$.value.push(...v),v.forEach(h=>{O({id:V.sprintId,payload:{card_ids:[h.id],priority:(h.priority||"Medium").toLowerCase(),story_points:h.storyPoints||0}})})}catch(a){console.error("Drop error:",a)}}function le(M,c){c?u.value.includes(M)||u.value.push(M):u.value=u.value.filter(a=>a!==M)}function ae(M,c){const a=c.target.checked;le(M,a)}return z(()=>V.checkedSprintAll,M=>{M?(u.value=E.value.map(c=>c.id),console.log(E.value)):u.value=[]}),(M,c)=>(f(),b("div",{class:Q(["h-full min-h-0 px-2",g(B)==="dark"?"bg-bg-surface":"bg-bg-surface/30"])},[t("div",{class:Q([R.value?"ring-2 ring-blue-400 rounded-lg":"","h-full box-border"]),onDragover:c[2]||(c[2]=$e(()=>{},["prevent"])),onDragenter:L,onDragleave:I,onDrop:W},[E.value.length>0&&M.sprint?(f(),b("div",Va,[t("div",Ea,[(f(!0),b(fe,null,ke(E.value,a=>{var r,s;return f(),b("div",{key:a.id,draggable:"true",class:Q(["flex items-center  gap-3 p-[8px] cursor-pointer transition-colors rounded-[8px]",u.value.includes(a.id)?"border-2 border-[#5a2d7f]":"border border-border-input",g(B)==="dark"?"bg-bg-body hover:bg-bg-surface":"bg-bg-charcoal hover:bg-bg-body"]),onDragstart:v=>q(v,a,"sprint",M.sprint.id),onDragend:c[1]||(c[1]=v=>K(v)),onClick:v=>M.$emit("open-ticket",a)},[t("input",{type:"checkbox",class:Q(["custom-checkbox border border-border-input flex-shrink-0",g(B)==="dark"?"bg-bg-charcoal":"bg-bg-body "]),checked:u.value.includes(a.id),onClick:c[0]||(c[0]=$e(()=>{},["stop"])),onChange:v=>ae(a.id,v)},null,42,Aa),t("div",Ma,[t("span",Ba,N(a.summary),1)]),t("div",Ia,[(a==null?void 0:a.assignee)=="Unassigned"?(f(),b("span",Fa,"UA")):(r=a.assignee)!=null&&r.u_profile_image?(f(),b("div",Ua,[t("img",{src:a.assignee.u_profile_image,alt:""},null,8,Oa)])):(f(),b("span",Na,N(g(Yt)(((s=a.assignee)==null?void 0:s.u_full_name)??"")),1))])],42,La)}),128))])])):(f(),b("div",Pa,c[3]||(c[3]=[Dl('<img src="'+Ta+'" class="mb-4" alt="backlog-plan" data-v-f3c6afa6><h6 class="text-sm text-text-primary font-semibold mb-1 text-center" data-v-f3c6afa6> Plan your sprint </h6><p class="text-sm text-text-primary/90 mb-3 max-w-120 text-center" data-v-f3c6afa6> Drag work items from the <span class="font-bold" data-v-f3c6afa6>Backlog</span> section or create new ones to plan the work for this sprint. Select <span class="font-bold" data-v-f3c6afa6>Start sprint</span> when you&#39;re ready. </p>',3)])))],34)],2))}}),za=Ut(qa,[["__scopeId","data-v-f3c6afa6"]]),ja={class:"px-6 gap-4 bg-bg-input pt-5 pb-8"},Ra={class:"mt-3"},Ha={class:"flex justify-end gap-2 p-6 sticky bottom-0 bg-bg-input border-t border-border"},Wa=at({__name:"SprintModal",props:{modelValue:{type:Boolean,default:!1},sprint:{},creatingSprint:{type:Boolean}},emits:["update:modelValue","save","close"],setup(w,{emit:_}){const B=_,V=w,P=T({get:()=>V.modelValue,set:L=>B("update:modelValue",L)}),$=tt({name:"",sprintType:"",description:""}),u=tt({name:!1,sprintType:!1,description:!1}),E=T(()=>u.name&&!String($.name||"").trim()?"Name is required":""),R=T(()=>!!String($.name||"").trim()&&!E.value);function H(){P.value=!1,B("close")}function O(){u.name=!0,R.value&&B("save",{name:String($.name||"").trim(),value:String($.sprintType||"").trim(),description:String($.description||"").trim()})}function q(){u.name=!1,u.sprintType=!1,u.description=!1}z(()=>V.sprint,L=>{if(!L){$.name="";return}$.name=L.name??(L==null?void 0:L.title)??"",$.sprintType=L.sprintType??(L==null?void 0:L.sprintType)??"",$.description=L.description??"",q()},{immediate:!0});const K=[{title:"Milestone",_id:"milestone",dot:"#2e9bda"},{title:"Sprint",_id:"sprint",dot:"#7d68c8"},{title:"Huddle",_id:"huddle",dot:"#eea832"}];return(L,I)=>(f(),pe(el,{modelValue:P.value,"onUpdate:modelValue":I[5]||(I[5]=W=>P.value=W),modalClass:"!py-0",size:"md"},{default:se(()=>[I[8]||(I[8]=t("div",{class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-input pb-4"},[t("h2",{class:"text-xl font-semibold"},"Add New Sprint")],-1)),t("div",ja,[F(tl,{class:"rounded-1",modelValue:$.name,"onUpdate:modelValue":I[0]||(I[0]=W=>$.name=W),label:"Name",placeholder:"Sprint 1",error:!!E.value,message:E.value,onBlur:I[1]||(I[1]=W=>u.name=!0)},null,8,["modelValue","error","message"]),F(Ft,{class:"rounded-1 mt-3",modelValue:$.sprintType,"onUpdate:modelValue":I[2]||(I[2]=W=>$.sprintType=W),label:"Sprint Type",options:K,error:!!E.value,message:E.value,onBlur:I[3]||(I[3]=W=>u.name=!0)},null,8,["modelValue","error","message"]),t("div",Ra,[F(Kl,{modelValue:$.description,"onUpdate:modelValue":I[4]||(I[4]=W=>$.description=W),label:"Description",placeholder:"Sprint description...",type:"textarea",rows:4},null,8,["modelValue"])]),I[6]||(I[6]=t("div",null,null,-1))]),t("div",Ha,[F(ze,{variant:"secondary",onClick:H},{default:se(()=>I[7]||(I[7]=[oe("Cancel")])),_:1,__:[7]}),F(ze,{variant:"primary",disabled:!R.value,onClick:O},{default:se(()=>[oe(N(L.creatingSprint?"Saving...":"Save"),1)]),_:1},8,["disabled"])])]),_:1,__:[8]},8,["modelValue"]))}}),Ka="/assets/filter-JX25xO5j.svg",Qa={class:"px-6 grid grid-cols-2 gap-4 bg-bg-input pt-5"},Ga={class:"flex flex-col col-span-2"},Ja={class:"flex flex-col col-span-2"},Za={class:"flex gap-1 flex-col col-span-2 sm:col-span-1"},Xa={key:0,class:"text-xs text-red-500"},Ya={class:"flex gap-1 flex-col col-span-2 sm:col-span-1"},es={key:0,class:"text-xs text-red-500"},ts={class:"flex flex-col col-span-2"},ls={class:"flex flex-col col-span-2"},as={class:"bg-bg-body wfull px-4 py-3 rounded-lg text-xs text-text-secondary"},ss={class:"flex justify-end gap-2 p-6 sticky bottom-0 bg-bg-input"},ns=at({__name:"StartSprintModal",props:{modelValue:{type:Boolean,default:!1},sprint:{},creatingSprint:{type:Boolean}},emits:["update:modelValue","save","close"],setup(w,{emit:_}){const B=_,V=w,P=[{_id:1,title:"1 Week"},{_id:2,title:"2 Weeks"},{_id:3,title:"3 Weeks"},{_id:4,title:"4 Weeks"},{_id:5,title:"Custom"}],$=T({get:()=>V.modelValue,set:a=>B("update:modelValue",a)}),u=tt({goal:"",start:new Date().toISOString().slice(0,10),end:"",sprint_name:"",duration:null}),E=tt({start:!1,end:!1}),R=T(()=>!u.start&&E.start?"Start date is required":""),H=T(()=>{if(!u.end&&E.end)return"End date is required";if(u.start&&u.end){const a=le(u.start),r=le(u.end);if(Number.isFinite(a)&&Number.isFinite(r)&&r<a)return"End date cannot be before start date"}return""}),O=T(()=>!R.value&&!H.value);function q(a){u.start=a||"",E.start=!0}function K(a){u.end=a||"",E.end=!0}function L(){$.value=!1,u.duration=null,B("close")}function I(){E.start=!0,E.end=!0,O.value&&(B("save",{title:u.sprint_name||"new sprint",duration:String(c.value)||null,start:u.start||"",end:u.end||"",goal:u.goal??""}),$.value=!1,B("close"))}function W(){E.start=!1,E.end=!1}function le(a){return a?new Date(`${a}T00:00:00`).getTime():NaN}const ae=T(()=>u.duration===5);z(()=>u.duration,a=>{if(!a)return;const r=typeof a=="object"?a._id:a;if(r!==5&&u.start){const s=M(u.start,r*7);u.end=s}}),z(()=>u.start,a=>{a&&(u.duration&&u.duration!==5&&(u.end=M(u.start,u.duration*7)),u.end&&le(u.end)<le(u.start)&&(u.end=u.start))});function M(a,r){const s=new Date(a);return s.setDate(s.getDate()+r),s.toISOString().slice(0,10)}const c=T(()=>!u.start||!u.end?0:u.duration!==5?u.duration*7:(le(u.end)-le(u.start))/864e5);return z(()=>V.sprint,a=>{if(!a){u.start=new Date().toISOString().slice(0,10),u.end="",u.sprint_name="",u.goal="",W();return}u.goal=a.goal??"",u.start=a.start??new Date().toISOString().slice(0,10),u.end=a.end??"",u.sprint_name=a.title??"",W()},{immediate:!0}),(a,r)=>(f(),pe(el,{modelValue:$.value,"onUpdate:modelValue":r[3]||(r[3]=s=>$.value=s),modalClass:"!py-0",size:"md"},{default:se(()=>[t("div",{class:"sticky top-0 z-10 flex justify-between items-center py-6 px-6 border-b border-border bg-bg-input"},[r[5]||(r[5]=t("h2",{class:"text-xl font-semibold"},"Start Sprint",-1)),t("span",{onClick:L,class:"text-sm text-text-secondary cursor-pointer"},r[4]||(r[4]=[t("i",{class:"fa-solid fa-xmark text-text-primary text-[19px]"},null,-1)]))]),t("div",Qa,[t("div",Ga,[F(tl,{modelValue:u.sprint_name,"onUpdate:modelValue":r[0]||(r[0]=s=>u.sprint_name=s),label:"Sprint Name",placeholder:"Enter sprint name",size:"md",class:"rounded-1"},null,8,["modelValue"])]),t("div",Ja,[F(Ft,{modelValue:u.duration,"onUpdate:modelValue":r[1]||(r[1]=s=>u.duration=s),options:P,label:"Duration",placeholder:"Select duration"},null,8,["modelValue"])]),t("div",Za,[r[7]||(r[7]=t("label",{class:"text-sm font-medium"},"Start date",-1)),t("div",{class:Q(["border relative flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",R.value?"border-red-500":""])},[F(ht,{placeholder:"Set start date",class:"w-full z-1","model-value":u.start,"emit-as":"ymd","onUpdate:modelValue":q},null,8,["model-value"]),r[6]||(r[6]=t("i",{class:"fa-regular fa-calendar absolute right-2 top-3 z-0"},null,-1))],2),R.value?(f(),b("p",Xa,N(R.value),1)):U("",!0)]),t("div",Ya,[r[8]||(r[8]=t("label",{class:"text-sm font-medium"},"End date",-1)),t("div",{class:Q(["border relative flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",H.value?"border-red-500":""])},[F(ht,{placeholder:"Set end date",class:"w-full","model-value":u.end,"emit-as":"ymd",disabled:!ae.value,"onUpdate:modelValue":K,"min-date":u.start},null,8,["model-value","disabled","min-date"]),t("i",{class:Q(["fa-regular fa-calendar absolute right-2 top-3 z-0",{"text-text-secondary/30 pointer-events-none":!ae.value,"text-text-primary":ae.value}])},null,2)],2),H.value?(f(),b("p",es,N(H.value),1)):U("",!0)]),t("div",ts,[r[9]||(r[9]=t("label",{class:"text-sm font-medium pb-1"},"Goal (optional)",-1)),et(t("textarea",{"onUpdate:modelValue":r[2]||(r[2]=s=>u.goal=s),class:"w-full text-sm rounded-md border border-border px-3 py-2 bg-bg-input",rows:"2",placeholder:"Ship onboarding flow"},null,512),[[ll,u.goal]])]),t("div",ls,[t("p",as," Duration: "+N(u.start?c.value+" days":""),1)])]),t("div",ss,[F(ze,{variant:"secondary",onClick:L},{default:se(()=>r[10]||(r[10]=[oe("Cancel")])),_:1,__:[10]}),F(ze,{variant:"primary",disabled:!O.value,onClick:I},{default:se(()=>[oe(N(a.creatingSprint?"Starting...":"Start"),1)]),_:1},8,["disabled"])])]),_:1},8,["modelValue"]))}}),os={class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-body pb-4 mb-4"},rs={class:"text-sm text-text-secondary mt-1"},is={class:"flex items-center gap-2 mt-4 w-full"},ds={class:"flex items-center gap-2 flex-1"},us={class:"px-6 min-h-[400px]"},cs={key:0},ps={key:0,class:"flex items-center justify-center py-12"},fs={key:1,class:"text-center py-12 text-text-secondary"},vs={key:2,class:"grid grid-cols-2 gap-3"},ms=["onClick"],gs={class:"flex items-center gap-3"},bs={class:"w-10 h-10 rounded-lg bg-bg-input flex items-center justify-center group-hover:bg-primary/10 transition-colors"},ys={class:"font-medium"},xs={key:1},_s={key:0,class:"flex items-center justify-center py-12"},hs={key:1,class:"text-center py-12 text-text-secondary"},ks={key:2,class:"grid grid-cols-2 gap-3"},Ss=["onClick"],ws={class:"flex items-center gap-3"},Cs={class:"w-10 h-10 rounded-lg bg-bg-input flex items-center justify-center group-hover:bg-primary/10 transition-colors"},$s={class:"font-medium"},Ds={key:2},Ts={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Vs={key:0,class:"flex flex-col"},Es={class:"flex gap-1 flex-col"},Ls={key:0,class:"text-xs text-red-500"},As={class:"flex gap-1 flex-col"},Ms={key:0,class:"text-xs text-red-500"},Bs={class:"flex flex-col gap-1"},Is={class:"mt-2"},Fs={class:"mt-4"},Us={key:0,class:"text-xs text-red-500 mt-1 px-1"},Os={class:"flex justify-between gap-2 p-6 mt-8 sticky bottom-0 bg-bg-body border-t border-border"},Ns={key:1},Ps={class:"flex gap-2"},qs=at({__name:"CreateBacklogTicketWithModuleSelection",props:{modelValue:{type:Boolean,default:!1},listId:{},selectedVariable:{}},emits:["update:modelValue","created"],setup(w,{emit:_}){const B=_,V=w,P=al(),{workspaceId:$}=yl(),u=y(1),E=y(null),R=y(null),{data:H,isLoading:O}=xl($.value),q=T(()=>{var C;return((C=H.value)==null?void 0:C.modules)||[]}),{data:K,isFetching:L,refetch:I}=_l({workspace_module_id:E,workspace_id:$},{enabled:T(()=>!!E.value)});z(()=>E.value,()=>{I()});const W=T(()=>K.value||[]),{data:le}=hl($.value),{data:ae}=kl($.value,E,{enabled:T(()=>!!E.value)}),{mutate:M,isPending:c}=Sl({onSuccess:()=>{Je(),P.invalidateQueries({queryKey:["sheet-list"]}),P.invalidateQueries({queryKey:["backlog-list"]}),a.value=!1}}),a=T({get:()=>V.modelValue,set:C=>B("update:modelValue",C)}),r=T(()=>{switch(u.value){case 1:return"Select a module to create the ticket in";case 2:return"Select a sheet within the module";case 3:return"Provide the ticket details below and click Add Ticket";default:return""}}),s=T(()=>((ae==null?void 0:ae.value)??[]).filter(C=>{var x;return((x=C==null?void 0:C.type)==null?void 0:x.title)==="Select"})),v=C=>C.map(x=>({_id:x,title:x})),h=T(()=>((le==null?void 0:le.value)??[]).map(C=>{var x;return{_id:C._id,title:((x=C==null?void 0:C.variables)==null?void 0:x["lane-title"])??String(C._id)}})),J=C=>C.slug,k=tt({title:"",description:"",startDate:null,endDate:null,lane_id:null,assignee:null,variables:{}});z(s,C=>{for(const x of C){const S=J(x);S in k.variables||(k.variables[S]=null)}},{immediate:!0});const D=tt({title:!1,description:!1,startDate:!1,endDate:!1,lane:!1}),me=T(()=>!!k.title.trim()&&!!k.lane_id&&!!k.startDate&&!!k.endDate&&!we.value&&!Ie.value&&!Fe.value&&!ne.value&&!re.value);function ge(C){k.startDate=C,D.startDate=!0}function Se(C){k.endDate=C,D.endDate=!0}function st(C){k.lane_id=C,D.lane=!0}function Ge(C){k.assignee=C}function mt(C){E.value=C._id,u.value=2}function nt(C){R.value=C._id,u.value=3}function te(){u.value>1&&u.value--}function Te(){a.value=!1,Je()}function Je(){u.value=1,E.value=null,R.value=null,k.title="",k.description="",k.startDate=null,k.endDate=null,k.lane_id=null,k.assignee=null,k.variables={},D.title=!1,D.description=!1,D.startDate=!1,D.endDate=!1,D.lane=!1}const ot=T(()=>{var C;return(C=ae==null?void 0:ae.value)==null?void 0:C.find(x=>(x==null?void 0:x._id)==V.selectedVariable)}),we=T(()=>D.title&&!k.title.trim()?"Title is required":""),Ie=T(()=>D.startDate?k.startDate?"":"Start date is required":""),Fe=T(()=>D.endDate?k.endDate?k.startDate&&k.endDate&&k.endDate<k.startDate?"End date cannot be before start date":"":"End date is required":""),ne=T(()=>D.lane?k.lane_id?"":"Lane is required":""),re=T(()=>D.description&&!k.description.trim()?"Description is required":""),ie=new Date().toISOString().split("T")[0];function Ze(){var x,S;if(D.title=!0,D.lane=!0,D.description=!0,D.startDate=!0,D.endDate=!0,!me.value||c.value)return;const C={sheet_list_id:V.listId,workspace_id:$.value,sheet_id:R.value,workspace_lane_id:k.lane_id,variables:{...k.variables,[`${(x=ot.value)==null?void 0:x.slug}`]:V.listId,"card-title":k.title.trim(),"card-description":k.description.trim(),"start-date":k.startDate,"end-date":k.endDate},seat_id:((S=k.assignee)==null?void 0:S._id)??null,createdAt:new Date().toISOString()};M(C)}return z(()=>k.title,C=>{C!=null&&C.trim()&&D.title&&(D.title=!1)}),z(()=>k.lane_id,C=>{C&&D.lane&&(D.lane=!1)}),z(()=>k.startDate,C=>{C&&D.startDate&&(D.startDate=!1)}),z(()=>k.endDate,C=>{C&&D.endDate&&(D.endDate=!1)}),z(()=>k.description,C=>{C!=null&&C.trim()&&D.description&&(D.description=!1)}),(C,x)=>(f(),pe(el,{modelValue:a.value,"onUpdate:modelValue":x[5]||(x[5]=S=>a.value=S),modalClass:"!py-0",size:"lg"},{default:se(()=>[t("div",os,[x[6]||(x[6]=t("h2",{class:"text-xl font-semibold"},"Create Backlog Ticket",-1)),t("p",rs,N(r.value),1),t("div",is,[(f(),b(fe,null,ke(3,S=>t("div",{key:S,class:"flex items-center flex-1"},[t("div",ds,[t("div",{class:Q(["h-1 flex-1 rounded-full transition-colors",u.value>=S?"bg-primary":"bg-border"])},null,2)])])),64))])]),t("div",us,[u.value===1?(f(),b("div",cs,[x[8]||(x[8]=t("h3",{class:"text-lg font-medium mb-4"},"Select Module",-1)),g(O)?(f(),b("div",ps,x[7]||(x[7]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):!q.value||q.value.length===0?(f(),b("div",fs," No modules available ")):(f(),b("div",vs,[(f(!0),b(fe,null,ke(q.value,S=>{var de,ue,be,Xe,Ve;return f(),b("button",{key:S._id,onClick:St=>mt(S),class:Q(["p-4 border rounded-lg hover:border-primary transition-all text-left group",E.value===S._id?"border-primary bg-primary/5":"border-border"])},[t("div",gs,[t("div",bs,[t("i",{class:Q([`${(ue=(de=S==null?void 0:S.variables)==null?void 0:de["module-icon"])==null?void 0:ue.prefix} ${(Xe=(be=S==null?void 0:S.variables)==null?void 0:be["module-icon"])==null?void 0:Xe.iconName}`,"text-lg"])},null,2)]),t("div",null,[t("p",ys,N(((Ve=S.variables)==null?void 0:Ve["module-title"])||"Untitled"),1)])])],10,ms)}),128))]))])):u.value===2?(f(),b("div",xs,[x[10]||(x[10]=t("h3",{class:"text-lg font-medium mb-4"},"Select Sheet",-1)),g(L)?(f(),b("div",_s,x[9]||(x[9]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):!W.value||W.value.length===0?(f(),b("div",hs," No sheets available for this module ")):(f(),b("div",ks,[(f(!0),b(fe,null,ke(W.value,S=>{var de,ue;return f(),b("button",{key:S._id,onClick:be=>nt(S),class:Q(["p-4 border rounded-lg hover:border-primary transition-all text-left group",R.value===S._id?"border-primary bg-primary/5":"border-border"])},[t("div",ws,[t("div",Cs,[t("i",{class:Q(`${(de=S==null?void 0:S.variables["sheet-icon"])==null?void 0:de.prefix} ${(ue=S==null?void 0:S.variables["sheet-icon"])==null?void 0:ue.iconName} text-lg`)},null,2)]),t("div",null,[t("p",$s,N((S==null?void 0:S.variables["sheet-title"])||"Untitled Sheet"),1)])])],10,Ss)}),128))]))])):u.value===3?(f(),b("div",Ds,[x[14]||(x[14]=t("h3",{class:"text-lg font-medium mb-4"},"Ticket Details",-1)),t("div",Ts,[F(tl,{modelValue:k.title,"onUpdate:modelValue":x[0]||(x[0]=S=>k.title=S),label:"Ticket Title",placeholder:"e.g., Implement real-time notifications",error:!!we.value,message:we.value,onBlur:x[1]||(x[1]=S=>D.title=!0)},null,8,["modelValue","error","message"]),h.value.length>0?(f(),b("div",Vs,[F(Ft,{size:"md",label:"Lane",options:h.value,placeholder:"Select lane",allowCustom:!1,"model-value":k.lane_id,"onUpdate:modelValue":st,error:!!ne.value,message:ne.value},null,8,["options","model-value","error","message"])])):U("",!0),(f(!0),b(fe,null,ke(s.value,S=>et((f(),pe(Ft,{size:"md",key:J(S),modelValue:k.variables[S.slug],"onUpdate:modelValue":de=>k.variables[S.slug]=de,options:v(S.data),label:S.title,placeholder:"Select value",allowCustom:!0},null,8,["modelValue","onUpdate:modelValue","options","label"])),[[Gt,(S==null?void 0:S._id)!=C.selectedVariable]])),128)),t("div",Es,[x[11]||(x[11]=t("label",{class:"text-sm"},"Start date",-1)),t("div",{class:Q(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",Ie.value?"border-red-500":""])},[F(ht,{placeholder:"Set start date",class:"w-full","model-value":k.startDate,"emit-as":"ymd","onUpdate:modelValue":ge,"min-date":g(ie)},null,8,["model-value","min-date"])],2),Ie.value?(f(),b("p",Ls,N(Ie.value),1)):U("",!0)]),t("div",As,[x[12]||(x[12]=t("label",{class:"text-sm"},"End date",-1)),t("div",{class:Q(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",Fe.value?"border-red-500":""])},[F(ht,{placeholder:"Set end date",class:"w-full","model-value":k.endDate,"emit-as":"ymd","onUpdate:modelValue":Se,"min-date":k.startDate||g(ie)},null,8,["model-value","min-date"])],2),Fe.value?(f(),b("p",Ms,N(Fe.value),1)):U("",!0)]),t("div",Bs,[x[13]||(x[13]=t("label",{class:"text-sm"},"Assignee",-1)),t("div",Is,[F(Tl,{name:!0,workspaceId:g($),onAssign:Ge,onUnassign:x[2]||(x[2]=S=>Ge(null)),assigneeId:k.assignee,seat:null,disabled:!1,skipPermissionCheck:!0,class:"w-full"},null,8,["workspaceId","assigneeId"])])])]),t("div",Fs,[F(Vl,{label:"Description",placeholder:"What needs to be done, acceptance criteria, links…",modelValue:k.description,"onUpdate:modelValue":x[3]||(x[3]=S=>k.description=S),onBlur:x[4]||(x[4]=S=>D.description=!0)},null,8,["modelValue"]),re.value?(f(),b("p",Us,N(re.value),1)):U("",!0)])])):U("",!0)]),t("div",Os,[u.value>1?(f(),pe(ze,{key:0,variant:"secondary",onClick:te},{default:se(()=>x[15]||(x[15]=[oe("Back")])),_:1,__:[15]})):(f(),b("div",Ns)),t("div",Ps,[F(ze,{variant:"secondary",onClick:Te},{default:se(()=>x[16]||(x[16]=[oe("Cancel")])),_:1,__:[16]}),u.value===3?(f(),pe(ze,{key:0,variant:"primary",disabled:!me.value||g(c),onClick:Ze},{default:se(()=>[oe(N(g(c)?"Adding…":"Add Ticket"),1)]),_:1},8,["disabled"])):U("",!0)])])]),_:1},8,["modelValue"]))}}),zs={class:"flex-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur rounded-[6px] shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] flex-grow h-full bg-bg-card border border-border overflow-x-auto flex-col flex scrollbar-visible"},js={class:"header px-4 py-3 flex items-center justify-between gap-1 w-[100%]"},Rs={class:"flex gap-4"},Hs={class:"flex gap-3 items-center"},Ws={class:"flex items-center gap-3 bg-bg-surface/50 h-[32px] px-2 rounded-md"},Ks={class:"overflow-y-hidden"},Qs={key:0,class:"flex-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] flex-grow h-full bg-bg-card border border-border overflow-x-auto flex"},Gs={class:"flex overflow-x-auto gap-3 p-4"},Js={key:0,class:"mx-auto text-text-secondary/80 m-2 w-[90%] h-full justify-center flex items-center border border-dashed border-border"},Zs={class:"relative w-full h-full flex overflow-hidden"},Xs={key:0,class:"format-sidebar h-full py-4 px-4 w-[320px] border-l bg-bg-card overflow-hidden flex flex-col"},Ys={class:"flex items-center justify-between pb-3 mb-4 border-b"},en={class:"format-content space-y-6"},tn={class:"format-group relative mb-3"},ln={class:"text-xs text-secondary"},an={key:0,class:"absolute z-50 mt-2 p-3 bg-bg-card rounded-lg shadow-lg border w-[240px]"},sn={class:"grid grid-cols-10 gap-1 mb-3"},nn=["onClick"],on={class:"flex items-center gap-2"},rn=["value"],dn=["value"],un={class:"format-group relative mb-3"},cn={class:"text-xs text-secondary"},pn={key:0,class:"absolute z-50 mt-2 p-3 bg-bg-card rounded-lg shadow-lg border w-[240px]"},fn={class:"grid grid-cols-10 gap-1 mb-3"},vn=["onClick"],mn={class:"flex items-center gap-2"},gn=["value"],bn=["value"],yn={class:"grid grid-cols-1 gap-3"},xn=["value"],_n={class:"mt-6 pt-4"},hn=["disabled"],kn={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},Sn={key:0,class:"fixed inset-0 bg-black/30 flex items-center justify-center"},wn={class:"bg-white p-6 rounded-xl w-80"},Cn={class:"flex justify-end gap-2 mt-4"},$n=["disabled"],Dn={class:"flex items-center mt-3 gap-3"},Tn=at({__name:"ActiveSprint",props:{sptint_id:{},searchQuery:{}},setup(w){const _=w,B=At(()=>Mt(()=>import("./CreateTaskModal-DqsxEstZ.js"),__vite__mapDeps([0,1,2,3]))),V=At(()=>Mt(()=>import("./ConfirmDeleteModal-CinGsOSy.js"),__vite__mapDeps([4,5,2,3]))),P=At(()=>Mt(()=>import("./SidePanel-jt_L_kql.js"),__vite__mapDeps([6,2,3,7]))),$=At(()=>Mt(()=>import("./KanbanBoard-D6fejA3E.js"),__vite__mapDeps([8,9,2,3,10,5,11]))),u=y(!1),E=y(""),R=y(null),H=y(null),O=y(null),q=y("");function K(l){E.value="",u.value=!0,R.value=l}function L(){R.value&&R.value(E.value),u.value=!1}function I(){u.value=!1}const{mutate:W}=Sl({onSuccess:()=>{}});function le(){const l=it.value.trim();l&&ot(l)}function ae(){rt.value=!rt.value}const M=Nl(),c=y("kanban"),{workspaceId:a,moduleId:r}=yl(),s=y(""),v=y(!1),h=y(!0),{canEditSheet:J,canDeleteSheet:k,canCreateVariable:D,canCreateSheet:me,canCreateCard:ge,canEditCard:Se,canAssignCard:st}=Xt(),{data:Ge}=xl(a.value),mt=y(Ge.value.modules||[]),nt=T(()=>(mt.value||[]).map(l=>{var e,o;return{_id:l._id,title:((e=l.variables)==null?void 0:e["module-title"])??"Untitled module",description:((o=l.variables)==null?void 0:o["module-description"])??"",icon:l.icon??null,status:l.status??null}})),te=al(),{mutate:Te,isPending:Je}=El({onSuccess:()=>{te.invalidateQueries({queryKey:["sheet-list"]}),it.value="",Ue.value=!1,rt.value=!1,Ue.value=!1}}),ot=l=>{Te({workspace_id:a.value,module_id:r.value,variable_id:ie.value,value:l})};z(nt,l=>{if(l.length&&!s.value){const e=l.find(o=>o.title==="Tasks")||l[0];s.value=e._id}},{immediate:!0});const{data:we,refetch:Ie}=_l({workspace_id:a.value,workspace_module_id:T(()=>s.value)});z(s,l=>{l&&Ie()});const Fe=T(()=>{var l;return we.value?(l=we.value[0])==null?void 0:l._id:""}),ne=y(Fe),re=T(()=>{var l;return ct.value?(l=ct.value[0])==null?void 0:l._id:""}),ie=y(re),Ze=Ll(),C=T(()=>_.sptint_id),{data:x,isPending:S}=aa(C,ne),de=y(!1),ue=y(),be=l=>{ue.value=l},Xe=Al(),Ve=Ml();function St(l){l.type=="column"?Xe.mutate({payload:{workspace_id:a.value,workspace_module_id:r.value,variable_id:ie.value,moved_value:l.meta.id,new_index:l.meta.newIndex}}):Ve.mutate({payload:{workspace_id:a.value,card_id:l.meta.moved._id,group_value:l.meta.fromColumnId,group_variable_id:ie.value,new_index:l.meta.newIndex,sheet_id:ne.value}})}const Ot=l=>{},{mutate:Ee}=Bl({onSuccess:()=>{Ie(),Ct.value=!1}}),gt=T(()=>!we.value||!we.value.length?[]:we.value.map(l=>{var e,o;return{_id:l._id,title:((e=l.variables)==null?void 0:e["sheet-title"])||"Untitled Sheet",description:((o=l.variables)==null?void 0:o["sheet-description"])||"",icon:l.icon||null,status:l.generation_status||null}}));z(gt,l=>{l.length>0&&!ne.value&&(ne.value=l[0]._id)},{immediate:!0}),z(gt,l=>{l.length>0?q.value=l[0].title:q.value=""},{immediate:!0}),z(we,l=>{var e;(l==null?void 0:l.length)>0&&(ne.value=(e=l[0])==null?void 0:e._id)});const rt=y(!1),it=y(""),Nt=l=>{Te({workspace_id:M.params.id,module_id:M.params.module_id,new_value:l.title,value:l.oldTitle,variable_id:ie.value})},Ue=y(!1),Oe=y(),Pt=()=>{Te({value:Oe.value.title,workspace_id:a.value,module_id:r.value,newValue:Oe.value.title,variable_id:ie.value,is_trash:!0})},bt=l=>{Ue.value=!0,Oe.value=l},wt=l=>{de.value=!0,Oe.value=l},je=T(()=>_.searchQuery),Re=y("");z(je,Yl.debounce(l=>{Re.value=l},200));const qt=T(()=>{const l=x.value.flatMap(e=>e.cards.map(o=>({...o,columnId:e.title})));return new pl(l,{keys:["card-title","card-description"],threshold:.3})}),dt=T(()=>{var l;if(c.value==="kanban"){if(!je.value)return x.value;const e=qt.value.search(je.value).map(o=>o.item);return x.value.map(o=>({...o,cards:e.filter(d=>d.columnId===o.title)}))}else{const e=(l=je.value)==null?void 0:l.trim();if(!e){let d=[];return(x.value??[]).forEach(m=>{d=[...d,...m==null?void 0:m.cards]}),d}return new pl(zt.value,{keys:["card-title","card-description"],threshold:.3}).search(e).map(d=>d.item)}}),zt=T(()=>{let l=[];return(x.value??[]).forEach(e=>{l=[...l,...e==null?void 0:e.cards]}),l}),Ct=y(!1);function $t(l){ut.value=!0,yt.value=l}const yt=y();function xt(l){Ct.value=!0,yt.value=l}const ut=y(!1),jt=()=>{yt.value={},ut.value=!ut.value},{data:ct,isPending:Rt}=kl(a.value,s,ne),{mutate:Ht}=Il(),Dt=(l,e)=>{Ht({payload:{sheet_id:ne.value,workspace_id:a.value,variable_slug:l,is_visible:e}})},{data:pt}=hl(a),He=T(()=>((pt==null?void 0:pt.value)??[]).map(l=>{var e;return{_id:l._id,title:((e=l==null?void 0:l.variables)==null?void 0:e["lane-title"])??String(l._id)}})),Ye=l=>l.map(e=>({_id:e.value??e,title:e.value??e})),Ne=Fl({onSuccess:()=>{te.invalidateQueries({queryKey:["get-sheets"]}),te.invalidateQueries({queryKey:["sheet-list"]}),te.invalidateQueries({queryKey:["roles"]})}}),_t=(l,e)=>{if(!x.value)return;const o=x.value.findIndex(d=>d.cards.some(m=>m._id===l));if(o!==-1){const d=x.value[o].cards.findIndex(m=>m._id===l);if(d!==-1){const m={...x.value[o].cards[d]};e(m),x.value[o].cards[d]=m,il(x)}}};function Tt(l,e){_t(l,o=>{const d=He.value.find(m=>m._id===e);d&&(o.lane=d)}),il(x),Ne.mutate({card_id:l,workspace_lane_id:e})}const Vt=(l,e)=>{_t(l,o=>{o.seat=e}),Ne.mutate({card_id:l,seat_id:e==null?void 0:e._id})},We=T(()=>{var l;return[{key:"card-title",label:"Title",render:({row:e,value:o})=>ve("div",{class:"flex items-center gap-1 w-full"},[ve("a",{onClick:()=>ue.value=e,class:"text-[12px] underline text-blue-500 shrink-0 overflow-ellipsis cursor-pointer"},e["card-code"]),ve("div",{class:"flex-1 min-w-0"},[ve("input",{onFocusout:d=>{var m;Et(e==null?void 0:e._id,"card-title",(m=d==null?void 0:d.target)==null?void 0:m.value)},class:"text-[12px] w-full overflow-ellipsis capitalize p-1 w-full p-1 focus:border border-accent/60 rounded-sm focus:outline-none focus:ring-1 focus:ring-accent bg-transparent focus:bg-bg-body text-[12px] h-8",defaultValue:o,disabled:!Se.value})])])},{key:"end-date",label:"Due Date",render:({row:e,value:o})=>{const d=y(o);return ve(ht,{class:" capitalize flex items-center gap-2 text-[12px]",placeholder:"Set start date",tableInputClass:!0,modelValue:d.value,disabled:!Se.value,"onUpdate:modelValue":m=>Wt(e==null?void 0:e._id,m),emptyText:"Date"})}},{key:"lane",label:"Lane",render:({row:e})=>{var o;return ve(cl,{options:He.value??[],placeholder:"Select lane",modelValue:((o=e.lane)==null?void 0:o._id)||null,disabled:!Se.value,"onUpdate:modelValue":d=>Tt(e==null?void 0:e._id,d),displayField:"title",emptyText:"Lane"})}},{key:"created_by",label:"Owner",render:({value:e})=>ve("div",{class:"capitalize flex items-center gap-2  px-3"},[ve("div",{class:" rounded-full  "},[e!=null&&e.u_profile_image?ve("img",{class:"w-6 h-6 rounded-full",src:e==null?void 0:e.u_profile_image}):ve("div",{class:"w-5 h-5 rounded-full flex justify-center items-center text-[11px] ",style:`background:${e!=null&&e.u_full_name?ql({name:e.u_full_name,email:e.u_email}):""}`},Yt(e==null?void 0:e.u_full_name))]),ve("span",{class:"text-[12px]"},e?e==null?void 0:e.u_full_name:"")])},{key:"seat",label:"Assignee",render:({row:e,value:o})=>ve(Jl,{class:"capitalize flex items-center gap-2 ",onAssign:d=>Vt(e==null?void 0:e._id,d),assigneeId:o,seat:o,name:!0,disabled:!st.value,emptyText:"Assignee"})},...((l=ct.value)==null?void 0:l.filter(e=>{var o;return((o=e==null?void 0:e.type)==null?void 0:o.title)==="Select"}).map(e=>({key:e==null?void 0:e.slug,label:e==null?void 0:e.slug,render:({row:o,value:d})=>{var Y;let m=d;if(Array.isArray(o==null?void 0:o.variables)){const A=o.variables.find(j=>j.slug===e.slug);A&&(m=A.value)}else m=((Y=o==null?void 0:o.variables)==null?void 0:Y[e.slug])??(o==null?void 0:o[e.slug])??d;return ve("div",{class:"capitalize flex items-center gap-2"},[ve(cl,{options:Ye(e.data??[]),modelValue:m,disabled:!Se.value,emptyText:e.slug,"onUpdate:modelValue":A=>{Et(o==null?void 0:o._id,e.slug,A)},columnName:e.slug})])},visible:e==null?void 0:e.is_visible})))??[]]});function Et(l,e,o){_t(l,d=>{if(e==="card-title"&&(d[e]=o),Array.isArray(d.variables)){const m=d.variables.find(Y=>Y.slug===e);m?m.value=o:d.variables.push({slug:e,value:o,type:"Select"})}else d.variables&&typeof d.variables=="object"?d.variables[e]=o:d[e]=o}),Ne.mutate({card_id:l,variables:{[e]:o.trim()}})}function Lt(l){if(l["card-title"]){const e={sheet_list_id:"To Do",workspace_id:a.value,sheet_id:ne.value,variables:{"card-title":l["card-title"].trim()},createdAt:new Date().toISOString()};W(e)}}const Wt=(l,e)=>{const o=x.value.findIndex(d=>d.cards.some(m=>m._id===l));if(o!==-1){const d=x.value[o].cards.findIndex(m=>m._id===l);d!==-1&&(x.value[o].cards[d]["end-date"]=e)}Ne.mutate({card_id:l,variables:{"start-date":e}})},Be=y(null),Ce=y(!1),ft=["#FFFFFF","#F2F2F2","#D9D9D9","#BFBFBF","#A6A6A6","#808080","#404040","#000000","#FFE066","#FF9AA2","#8EE4AF","#00EAD3","#90DBF4","#4D96FF","#6C63FF","#C77DFF","#F7A1C4","#FFC300","#FF5733","#2ECC71","#00B894","#17A2B8","#0984E3","#3F51B5","#9C27B0","#E84393","#FF8C00","#E74C3C","#1E8449","#006D6F","#004C6D","#0057A8","#1A237E","#4A148C","#7D3C98"],Ke=y(!1);z(Ce,l=>{l&&(Ke.value=!1)}),z(Ke,l=>{l&&(Ce.value=!1)});const Le=T(()=>{var l,e;return(e=(l=Be.value)==null?void 0:l.nodeObj)!=null&&e.style?Be.value.nodeObj.style:Me(xe)});function ye(l,e,o){return l!==void 0?l:e!==void 0?e:o}function Pe(l,e){var A;if(!((A=Be.value)!=null&&A.nodeObj))return;const o=Be.value.nodeObj;o.style||(o.style={});const d=e.target,m=d.type==="number"?Number(d.value):d.value;switch(l){case"bg_color":o.style.background=m;break;case"color":o.style.color=m;break;case"font_size":o.style.fontSize=`${m}px`;break;case"font_weight":o.style.fontWeight=m;break;case"font_style":o.style.fontStyle=m;break;case"font_family":o.style.fontFamily=m;break;case"border_color":o.style.borderColor=m;break;case"border_width":o.style.borderWidth=`${m}px`;break;case"border_radius":o.style.borderRadius=`${m}px`;break;case"padding":o.style.padding=`${m}px`;break}const Y=document.getElementById(o.id);Y&&Ae(o,Y)}const xe={bg_color:"#ffffff",color:"#000000",font_size:14,font_weight:"normal",font_style:"normal",font_family:"Inter",border_color:"#cccccc",border_width:0,border_radius:0,padding:0},p=y(!1);async function n(){var e;const l=(e=Be.value)==null?void 0:e.nodeObj;if(!(!l||p.value)){p.value=!0;try{const o=Pl(l);o._originalStyle||(o._originalStyle={});const d=o.style||{},m=o._originalStyle,Y={bg_color:ye(d.background,m.bg_color,xe.bg_color),color:ye(d.color,m.color,xe.color),font_size:ye(d.fontSize?parseInt(d.fontSize):void 0,m.font_size,xe.font_size),font_weight:ye(d.fontWeight,m.font_weight,xe.font_weight),font_style:ye(d.fontStyle,m.font_style,xe.font_style),font_family:ye(d.fontFamily,m.font_family,xe.font_family),border_color:ye(d.borderColor,m.border_color,xe.border_color),border_width:ye(d.borderWidth?parseInt(d.borderWidth):void 0,m.border_width,xe.border_width),border_radius:ye(d.borderRadius?parseInt(d.borderRadius):void 0,m.border_radius,xe.border_radius),padding:ye(d.padding?parseInt(d.padding):void 0,m.padding,xe.padding),hyperLink:E.value||o.hyperLink||""};o._originalStyle={...Y};const A=o.unique_name==="sheet"?{sheet_id:o.id,workspace_id:a.value,workspace_module_id:r.value,style:Y}:{card_id:o.id,seat_id:o.seat_id,style:Y};o.unique_name==="sheet"?await Ee(A):await Ne.mutateAsync(A)}finally{p.value=!1}}}const Z=y([]);function _e(l){const e={id:"root",topic:localStorage.getItem("currentName")??"",isRoot:!0,children:[],style:{},_originalStyle:{},unique_name:"root"};if(!Array.isArray(l))return e;const o={};return l.forEach(d=>{var j;const m=q.value,Y=((j=d.style)==null?void 0:j.hyperLink)||"";o[m]||(o[m]={id:d._id,topic:m,variables:d==null?void 0:d.variables,children:[],style:d==null?void 0:d.style,_originalStyle:(d==null?void 0:d.style)||{},unique_name:"sheet",hyperLink:Y||""},e.children.push(o[m]));const A={id:d==null?void 0:d._id,topic:d.title,children:[],style:Me(d==null?void 0:d.style),_originalStyle:d.style||{},unique_name:"List",hyperLink:Y||""};(d.cards||[]).forEach((G,he)=>{var ce;const i=((ce=G.style)==null?void 0:ce.hyperLink)||"",ee={id:G._id||`card-${he}`,seat_id:G.seat_id,topic:G["card-title"],style:Me(G.style),_originalStyle:G.style||{},children:[],unique_name:"card",hyperLink:i||""};A.children.push(ee),Z.value=ee}),o[m].children.push(A)}),e}const{mutateAsync:X}=Ul({onSuccess:()=>{te.invalidateQueries({queryKey:["sheets"]}),te.invalidateQueries({queryKey:["sheet-list"]}),close()}});Ol(()=>{c.value!=="mindmap"||!H.value||!x.value||zl(()=>{var m,Y;const l=_e(x.value);O.value&&((Y=(m=O.value).destroy)==null||Y.call(m),O.value=null);const e=new Zl({el:H.value,theme:void 0,draggable:!0,contextMenu:!0,contextMenuOption:{Update:!0,extend:[{name:"Update Node",onclick:()=>{var j;h.value&&(h.value=!1);const A=(j=Be.value)==null?void 0:j.nodeObj;A&&be(A)}},{name:"Add Hyperlink",onclick:()=>{K(async()=>{await n()})}}]}});O.value=e,e.init({nodeData:l}),e.bus.addListener("selectNode",A=>{A&&(Be.value={nodeObj:A},h.value=!0)}),e.bus.addListener("renderNode",A=>{!(A!=null&&A.nodeObj)||!(A!=null&&A.element)||Ae(A.nodeObj,A.element)});const o=new Set;e.bus.addListener("operation",async A=>{var he,i,ee;if(!A||A.name!=="insertSibling"&&A.name!=="addChild")return;const j=A.obj;if(!j||!j.id||o.has(j.id))return;o.add(j.id);let G;if(A.name==="addChild"?G=(he=e.currentNode)==null?void 0:he.nodeObj:G=(ee=(i=e.currentNode)==null?void 0:i.nodeObj)==null?void 0:ee.parent,!(!G||!("unique_name"in G))&&G.unique_name==="List")try{const ce=Qe({topic:j.topic??"New Card",id:j.id},G);await W(ce)}catch(ce){console.error("Error creating card or refetching sheets:",ce)}});const d=new Set;e.bus.addListener("operation",async A=>{var he,i;if(!A)return;const j=A.obj;if(!(j!=null&&j.id))return;const G=j.parent??((i=(he=e.currentNode)==null?void 0:he.nodeObj)==null?void 0:i.parent);if(!(!G||!("unique_name"in G))){if(A.name==="addChild"&&G.unique_name==="root"&&!d.has(j.id)){d.add(j.id);try{await X({variables:{"sheet-title":j.topic??"New Sheet","sheet-description":"This is custom description"},is_ai_generated:!1,workspace_id:a.value,workspace_module_id:r.value})}catch(ee){console.error("Error creating workspace sheet:",ee)}return}if(G.unique_name==="List")try{const ee=Qe({topic:j.topic??"New Card",id:j.id},G);await W(ee)}catch(ee){console.error("Error creating card or refetching sheets:",ee)}}})})});function Ae(l,e){if(!l||!e||!l.style)return;const o=e.querySelector(".topic"),d=e.querySelector(".node")??e,m=l.style;m.background&&(d.style.background=m.background),m.color&&o&&(o.style.color=m.color),o&&(m.fontSize&&(o.style.fontSize=m.fontSize),m.fontFamily&&(o.style.fontFamily=m.fontFamily),m.fontWeight&&(o.style.fontWeight=m.fontWeight),m.fontStyle&&(o.style.fontStyle=m.fontStyle)),m.borderColor&&(d.style.borderColor=m.borderColor),m.borderWidth&&(d.style.borderWidth=m.borderWidth),m.borderRadius&&(d.style.borderRadius=m.borderRadius),m.padding&&(d.style.padding=m.padding)}function Me(l={}){return{background:l.bg_color,color:l.color,fontSize:l.font_size!=null?`${l.font_size}px`:void 0,fontWeight:l.font_weight,fontStyle:l.font_style,fontFamily:l.font_family,borderColor:l.border_color,borderWidth:l.border_width!=null?`${l.border_width}px`:void 0,borderRadius:l.border_radius!=null?`${l.border_radius}px`:void 0,padding:l.padding!=null?`${l.padding}px`:void 0,hyperLink:l.hyperLink||void 0}}function Qe(l,e){const o=new Date,d=o.toISOString().split("T")[0],m=new Date(o.getTime()+3*24*60*60*1e3).toISOString().split("T")[0];return{sheet_list_id:(e==null?void 0:e.topic)||"In Progress",workspace_id:a.value,sheet_id:ne.value,workspace_lane_id:(l==null?void 0:l.workspace_lane_id)||null,variables:{"card-status":(e==null?void 0:e.topic)||"In Progress","card-type":null,priority:null,process:null,"card-title":l.topic||"New Card","card-description":"","start-date":d,"end-date":m},createdAt:new Date().toISOString()}}return(l,e)=>{var Y,A,j,G,he;const o=Kt("Button"),d=Kt("Searchbar"),m=Kt("BaseTextField");return f(),b("div",zs,[t("div",js,[t("div",Rs,[F(o,{class:"cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white flex items-center justify-center gap-1 px-2 rounded-md text-xs font-medium",onClick:e[0]||(e[0]=i=>l.$emit("go-back"))},{default:se(()=>e[28]||(e[28]=[t("i",{class:"fa-solid fa-chevron-left text-xs"},null,-1),oe(" Go Back")])),_:1,__:[28]}),F(Qt,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=i=>s.value=i),options:nt.value,variant:"secondary",customClasses:"fixed w-auto"},null,8,["modelValue","options"]),s.value?(f(),pe(Qt,{key:0,onEditOption:$t,modelValue:ne.value,"onUpdate:modelValue":e[3]||(e[3]=i=>ne.value=i),canEdit:g(J),canDelete:g(k),onDeleteOption:xt,options:gt.value,variant:"secondary",customClasses:"fixed w-auto"},{more:se(()=>[g(me)?(f(),b("div",{key:0,onClick:e[2]||(e[2]=i=>jt()),class:"capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},e[29]||(e[29]=[t("i",{class:"fa-solid fa-plus"},null,-1),oe(" Add new ")]))):U("",!0)]),_:1},8,["modelValue","canEdit","canDelete","options"])):U("",!0)]),t("div",Hs,[s.value?(f(),pe(Qt,{key:0,actions:!1,modelValue:ie.value,"onUpdate:modelValue":e[5]||(e[5]=i=>ie.value=i),options:g(ct),variant:"secondary",customClasses:"fixed w-auto"},{more:se(()=>[g(D)?(f(),b("div",{key:0,onClick:e[4]||(e[4]=()=>{v.value=!0}),class:"sticky bottom-0 bg-bg-dropdown shadow-md shadow-border capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},e[30]||(e[30]=[t("i",{class:"fa-solid fa-plus"},null,-1),oe(" Add new ")]))):U("",!0)]),_:1},8,["modelValue","options"])):U("",!0),F(d,{onOnChange:e[6]||(e[6]=i=>{je.value=i}),placeholder:"Search in Orchit AI space"}),t("div",Ws,[t("button",{class:Q(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",c.value==="kanban"?"text-accent bg-accent-text":" hover:bg-border/50 backdrop-blur-2xl  transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"List view",onClick:e[7]||(e[7]=i=>c.value="kanban")},e[31]||(e[31]=[t("i",{class:"fa-solid fa-chart-kanban"},null,-1)]),2),t("button",{onClick:e[8]||(e[8]=i=>c.value="table"),class:Q(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",c.value==="table"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gallery view"},e[32]||(e[32]=[t("i",{class:"fa-solid fa-align-left"},null,-1)]),2),t("button",{onClick:e[9]||(e[9]=i=>c.value="mindmap"),class:Q(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",c.value==="mindmap"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"MindMap view"},e[33]||(e[33]=[t("i",{class:"fa-solid fa-chart-diagram"},null,-1)]),2)])])]),t("div",Ks,[c.value=="kanban"?(f(),b("div",Qs,[et(F(wl,null,null,512),[[Gt,g(S)]]),et(t("div",Gs,[F(g($),{onOnPlus:wt,"onDelete:column":e[10]||(e[10]=i=>bt(i)),"onUpdate:column":e[11]||(e[11]=i=>Nt(i)),onReorder:St,onAddColumn:ot,"onSelect:ticket":be,board:dt.value,onOnBoardUpdate:Ot,variable_id:ie.value,sheet_id:ne.value},{"column-footer":se(i=>{var ee,ce,nl,ol,rl;return[(ce=(ee=g(Ze))==null?void 0:ee.transitions)!=null&&ce.all_allowed&&!((rl=(ol=(nl=g(Ze))==null?void 0:nl.transitions)==null?void 0:ol.all_allowed)!=null&&rl.includes(i.column.title))&&g(Ze).transitions.currentColumn!=i.column.title?(f(),b("div",Js," Disbale ( you can't drop here )")):U("",!0)]}),ticket:se(({ticket:i})=>[F(Xl,{selectedVar:ie.value,onSelect:()=>{be(i)},ticket:i},null,8,["selectedVar","onSelect","ticket"])]),_:1},8,["board","variable_id","sheet_id"])],512),[[Gt,!g(S)]])])):U("",!0),c.value=="table"?(f(),pe(Gl,{key:1,onToggleVisibility:Dt,onAddVar:e[12]||(e[12]=()=>{v.value=!0}),isPending:g(S)||g(Rt),columns:We.value,rows:dt.value,canCreate:g(ge),canCreateVariable:g(D),onCreate:Lt},null,8,["isPending","columns","rows","canCreate","canCreateVariable"])):U("",!0),c.value==="mindmap"?(f(),b(fe,{key:2},[t("div",Zs,[t("div",{ref_key:"mindMapRef",ref:H,class:"flex-1 h-full overflow-y-hidden rounded-md relative"},null,512),h.value?(f(),b("div",Xs,[t("div",Ys,[e[35]||(e[35]=t("h3",{class:"text-sm font-semibold text-secondary"},"Format Node",-1)),t("button",{onClick:e[13]||(e[13]=i=>h.value=!1),class:"text-gray-400 hover:text-gray-700"},e[34]||(e[34]=[t("i",{class:"fa-solid fa-times"},null,-1)]))]),t("div",en,[t("div",null,[e[38]||(e[38]=t("h4",{class:"text-xs font-semibold text-secondary uppercase mb-3"}," Colors ",-1)),t("div",tn,[e[36]||(e[36]=t("label",{class:"block text-xs text-secondary mb-1"},"Background",-1)),t("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[14]||(e[14]=i=>Ce.value=!Ce.value)},[t("div",{class:"w-full h-7 rounded border",style:qe({background:Le.value.background})},null,4),t("span",ln,N(Le.value.background),1)]),Ce.value?(f(),b("div",an,[t("div",sn,[(f(),b(fe,null,ke(ft,i=>t("button",{key:i,class:"w-5 h-5 rounded border",style:qe({background:i}),onClick:ee=>{Pe("bg_color",{target:{value:i}}),Ce.value=!1}},null,12,nn)),64))]),t("div",on,[t("input",{type:"color",value:Le.value.background,class:"w-8 h-8 cursor-pointer",onInput:e[15]||(e[15]=i=>Pe("bg_color",i))},null,40,rn),t("input",{type:"text",class:"flex-1 text-xs border rounded px-2 py-1",value:Le.value.background,readonly:""},null,8,dn)])])):U("",!0)]),t("div",un,[e[37]||(e[37]=t("label",{class:"block text-xs text-secondary mb-1"},"Text",-1)),t("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[16]||(e[16]=i=>Ke.value=!Ke.value)},[t("div",{class:"w-full h-7 rounded border",style:qe({background:Le.value.color})},null,4),t("span",cn,N(Le.value.color),1)]),Ke.value?(f(),b("div",pn,[t("div",fn,[(f(),b(fe,null,ke(ft,i=>t("button",{key:i,class:"w-5 h-5 rounded border",style:qe({background:i}),onClick:ee=>{Pe("color",{target:{value:i}}),Ke.value=!1}},null,12,vn)),64))]),t("div",mn,[t("input",{type:"color",value:Le.value.color,class:"w-8 h-8 cursor-pointer",onInput:e[17]||(e[17]=i=>Pe("color",i))},null,40,gn),t("input",{type:"text",class:"flex-1 text-xs border rounded px-2 py-1",value:Le.value.color,readonly:""},null,8,bn)])])):U("",!0)])]),t("div",null,[t("div",yn,[t("div",null,[e[40]||(e[40]=t("label",{class:"block text-xs text-secondary mb-1"},"Weight",-1)),t("select",{class:"w-full h-8 border rounded px-2 text-sm",value:Le.value.fontWeight,onChange:e[18]||(e[18]=i=>Pe("font_weight",i))},e[39]||(e[39]=[t("option",{value:"lighter"},"Light",-1),t("option",{value:"normal"},"Normal",-1),t("option",{value:"bold"},"Bold",-1),t("option",{value:"bolder"},"Extra Bold",-1)]),40,xn)])])])]),t("div",_n,[t("button",{class:"w-full cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm font-medium hover:shadow-md disabled:opacity-60",disabled:p.value,onClick:n},[p.value?(f(),b("span",kn)):U("",!0),t("span",null,N(p.value?"Updating...":"Update"),1)],8,hn)])])):U("",!0)]),u.value?(f(),b("div",Sn,[t("div",wn,[e[41]||(e[41]=t("h3",{class:"text-lg font-semibold mb-4"},"Insert Web Link",-1)),et(t("input",{"onUpdate:modelValue":e[19]||(e[19]=i=>E.value=i),type:"text",placeholder:"Enter or paste a URL",class:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ll,E.value]]),t("div",Cn,[t("button",{onClick:I,class:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300"}," Cancel "),t("button",{disabled:!E.value,onClick:L,class:Q(["px-4 py-2 rounded-md text-white",E.value?"bg-blue-500 hover:bg-blue-600":"bg-blue-300 cursor-not-allowed"])}," Insert ",10,$n)])])])):U("",!0),rt.value?(f(),b("div",{key:1,class:"absolute top-40 left-70 bg-bg-body rounded-lg p-4 shadow-lg z-100 min-w-[328px] border",onClick:e[21]||(e[21]=$e(()=>{},["stop"]))},[F(m,{autofocus:!0,modelValue:it.value,"onUpdate:modelValue":e[20]||(e[20]=i=>it.value=i),placeholder:"Add New list",onKeyup:Jt(le,["enter"])},null,8,["modelValue"]),e[42]||(e[42]=t("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),t("div",Dn,[F(o,{onClick:le,varaint:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:se(()=>[oe(N(g(Je)?"Adding...":"Add list"),1)]),_:1}),t("i",{class:"fa-solid fa-close cursor-pointer",onClick:ae})])])):U("",!0)],64)):U("",!0),F(g(V),{onClick:e[22]||(e[22]=$e(()=>{},["stop"])),modelValue:Ue.value,"onUpdate:modelValue":e[23]||(e[23]=i=>Ue.value=i),title:"Delete List",itemLabel:"list",itemName:(Y=Oe.value)==null?void 0:Y.title,requireMatchText:(A=Oe.value)==null?void 0:A.title,confirmText:"Delete workspace",cancelText:"Cancel",size:"md",loading:g(Je),onConfirm:Pt,onCancel:e[24]||(e[24]=()=>{Ue.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),de.value?(f(),pe(g(B),{selectedVariable:ie.value,listId:(j=Oe.value)==null?void 0:j.title,sheet_id:ne.value,key:"createTaskModalKey",modelValue:de.value,"onUpdate:modelValue":e[25]||(e[25]=i=>de.value=i),onSubmit:e[26]||(e[26]=()=>{})},null,8,["selectedVariable","listId","sheet_id","modelValue"])):U("",!0),(G=ue.value)!=null&&G._id?(f(),pe(g(P),{key:4,details:ue.value,onClose:e[27]||(e[27]=()=>{be({variables:{}})}),showPanel:!!((he=ue.value)!=null&&he._id)},null,8,["details","showPanel"])):U("",!0)])])}}}),Vn=Ut(Tn,[["__scopeId","data-v-dca13520"]]),En={class:"flex-auto flex-grow h-full min-h-0 bg-bg-card rounded-[6px] border border-border overflow-x-auto flex-col flex"},Ln={key:1},An={key:1,class:"p-4 w-full min-w-0 box-border h-full min-h-0"},Mn={class:"flex items-center justify-between"},Bn={class:"text-sm font-semibold flex gap-2 items-center"},In={class:"flex items-center gap-2 relative",ref:"filterDropdownRef"},Fn={key:0,class:"flex items-center gap-2 overflow-x-auto no-scrollbar py-1"},Un=["onClick"],On={key:1,class:"relative flex items-center gap-3"},Nn={class:"relative flex-shrink-0"},Pn={class:"flex items-center gap-2 truncate"},qn=["src"],zn={class:"truncate"},jn={key:0,class:"absolute left-0 top-full mt-1 w-44 bg-white border border-gray-200 rounded-lg shadow-lg z-[9999]"},Rn={class:"flex flex-col"},Hn=["onClick"],Wn={class:"flex gap-2 overflow-x-auto no-scrollbar flex-1"},Kn=["onClick"],Qn={key:0,class:"w-full h-full min-h-[250px] flex justify-center items-center"},Gn={class:"flex justify-between px-3"},Jn={class:"flex items-center gap-2 bg-transparent min-w-0 pe-2"},Zn=["onClick"],Xn={class:"flex items-center gap-2 max-w-full"},Yn={class:"flex items-center gap-2 max-w-full"},eo={class:"truncate max-w-[160px]"},to={key:1,class:"absolute left-0 mt-2 w-60 bg-white border border-gray-200 rounded-xl shadow-lg z-50 max-h-64 overflow-y-auto overflow-x-hidden"},lo={class:"relative flex-1"},ao=["onClick"],so=["onBlur","onKeyup"],no={class:"relative ml-2 flex gap-2"},oo=["onClick"],ro=["onClick"],io={class:"flex gap-3 items-center"},uo={class:"hidden sm:flex flex-1"},co={class:"gap-2 hidden lg:flex"},po={key:0,class:"flex gap-2"},fo={key:0,class:"flex gap-2 lg:hidden"},vo={key:0},mo=["title"],go=["disabled"],bo={key:0,class:"fixed inset-0 z-50 -top-30 flex items-center justify-center"},yo={class:"bg-white rounded-lg w-11/12 max-w-md p-4"},xo={class:"flex items-center gap-2"},_o={key:0,class:"w-full h-full min-h-[250px] flex justify-center items-center"},It=400,ho=at({__name:"Plan",setup(w){const{theme:_}=sl(),B=y(!1),V=y(""),P=y(!1),$=y(!1),{canCreateCard:u}=Xt(),E=y(!1),R=y(null),H=y(!1),O=y(!1),q=T(()=>I.value.value),K=y(null),L=[{label:"Milestone",value:"milestone",dot:"#2e9bda"},{label:"Sprint",value:"sprint",dot:"#7d68c8"},{label:"Huddle",value:"huddle",dot:"#eea832"}],I=y(L[0]),W=y(null),le=y(!1);Bt(W,()=>{le.value=!1});const ae=()=>{B.value=!1},M=()=>{E.value=!0},{workspaceId:c}=bl(),a=y(!1),{moveSelectedToSprint:r,moveSelectedToBacklog:s,deleteSelected:v,saveSprintMeta:h,toggleStartSprint:J}=ca();function k(p){K.value=p}function D(p){K.value=p}function me(p){K.value=p}const{data:ge,refetch:Se}=Zt(c,q,K);z(K,()=>{Se()});const{data:st}=jl(c),Ge=T(()=>{var p;return((p=st.value)==null?void 0:p.modules.filter(n=>{var Z;return((Z=n==null?void 0:n.variables)==null?void 0:Z["module-title"])!=="Pin"}))||[]});z(()=>q.value,(p,n)=>{p!==n&&Se()});const{mutate:mt,isPending:nt}=ia({onSuccess:()=>{dt.invalidateQueries({queryKey:["sprint-list"]}),Te.value=!1}}),te=y(null),Te=y(!1),Je=()=>{var p;mt((p=te.value)==null?void 0:p._id)},{mutate:ot,isPending:we}=fl({onSuccess:p=>{h({name:p.title}),console.log(p,"this is testing data"),Ie({id:S.value,payload:{title:p.title,start_date:p.start_date,end_date:p.end_date,goal:p.goal,duration:Number(p.duration_days)}}),be.value=!1}}),{mutate:Ie,isPending:Fe}=ra({onSuccess:()=>{ue()}}),ne=p=>{console.log("helo",te.value,p),ot({id:S.value,payload:{title:p.title,duration:p.duration,start_date:p.start,end_date:p.end,goal:p.goal}})},{data:re,refetch:ie}=ta(c.value,q);z(()=>q.value,(p,n)=>{p!==n&&ie()});const{refetch:Ze,isPending:C}=Zt(c,q),x=T(()=>{var p,n;return(n=(p=re==null?void 0:re.value)==null?void 0:p.sprints[0])==null?void 0:n._id}),S=y(x.value);z(()=>x.value,p=>{S.value=p}),z(()=>S.value,p=>{var n;te.value=((n=re.value)==null?void 0:n.sprints.find(Z=>Z._id===p))||null});const{data:de,refetch:ue}=na(S),be=y(!1),Xe=()=>{console.log(Ee.value,"this is sprint"),be.value=!0},{data:Ve,isPending:St,refetch:Ot}=la(S);z(()=>S.value,()=>{ue()});const Ee=T(()=>{var Z,_e;const p=(Z=Ve==null?void 0:Ve.value)==null?void 0:Z.backlog_items;if(!p)return null;const n=(((_e=Ve==null?void 0:Ve.value)==null?void 0:_e.backlog_items)||[]).map(X=>{var Qe,l,e,o,d;const Ae=((Qe=X==null?void 0:X.card)==null?void 0:Qe.variables)||{},Me=((l=X==null?void 0:X.card)==null?void 0:l._id)||X.card_id;return{id:Me,key:Ae["card-code"]||(Me==null?void 0:Me.slice(-6))||"PRJ-?",summary:Ae["card-title"]||"(untitled)",type:"Story",status:rt(String(Ae["card-status"]||"").trim()),assignee:((o=(e=X==null?void 0:X.card)==null?void 0:e.assigned_to)==null?void 0:o.name)||"Unassigned",storyPoints:Number(X.story_points||0),priority:it(String(Ae.priority||"").trim()),createdAt:((d=X==null?void 0:X.card)==null?void 0:d.created_at)||new Date().toISOString(),description:Ae["card-description"]||""}});return{id:p._id,name:p.title||"Sprint 1",title:p.title,goal:"",start:"",end:"",started:!1,tickets:n}});function gt(p){S.value=p._id,Ce.value=!1}function rt(p){const n=p.toLowerCase();return n.includes("progress")?"In Progress":n.includes("done")||n.includes("complete")?"Done":"Todo"}function it(p){const n=p.toLowerCase();return n==="highest"||n==="blocker"||n==="critical"?"Highest":n==="high"||n==="major"?"High":n==="medium"||n==="normal"?"Medium":"Low"}const{mutate:Nt}=da({onSuccess:()=>{vt.success("Card removed from sprint successfully"),Ue()},onError:p=>{vt.error("Failed to remove card from sprint"),console.error("Failed to remove card from sprint:",p)}});function Ue(){Ot(),ie(),Ze(),ue()}function Oe(p,n){const Z=Array.isArray(p)?p:[p],_e=n||S.value;!_e||!Z.length||Z.forEach(X=>{Nt({sprintId:_e,cardId:X})})}const Pt=y(!1),bt=y(null);function wt(){a.value=!0,bt.value=null}function je(p){bt.value=p,B.value=!0,Pt.value=!0}const Re=y(!1);function qt(){Re.value=!0}const dt=al(),{mutate:zt,isPending:Ct}=oa({onSuccess:p=>{h({name:p.title}),dt.invalidateQueries({queryKey:["sprint-list"]}),Re.value=!1}}),{mutate:$t,isPending:yt}=fl({onSuccess:p=>{h({name:p.title}),dt.invalidateQueries({queryKey:["sprint-list"]}),Re.value=!1}}),xt=y("");function ut(p){const n=xt.value.trim();if(!n||n===p.title){Lt();return}$t({id:p._id,payload:{workspace_id:c.value,title:n}}),We.value=null}function jt(p){var n;te.value?$t({id:(n=te.value)==null?void 0:n._id,payload:{workspace_id:c.value,title:p.name,sprintType:p.value,description:p.description}}):zt({payload:{workspace_id:c.value,title:p.name,sprintType:p.value,description:p.description}})}function ct(){te.value=null,Re.value=!0}function Rt(p){te.value=p,Te.value=!0}const{mutate:Ht,isPending:Dt}=sa(S,{onSuccess:()=>{ue()}}),pt=()=>{Ht({})},He=y(null),Ye=y(0);let Ne=!1;Rl(()=>{if(!He.value)return;const p=He.value.offsetWidth;Ye.value=p/3});function _t(){Ne=!0,document.addEventListener("mousemove",Tt),document.addEventListener("mouseup",Vt)}function Tt(p){if(!Ne||!He.value)return;const n=He.value.getBoundingClientRect(),Z=p.clientX-n.left;Z<It?Ye.value=It:Z>n.width-It?Ye.value=n.width-It:Ye.value=Z}function Vt(){Ne=!1,document.removeEventListener("mousemove",Tt),document.removeEventListener("mouseup",Vt)}const We=y(null);function Et(p){We.value=p._id,p.tempTitle=p.title}function Lt(){var n;const p=(n=re.value)==null?void 0:n.sprints.find(Z=>Z._id===We.value);p&&(p.tempTitle=p.title),We.value=null}Bt(R,()=>{O.value=!1});const Wt=p=>{I.value=p,H.value=!1};Bt(W,()=>{H.value=!1});const Be=y(null),Ce=y(!1);Bt(Be,()=>{Ce.value=!1});const ft=y(!1),Ke=()=>{ft.value=!0},Le=()=>{ft.value=!1},ye=y("all"),Pe=y(!1),xe=T(()=>{var n,Z,_e;if(ye.value==="all")return"All Milestones";const p=(Z=(n=st.value)==null?void 0:n.modules)==null?void 0:Z.find(X=>X._id===ye.value);return((_e=p==null?void 0:p.variables)==null?void 0:_e["module-title"])||"Select Module"});return(p,n)=>{var Z,_e,X,Ae,Me,Qe,l,e,o,d,m,Y,A,j,G,he;return f(),b("div",En,[E.value?(f(),pe(Vn,{key:0,sptint_id:S.value,searchQuery:V.value,onGoBack:n[0]||(n[0]=i=>E.value=!1)},null,8,["sptint_id","searchQuery"])):U("",!0),E.value?U("",!0):(f(),b("div",Ln,[g(Fe)?(f(),pe(wl,{key:0})):(f(),b("div",An,[t("div",{class:"flex gap-2 h-full max-h-screen min-h-0 box-border overflow-x-auto group",ref_key:"containerRef",ref:He},[t("section",{class:Q(["space-y-4 p-4 rounded-md relative group overflow-hidden box-border h-full min-h-0 min-w-[400px]",g(_)==="dark"?"bg-bg-surface":"bg-bg-surface/30"]),style:qe({width:Ye.value+"px"})},[t("div",Mn,[t("h2",Bn,[et(t("input",{type:"checkbox",class:"custom-checkbox bg-bg-body border border-border-input flex-shrink-0","onUpdate:modelValue":n[1]||(n[1]=i=>P.value=i)},null,512),[[Hl,P.value]]),oe(" Tickets ("+N((_e=(Z=g(ge))==null?void 0:Z.cards)==null?void 0:_e.length)+" "+N(((Ae=(X=g(ge))==null?void 0:X.cards)==null?void 0:Ae.length)>1?"Tasks":"Task")+") ",1)]),t("div",In,[g(u)?(f(),b("button",{key:0,class:"w-8 h-8 rounded cursor-pointer text-sm hover:bg-bg-body flex items-center justify-center",onClick:wt},n[22]||(n[22]=[t("i",{class:"text-text-primary fa-regular fa-plus"},null,-1)]))):U("",!0)],512)]),t("div",null,[q.value==="milestone"?(f(),b("div",Fn,[t("button",{onClick:n[2]||(n[2]=i=>k("all")),class:Q(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium transition-colors whitespace-nowrap",K.value==="all"?"bg-accent text-white border-none":"bg-transparent text-accent border border-accent"])}," All Modules ",2),(f(!0),b(fe,null,ke(Ge.value,i=>(f(),b("button",{key:i._id,onClick:ee=>k(i._id),class:Q(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",K.value===i._id?"bg-accent text-white border-none":"bg-transparent text-accent border border-accent"])},N(i.variables["module-title"]),11,Un))),128))])):q.value==="huddle"||q.value==="sprint"?(f(),b("div",On,[t("div",Nn,[t("button",{class:"h-8 min-w-[160px] flex items-center justify-between px-2 rounded-md border text-sm border-border hover:bg-bg-body",onClick:n[3]||(n[3]=i=>Pe.value=!Pe.value)},[t("span",Pn,[t("img",{src:g(Ka),alt:"filter",class:"w-4 h-4"},null,8,qn),t("span",zn,N(xe.value||"All Milestones"),1)]),n[23]||(n[23]=t("i",{class:"fas fa-chevron-down text-xs ml-2"},null,-1))]),Pe.value?(f(),b("div",jn,[t("ul",Rn,[t("li",{class:"px-3 py-2 cursor-pointer hover:bg-gray-100",onClick:n[4]||(n[4]=i=>D("all"))}," All Milestones "),(f(!0),b(fe,null,ke(Ge.value,i=>(f(),b("li",{key:i._id,class:"px-3 py-2 cursor-pointer hover:bg-gray-100",onClick:ee=>D(i._id)},N(i.variables["module-title"]),9,Hn))),128))])])):U("",!0)]),t("div",Wn,[(f(!0),b(fe,null,ke((Me=g(re))==null?void 0:Me.sprints,i=>(f(),b("button",{key:i._id,onClick:ee=>me(i._id),class:Q(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium whitespace-nowrap transition-colors",K.value===i._id?"bg-accent text-white border-none":"bg-transparent text-accent border border-accent"])},N(i.title),11,Kn))),128))])])):U("",!0)]),g(C)?(f(),b("div",Qn,n[24]||(n[24]=[t("div",{role:"status","aria-label":"Loading",class:"h-10 w-10 rounded-full border-4 border-neutral-700 border-t-transparent animate-spin"},null,-1)]))):(f(),pe(Da,{key:1,checkedAll:P.value,"sprint-type":q.value,searchQuery:V.value,"module-id":K.value,onMoveSelectedToSprint:g(r),onDeleteSelectedBacklog:n[5]||(n[5]=i=>g(v)("backlog")),onOpenTicket:je,onTicketMovedToBacklog:Oe,onOpenCreateTicket:wt},null,8,["checkedAll","sprint-type","searchQuery","module-id","onMoveSelectedToSprint"]))],6),t("div",{class:"h-full w-[3px] relative z-10 opacity-0 group-hover:opacity-100 bg-red hover:bg-accent cursor-col-resize transition",onMousedown:_t},null,32),t("section",{class:Q(["space-y-4 rounded-md relative group pt-2 ovrflow-hidden flex-1 h-full min-h-0 box-border min-w-[400px] border border-border-input overflow-x-hidden",g(_)==="dark"?"bg-bg-surface":"bg-bg-surface/30"])},[t("div",Gn,[t("div",Jn,[t("div",{ref_key:"elipseWrapperSprint",ref:R,class:"relative inline-block"},[t("button",{onClick:n[6]||(n[6]=$e(i=>O.value=!O.value,["stop"])),class:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium bg-transparent rounded-lg",style:qe({border:"1px solid "+I.value.dot})},[t("span",{class:"w-2 h-2 rounded-full",style:qe({backgroundColor:I.value.dot})},null,4),oe(" "+N(I.value.label)+" ",1),n[25]||(n[25]=t("i",{class:"fas fa-chevron-down text-xs"},null,-1))],4),F(dl,{name:"fade"},{default:se(()=>[O.value?(f(),b("ul",{key:0,onClick:n[7]||(n[7]=$e(()=>{},["stop"])),class:"absolute left-0 mt-2 w-44 bg-bg-dropdown border border-border rounded-xl shadow-lg z-50"},[(f(),b(fe,null,ke(L,i=>t("li",{key:i.value,onClick:ee=>(Wt(i),O.value=!O.value),class:"flex items-center gap-3 px-4 py-2 text-sm cursor-pointer"},[t("span",{class:"w-2 h-2 rounded-full",style:qe({backgroundColor:i.dot})},null,4),oe(" "+N(i.label),1)],8,Zn)),64))])):U("",!0)]),_:1})],512),t("div",Xn,[t("div",Yn,[t("div",{ref_key:"sprintDropdownWrapperRef",ref:Be,class:"relative min-w-0"},[(Qe=g(re))!=null&&Qe.sprints.length?(f(),b("button",{key:0,onClick:n[8]||(n[8]=i=>Ce.value=!Ce.value),class:Q(["flex items-center gap-3 lg:px-6 px-2 py-1.5 rounded-lg text-sm font-medium transition-all",S.value?"text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"]),style:qe(S.value?{backgroundColor:I.value.dot}:{})},[t("span",eo,N((o=(e=(l=g(re))==null?void 0:l.sprints)==null?void 0:e.find(i=>i._id===S.value))==null?void 0:o.title),1),n[26]||(n[26]=t("i",{class:"fas fa-chevron-down text-xs"},null,-1))],6)):U("",!0),Ce.value?(f(),b("div",to,[(f(!0),b(fe,null,ke((d=g(re))==null?void 0:d.sprints,i=>{var ee;return f(),b("div",{key:i._id,class:"relative px-4 py-2 flex items-center justify-between text-sm cursor-pointer transition-colors hover:bg-gray-100"},[t("div",lo,[We.value!==i._id?(f(),b("button",{key:0,class:"text-left truncate w-full",onClick:ce=>gt(i)},N(i.title),9,ao)):et((f(),b("input",{key:1,ref_for:!0,ref:"editingInputRef","onUpdate:modelValue":n[9]||(n[9]=ce=>xt.value=ce),class:"w-full px-1 py-1 text-sm rounded outline-none bg-white border border-[#7d68c8]",placeholder:"Enter new name",onClick:n[10]||(n[10]=$e(()=>{},["stop"])),onBlur:ce=>ut(i),onKeyup:[Jt(ce=>ut(i),["enter"]),Jt(Lt,["esc"])]},null,40,so)),[[ll,xt.value]])]),t("div",no,[t("button",{class:"ml-2 text-xs text-gray-400 hover:text-accent",onClick:$e(ce=>Et(i),["stop"])},n[27]||(n[27]=[t("i",{class:"fas fa-pen"},null,-1)]),8,oo),((ee=g(re))==null?void 0:ee.sprints.length)>1&&We.value!==i._id?(f(),b("button",{key:0,onClick:$e(ce=>Rt(i),["stop"]),class:"w-4 h-4 rounded-full flex items-center justify-center text-gray-400 hover:text-red-500"},n[28]||(n[28]=[t("i",{class:"fas fa-times text-xs"},null,-1)]),8,ro)):U("",!0)])])}),128))])):U("",!0)],512)]),t("button",{onClick:n[11]||(n[11]=i=>ct()),class:"w-7 h-7 flex items-center -lg:ms-0 -ms-1 justify-center rounded-full bg-accent border text-white transition-colors shrink-0"},n[29]||(n[29]=[t("i",{class:"fa-solid fa-plus text-xs"},null,-1)]))])]),t("div",io,[t("div",uo,[F(ul,{placeholder:"Search in sprint",modelValue:V.value,"onUpdate:modelValue":n[12]||(n[12]=i=>V.value=i)},null,8,["modelValue"])]),t("button",{class:"sm:hidden flex items-center justify-center w-7 h-7 rounded-full bg-accent border",onClick:Ke},n[30]||(n[30]=[t("i",{class:"fa-solid fa-magnifying-glass text-white text-xs"},null,-1)])),t("div",co,[((m=g(de))==null?void 0:m.status)==="active"?(f(),b("div",po,[F(ze,{size:"sm",onClick:pt,variant:(g(_)==="dark","primary"),class:"border-border-input border"},{default:se(()=>[oe(N(g(Dt)?"Ending...":"End"),1)]),_:1},8,["variant"]),t("button",{class:"cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white flex items-center justify-center gap-1 px-2 py-1 rounded-md text-sm font-medium",onClick:M},n[31]||(n[31]=[t("i",{class:"fa-regular fa-eye text-sm"},null,-1),oe(" Preview")]))])):(f(),pe(ze,{key:1,size:"sm",variant:(g(_)==="dark","primary"),class:"border-border-input border",onClick:Xe,disabled:!Ee.value||Ee.value.tickets.length===0},{default:se(()=>n[32]||(n[32]=[oe(" Start Sprint ")])),_:1,__:[32]},8,["variant","disabled"]))]),Ee.value&&Ee.value.tickets.length?(f(),b("div",fo,[oe(N((Y=g(de))==null?void 0:Y.status)+" ",1),((A=g(de))==null?void 0:A.status)==="active"?(f(),b("div",vo,[t("button",{onClick:pt,class:"w-7 h-7 flex items-center justify-center rounded-full bg-accent border",title:g(Dt)?"Ending...":"End Sprint"},n[33]||(n[33]=[t("i",{class:"fa-solid fa-flag-checkered text-gray-700"},null,-1)]),8,mo)])):(f(),b("button",{key:1,onClick:Xe,disabled:!Ee.value||Ee.value.tickets.length===0,class:"w-7 h-7 flex items-center justify-center rounded-full bg-accent border disabled:opacity-50 disabled:cursor-not-allowed",title:"Start Sprint"},n[34]||(n[34]=[t("i",{class:"fa-solid fa-play"},null,-1)]),8,go))])):U("",!0)]),F(dl,{name:"fade"},{default:se(()=>[ft.value?(f(),b("div",bo,[t("div",yo,[t("div",xo,[F(ul,{placeholder:"Search in sprint",modelValue:V.value,"onUpdate:modelValue":n[13]||(n[13]=i=>V.value=i),class:"flex-1"},null,8,["modelValue"]),t("button",{onClick:Le,class:"p-2 rounded hover:bg-gray-100 text-accent"},n[35]||(n[35]=[t("i",{class:"fa-solid fa-xmark"},null,-1)]))])])])):U("",!0)]),_:1})]),g(St)?(f(),b("div",_o,n[36]||(n[36]=[t("div",{role:"status","aria-label":"Loading",class:"h-10 w-10 rounded-full border-4 border-neutral-700 border-t-transparent animate-spin"},null,-1)]))):(f(),b(fe,{key:1},[Ee.value?(f(),pe(za,{key:0,searchQuery:V.value,sprintId:S.value,checkedSprintAll:$.value,sprint:Ee.value,onOpenTicket:je,onEditSprint:qt,onToggleStart:g(J),onMoveSelectedToBacklog:g(s),onDeleteSelectedSprint:n[14]||(n[14]=i=>g(v)("sprint",i)),onRefresh:Ue},null,8,["searchQuery","sprintId","checkedSprintAll","sprint","onToggleStart","onMoveSelectedToBacklog"])):U("",!0)],64))],2)],512)]))])),F(Ql,{onClick:n[15]||(n[15]=$e(()=>{},["stop"])),modelValue:Te.value,"onUpdate:modelValue":n[16]||(n[16]=i=>Te.value=i),title:"Delete Sprint",itemLabel:"Sprint",itemName:(j=te.value)==null?void 0:j.title,requireMatchText:(G=te.value)==null?void 0:G.title,confirmText:"Delete Sprint",cancelText:"Cancel",size:"md",loading:g(nt),onConfirm:Je,onCancel:n[17]||(n[17]=()=>{te.value=null,Te.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),F(Wa,{modelValue:Re.value,"onUpdate:modelValue":n[18]||(n[18]=i=>Re.value=i),onSave:jt,sprint:te.value,creatingSprint:te.value?g(yt):g(Ct)},null,8,["modelValue","sprint","creatingSprint"]),F(ns,{sprint:te.value,modelValue:be.value,"onUpdate:modelValue":n[19]||(n[19]=i=>be.value=i),onSave:ne,creatingSprint:g(Fe)||g(we)},null,8,["sprint","modelValue","creatingSprint"]),F(Wl,{modelValue:B.value,"onUpdate:modelValue":n[20]||(n[20]=i=>B.value=i),cardId:(he=bt.value)==null?void 0:he.id,onClose:ae},null,8,["modelValue","cardId"]),F(qs,{modelValue:a.value,"onUpdate:modelValue":n[21]||(n[21]=i=>a.value=i)},null,8,["modelValue"])])}}}),Mo=Ut(ho,[["__scopeId","data-v-64e81163"]]);export{Mo as default};
