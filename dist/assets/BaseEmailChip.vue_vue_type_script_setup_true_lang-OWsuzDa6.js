import{d as S,r as b,m as R,c as g,i,y,j as d,e as p,f as E,t as v,au as M,I as x,A as T,F as j,x as J,g as O,L as U,o}from"./index-ubn_zQ8L.js";const K=["title"],P={class:"relative"},Z={key:0,class:"mr-1 text-text-secondary -500"},_={class:"flex flex-wrap gap-2 w-full items-center flex-1"},q={key:0,class:"font-medium"},G={key:1,class:"opacity-70 w-[90%] overflow-ellipsis overflow-hidden"},H={key:2,class:"w-[90%] overflow-ellipsis overflow-hidden"},Q=["onClick","disabled"],W=["placeholder","disabled"],X={key:1,class:"ml-1 text-text-secondary"},ee=S({__name:"BaseEmailChip",props:{modelValue:{default:()=>[]},label:{},tooltip:{},message:{},error:{type:Boolean,default:!1},placeholder:{default:"Add people by email… (Enter, comma, space)"},size:{default:"md"},theme:{default:"light"},disabled:{type:Boolean,default:!1},allowDuplicates:{type:Boolean,default:!1},showName:{type:Boolean,default:!1},validator:{},maxEmails:{default:void 0}},emits:["update:modelValue","invalid","add","remove","limit"],setup(N,{emit:C}){const n=N,s=C,w=b(null),m=b(""),a=b([...n.modelValue]);R(()=>n.modelValue,e=>{JSON.stringify(e)!==JSON.stringify(a.value)&&(a.value=[...e])});const f=g(()=>n.maxEmails&&n.maxEmails>0?n.maxEmails:1/0),h=g(()=>Math.max(0,f.value-a.value.length)),c=g(()=>h.value===0);function D(){var e;!n.disabled&&!c.value&&((e=w.value)==null||e.focus())}const $=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i;function I(e){return(n.validator??(t=>$.test(t)))(e)}function k(e){return e.split(/[\s,;]+/).map(t=>t.trim().toLowerCase()).filter(Boolean)}function V(e){if(h.value===0){s("limit",isFinite(f.value)?Number(f.value):1/0);return}const t=[],l=[],r=n.allowDuplicates?null:new Set(a.value);for(const u of e){if(h.value-t.length<=0)break;if(!I(u)){l.push(u);continue}r&&r.has(u)||(r&&r.add(u),a.value.push(u),t.push(u))}t.length&&s("add",t),l.length&&s("invalid",l),t.length&&l.length===0&&s("invalid",[]),(t.length||l.length)&&s("update:modelValue",[...a.value]),h.value===0&&s("limit",isFinite(f.value)?Number(f.value):1/0)}function B(){!m.value||c.value||(V(k(m.value)),m.value="")}function z(e){var l;if(c.value){e.preventDefault(),s("limit",Number(f.value));return}const t=((l=e.clipboardData)==null?void 0:l.getData("text"))||"";t&&(e.preventDefault(),V(k(t)))}function A(e){if(!n.disabled){if(e.key==="Enter"||e.key==="Tab"||e.key===","||e.key===" "){e.preventDefault(),B();return}if(e.key==="Backspace"&&!m.value&&a.value.length){const t=a.value.pop();s("remove",t),s("update:modelValue",[...a.value])}}}function F(e){if(n.disabled)return;const[t]=a.value.splice(e,1);s("remove",t),s("update:modelValue",[...a.value])}function L(e){const l=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return l.length?l.map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):e}return(e,t)=>(o(),i("div",{class:y(e.theme==="dark"?"text-white":"text-text-primary")},[e.label?(o(),i("label",{key:0,class:y(["text-base font-medium mb-1 flex items-center",e.theme==="dark"?"text-white":"text-text-primary"])},[E(v(e.label)+" ",1),e.tooltip?(o(),i("span",{key:0,class:"inline-block text-text-secondary -400 ml-1 cursor-help",title:e.tooltip},t[1]||(t[1]=[p("img",{src:M,alt:"info"},null,-1)]),8,K)):d("",!0)],2)):d("",!0),p("div",P,[p("div",{class:y(["flex items-center gap-2 border rounded-xl px-3 py-2 w-full text-sm focus-within:ring-2",e.size==="md"?"min-h-10":"min-h-12",e.error?"border-red-500 focus-within:ring-red-500":"focus-within:ring-border",e.theme==="dark"?"bg-[#131318] border-border ":" border-border bg-bg-input",e.disabled?"opacity-60 cursor-not-allowed":""]),onClick:D},[e.$slots.prefix?(o(),i("span",Z,[x(e.$slots,"prefix")])):d("",!0),p("div",_,[(o(!0),i(j,null,J(a.value,(l,r)=>(o(),i("span",{key:l+r,class:"inline-flex items-center w-full gap-2 rounded-full px-2 py-1 text-xs bg-bg-body text-text-secondary"},[e.showName?(o(),i("span",q,v(L(l)),1)):d("",!0),e.showName?(o(),i("span",G,"<"+v(l)+">",1)):(o(),i("span",H,v(l),1)),p("button",{type:"button",class:"ml-1 rounded hover:bg-bg-surface px-1",title:"Remove",onClick:O(u=>F(r),["stop"]),disabled:e.disabled},"✕",8,Q)]))),128)),T(p("input",{ref_key:"inputRef",ref:w,"onUpdate:modelValue":t[0]||(t[0]=l=>m.value=l),placeholder:c.value?"":a.value.length===0?e.placeholder:"",class:"flex-1 min-w-[160px] bg-transparent outline-none text-sm placeholder:text-text-secondary text-text-primary",disabled:e.disabled||c.value,onKeydown:A,onBlur:B,onPaste:z},null,40,W),[[U,m.value]])]),e.$slots.suffix?(o(),i("span",X,[x(e.$slots,"suffix")])):d("",!0)],2)]),e.message?(o(),i("p",{key:1,class:y(["mt-2 text-xs flex items-center gap-1",e.error?"text-red-500":(e.theme==="dark","text-text-secondary ")])},[e.$slots.msgIcon?x(e.$slots,"msgIcon",{key:0}):d("",!0),E(" "+v(e.message),1)],2)):d("",!0)],2))}});export{ee as _};
