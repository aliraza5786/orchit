import{d as te,r as m,m as oe,c as E,N as ne,i as a,e as d,b as ae,y as f,t as v,h as re,$ as se,w as le,j as T,U as de,S as ie,g as ue,n as D,F as I,x as N,ap as ce,V as me,o as n,_ as pe}from"./index-QAH94Xm8.js";const fe=["disabled"],ve={key:0},he={key:1,class:"opacity-70"},be=["onKeydown"],ge={class:"flex items-center justify-between mb-2"},ye={class:"text-sm font-semibold"},we={class:"grid grid-cols-7 text-[11px] opacity-60 mb-1"},xe={class:"grid grid-cols-7 gap-1"},ke=["disabled","onClick"],De={key:1,class:"w-9 h-9"},_e={class:"flex items-center justify-between mt-3"},Me=te({__name:"DatePicker",props:{modelValue:{},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},minDate:{},maxDate:{},theme:{default:"light"},emitAs:{default:"ymd"},placeholder:{}},emits:["update:modelValue"],setup(z,{emit:A}){const u=z,_=A,g=m(null),M=m(null),p=m(!1),F=m({top:"0px",left:"0px",width:"0px"}),r=m(h(u.modelValue)),s=m(r.value?b(r.value):b(new Date)),j=w(new Date),O=new Intl.DateTimeFormat(void 0,{month:"long",year:"numeric"}),K=new Intl.DateTimeFormat(void 0,{weekday:"short"}),H=Array.from({length:7},(e,t)=>K.format(new Date(2021,7,t+1)).slice(0,2));oe(()=>u.modelValue,e=>{const t=h(e);r.value=t,t&&(s.value=b(t))});function P(){u.disabled||(p.value=!p.value,p.value?me(U):y())}function U(){var t;const e=(t=g.value)==null?void 0:t.querySelector("button");if(e){const o=e.getBoundingClientRect();F.value={top:`${o.bottom+window.scrollY}px`,left:`${o.left+window.scrollX}px`,width:"280px"}}document.addEventListener("pointerdown",C,!0),window.addEventListener("scroll",c,!0),window.addEventListener("resize",c,!0)}function y(){document.removeEventListener("pointerdown",C,!0),window.removeEventListener("scroll",c,!0),window.removeEventListener("resize",c,!0)}function C(e){var o,l;const t=e.target;!((o=g.value)!=null&&o.contains(t))&&!((l=M.value)!=null&&l.contains(t))&&c()}function c(){p.value=!1,y()}function q(){s.value=V(s.value,-1)}function R(){s.value=V(s.value,1)}const W=E(()=>{const t=b(s.value).getDay(),o=Q(s.value),l=[];for(let i=0;i<t;i++)l.push({date:null});const x=h(u.minDate),$=h(u.maxDate);for(let i=1;i<=o;i++){const k=new Date(s.value.getFullYear(),s.value.getMonth(),i),S=x&&k<w(x)||$&&k>w($),ee=S??!1;l.push({date:k,disabled:ee})}const L=l.length%7;if(L)for(let i=0;i<7-L;i++)l.push({date:null});return l});function X(e){r.value=e;let t;u.emitAs==="date"?t=e:u.emitAs==="iso"?t=e.toISOString():t=Z(e),_("update:modelValue",t)}function G(){r.value=null,_("update:modelValue",null)}const J=E(()=>r.value?new Intl.DateTimeFormat(void 0,{month:"short",day:"numeric",year:"numeric"}).format(r.value):"");function h(e){if(!e&&e!==0)return null;const t=e instanceof Date?e:new Date(e);return isNaN(t.getTime())?null:t}function w(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function b(e){const t=new Date(e.getFullYear(),e.getMonth(),1);return t.setHours(0,0,0,0),t}function Q(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}function V(e,t){return new Date(e.getFullYear(),e.getMonth()+t,1)}function B(e,t){return!!e&&!!t&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function Y(e){return e<10?`0${e}`:`${e}`}function Z(e){return`${e.getFullYear()}-${Y(e.getMonth()+1)}-${Y(e.getDate())}`}return ne(y),(e,t)=>(n(),a("div",{ref_key:"root",ref:g,class:"relative inline-block text-left"},[d("button",{type:"button",class:f(["inline-flex text-xs w-full items-center transition",[e.disabled?"opacity-60 cursor-not-allowed":"cursor-pointer",e.theme==="dark"?"text-text-secondary":"text-text-primary"]]),onClick:P,disabled:e.disabled},[r.value?(n(),a("span",ve,v(J.value),1)):(n(),a("span",he,v(e.placeholder),1))],10,fe),(n(),ae(ce,{to:"body"},[re(se,{name:"dp-scale"},{default:le(()=>[p.value?(n(),a("div",{key:0,ref_key:"popover",ref:M,class:f(["absolute z-50 mt-2 w-[280px] rounded-xl shadow-lg border p-3 select-none",(e.theme==="dark","bg-bg-dropdown border-border text-text-primary")]),style:ie(F.value),onKeydown:de(ue(c,["prevent","stop"]),["esc"])},[d("div",ge,[d("button",{class:"px-2 py-1 rounded hover:bg-bg-dropdown-menu-hover",onClick:q},"‹"),d("div",ye,v(D(O).format(s.value)),1),d("button",{class:"px-2 py-1 rounded hover:bg-bg-dropdown-menu-hover",onClick:R},"›")]),d("div",we,[(n(!0),a(I,null,N(D(H),o=>(n(),a("div",{key:o,class:"text-center py-1"},v(o),1))),128))]),d("div",xe,[(n(!0),a(I,null,N(W.value,(o,l)=>(n(),a("div",{key:l},[o.date?(n(),a("button",{key:0,class:f(["w-9 h-9 rounded-full text-sm flex items-center justify-center hover:bg-bg-dropdown-menu-hover transition",[B(o.date,D(j))?"ring-1 ring-gray-400":"",B(o.date,r.value)?(e.theme==="dark","bg-bg-card text-text-primary"):"",o.disabled?"opacity-40 cursor-not-allowed hover:bg-transparent":""]]),disabled:o.disabled,onClick:x=>X(o.date)},v(o.date.getDate()),11,ke)):(n(),a("div",De))]))),128))]),d("div",_e,[e.clearable&&r.value?(n(),a("button",{key:0,class:f(["text-xs px-2 py-1 rounded border hover:bg-bg-dropdown-hover",e.theme==="dark"?"border-border ":"border-border"]),onClick:G},"Clear",2)):T("",!0),t[0]||(t[0]=d("div",{class:"flex-1"},null,-1)),d("button",{class:f(["text-xs px-3 py-1 rounded border hover:bg-bg-dropdown-menu-hover dark:hover:bg-white/10",(e.theme==="dark","border-border")]),onClick:c},"Done",2)])],46,be)):T("",!0)]),_:1})]))],512))}}),Ce=pe(Me,[["__scopeId","data-v-52baf779"]]);export{Ce as D};
