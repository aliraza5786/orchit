import{d as X,r as u,c as z,q as j,al as q,m as G,i as s,y as a,j as w,e as r,A as x,f as y,t as k,av as J,g as c,F as H,x as N,V as Q,a9 as W,C as T,I as Y,af as C,o as i}from"./index-C0EDYk9O.js";const Z=["title"],ee={class:"flex flex-nowrap gap-1 h-full"},te=["onClick"],oe=["placeholder","onKeydown"],le=["onClick"],ne=["innerHTML"],D=160,re=8,I=!0,ae=X({__name:"BaseMultiSelect",props:{modelValue:{},options:{},label:{},tooltip:{},message:{},error:{type:Boolean},placeholder:{default:"Select..."},size:{default:"md"},theme:{default:"light"},allowCustom:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(U,{emit:A}){const l=U,b=A,g=u(null),V=u(null),L=u(null),M=u(null),d=u(""),n=u(!1),m=u(!1),R=z(()=>l.modelValue.map(e=>l.options.find(t=>t._id===e)||{title:String(e),_id:e})),f=z(()=>l.options.filter(e=>e.title.toLowerCase().includes(d.value.toLowerCase())&&!l.modelValue.includes(e._id)));function E(){n.value||(n.value=!0),C(()=>{var e;v(),(e=M.value)==null||e.focus()})}function P(){n.value=!0,C(v)}function B(e){b("update:modelValue",[...l.modelValue,e._id]),d.value="",n.value=!1}function $(e){b("update:modelValue",l.modelValue.filter(o=>o!==e))}function F(){if(!l.allowCustom||!d.value.trim())return;const e=d.value.trim();if(l.options.some(t=>t.title.toLowerCase()===e.toLowerCase())){const t=l.options.find(p=>p.title.toLowerCase()===e.toLowerCase());t&&B(t)}else{const t=e.toLowerCase().replace(/\s+/g,"-");b("update:modelValue",[...l.modelValue,t]),l.options.push({title:e,_id:t})}d.value="",n.value=!1}function S(e){g.value&&!g.value.contains(e.target)&&(n.value=!1)}function v(){var _;const e=V.value;if(!e)return;const o=e.getBoundingClientRect(),p=window.innerHeight-o.bottom,K=o.top,O=Math.min(((_=L.value)==null?void 0:_.scrollHeight)??D,D);p<O+re?m.value=K>p:m.value=!1}function h(){n.value&&v()}return j(()=>{document.addEventListener("click",S),window.addEventListener("resize",h),window.addEventListener("scroll",h,I)}),q(()=>{document.removeEventListener("click",S),window.removeEventListener("resize",h),window.removeEventListener("scroll",h,I)}),G([n,()=>f.value.length],()=>{n.value&&C(v)}),(e,o)=>(i(),s("div",{class:a([e.theme==="dark"?"text-white":"text-text-primary","relative"]),ref_key:"wrapperRef",ref:g},[e.label?(i(),s("label",{key:0,class:a(["text-base font-medium mb-1 flex items-center",e.theme==="dark"?"text-white":"text-text-primary"])},[y(k(e.label)+" ",1),e.tooltip?(i(),s("span",{key:0,class:"inline-block text-text-secondary ml-1 cursor-help",title:e.tooltip},o[2]||(o[2]=[r("img",{src:J,alt:"info"},null,-1)]),8,Z)):w("",!0)],2)):w("",!0),r("div",{ref_key:"anchorRef",ref:V,class:a(["relative px-3 py-2 rounded-xl overflow-x-auto w-full border text-sm",[e.size==="md"?"h-10":"h-12",e.theme==="dark"?"bg-bg-input border-border":"bg-bg-input border-border ",e.error?"border-red-500 focus-within:ring-red-500":"focus-within:ring-black"]]),onMousedown:c(E,["self"])},[r("div",ee,[(i(!0),s(H,null,N(R.value,t=>(i(),s("span",{key:t._id,class:"bg-bg-body text-text-primary px-2 text-nowrap py-1 rounded text-xs flex items-center gap-1"},[y(k(t.title)+" ",1),r("span",{onClick:c(p=>$(t._id),["stop"]),class:"cursor-pointer"},"âœ•",8,te)]))),128)),x(r("input",{ref_key:"inputRef",ref:M,class:a(["outline-none flex-1 bg-transparent text-sm h-full",e.theme=="dark"?"!text-white placeholder-white/60":"text-text-primary placeholder-gray-400"]),placeholder:R.value.length?"":e.placeholder,"onUpdate:modelValue":o[0]||(o[0]=t=>d.value=t),onFocus:E,onInput:P,onKeydown:W(c(F,["prevent"]),["enter"])},null,42,oe),[[Q,d.value]])])],34),x(r("ul",{ref_key:"menuRef",ref:L,class:a(["absolute left-0 z-10 text-sm p-2 border rounded-md shadow max-h-40 overflow-auto w-full",[e.theme==="dark"?"bg-[#131318] text-white border-border":"bg-bg-dropdown text-text-primary border-border",m.value?"bottom-[76%] ":"top-full "]])},[(i(!0),s(H,null,N(f.value,t=>(i(),s("li",{key:t._id,class:a(["px-3 py-2 rounded-lg cursor-pointer",e.theme==="dark"?"hover:bg-[#000000de]":"hover:bg-bg-dropdown-menu-hover"]),onMousedown:o[1]||(o[1]=c(()=>{},["prevent"])),onClick:c(p=>B(t),["stop"])},[r("span",{innerHTML:t.title},null,8,ne)],42,le))),128))],2),[[T,n.value&&f.value.length>0]]),x(r("ul",{class:a(["absolute left-0 z-10 p-2 border rounded shadow w-full",[e.theme==="dark"?"bg-bg-dropdown text-text-primary border-border":"bg-bg-dropdown border-border",m.value?"bottom-full mb-2":"top-full mt-2"]])},o[3]||(o[3]=[r("li",{class:"px-3 py-2 text-sm text-text-secondary"},"No options found",-1)]),2),[[T,n.value&&f.value.length===0]]),e.message?(i(),s("p",{key:1,class:a(["mt-2 text-xs flex items-center gap-1",e.error?"text-red-500":(e.theme==="dark","text-text-secondary ")])},[e.$slots.msgIcon?Y(e.$slots,"msgIcon",{key:0}):w("",!0),y(" "+k(e.message),1)],2)):w("",!0)],2))}});export{ae as _};
