const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dropdown-N0RXl4eD.js","assets/index-BCXm2D5k.js","assets/index-BkThUD6V.css","assets/index-CPHFkODT.js","assets/Dropdown-P9l2osTz.css","assets/SearchBar-COk_sj9I.js","assets/SearchBar.vue_vue_type_script_setup_true_lang-BwztNeYZ.js","assets/KanbanSkeleton-Br7Pgt93.js","assets/KanbanSkeleton-BjQaxKe3.css","assets/BaseTextField-B3lZpqmt.js","assets/KanbanTicket-CyapJi2U.js","assets/DropMenu.vue_vue_type_script_setup_true_lang-DNIJ9Rx_.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Ds0MNnWK.js","assets/KanbanTicket-DarASgyM.css","assets/TableView-Wj-SYh6e.js","assets/TableView.vue_vue_type_script_setup_true_lang-HS70wTSW.js","assets/TableSearchCell-DFTNYFH5.js","assets/TableAssigneeCell-i3Uzavg6.js","assets/CalendarView-C_bwIUD5.js","assets/CalendarView-ucztpRLd.css","assets/GanttChartView--7eVtUTI.js","assets/TimelineView-D-7HMiL9.js","assets/CreateTaskModal-DjCbXAOS.js","assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-CSTGtyFr.js","assets/CreateSheetModal-CIad4EMP.js","assets/IconPicker-C3fHrufW.js","assets/IconPicker-CIMr_3tu.css","assets/AudioRecorder.vue_vue_type_script_setup_true_lang-D7Qog1lO.js","assets/CreateSheetModal--7RYCgy-.css","assets/CreateVariableModal-DKJg2m0y.js","assets/ConfirmDeleteModal-C3g9FwrT.js","assets/SidePanel-CDqAEjAq.js","assets/SidePanel-CGmXvpKR.css","assets/KanbanBoard-D1wSZfqZ.js","assets/vuedraggable.umd-CSlpksUp.js","assets/_commonjsHelpers-_d1bhYXs.js","assets/KanbanBoard-Dffh696C.css"])))=>i.map(i=>d[i]);
import{d as ga,W as ya,r as u,M as xa,N as ka,c as V,a2 as ha,n as F,a0 as wa,a6 as Ca,u as Sa,as as Ta,a7 as Va,a8 as Ea,a9 as Da,a1 as La,ac as w,ad as Aa,Q as Ia,ae as b,ab as Na,a3 as Pa,aa as qa,V as Ma,af as Oa,ag as Ra,j as E,f as r,i as k,e as q,k as x,w as G,p as s,z as M,F as ze,D as Ue,E as nt,h as se,ai as it,ah as st,t as Be,P as za,q as Ua,aj as dt,ak as Ba,A as _,o as f,g as we,T as ut,U as ct,am as Wa,al as vt,J as Fa}from"./index-BCXm2D5k.js";import{F as pt}from"./fuse-Ch1WBRTM.js";import{l as $a}from"./lodash-CQYOKM_D.js";import{k as de}from"./MindElixir-Ch35iPok.js";import"./_commonjsHelpers-_d1bhYXs.js";const ja={class:"flex-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur rounded-[6px] shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] flex-grow h-full bg-bg-card border border-border overflow-x-auto flex-col flex scrollbar-visible"},Ka={class:"overflow-x-auto shrink-0 sticky top-0 z-20 bg-bg-card"},Ha={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1 min-w-max h-full"},Qa={class:"flex gap-3 items-center"},Ga={class:"flex items-center gap-3 bg-bg-surface/50 h-[32px] px-2 rounded-md"},Ya={class:"flex overflow-x-auto gap-3 p-4 scrollbar-visible h-full"},Ja={key:0,class:"mx-auto text-text-secondary/80 m-2 w-[90%] h-full justify-center flex items-center border border-dashed border-border"},Xa={key:0,class:"bg-bg-body rounded-lg p-4"},Za={class:"flex items-center mt-3 gap-3"},el=["disabled"],tl={class:"relative w-full h-full flex overflow-hidden"},al={key:0,class:"format-sidebar h-full py-4 px-4 w-[320px] border-l bg-bg-card overflow-x-hidden overflow-y-auto flex flex-col"},ll={class:"flex items-center justify-between pb-3 mb-4 border-b"},ol={class:"format-content space-y-6"},rl={class:"format-group mb-3"},nl={class:"flex items-center gap-2"},il=["value"],sl={class:"format-group mb-3"},dl={class:"flex items-center gap-2"},ul=["value"],cl={class:"grid grid-cols-1 gap-3"},vl=["value"],pl={class:"mt-6 pt-4"},fl=["disabled"],ml={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},bl={key:0,class:"fixed inset-0 bg-black/30 flex items-center justify-center"},_l={class:"bg-white p-6 rounded-xl w-80"},gl={class:"flex justify-end gap-2 mt-4"},yl=["disabled"],xl={class:"flex items-center mt-3 gap-3"},kl=ga({__name:"Product",setup(hl){const We=b(()=>_(()=>import("./Dropdown-N0RXl4eD.js"),__vite__mapDeps([0,1,2,3,4]))),ft=b(()=>_(()=>import("./SearchBar-COk_sj9I.js"),__vite__mapDeps([5,6,1,2]))),mt=b(()=>_(()=>import("./KanbanSkeleton-Br7Pgt93.js"),__vite__mapDeps([7,1,2,8]))),ue=b(()=>_(()=>import("./BaseTextField-B3lZpqmt.js"),__vite__mapDeps([9,1,2]))),Fe=b(()=>_(()=>import("./index-BCXm2D5k.js").then(t=>t.dp),__vite__mapDeps([1,2]))),bt=b(()=>_(()=>import("./KanbanTicket-CyapJi2U.js"),__vite__mapDeps([10,1,2,11,3,12,13]))),_t=b(()=>_(()=>import("./TableView-Wj-SYh6e.js"),__vite__mapDeps([14,15,1,2]))),gt=b(()=>_(()=>import("./index-BCXm2D5k.js").then(t=>t.dr),__vite__mapDeps([1,2]))),$e=b(()=>_(()=>import("./TableSearchCell-DFTNYFH5.js"),__vite__mapDeps([16,1,2]))),yt=b(()=>_(()=>import("./TableAssigneeCell-i3Uzavg6.js"),__vite__mapDeps([17,1,2]))),xt=b(()=>_(()=>import("./CalendarView-C_bwIUD5.js"),__vite__mapDeps([18,1,2,19]))),kt=b(()=>_(()=>import("./GanttChartView--7eVtUTI.js"),__vite__mapDeps([20,1,2]))),ht=b(()=>_(()=>import("./TimelineView-D-7HMiL9.js"),__vite__mapDeps([21,1,2]))),{canEditSheet:wt,canDeleteSheet:Ct,canCreateVariable:ce,canCreateSheet:St,canCreateCard:Tt,canEditCard:ve,canAssignCard:Vt}=ya(),Y=u(!1),pe=u(null),fe=u(!1),me=u(null),Ce=u(!1),v=u("kanban"),J=u(null),$=u(null),X=u(!1),je=Ua(),{workspaceId:C,moduleId:I}=xa(),O=ka(),be=u(!1),Z=u(),R=u(null),j=u(!1),_e=u(!1),z=u(""),Se=u(null);function Et(t){z.value="",_e.value=!0,Se.value=t}function Dt(){Se.value&&Se.value(z.value),_e.value=!1}function Lt(){_e.value=!1}const Te=u(null),At=t=>{Te.value=t},It=V(()=>{var t;return(t=N.value)==null?void 0:t.find(e=>e._id===h.value)}),Ke=u(!1),He=u(!1);F(Ke,t=>{t&&(He.value=!1)}),F(He,t=>{t&&(Ke.value=!1)});const Qe=async()=>{if(me.value)try{Ce.value=!0,await ut({url:`workspace/card/${me.value}`,method:"DELETE"}),Pt(me.value),fe.value=!1,pe.value=null,ct.success("Ticket deleted successfully"),await ee(),await xe()}catch(t){ct.error(Wa(t))}finally{Ce.value=!1}},Nt=async()=>{await Qe()},Pt=t=>{var e,a;(a=(e=g.value)==null?void 0:e.sheets)==null||a.forEach(l=>{var o;(o=l.sheet_lists)==null||o.forEach(c=>{c.cards=c.cards.filter(p=>p._id!==t)})})},qt=b(()=>_(()=>import("./CreateTaskModal-DjCbXAOS.js"),__vite__mapDeps([22,23,1,2]))),Mt=b(()=>_(()=>import("./CreateSheetModal-CIad4EMP.js"),__vite__mapDeps([24,1,2,25,26,27,28]))),Ot=b(()=>_(()=>import("./CreateVariableModal-DKJg2m0y.js"),__vite__mapDeps([29,1,2]))),Ve=b(()=>_(()=>import("./ConfirmDeleteModal-C3g9FwrT.js"),__vite__mapDeps([30,12,1,2]))),Rt=b(()=>_(()=>import("./SidePanel-CDqAEjAq.js"),__vite__mapDeps([31,1,2,32]))),zt=b(()=>_(()=>import("./KanbanBoard-D1wSZfqZ.js"),__vite__mapDeps([33,34,35,1,2,11,3,36]))),{data:ge,refetch:ee,isPending:Ge}=wa({workspace_id:C,workspace_module_id:I}),Ee=V(()=>{var t;return ge.value?(t=ge.value[0])==null?void 0:t._id:""}),S=u(Ee.value),{data:N,isPending:Ut}=ha(C,I,S),{mutate:De,isPending:Le}=Ca({onSuccess:()=>{O.invalidateQueries({queryKey:["sheet-list"]}),K.value="",H.value=!1,ae.value=!1,H.value=!1}}),Ye=V(()=>{var t;return((t=It.value)==null?void 0:t.title)==="Process"&&Te.value?{variable_slug:"card-type",type_value:Te.value.title}:{}}),Je=t=>{const e={workspace_id:C.value,module_id:I.value,variable_id:h.value,value:t,...Ye.value};De(e)};F(Ee,()=>{S.value=Ee.value});const Ae=V(()=>{var t;return N!=null&&N.value?(t=N==null?void 0:N.value[0])==null?void 0:t._id:""}),h=u(Ae.value);F(Ae,()=>{h.value=Ae.value});const ye=Sa(),{data:g,isPending:Ie,refetch:xe}=Ta(I,S,V(()=>[...ye.selectedLaneIds]),h,Ye),P=t=>{t._id||(t._id=t.id),Z.value=t};window.selectCardHandler=P;const te=u(!1),Bt=()=>{B.value={},te.value=!te.value},Wt=Va(),Ft=Ea();function $t(t){t.type==="column"?Wt.mutate({payload:{workspace_id:C.value,workspace_module_id:I.value,variable_id:h.value,moved_value:t.meta.id,new_index:t.meta.newIndex}},{onSuccess:()=>{ee(),xe()}}):Ft.mutate({payload:{workspace_id:C.value,card_id:t.meta.moved._id,group_value:t.meta.fromColumnId,group_variable_id:h.value,new_index:t.meta.newIndex,sheet_id:S.value}},{onSuccess:()=>{ee(),xe()}})}const jt=t=>{},Kt=V(()=>(ge.value||[]).map(t=>({_id:t._id,title:t==null?void 0:t.variables["sheet-title"],description:t==null?void 0:t.variables["sheet-description"],icon:t.icon,status:t==null?void 0:t.generation_status})));F(ge,t=>{var e;(t==null?void 0:t.length)>0&&(S.value=(e=t[0])==null?void 0:e._id)});const ae=u(!1),K=u("");function Ne(){ae.value=!ae.value}function ke(){const t=K.value.trim();t&&Je(t)}const Ht=t=>{De({workspace_id:je.params.id,module_id:je.params.module_id,new_value:t.title,value:t.oldTitle,variable_id:h.value})},H=u(!1),U=u(),Qt=()=>{De({value:U.value.title,workspace_id:C.value,module_id:I.value,newValue:U.value.title,variable_id:h.value,is_trash:!0})},Gt=t=>{H.value=!0,U.value=t},Yt=t=>{be.value=!0,U.value=t},B=u();function Jt(t){Y.value=!0,B.value=t}const{mutate:Xe,isPending:Xt}=Da({onSuccess:()=>{ee(),Y.value=!1}});function Zt(){var t;Xe({sheet_id:(t=B.value)==null?void 0:t._id,workspace_module_id:I.value,is_trash:!0})}function ea(t){te.value=!0,B.value=t}const le=u(""),ta=u("");F(le,$a.debounce(t=>{ta.value=t},200));const aa=V(()=>{const t=g.value.flatMap(e=>e.cards.map(a=>({...a,columnId:e.title})));return new pt(t,{keys:["card-title","card-description"],threshold:.3})}),oe=V(()=>{var t;if(v.value==="kanban"){if(!le.value)return g.value;const e=aa.value.search(le.value).map(a=>a.item);return g.value.map(a=>({...a,cards:e.filter(l=>l.columnId===a.title)}))}else{const e=(t=le.value)==null?void 0:t.trim();if(!e){let l=[];return(g.value??[]).forEach(o=>{l=[...l,...o==null?void 0:o.cards]}),l}return new pt(ra.value,{keys:["card-title","card-description"],threshold:.3}).search(e).map(l=>l.item)}}),{data:Pe}=La(C),Ze=V(()=>((Pe==null?void 0:Pe.value)??[]).map(t=>{var e;return{_id:t._id,title:((e=t==null?void 0:t.variables)==null?void 0:e["lane-title"])??String(t._id)}})),la=V(()=>{var t;return[{key:"card-title",label:"Title",render:({row:e,value:a})=>w("div",{class:"flex items-center gap-1 w-full"},[w("a",{onClick:()=>Z.value=e,class:"text-[12px] underline text-blue-500 shrink-0 overflow-ellipsis cursor-pointer"},e["card-code"]),w("div",{class:"flex-1 min-w-0"},[w("input",{onFocusout:l=>{var o;tt(e==null?void 0:e._id,"card-title",(o=l==null?void 0:l.target)==null?void 0:o.value)},class:"text-[12px] w-full overflow-ellipsis capitalize p-1 w-full p-1 focus:border border-accent/60 rounded-sm focus:outline-none focus:ring-1 focus:ring-accent bg-transparent focus:bg-bg-body text-[12px] h-8",defaultValue:a,disabled:!ve.value})])])},{key:"end-date",label:"Due Date",render:({row:e,value:a})=>{const l=u(a);return w(gt,{class:" capitalize flex items-center gap-2 text-[12px]",placeholder:"Set start date",tableInputClass:!0,modelValue:l.value,disabled:!ve.value,"onUpdate:modelValue":o=>sa(e==null?void 0:e._id,o),emptyText:"Date"})}},{key:"lane",label:"Lane",render:({row:e})=>{var a;return w($e,{options:Ze.value??[],placeholder:"Select lane",modelValue:((a=e.lane)==null?void 0:a._id)||null,disabled:!ve.value,"onUpdate:modelValue":l=>da(e==null?void 0:e._id,l),displayField:"title",emptyText:"Lane"})}},{key:"created_by",label:"Owner",render:({value:e})=>w("div",{class:"capitalize flex items-center gap-2  px-3"},[w("div",{class:" rounded-full  "},[e!=null&&e.u_profile_image?w("img",{class:"w-6 h-6 rounded-full",src:e==null?void 0:e.u_profile_image}):w("div",{class:"w-5 h-5 rounded-full flex justify-center items-center text-[11px] ",style:`background:${e!=null&&e.u_full_name?Aa({name:e.u_full_name,email:e.u_email}):""}`},Ia(e==null?void 0:e.u_full_name))]),w("span",{class:"text-[12px]"},e?e==null?void 0:e.u_full_name:"")])},{key:"seat",label:"Assignee",render:({row:e,value:a})=>w(yt,{class:"capitalize flex items-center gap-2 ",onAssign:l=>oa(e==null?void 0:e._id,l),assigneeId:a,seat:a,name:!0,disabled:!Vt.value,emptyText:"Assignee"})},...((t=N.value)==null?void 0:t.filter(e=>{var a;return((a=e==null?void 0:e.type)==null?void 0:a.title)==="Select"}).map(e=>({key:e==null?void 0:e.slug,label:e==null?void 0:e.slug,render:({row:a,value:l})=>{var c;let o=l;if(Array.isArray(a==null?void 0:a.variables)){const p=a.variables.find(A=>A.slug===e.slug);p&&(o=p.value)}else o=((c=a==null?void 0:a.variables)==null?void 0:c[e.slug])??(a==null?void 0:a[e.slug])??l;return w("div",{class:"capitalize flex items-center gap-2"},[w($e,{options:na(e.data??[]),modelValue:o,disabled:!ve.value,emptyText:e.slug,"onUpdate:modelValue":p=>{tt(a==null?void 0:a._id,e.slug,p)},columnName:e.slug})])},visible:e==null?void 0:e.is_visible})))??[]]}),oa=(t,e)=>{qe(t,a=>{a.seat=e}),re.mutate({card_id:t,seat_id:e==null?void 0:e._id})},ra=V(()=>{let t=[];return(g.value??[]).forEach(e=>{t=[...t,...e==null?void 0:e.cards]}),t}),na=t=>t.map(e=>({_id:e.value??e,title:e.value??e})),re=Na({onSuccess:()=>{O.invalidateQueries({queryKey:["get-sheets"]}),O.invalidateQueries({queryKey:["sheet-list"]}),O.invalidateQueries({queryKey:["roles"]})}}),qe=(t,e)=>{if(!g.value)return;const a=g.value.findIndex(l=>l.cards.some(o=>o._id===t));if(a!==-1){const l=g.value[a].cards.findIndex(o=>o._id===t);if(l!==-1){const o={...g.value[a].cards[l]};e(o),g.value[a].cards[l]=o,dt(g)}}},{mutate:et}=Pa({onSuccess:()=>{O.invalidateQueries({queryKey:["sheet-list"]})}});function tt(t,e,a){qe(t,l=>{if(e==="card-title"&&(l[e]=a),Array.isArray(l.variables)){const o=l.variables.find(c=>c.slug===e);o?o.value=a:l.variables.push({slug:e,value:a,type:"Select"})}else l.variables&&typeof l.variables=="object"?l.variables[e]=a:l[e]=a}),re.mutate({card_id:t,variables:{[e]:a.trim()}})}function ia(t){if(t["card-title"]){const e={sheet_list_id:"To Do",workspace_id:C.value,sheet_id:S.value,variables:{"card-title":t["card-title"].trim()},createdAt:new Date().toISOString()};et(e)}}const sa=(t,e)=>{const a=g.value.findIndex(l=>l.cards.some(o=>o._id===t));if(a!==-1){const l=g.value[a].cards.findIndex(o=>o._id===t);l!==-1&&(g.value[a].cards[l]["end-date"]=e)}re.mutate({card_id:t,variables:{"start-date":e}})};function da(t,e){qe(t,a=>{const l=Ze.value.find(o=>o._id===e);l&&(a.lane=l)}),dt(g),re.mutate({card_id:t,workspace_lane_id:e})}const{mutate:ua}=qa(),ca=(t,e)=>{ua({payload:{sheet_id:S.value,workspace_id:C.value,variable_slug:t,is_visible:e}})},W=V(()=>{var t,e;return(e=(t=R.value)==null?void 0:t.nodeObj)!=null&&e.style?R.value.nodeObj.style:Re(D)});function L(t,e,a){return t!==void 0?t:e!==void 0?e:a}function Me(t,e){var p;if(!((p=R.value)!=null&&p.nodeObj))return;const a=R.value.nodeObj;a.style||(a.style={});const l=e.target,o=l.type==="number"?Number(l.value):l.value;switch(t){case"bg_color":a.style.background=o;break;case"color":a.style.color=o;break;case"font_size":a.style.fontSize=`${o}px`;break;case"font_weight":a.style.fontWeight=o;break;case"font_style":a.style.fontStyle=o;break;case"font_family":a.style.fontFamily=o;break;case"border_color":a.style.borderColor=o;break;case"border_width":a.style.borderWidth=`${o}px`;break;case"border_radius":a.style.borderRadius=`${o}px`;break;case"padding":a.style.padding=`${o}px`;break}const c=document.getElementById(a.id);c&&ot(a,c)}const D={bg_color:"#ffffff",color:"#000000",font_size:14,font_weight:"normal",font_style:"normal",font_family:"Inter",border_color:"#cccccc",border_width:0,border_radius:0,padding:0},Q=u(!1);async function at(){var e;const t=(e=R.value)==null?void 0:e.nodeObj;if(!(!t||Q.value)){Q.value=!0;try{const a=Ba(t);a._originalStyle||(a._originalStyle={});const l=a.style||{},o=a._originalStyle,c={bg_color:L(l.background,o.bg_color,D.bg_color),color:L(l.color,o.color,D.color),font_size:L(l.fontSize?parseInt(l.fontSize):void 0,o.font_size,D.font_size),font_weight:L(l.fontWeight,o.font_weight,D.font_weight),font_style:L(l.fontStyle,o.font_style,D.font_style),font_family:L(l.fontFamily,o.font_family,D.font_family),border_color:L(l.borderColor,o.border_color,D.border_color),border_width:L(l.borderWidth?parseInt(l.borderWidth):void 0,o.border_width,D.border_width),border_radius:L(l.borderRadius?parseInt(l.borderRadius):void 0,o.border_radius,D.border_radius),padding:L(l.padding?parseInt(l.padding):void 0,o.padding,D.padding),hyperLink:z.value||a.hyperLink||""};a._originalStyle={...c};const p=a.unique_name==="sheet"?{sheet_id:a.id,workspace_id:C.value,workspace_module_id:I.value,style:c}:{card_id:a.id,seat_id:a.seat_id,style:c};a.unique_name==="sheet"?await Xe(p):await re.mutateAsync(p)}finally{Q.value=!1}}}const va=u([]),{isDark:Oe}=Ma();function pa(t){const e={id:"root",topic:localStorage.getItem("currentName")??"",isRoot:!0,children:[],style:{},_originalStyle:{},unique_name:"root"};if(!Array.isArray(t))return e;const a={};return t.forEach(l=>{var A,d;const o=((A=l.variables)==null?void 0:A["sheet-title"])||"Untitled",c=((d=l.style)==null?void 0:d.hyperLink)||"";a[o]||(a[o]={id:l._id,topic:o,variables:l==null?void 0:l.variables,children:[],style:l==null?void 0:l.style,_originalStyle:(l==null?void 0:l.style)||{},unique_name:"sheet",hyperLink:c||""},e.children.push(a[o]));const p={id:l==null?void 0:l._id,topic:l.title,children:[],style:Re(l==null?void 0:l.style),_originalStyle:l.style||{},unique_name:"List",hyperLink:c||""};(l.cards||[]).forEach((n,T)=>{var y;const i=((y=n.style)==null?void 0:y.hyperLink)||"",m={id:n._id||`card-${T}`,seat_id:n.seat_id,topic:n["card-title"],style:Re(n.style),_originalStyle:n.style||{},children:[],unique_name:"card",hyperLink:i||""};p.children.push(m),va.value=m}),a[o].children.push(p)}),e}const{mutateAsync:fa}=Oa({onSuccess:()=>{O.invalidateQueries({queryKey:["sheets"]}),O.invalidateQueries({queryKey:["sheet-list"]}),close()}}),ma=async t=>{try{await ut({url:"workspace/cards/group-card-order",method:"PATCH",data:t}),ee(),xe(),console.log("Card reordered successfully")}catch(e){console.error("Failed to reorder card:",e)}};function lt(){var a;const t=(a=J.value)==null?void 0:a.querySelector(".mind-elixir-toolbar.rb");if(!t||t.querySelector(".open-sidebar-btn"))return;const e=document.createElement("button");e.className="open-sidebar-btn me-toolbar-btn ms-2",e.title="Open Formatting Sidebar",e.innerHTML='<i class="fa-solid fa-sidebar"></i>',e.addEventListener("click",()=>{j.value=!j.value}),t.appendChild(e)}let ne=null;function ba(){var e,a;ne&&(ne.disconnect(),ne=null);const t=(a=(e=J.value)==null?void 0:e.querySelector(".mind-elixir-toolbar.rb"))==null?void 0:a.parentElement;t&&(ne=new MutationObserver(()=>{lt()}),ne.observe(t,{childList:!0,subtree:!0}),lt())}Ra(()=>{v.value!=="mindmap"||!J.value||!g.value||vt(()=>{var p,A;const t=pa(g.value);$.value&&((A=(p=$.value).destroy)==null||A.call(p),$.value=null);const e=new Set,a=new Set,l=new Set,o=new de({el:J.value,theme:Oe.value?de.DARK_THEME:de.THEME,draggable:!0,contextMenu:!0,toolBar:!0,keypress:!0,locale:"en",overflowHidden:!1,contextMenuOption:{Update:!0,extend:[{name:"Update Node",onclick:()=>{var n;j.value&&(j.value=!1);const d=(n=R.value)==null?void 0:n.nodeObj;d&&P(d)}},{name:"Add Hyperlink",onclick:()=>{Et(async()=>{await at()})}}]}});$.value=o,o.init({nodeData:t}),setTimeout(()=>{o.toCenter()},100),vt(()=>{ba()}),o.bus.addListener("selectNode",d=>{d&&(R.value={nodeObj:d})}),o.bus.addListener("renderNode",d=>{!(d!=null&&d.nodeObj)||!(d!=null&&d.element)||ot(d.nodeObj,d.element)});const c=d=>{let n=d;for(;n;){if(n.unique_name==="sheet")return n;n=n.parent}return null};o.bus.addListener("operation",async d=>{if(d){if(d.name==="moveNode"||d.name==="moveNodeBefore"||d.name==="moveNodeAfter"){const n=d.obj,T=d.target;if(!n||n.unique_name!=="card"||!T)return;const i=n._originalParent||n.parent;if(!i||i.unique_name!=="List")return;const m=T.unique_name==="List"?T:T.parent;if(!m||m.unique_name!=="List")return;const y=c(m);if(!y)return;const ie=m.children.findIndex(he=>he.id===n.id);if(ie===-1)return;n._originalParent=m,await ma({workspace_id:C.value,card_id:n.id,group_value:m.topic,group_variable_id:h.value,new_index:ie,sheet_id:y.id});return}if(d.name==="removeNode"){const n=d.obj;if(!n||!n.id||n.unique_name!=="card")return;me.value=n.id,await Qe();return}if(d.name==="addChild"||d.name==="insertSibling"){const n=d.obj;if(!n||!n.id)return;e.add(n.id);return}if(d.name==="beginEdit"){const n=d.obj;console.log("editing node",n);return}if(d.name==="finishEdit"){const n=d.obj;if(!n||!n.id)return;const T=e.has(n.id),i=a.has(n.id);if(!T&&!i||i)return;if(T){e.delete(n.id),a.add(n.id);const m=n.parent;if(!m||!("unique_name"in m)){a.delete(n.id);return}if(m.unique_name==="root"&&!l.has(n.id)){l.add(n.id);try{await fa({variables:{"sheet-title":n.topic??"New Sheet","sheet-description":"This is custom description"},is_ai_generated:!1,workspace_id:C.value,workspace_module_id:I.value})}catch(y){console.error("Error creating workspace sheet:",y),a.delete(n.id),l.delete(n.id)}return}if(m.unique_name==="List"){try{const y=_a({topic:n.topic??"New Card",id:n.id},m);y.variables&&(y.variables["card-description"]="This is a default description"),await et(y)}catch(y){console.error("Error creating card:",y),a.delete(n.id)}return}if(m.unique_name==="sheet"){try{console.log("Creating new list under sheet...")}catch(y){console.error("Error creating list:",y),a.delete(n.id)}return}}}}})})}),F(Oe,()=>{$.value&&$.value.changeTheme(Oe.value?de.DARK_THEME:de.THEME)},{immediate:!0});function ot(t,e){if(!t||!e||!t.style)return;const a=e.querySelector(".topic"),l=e.querySelector(".node")??e,o=t.style;o.background&&(l.style.background=o.background),o.color&&a&&(a.style.color=o.color),a&&(o.fontSize&&(a.style.fontSize=o.fontSize),o.fontFamily&&(a.style.fontFamily=o.fontFamily),o.fontWeight&&(a.style.fontWeight=o.fontWeight),o.fontStyle&&(a.style.fontStyle=o.fontStyle)),o.borderColor&&(l.style.borderColor=o.borderColor),o.borderWidth&&(l.style.borderWidth=o.borderWidth),o.borderRadius&&(l.style.borderRadius=o.borderRadius),o.padding&&(l.style.padding=o.padding)}function Re(t={}){return{background:t.bg_color,color:t.color,fontSize:t.font_size!=null?`${t.font_size}px`:void 0,fontWeight:t.font_weight,fontStyle:t.font_style,fontFamily:t.font_family,borderColor:t.border_color,borderWidth:t.border_width!=null?`${t.border_width}px`:void 0,borderRadius:t.border_radius!=null?`${t.border_radius}px`:void 0,padding:t.padding!=null?`${t.padding}px`:void 0,hyperLink:t.hyperLink||void 0}}function _a(t,e){const a=new Date,l=a.toISOString().split("T")[0],o=new Date(a.getTime()+3*24*60*60*1e3).toISOString().split("T")[0];return{sheet_list_id:(e==null?void 0:e.topic)||"In Progress",workspace_id:C.value,sheet_id:S.value,workspace_lane_id:(t==null?void 0:t.workspace_lane_id)||null,variables:{"card-status":(e==null?void 0:e.topic)||"In Progress","card-type":"General",priority:"medium",process:null,"card-title":t.topic||"New Card","card-description":"","start-date":l,"end-date":o},createdAt:new Date().toISOString()}}return(t,e)=>{var a,l,o,c,p,A,d,n,T;return f(),E(ze,null,[r("div",ja,[r("div",Ka,[r("div",Ha,[k(s(We),{onEditOption:ea,modelValue:S.value,"onUpdate:modelValue":e[1]||(e[1]=i=>S.value=i),canEdit:s(wt),canDelete:s(Ct),onDeleteOption:Jt,options:Kt.value,variant:"secondary",customClasses:"fixed w-auto"},{more:G(()=>[s(St)?(f(),E("div",{key:0,onClick:e[0]||(e[0]=i=>Bt()),class:"capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},e[36]||(e[36]=[r("i",{class:"fa-solid fa-plus"},null,-1),we(" Add new ")]))):x("",!0)]),_:1},8,["modelValue","canEdit","canDelete","options"]),r("div",Qa,[(v.value=="kanban",f(),q(s(We),{key:0,actions:!1,modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=i=>h.value=i),options:s(N),variant:"secondary",customClasses:"fixed w-auto",onNestedSelect:At},{more:G(()=>[s(ce)?(f(),E("div",{key:0,onClick:e[2]||(e[2]=()=>{X.value=!0}),class:"sticky bottom-0 bg-bg-dropdown shadow-md shadow-border capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},e[37]||(e[37]=[r("i",{class:"fa-solid fa-plus"},null,-1),we(" Add new ")]))):x("",!0)]),_:1},8,["modelValue","options"])),k(s(ft),{onOnChange:e[4]||(e[4]=i=>{le.value=i}),placeholder:"Search in Orchit AI space"}),r("div",Ga,[r("button",{class:M(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",v.value==="kanban"?"text-accent bg-accent-text":" hover:bg-border/50 backdrop-blur-2xl  transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"List view",onClick:e[5]||(e[5]=i=>v.value="kanban")},e[38]||(e[38]=[r("i",{class:"fa-solid fa-chart-kanban"},null,-1)]),2),r("button",{onClick:e[6]||(e[6]=i=>v.value="table"),class:M(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",v.value==="table"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gallery view"},e[39]||(e[39]=[r("i",{class:"fa-solid fa-align-left"},null,-1)]),2),r("button",{onClick:e[7]||(e[7]=i=>v.value="mindmap"),class:M(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",v.value==="mindmap"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"MindMap view"},e[40]||(e[40]=[r("i",{class:"fa-solid fa-chart-diagram"},null,-1)]),2),r("button",{onClick:e[8]||(e[8]=i=>v.value="calendar"),class:M(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",v.value==="calendar"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Calendar view"},e[41]||(e[41]=[r("i",{class:"fa-regular fa-calendar"},null,-1)]),2),r("button",{onClick:e[9]||(e[9]=i=>v.value="gantt"),class:M(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",v.value==="gantt"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gantt Chart view"},e[42]||(e[42]=[r("i",{class:"fa-solid fa-chart-gantt"},null,-1)]),2),r("button",{onClick:e[10]||(e[10]=i=>v.value="timeline"),class:M(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",v.value==="timeline"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Timeline view"},e[43]||(e[43]=[r("i",{class:"fa-solid fa-timeline"},null,-1)]),2)])])])]),v.value=="kanban"?(f(),E(ze,{key:0},[Ue(k(s(mt),null,null,512),[[nt,s(Ie)||s(Ge)]]),Ue(r("div",Ya,[k(s(zt),{onOnPlus:Yt,board:oe.value,"onDelete:column":e[11]||(e[11]=i=>Gt(i)),"onUpdate:column":e[12]||(e[12]=i=>Ht(i)),onReorder:$t,onAddColumn:Je,"onSelect:ticket":P,onOnBoardUpdate:jt,variable_id:h.value,sheet_id:S.value},{"column-footer":G(i=>{var m,y,ie,he,rt;return[(y=(m=s(ye))==null?void 0:m.transitions)!=null&&y.all_allowed&&!((rt=(he=(ie=s(ye))==null?void 0:ie.transitions)==null?void 0:he.all_allowed)!=null&&rt.includes(i.column.title))&&s(ye).transitions.currentColumn!=i.column.title?(f(),E("div",Ja," Disbale ( you can't drop here ) ")):x("",!0)]}),ticket:G(({ticket:i})=>[k(s(bt),{selectedVar:h.value,onSelect:()=>{P(i)},ticket:i},null,8,["selectedVar","onSelect","ticket"])]),_:1},8,["board","variable_id","sheet_id"]),r("div",{class:"min-w-[270px] sm:min-w-[328px]",onClick:e[14]||(e[14]=se(()=>{},["stop"]))},[ae.value?(f(),E("div",Xa,[k(s(ue),{autofocus:!0,modelValue:K.value,"onUpdate:modelValue":e[13]||(e[13]=i=>K.value=i),placeholder:"Add New list",onKeyup:it(ke,["enter"])},null,8,["modelValue"]),e[44]||(e[44]=r("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),r("div",Za,[k(s(Fe),{onClick:ke,varaint:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:G(()=>[we(Be(s(Le)?"Adding...":"Add list"),1)]),_:1}),r("i",{class:"fa-solid fa-close",onClick:Ne})])])):(f(),E("button",{key:1,disabled:!s(ce),class:M(["text-sm text-text-primary py-2.5 font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",s(ce)?"cursor-pointer":"cursor-not-allowed"]),onClick:se(Ne,["stop"])}," + Add List ",10,el))])],512),[[nt,!s(Ie)&&!s(Ge)]])],64)):x("",!0),v.value=="table"?(f(),q(s(_t),{key:1,onToggleVisibility:ca,onAddVar:e[15]||(e[15]=()=>{X.value=!0}),isPending:s(Ie)||s(Ut),columns:la.value,rows:oe.value,canCreate:s(Tt),canCreateVariable:s(ce),onCreate:ia},null,8,["isPending","columns","rows","canCreate","canCreateVariable"])):x("",!0),v.value==="mindmap"?(f(),E(ze,{key:2},[r("div",tl,[r("div",{ref_key:"mindMapRef",ref:J,class:"flex-1 h-full overflow-hidden rounded-md relative"},null,512),j.value?(f(),E("div",al,[r("div",ll,[e[46]||(e[46]=r("h3",{class:"text-sm font-semibold text-secondary"},"Format Node",-1)),r("button",{onClick:e[16]||(e[16]=i=>j.value=!1),class:"text-gray-400 hover:text-gray-700"},e[45]||(e[45]=[r("i",{class:"fa-solid fa-times"},null,-1)]))]),r("div",ol,[r("div",null,[e[49]||(e[49]=r("h4",{class:"text-xs font-semibold text-secondary uppercase mb-3"}," Colors ",-1)),r("div",rl,[e[47]||(e[47]=r("label",{class:"block text-xs text-secondary mb-1"},"Background",-1)),r("div",nl,[r("div",{class:"h-10 w-10 rounded-md border cursor-pointer relative",style:st({backgroundColor:W.value.background})},[r("input",{type:"color",value:W.value.background,class:"absolute inset-0 opacity-0 cursor-pointer",onInput:e[17]||(e[17]=i=>Me("bg_color",i)),style:{"pointer-events":"all"}},null,40,il)],4),k(s(ue),{modelValue:W.value.background,placeholder:"#3b82f6",class:"flex-1",readonly:""},null,8,["modelValue"])])]),r("div",sl,[e[48]||(e[48]=r("label",{class:"block text-xs text-secondary mb-1"},"Text",-1)),r("div",dl,[r("div",{class:"h-10 w-10 rounded-md border cursor-pointer relative",style:st({backgroundColor:W.value.color})},[r("input",{type:"color",value:W.value.color,class:"absolute inset-0 opacity-0 cursor-pointer",onInput:e[18]||(e[18]=i=>Me("color",i)),style:{"pointer-events":"all"}},null,40,ul)],4),k(s(ue),{modelValue:W.value.color,placeholder:"#3b82f6",class:"flex-1",readonly:""},null,8,["modelValue"])])])]),r("div",null,[r("div",cl,[r("div",null,[e[51]||(e[51]=r("label",{class:"block text-xs text-secondary mb-1"},"Weight",-1)),r("select",{class:"w-full h-8 border rounded px-2 text-sm",value:W.value.fontWeight,onChange:e[19]||(e[19]=i=>Me("font_weight",i))},e[50]||(e[50]=[r("option",{value:"lighter"},"Light",-1),r("option",{value:"normal"},"Normal",-1),r("option",{value:"bold"},"Bold",-1),r("option",{value:"bolder"},"Extra Bold",-1)]),40,vl)])])])]),r("div",pl,[r("button",{class:"w-full cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm font-medium hover:shadow-md disabled:opacity-60",disabled:Q.value,onClick:at},[Q.value?(f(),E("span",ml)):x("",!0),r("span",null,Be(Q.value?"Updating...":"Update"),1)],8,fl)])])):x("",!0)]),_e.value?(f(),E("div",bl,[r("div",_l,[e[52]||(e[52]=r("h3",{class:"text-lg font-semibold mb-4"},"Insert Web Link",-1)),Ue(r("input",{"onUpdate:modelValue":e[20]||(e[20]=i=>z.value=i),type:"text",placeholder:"Enter or paste a URL",class:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[za,z.value]]),r("div",gl,[r("button",{onClick:Lt,class:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300"}," Cancel "),r("button",{disabled:!z.value,onClick:Dt,class:M(["px-4 py-2 rounded-md text-white",z.value?"bg-blue-500 hover:bg-blue-600":"bg-blue-300 cursor-not-allowed"])}," Insert ",10,yl)])])])):x("",!0),ae.value?(f(),E("div",{key:1,class:"absolute top-40 left-70 bg-bg-body rounded-lg p-4 shadow-lg z-100 min-w-[328px] border",onClick:e[22]||(e[22]=se(()=>{},["stop"]))},[k(s(ue),{autofocus:!0,modelValue:K.value,"onUpdate:modelValue":e[21]||(e[21]=i=>K.value=i),placeholder:"Add New list",onKeyup:it(ke,["enter"])},null,8,["modelValue"]),e[53]||(e[53]=r("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),r("div",xl,[k(s(Fe),{onClick:ke,varaint:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:G(()=>[we(Be(s(Le)?"Adding...":"Add list"),1)]),_:1}),r("i",{class:"fa-solid fa-close cursor-pointer",onClick:Ne})])])):x("",!0)],64)):x("",!0),v.value==="calendar"?(f(),q(s(xt),{key:3,data:oe.value,"onSelect:ticket":P},null,8,["data"])):x("",!0),v.value==="gantt"?(f(),q(s(kt),{key:4,data:oe.value,"onSelect:ticket":P},null,8,["data"])):x("",!0),v.value==="timeline"?(f(),q(s(ht),{key:5,data:oe.value,"onSelect:ticket":P},null,8,["data"])):x("",!0)]),k(s(Ve),{onClick:e[23]||(e[23]=se(()=>{},["stop"])),modelValue:H.value,"onUpdate:modelValue":e[24]||(e[24]=i=>H.value=i),title:"Delete List",itemLabel:"list",itemName:(a=U.value)==null?void 0:a.title,requireMatchText:(l=U.value)==null?void 0:l.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:s(Le),onConfirm:Qt,onCancel:e[25]||(e[25]=()=>{H.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),be.value?(f(),q(s(qt),{selectedVariable:h.value,listId:(o=U.value)==null?void 0:o.title,sheet_id:S.value,key:"createTaskModalKey",modelValue:be.value,"onUpdate:modelValue":e[26]||(e[26]=i=>be.value=i),onSubmit:e[27]||(e[27]=()=>{})},null,8,["selectedVariable","listId","sheet_id","modelValue"])):x("",!0),(c=Z.value)!=null&&c._id?(f(),q(s(Rt),{key:1,details:Z.value,onClose:e[28]||(e[28]=()=>{P({variables:{}})}),showPanel:!!((p=Z.value)!=null&&p._id)},null,8,["details","showPanel"])):x("",!0),k(s(Mt),{size:"md",sheet:B.value,modelValue:te.value,"onUpdate:modelValue":e[29]||(e[29]=i=>te.value=i)},null,8,["sheet","modelValue"]),X.value?(f(),q(s(Ot),{key:2,modelValue:X.value,"onUpdate:modelValue":e[30]||(e[30]=i=>X.value=i),sheetID:S.value},null,8,["modelValue","sheetID"])):x("",!0),k(s(Ve),{onClick:e[31]||(e[31]=se(()=>{},["stop"])),modelValue:Y.value,"onUpdate:modelValue":e[32]||(e[32]=i=>Y.value=i),title:"Delete Sheet",itemLabel:"Sheet",itemName:(A=B.value)==null?void 0:A.title,requireMatchText:(d=B.value)==null?void 0:d.title,confirmText:"Delete Sheet",cancelText:"Cancel",size:"md",loading:s(Xt),onConfirm:Zt,onCancel:e[33]||(e[33]=()=>{Y.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),k(s(Ve),{modelValue:fe.value,"onUpdate:modelValue":e[34]||(e[34]=i=>fe.value=i),title:"Delete Ticket",itemLabel:"Ticket",itemName:(n=pe.value)==null?void 0:n.title,requireMatchText:(T=pe.value)==null?void 0:T.title,confirmText:"Delete Ticket",cancelText:"Cancel",size:"md",loading:Ce.value,onConfirm:Nt,onCancel:e[35]||(e[35]=()=>{fe.value=!1,pe.value=null})},null,8,["modelValue","itemName","requireMatchText","loading"]),e[54]||(e[54]=r("div",null,null,-1))],64)}}}),El=Fa(kl,[["__scopeId","data-v-09179570"]]);export{El as default};
