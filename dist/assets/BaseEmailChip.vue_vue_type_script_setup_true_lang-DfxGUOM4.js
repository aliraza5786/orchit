import{d as S,r as h,m as A,i as l,y as c,j as u,e as m,f as k,t as f,I as v,z as I,F as R,x as F,g as L,O,o}from"./index-By-MWQyp.js";import{_ as T}from"./info-DjaLHeD_.js";const j=["title"],J={class:"relative"},M={key:0,class:"mr-1 text-text-secondary -500"},U={class:"flex flex-wrap gap-2 items-center flex-1"},_={key:0,class:"font-medium"},K={key:1,class:"opacity-70"},P={key:2},Z=["onClick","disabled"],q=["placeholder","disabled"],G={key:1,class:"ml-1 text-text-secondary"},W=S({__name:"BaseEmailChip",props:{modelValue:{default:()=>[]},label:{},tooltip:{},message:{},error:{type:Boolean,default:!1},placeholder:{default:"Add people by email… (Enter, comma, space)"},size:{default:"md"},theme:{default:"light"},disabled:{type:Boolean,default:!1},allowDuplicates:{type:Boolean,default:!1},showName:{type:Boolean,default:!1},validator:{}},emits:["update:modelValue","invalid","add","remove"],setup(w,{emit:V}){const r=w,i=V,y=h(null),p=h(""),s=h([...r.modelValue]);A(()=>r.modelValue,e=>{JSON.stringify(e)!==JSON.stringify(s.value)&&(s.value=[...e])});function B(){var e;r.disabled||(e=y.value)==null||e.focus()}const C=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i;function N(e){return(r.validator??(t=>C.test(t)))(e)}function b(e){return e.split(/[\s,;]+/).map(t=>t.trim().toLowerCase()).filter(Boolean)}function g(e){const t=[],a=[],n=r.allowDuplicates?null:new Set(s.value);for(const d of e){if(!N(d)){a.push(d);continue}n&&n.has(d)||(n&&n.add(d),s.value.push(d),t.push(d))}t.length&&i("add",t),a.length&&i("invalid",a),t.length&&a.length===0&&i("invalid",[]),(t.length||a.length)&&i("update:modelValue",[...s.value])}function x(){p.value&&(g(b(p.value)),p.value="")}function D(e){var a;const t=((a=e.clipboardData)==null?void 0:a.getData("text"))||"";t&&(e.preventDefault(),g(b(t)))}function E(e){if(!r.disabled){if(e.key==="Enter"||e.key==="Tab"||e.key===","||e.key===" "){e.preventDefault(),x();return}if(e.key==="Backspace"&&!p.value&&s.value.length){const t=s.value.pop();i("remove",t),i("update:modelValue",[...s.value])}}}function $(e){if(r.disabled)return;const[t]=s.value.splice(e,1);i("remove",t),i("update:modelValue",[...s.value])}function z(e){const a=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return a.length?a.map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(" "):e}return(e,t)=>(o(),l("div",{class:c(e.theme==="dark"?"text-white":"text-text-primary")},[e.label?(o(),l("label",{key:0,class:c(["text-base font-medium mb-1 flex items-center",e.theme==="dark"?"text-white":"text-text-primary"])},[k(f(e.label)+" ",1),e.tooltip?(o(),l("span",{key:0,class:"inline-block text-text-secondary -400 ml-1 cursor-help",title:e.tooltip},t[1]||(t[1]=[m("img",{src:T,alt:"info"},null,-1)]),8,j)):u("",!0)],2)):u("",!0),m("div",J,[m("div",{class:c(["flex items-center gap-2 border rounded-xl px-3 py-2 w-full text-sm focus-within:ring-2",e.size==="md"?"min-h-10":"min-h-12",e.error?"border-red-500 focus-within:ring-red-500":"focus-within:ring-border",e.theme==="dark"?"bg-[#131318] border-border ":" border-border bg-bg-input",e.disabled?"opacity-60 cursor-not-allowed":""]),onClick:B},[e.$slots.prefix?(o(),l("span",M,[v(e.$slots,"prefix")])):u("",!0),m("div",U,[(o(!0),l(R,null,F(s.value,(a,n)=>(o(),l("span",{key:a+n,class:"inline-flex items-center gap-2 rounded-full px-2 py-1 text-xs bg-bg-body text-text-secondary"},[e.showName?(o(),l("span",_,f(z(a)),1)):u("",!0),e.showName?(o(),l("span",K,"<"+f(a)+">",1)):(o(),l("span",P,f(a),1)),m("button",{type:"button",class:"ml-1 rounded hover:bg-bg-surface px-1",title:"Remove",onClick:L(d=>$(n),["stop"]),disabled:e.disabled},"✕",8,Z)]))),128)),I(m("input",{ref_key:"inputRef",ref:y,"onUpdate:modelValue":t[0]||(t[0]=a=>p.value=a),placeholder:s.value.length===0?e.placeholder:"",class:"flex-1 min-w-[160px] bg-transparent outline-none text-sm placeholder:text-text-secondary text-text-primary",disabled:e.disabled,onKeydown:E,onBlur:x,onPaste:D},null,40,q),[[O,p.value]])]),e.$slots.suffix?(o(),l("span",G,[v(e.$slots,"suffix")])):u("",!0)],2)]),e.message?(o(),l("p",{key:1,class:c(["mt-2 text-xs flex items-center gap-1",e.error?"text-red-500":(e.theme==="dark","text-text-secondary ")])},[e.$slots.msgIcon?v(e.$slots,"msgIcon",{key:0}):u("",!0),k(" "+f(e.message),1)],2)):u("",!0)],2))}});export{W as _};
