import{d as G,c as r,p as I,r as f,u as q,q as Z,b as J,w as m,o as t,e as s,i as a,h as i,f as o,B as R,k as K,g as O,j as Q,_ as F,y as w,t as N,l as W}from"./index-aJ6kFthw.js";import{_ as X}from"./AuthLayout.vue_vue_type_script_setup_true_lang-C6zoSqRr.js";import{c as ee,d as se}from"./auth-DtTFtoPv.js";import"./favicon-BAFXWHLW.js";const te={class:"max-w-[500px] md:mx-auto w-full text-text-primary bg-bg-body"},ae={key:0,class:"text-center py-12"},re={key:1,class:"text-center"},oe={class:"mt-6"},le={key:2,class:"text-center"},ne={key:3},ie={class:"bg-bg-card border border-border rounded-lg p-4"},ue={class:"text-xs text-text-secondary space-y-1"},de={key:0,class:"fa-solid fa-check mr-1"},me={key:1,class:"fa-solid fa-circle text-[4px] mr-1"},ce={key:0,class:"fa-solid fa-check mr-1"},fe={key:1,class:"fa-solid fa-circle text-[4px] mr-1"},ve={key:0,class:"fa-solid fa-check mr-1"},we={key:1,class:"fa-solid fa-circle text-[4px] mr-1"},xe={key:0,class:"fa-solid fa-check mr-1"},pe={key:1,class:"fa-solid fa-circle text-[4px] mr-1"},ye={key:0,class:"fa-solid fa-check mr-1"},be={key:1,class:"fa-solid fa-circle text-[4px] mr-1"},ge={key:0,class:"text-red-500 text-sm text-center mt-2"},Ve=G({name:"ResetPasswordPage",__name:"ResetPassword",setup(ke){const M=I(),T=W(),b=r(()=>M.query.token),l=f(""),u=f(""),d=f(""),x=f(!0),g=f(!1),B=f(!1),n={newPassword:!1,confirmPassword:!1},k=r(()=>l.value.length>=8),P=r(()=>/\d/.test(l.value)),_=r(()=>/[!@#$%^&*(),.?":{}|<>]/.test(l.value)),h=r(()=>/[A-Z]/.test(l.value)),C=r(()=>/[a-z]/.test(l.value)),p=r(()=>n.newPassword?l.value.trim()?k.value?P.value?_.value?h.value?C.value?"":"Password must contain at least one lowercase letter":"Password must contain at least one uppercase letter":"Password must contain at least one special character":"Password must contain at least one number":"Password must be at least 8 characters long":"Password is required":""),$=r(()=>!!p.value),y=r(()=>n.confirmPassword?u.value.trim()?u.value.trim()!==l.value.trim()?"Passwords do not match":"":"Please confirm your password":""),A=r(()=>!!y.value),S=r(()=>!p.value&&!y.value),{mutateAsync:j}=q({mutationFn:ee}),{mutateAsync:L,isPending:E}=q({mutationFn:se}),U=r(()=>E.value?"Resetting...":"Reset password");function z(){d.value&&(d.value=""),n.newPassword&&l.value&&(n.newPassword=!1),n.confirmPassword&&u.value&&(n.confirmPassword=!1)}Z(async()=>{if(!b.value){g.value=!0,x.value=!1;return}try{await j({token:b.value}),x.value=!1}catch{x.value=!1,g.value=!0}});function D(){return n.newPassword=!0,n.confirmPassword=!0,!(!l.value.trim()||!u.value.trim()||p.value||y.value)}async function H(){if(d.value="",!D()){d.value="Please fill all fields correctly.";return}try{await L({token:b.value,new_password:l.value.trim(),confirm_password:u.value.trim()}),B.value=!0,setTimeout(()=>T.push("/login"),3e3)}catch(c){d.value=(c==null?void 0:c.message)||"Failed to reset password. Please try again."}}const Y=r(()=>E.value||!S.value);return(c,e)=>{const V=K("router-link");return t(),J(X,null,{form:m(()=>[s("div",te,[x.value?(t(),a("div",ae,e[4]||(e[4]=[s("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent mx-auto mb-4"},null,-1),s("p",{class:"text-sm text-text-secondary"},"Verifying your reset link...",-1)]))):g.value?(t(),a("div",re,[e[7]||(e[7]=s("div",{class:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},[s("i",{class:"fa-solid fa-times text-red-600 text-2xl"})],-1)),e[8]||(e[8]=s("h2",{class:"text-2xl font-medium mb-4 text-text-primary"}," Reset link expired ",-1)),e[9]||(e[9]=s("p",{class:"text-sm text-text-secondary mb-8"},[o(" This password reset link has expired or is invalid."),s("br"),o(" Please request a new one. ")],-1)),i(V,{to:"/forgot-password"},{default:m(()=>[i(R,{size:"md",variant:"primary"},{default:m(()=>e[5]||(e[5]=[o(" Request new reset link ")])),_:1,__:[5]})]),_:1}),s("div",oe,[i(V,{to:"/login",class:"text-sm text-text-secondary hover:text-text-primary"},{default:m(()=>e[6]||(e[6]=[s("i",{class:"fa-solid fa-arrow-left mr-2"},null,-1),o("Back to login ")])),_:1,__:[6]})])])):B.value?(t(),a("div",le,[e[11]||(e[11]=s("div",{class:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},[s("i",{class:"fa-solid fa-check text-green-600 text-2xl"})],-1)),e[12]||(e[12]=s("h2",{class:"text-2xl font-medium mb-4 text-text-primary"}," Password reset successful ",-1)),e[13]||(e[13]=s("p",{class:"text-sm text-text-secondary mb-8"},[o(" Your password has been successfully reset."),s("br"),o(" You can now sign in with your new password. ")],-1)),i(V,{to:"/login"},{default:m(()=>[i(R,{size:"md",variant:"primary"},{default:m(()=>e[10]||(e[10]=[o(" Go to login ")])),_:1,__:[10]})]),_:1})])):(t(),a("div",ne,[e[20]||(e[20]=s("h2",{class:"text-[32px] font-medium mb-4 text-center text-text-primary"}," Reset your password ",-1)),e[21]||(e[21]=s("p",{class:"text-sm text-text-secondary text-center mb-8"}," Enter your new password below. ",-1)),s("form",{onSubmit:O(H,["prevent"]),class:"space-y-4 w-full"},[i(F,{modelValue:l.value,"onUpdate:modelValue":[e[0]||(e[0]=v=>l.value=v),z],label:"New Password",type:"password",placeholder:"Enter new password",size:"lg",error:$.value,message:p.value,onBlur:e[1]||(e[1]=v=>n.newPassword=!0)},null,8,["modelValue","error","message"]),i(F,{modelValue:u.value,"onUpdate:modelValue":[e[2]||(e[2]=v=>u.value=v),z],label:"Confirm Password",placeholder:"Confirm new password",size:"lg",type:"password",error:A.value,message:y.value,onBlur:e[3]||(e[3]=v=>n.confirmPassword=!0)},null,8,["modelValue","error","message"]),s("div",ie,[e[19]||(e[19]=s("p",{class:"text-xs text-text-secondary mb-2"},"Password requirements:",-1)),s("ul",ue,[s("li",{class:w({"text-green-600":k.value})},[k.value?(t(),a("i",de)):(t(),a("i",me)),e[14]||(e[14]=o(" At least 8 characters "))],2),s("li",{class:w({"text-green-600":P.value})},[P.value?(t(),a("i",ce)):(t(),a("i",fe)),e[15]||(e[15]=o(" Contains a number "))],2),s("li",{class:w({"text-green-600":_.value})},[_.value?(t(),a("i",ve)):(t(),a("i",we)),e[16]||(e[16]=o(" Contains a special character "))],2),s("li",{class:w({"text-green-600":h.value})},[h.value?(t(),a("i",xe)):(t(),a("i",pe)),e[17]||(e[17]=o(" Contains an uppercase letter "))],2),s("li",{class:w({"text-green-600":C.value})},[C.value?(t(),a("i",ye)):(t(),a("i",be)),e[18]||(e[18]=o(" Contains a lowercase letter "))],2)])]),i(R,{disabled:Y.value,size:"lg",block:!0,type:"submit"},{default:m(()=>[o(N(U.value),1)]),_:1},8,["disabled"]),d.value?(t(),a("p",ge,N(d.value),1)):Q("",!0)],32)]))])]),_:1})}}});export{Ve as default};
