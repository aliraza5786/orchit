const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BCXm2D5k.js","assets/index-BkThUD6V.css","assets/BaseSelectField-CZf1tVjz.js","assets/AssigmentDropdown-cEIlD2f3.js"])))=>i.map(i=>d[i]);
import{d as pt,r as h,W as mt,M as ht,N as ft,bw as gt,n as q,v as ke,av as bt,K as Ce,c as T,a1 as _t,bx as xt,by as wt,bz as yt,bA as kt,bB as Ct,ab as Dt,aN as Et,e as St,ap as K,w as D,o as d,D as W,E as Vt,f as s,j as r,p as i,z as U,i as f,F as y,y as A,k as E,t as p,ae as L,ai as De,h as Ee,P as de,g as Y,al as Se,U as re,A as O,J as It}from"./index-BCXm2D5k.js";const Pt={key:0,class:"flex flex-col gap-5 p-6 animate-pulse"},Tt={key:1},Ut={class:"sticky top-0 z-10 border-b border-border px-4 sm:px-6 py-[9px] flex items-center justify-between bg-bg-card"},At={class:"flex items-center gap-2"},Lt=["aria-label"],Ot={class:"py-5 px-4 sm:px-6 flex flex-col gap-5 flex-grow"},zt={key:0,class:"space-y-2 sm:col-span-1"},Bt={class:"text-xs uppercase tracking-wider text-text-secondary"},Mt={class:"capitalize"},Qt=["disabled","title","onKeydown"],Rt=["title"],jt=["disabled"],Ft=["innerHTML"],qt={key:1,class:"opacity-60"},Kt={key:"tab-details",class:"space-y-6"},$t={class:"grid grid-cols-2 gap-4 text-sm"},Nt={class:"rounded-xl bg-orchit-white/5 border border-orchit-white/10 p-4"},Ht={class:"mt-1 font-medium"},Wt={class:"rounded-xl bg-orchit-white/5 border border-orchit-white/10 p-4"},Yt={class:"mt-1 font-medium"},Jt={class:"rounded-2xl border border-orchit-white/10 bg-orchit-white/5 p-4 grid grid-cols-1 gap-4"},Gt={class:"space-y-2"},Xt={class:"space-y-2"},Zt={class:"space-y-2"},es={class:"h-8 px-3 flex items-center gap-2 rounded-lg bg-bg-input border border-orchit-white/10"},ts={class:"space-y-2"},ss={key:0,class:"text-xs text-red-400 mt-1"},as={key:0,class:"space-y-2 sm:col-span-1"},ls={class:"text-xs uppercase tracking-wider text-text-secondary"},os={key:1},is={class:"relative border-l border-orchit-white/10 pl-5 space-y-4 ml-1"},ns={class:"rounded-xl bg-orchit-white/5 border border-orchit-white/10 p-3 hover:bg-orchit-white/7 transition"},ds={class:"font-semibold"},rs={class:"font-semibold"},us={key:"tab-comments",class:"space-y-4"},cs={class:"flex items-center gap-3 mb-2"},vs={class:"h-8 w-8 rounded-full bg-accent/15 text-accent flex items-center justify-center text-xs font-semibold"},ps={class:"flex-1"},ms={class:"text-sm font-medium"},hs={class:"text-xs text-text-secondary"},fs={key:0,class:"flex items-center gap-2"},gs=["disabled","onClick"],bs=["disabled","onClick"],_s={class:"flex items-center gap-2 justify-end"},xs={key:0,class:"mt-3 grid grid-cols-2 gap-2"},ws=["href"],ys={class:"text-xs truncate"},ks={class:"rounded-xl border border-orchit-white/10 bg-orchit-white/5 overflow-hidden"},Cs=["disabled"],Ds={class:"flex items-center w-full justify-between p-2 border-t border-orchit-white/10"},Es={key:"tab-attachments",class:"space-y-3"},Ss={class:"text-xs text-text-secondary"},Vs={class:"grid sm:grid-cols-2 gap-4"},Is={class:"p-3"},Ps={key:0,class:"rounded-lg overflow-hidden"},Ts=["src"],Us={key:1,class:"rounded-lg overflow-hidden"},As=["src"],Ls={key:2,class:"h-40 rounded-lg bg-black/5 grid place-items-center"},Os={class:"mt-3"},zs={class:"font-medium truncate"},Bs={class:"text-xs text-text-secondary capitalize"},Ms={class:"p-3 pt-0"},Qs=["href"],Rs=pt({__name:"SidePanel",props:{pin:{type:Boolean,default:!1},showPanel:{type:Boolean,default:!0},details:{type:Object,default:()=>({})}},emits:["close","update:details","comment:post","priority:change"],setup(z,{emit:Ve}){var _e,xe,we;const Ie=L({loader:()=>O(()=>import("./index-BCXm2D5k.js").then(e=>e.dq),__vite__mapDeps([0,1])),loadingComponent:{template:'<div class="h-20 w-full animate-pulse bg-neutral-700/30 rounded-lg"></div>'},delay:200}),J=L(()=>O(()=>import("./BaseSelectField-CZf1tVjz.js"),__vite__mapDeps([2,0,1]))),ue=L(()=>O(()=>import("./index-BCXm2D5k.js").then(e=>e.dr),__vite__mapDeps([0,1]))),Pe=L(()=>O(()=>import("./AssigmentDropdown-cEIlD2f3.js"),__vite__mapDeps([3,0,1]))),G=L(()=>O(()=>import("./index-BCXm2D5k.js").then(e=>e.dp),__vite__mapDeps([0,1]))),Te=L(()=>O(()=>import("./index-BCXm2D5k.js").then(e=>e.dt),__vite__mapDeps([0,1]))),B=h(!1),{canCreateComment:X,canEditComment:$,canViewComment:ce,canDeleteComment:Ue,canEditCard:g,canViewAttachment:Ae,canAssignCard:Le}=mt(),{workspaceId:Oe}=ht(),b=ft(),m=z,ze=Ve,Z=h(m.details._id),{data:n,isPending:ve,isFetching:Be}=gt(Z,{initialData:()=>b.getQueryData(["product-card",Z.value]),staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1});q(m,()=>{Z.value=m.details._id});const M=h("details"),Me=[{label:"Details",value:"details"},{label:"Comments",value:"comments",disabled:ce},{label:"History",value:"history"},{label:"Attachment",value:"attachment"}],N=h(!1),C=h(n.value?n.value["card-title"]:""),ee=h(null);function Qe(){g.value&&(N.value=!0,Se(()=>{var e,t;(e=ee.value)==null||e.focus(),(t=ee.value)==null||t.select()}))}function pe(){var e;C.value.trim()||(C.value=m.details["card-title"]??""),g.value?V.mutate({card_id:m.details._id,variables:{"card-title":C.value.trim()}}):(C.value=((e=n.value)==null?void 0:e["card-title"])??"",re.error("You do not have permission to do that"),console.log("you  dont have access to do that")),N.value=!1}const P=h(n!=null&&n.value?n==null?void 0:n.value["card-description"]:""),H=h(!1),te=h(null);function Re(e){var c,u;const t=(c=e==null?void 0:e.querySelector)==null?void 0:c.call(e,".ProseMirror");if(!t)return;t.focus();const a=(u=window.getSelection)==null?void 0:u.call(window),o=document.createRange();o.selectNodeContents(t),o.collapse(!1),a==null||a.removeAllRanges(),a==null||a.addRange(o)}async function je(){g.value&&(H.value=!0,await Se(),Re(te.value||void 0))}function me(e){console.log(e,"???"),V.mutate({card_id:m.details._id,attachments:e??[],variables:{"card-description":P.value}}),H.value=!1}function he(e){var a;if(!H.value)return;const t=e.target;(a=te.value)!=null&&a.contains(t)||me()}ke(()=>document.addEventListener("mousedown",he)),bt(()=>document.removeEventListener("mousedown",he));const se=Ce({posted_on:((_e=m.details)==null?void 0:_e.posted_on)??((xe=m.details)==null?void 0:xe.created_at)??""}),Fe=T({get:()=>se.posted_on?new Date(se.posted_on).toISOString().slice(0,10):"",set:e=>{se.posted_on=e?new Date(e+"T00:00:00").toISOString():""}}),{data:ae}=_t(Oe.value),le=h(n!=null&&n.value?n.value.workspace_lane_id:"");q([()=>n.value,()=>Be.value],()=>{n!=null&&n.value&&(C.value=n==null?void 0:n.value["card-title"],P.value=n.value["card-description"],le.value=n.value.workspace_lane_id)});const qe=T(()=>((ae==null?void 0:ae.value)??[]).map(e=>{var t;return{_id:e._id,title:((t=e==null?void 0:e.variables)==null?void 0:t["lane-title"])??String(e._id)}}));function Ke(e){le.value=e,V.mutate({card_id:m.details._id,workspace_lane_id:e})}const _=h({startDate:null,endDate:null});q(()=>n.value,e=>{_.value.startDate=(e==null?void 0:e["start-date"])??null,_.value.endDate=(e==null?void 0:e["end-date"])??null},{immediate:!0,deep:!0});const oe=T(()=>_!=null&&_.value.startDate&&_.value.endDate&&_.value.endDate<_.value.startDate?"End date cannot be before start date":""),$e=e=>{_.value.startDate=e??null,V.mutate({card_id:m.details._id,variables:{"start-date":e}})},Ne=e=>{_.value.endDate=e??null,V.mutate({card_id:m.details._id,variables:{"end-date":e}})},He=T(()=>n==null?void 0:n.value.assigned_to),We=e=>{V.mutate({card_id:m.details._id,seat_id:e==null?void 0:e._id})},Ye=T(()=>{var e;return(e=m.details)==null?void 0:e._id}),{data:ie}=xt(Ye),v=h((we=ie.value)==null?void 0:we.comments);q(()=>ie.value,()=>{var e;v.value=(e=ie.value)==null?void 0:e.comments});const{mutate:Je,isPending:Ge}=wt({onSuccess:e=>{Q.value="",j.value=[],v.value=[...v.value,e]}}),Q=h(""),Xe=e=>(e??"").split(" ").map(t=>t[0]).filter(Boolean).slice(0,2).join("").toUpperCase(),Ze=e=>e?new Date(e).toLocaleString():"",{data:et}=yt(),tt=e=>{var t;return((t=e==null?void 0:e.created_by)==null?void 0:t._id)===et.value},R=h(null),S=h(""),{mutate:st,isPending:fe}=kt({onSuccess:e=>{const t=v.value.findIndex(a=>a._id===e._id);t>-1&&(v.value[t]={...v.value[t],comment_text:e.comment_text}),R.value=null,S.value=""}}),{mutate:at}=Ct();function lt(e){R.value=e._id,S.value=e.comment_text??""}function ne(){R.value=null,S.value="",N.value=!1}function ot(e){const t=S.value.trim();if(!t)return;const a=v.value.findIndex(c=>c._id===e._id),o=a>-1?{...v.value[a]}:null;a>-1&&(v.value[a]={...v.value[a],comment_text:t}),st({id:e._id,payload:{comment_text:t}},{onError:()=>{a>-1&&o&&(v.value[a]=o)},onSuccess:c=>{a>-1&&(v.value[a]=c??v.value[a]),ne()}})}function it(e){const t=v.value.findIndex(o=>o._id===e._id),a=t>-1?v.value[t]:null;t>-1&&v.value.splice(t,1),at({id:e._id},{onError:()=>{a&&v.value.splice(t,0,a)}})}const nt=T(()=>{var e,t;return console.log((e=m.details)==null?void 0:e.attachments,">>>"),(t=n.value)==null?void 0:t.attachments.map(a=>{var o;return{_id:a._id??a.id??((o=crypto.randomUUID)==null?void 0:o.call(crypto))??Math.random(),name:a.name??a.filename??"file",url:a.url,kind:(a.type??a.kind??"").toLowerCase().includes("image")?"image":(a.type??a.kind??"").toLowerCase().includes("video")?"video":"file"}})}),V=Dt({onMutate:async e=>{const{card_id:t,variables:a}=e;await b.cancelQueries({queryKey:["get-sheets"]}),await b.cancelQueries({queryKey:["sheet-list"]});const o=b.getQueryData(["get-sheets"]),c=b.getQueryData(["sheet-list"]);return b.setQueryData(["get-sheets"],u=>u==null?void 0:u.map(w=>w._id===t?{...w,variables:{...w.variables,...a}}:w)),b.setQueryData(["sheet-list"],u=>u==null?void 0:u.map(w=>{var l;return{...w,cards:(l=w.cards)==null?void 0:l.map(x=>x._id===t?{...x,variables:{...x.variables,...a}}:x)}})),{previousSheets:o,previousList:c}},onError:e=>{e!=null&&e.previousSheets&&b.setQueryData(["get-sheets"],e.previousSheets),e!=null&&e.previousList&&b.setQueryData(["sheet-list"],e.previousList)},onSettled:()=>{b.invalidateQueries({queryKey:["get-sheets"]}),b.invalidateQueries({queryKey:["sheet-list"]}),b.invalidateQueries({queryKey:["roles"]})}}),j=h([]),{mutate:dt}=Et({onSuccess:e=>{j.value=[e]}});function rt(e){const t=e.target.files;Array.from(t).forEach(a=>{const o=new FormData;o.append("file",a),dt(o)})}function ut(){const e=Q.value.trim();!e&&!j.value.length||Je({id:m.details._id,payload:{comment_text:e,attachments:j.value.map(t=>({name:t.data.name,url:t.data.url}))}})}const F=Ce({}),ge=()=>{var e;(e=n==null?void 0:n.value)!=null&&e.variables&&(n.value.variables??[]).forEach(a=>{var c,u;if(!a||a.type!=="Select")return;const o=Array.isArray(a.data)&&a.data.length?((c=a.data[0])==null?void 0:c.value)??((u=a.data[0])==null?void 0:u._id)??a.data[0]:void 0;F[a.slug]=a.value??F[a.slug]??o??null})};ke(ge),q(()=>n.value,ge,{deep:!0});function be(e,t){var o,c;F[t]=e,((c=(((o=n.value)==null?void 0:o.variables)??[]).find(u=>u.slug===t))==null?void 0:c.value)!==e&&V.mutate({card_id:m.details._id,variables:{[t]:e}})}function ct(e){return e==="comments"&&!ce.value?(re.error("You do not have permission to view comments"),!1):e==="attachment"&&!Ae.value?(re.error("You do not have permission to view attachments"),!1):!0}return(e,t)=>(d(),St(K,{name:"panel",appear:""},{default:D(()=>{var a;return[W(s("div",{class:U(["flex flex-col h-full overflow-y-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur rounded-[6px] shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] border border-orchit-white/5 overflow-hidden transition-all duration-300 ease-in-out",B.value?"min-w-full max-w-full":"min-w-full max-w-[380px] sm:min-w-[380px]"]),role:"complementary","aria-label":"Details panel"},[i(ve)&&!i(n)?(d(),r("div",Pt,t[8]||(t[8]=[s("div",{class:"h-8 bg-orchit-white/10 rounded-xl w-3/4"},null,-1),s("div",{class:"space-y-2"},[s("div",{class:"h-4 bg-orchit-white/10 rounded w-full"}),s("div",{class:"h-4 bg-orchit-white/10 rounded w-5/6"})],-1),s("div",{class:"grid grid-cols-2 gap-4"},[s("div",{class:"h-20 bg-orchit-white/10 rounded-xl"}),s("div",{class:"h-20 bg-orchit-white/10 rounded-xl"})],-1)]))):(d(),r("div",Tt,[s("div",Ut,[t[10]||(t[10]=s("h5",{class:"text-[18px] font-semibold tracking-tight"},"Details",-1)),s("div",At,[s("button",{class:"p-2 rounded-xl hover:bg-orchit-white/5 active:scale-[.98] cursor-pointer transition",onClick:t[0]||(t[0]=o=>B.value=!B.value),"aria-label":B.value?"Collapse details":"Expand details"},[s("i",{class:U(["fa-solid",B.value?"fa-compress":"fa-expand","text-lg"])},null,2)],8,Lt),s("button",{class:"p-2 rounded-xl hover:bg-orchit-white/5 active:scale-[.98] cursor-pointer transition",onClick:t[1]||(t[1]=()=>ze("close")),"aria-label":"Close details"},t[9]||(t[9]=[s("i",{class:"fa-solid fa-xmark text-lg"},null,-1)]))])]),s("div",Ot,[(d(!0),r(y,null,A((a=i(n))==null?void 0:a.variables,(o,c)=>(d(),r(y,{key:o.slug||`var-${c}`},[(o==null?void 0:o.type)==="Select"&&o.slug=="card-type"?(d(),r("div",zt,[s("div",Bt,p(o.title),1),f(i(J),{disabled:!i(g),size:"sm",options:o==null?void 0:o.data.map(u=>({_id:u,title:u})),placeholder:"Select option",allowCustom:!1,"model-value":F[o.slug],"onUpdate:modelValue":u=>be(u,o.slug)},null,8,["disabled","options","model-value","onUpdate:modelValue"])])):E("",!0)],64))),128)),s("div",Mt,[f(K,{name:"fade-scale",mode:"out-in"},{default:D(()=>[N.value?W((d(),r("input",{disabled:!i(g),title:i(g)?"":"You do not have permission to edit this card",key:"title-edit",ref_key:"titleInput",ref:ee,"onUpdate:modelValue":t[2]||(t[2]=o=>C.value=o),onBlur:pe,onKeydown:[De(Ee(pe,["prevent"]),["enter"]),De(Ee(ne,["prevent"]),["esc"])],class:"w-full text-2xl font-semibold rounded-xl px-3 py-2 bg-orchit-white/5 border border-orchit-white/10 focus:outline-none focus:ring-2 focus:ring-accent/40 transition",type:"text","aria-label":"Edit title"},null,40,Qt)),[[de,C.value]]):(d(),r("h1",{key:"title-view",class:U([i(g)?"cursor-text":"cursor-not-allowed","text-[20px] leading-[28px] font-semibold tracking-tight rounded-lg px-2 py-1 hover:bg-orchit-white/5 transition"]),onClick:Qe,"aria-label":"Card title",title:i(g)?"":"You do not have permission to edit this card"},p(C.value||"Untitled"),11,Rt))]),_:1})]),s("div",null,[t[11]||(t[11]=s("h3",{class:"mb-2 text-base font-semibold tracking-wide px-1"},"Description",-1)),f(K,{name:"fade-scale",mode:"out-in"},{default:D(()=>[H.value?(d(),r("div",{key:"desc-edit",ref_key:"descEditorWrap",ref:te,class:"rounded-xl overflow-hidden border border-orchit-white/10 shadow-sm"},[f(i(Ie),{modelValue:P.value,"onUpdate:modelValue":t[3]||(t[3]=o=>P.value=o),onFocusOut:me},null,8,["modelValue"])],512)):(d(),r("div",{key:"desc-view",class:U(["text-[15px] leading-6 text-text-secondary whitespace-pre-wrap rounded-xl px-4 py-3 border border-orchit-white/10 bg-orchit-white/5 hover:border-orchit-white/20 transition",i(g)?"cursor-text":"cursor-not-allowed"]),disabled:!i(g),onClick:je},[P.value?(d(),r("div",{key:0,innerHTML:P.value},null,8,Ft)):(d(),r("span",qt,"Click to add a description…"))],10,jt))]),_:1})]),f(i(Te),{modelValue:M.value,"onUpdate:modelValue":t[4]||(t[4]=o=>M.value=o),options:Me,size:"md",beforeChange:ct},null,8,["modelValue"]),f(K,{name:"section",mode:"out-in"},{default:D(()=>{var o,c,u,w;return[M.value==="details"?(d(),r("section",Kt,[s("div",$t,[s("div",Nt,[t[12]||(t[12]=s("div",{class:"text-xs uppercase tracking-wider text-text-secondary"},"Posted On",-1)),s("div",Ht,p(Fe.value),1)]),s("div",Wt,[t[13]||(t[13]=s("div",{class:"text-xs uppercase tracking-wider text-text-secondary"},"ID",-1)),s("div",Yt,p(z.details["card-code"]),1)])]),s("div",Jt,[s("div",Gt,[t[14]||(t[14]=s("div",{class:"text-xs uppercase tracking-wider text-text-secondary"},"Lane",-1)),f(i(J),{disabled:!i(g),size:"sm",options:qe.value,placeholder:"Select lane",allowCustom:!1,"model-value":le.value,"onUpdate:modelValue":Ke},null,8,["disabled","options","model-value"])]),s("div",Xt,[t[15]||(t[15]=s("div",{class:"text-xs uppercase tracking-wider text-text-secondary"},"Assign",-1)),f(i(Pe),{disabled:!i(Le),onAssign:t[5]||(t[5]=l=>We(l)),assigneeId:He.value,seat:i(n).seat},null,8,["disabled","assigneeId","seat"])]),z.pin?E("",!0):(d(),r(y,{key:0},[s("div",Zt,[t[17]||(t[17]=s("div",{class:"text-xs uppercase tracking-wider text-text-secondary"},"Start Date",-1)),s("div",es,[t[16]||(t[16]=s("i",{class:"fa-regular fa-calendar"},null,-1)),f(i(ue),{disabled:!i(g),placeholder:"Set start date",class:"w-full","model-value":_.value.startDate,"emit-as":"ymd","onUpdate:modelValue":$e},null,8,["disabled","model-value"])])]),s("div",ts,[t[19]||(t[19]=s("div",{class:"text-xs uppercase tracking-wider text-text-secondary"},"Target End",-1)),s("div",{class:U(["h-8 px-3 flex items-center gap-2 rounded-lg bg-bg-input border transition-colors",oe.value?"border-red-500":"border-orchit-white/10"])},[t[18]||(t[18]=s("i",{class:"fa-regular fa-calendar"},null,-1)),f(i(ue),{disabled:!i(g),placeholder:"Set end date",class:"w-full","model-value":_.value.endDate,"emit-as":"ymd","onUpdate:modelValue":Ne},null,8,["disabled","model-value"])],2),oe.value?(d(),r("p",ss,p(oe.value),1)):E("",!0)])],64)),i(ve)?(d(),r(y,{key:1},[t[20]||(t[20]=s("div",{class:"bg-bg-surface/40 w-full animate-pulse h-8 p-1"},null,-1)),t[21]||(t[21]=s("div",{class:"bg-bg-surface/40 w-full animate-pulse h-8 p-1"},null,-1)),t[22]||(t[22]=s("div",{class:"bg-bg-surface/40 w-full animate-pulse h-8 p-1"},null,-1)),t[23]||(t[23]=s("div",{class:"bg-bg-surface/40 w-full animate-pulse h-6 p-1"},null,-1))],64)):(o=i(n))!=null&&o.variables?(d(!0),r(y,{key:2},A((c=i(n))==null?void 0:c.variables,(l,x)=>(d(),r(y,{key:l.slug||`var-${x}`},[l.type==="Select"&&l.slug!=="card-type"?(d(),r("div",as,[s("div",ls,p(l.title),1),f(i(J),{disabled:!i(g),size:"sm",options:l==null?void 0:l.data.map(I=>({_id:I,title:I})),placeholder:"Select option",allowCustom:!1,"model-value":F[l.slug],"onUpdate:modelValue":I=>be(I,l.slug)},null,8,["disabled","options","model-value","onUpdate:modelValue"])])):E("",!0)],64))),128)):E("",!0)])])):M.value==="history"?(d(),r("section",os,[s("div",null,[t[26]||(t[26]=s("h3",{class:"text-sm font-semibold tracking-wide mb-3"},"History",-1)),s("ol",is,[(d(!0),r(y,null,A((u=i(n))==null?void 0:u.history,(l,x)=>(d(),r("li",{key:x,class:"group"},[t[25]||(t[25]=s("span",{class:"absolute -left-[5px] top-0 w-2 h-2 rounded-full bg-accent/70 ring-4 ring-accent/10"},null,-1)),s("div",ns,[s("span",ds,p(l.user.u_full_name),1),t[24]||(t[24]=s("span",{class:"text-text-secondary"}," changed ",-1)),s("span",rs,p(l.field_name),1)])]))),128))])])])):M.value==="comments"?(d(),r("section",us,[(d(!0),r(y,null,A(v.value??[],l=>{var x,I,ye;return d(),r("div",{key:l._id,class:"rounded-xl border border-orchit-white/10 bg-orchit-white/5 p-4 hover:bg-orchit-white/7 transition"},[s("div",cs,[s("div",vs,p(Xe((x=l.commented_by)==null?void 0:x.u_full_name)),1),s("div",ps,[s("div",ms,p((I=l.commented_by)==null?void 0:I.u_full_name),1),s("div",hs,p(Ze(l.created_at)),1)]),tt(l)?(d(),r("div",fs,[R.value!==l._id?(d(),r("button",{key:0,disabled:!i($),class:"text-xs text-accent hover:underline",onClick:k=>lt(l)},"Edit",8,gs)):E("",!0),s("button",{disabled:!i(Ue),class:"text-xs text-red-400 hover:underline",onClick:k=>it(l)},"Delete",8,bs)])):E("",!0)]),f(K,{name:"fade",mode:"out-in"},{default:D(()=>[R.value!==l._id?(d(),r("p",{key:`c-view-${l._id}`,class:"text-[15px] leading-6"},p(l.comment_text),1)):(d(),r("div",{key:`c-edit-${l._id}`,class:"space-y-2"},[W(s("textarea",{"onUpdate:modelValue":t[6]||(t[6]=k=>S.value=k),rows:"3",class:"w-full p-3 rounded-lg bg-bg-input/80 border border-orchit-white/10 focus:ring-2 focus:ring-accent/40 outline-none"},null,512),[[de,S.value]]),s("div",_s,[f(i(G),{variant:"secondary",size:"sm",onClick:ne},{default:D(()=>t[27]||(t[27]=[Y("Cancel")])),_:1,__:[27]}),f(i(G),{class:"btn",size:"sm",onClick:k=>ot(l),disabled:!S.value.trim()||i(fe)||!i($)},{default:D(()=>[Y(p(i(fe)?"Saving…":"Save"),1)]),_:2},1032,["onClick","disabled"])])]))]),_:2},1024),(ye=l==null?void 0:l.attachments)!=null&&ye.length?(d(),r("div",xs,[(d(!0),r(y,null,A(l.attachments,(k,vt)=>(d(),r("a",{key:vt,href:k.url,target:"_blank",class:"group flex items-center gap-2 rounded-lg border border-orchit-white/10 bg-orchit-white/5 px-2 py-1 hover:bg-orchit-white/10 transition"},[t[28]||(t[28]=s("i",{class:"fa-regular fa-file text-text-secondary group-hover:text-text-primary transition"},null,-1)),s("span",ys,p(k==null?void 0:k.name),1)],8,ws))),128))])):E("",!0)])}),128)),s("div",ks,[W(s("textarea",{disabled:!i(X)||!i($),"onUpdate:modelValue":t[7]||(t[7]=l=>Q.value=l),rows:"3",class:U([i(X)||i($)?"cursor-text":"cursor-not-allowed","w-full p-3 bg-transparent outline-none text-sm"]),placeholder:"Write a comment"},null,10,Cs),[[de,Q.value]]),s("div",Ds,[s("input",{type:"file",multiple:"",onChange:rt,class:"max-w-full text-ellipsis text-xs text-text-secondary file:mr-3 col-span-2 file:px-3 file:py-1.5 file:rounded-md file:border file:border-orchit-white/10 file:bg-orchit-white/10 hover:file:bg-orchit-white/15 file:text-text-primary transition inline w-fit"},null,32),f(i(G),{variant:"primary",class:"min-w-[70px]",size:"sm",onClick:ut,disabled:!Q.value.trim()&&!j.value.length||!i(X)},{default:D(()=>[Y(p(i(Ge)?"Posting…":"Post"),1)]),_:1},8,["disabled"])])])])):(d(),r("section",Es,[s("div",Ss," Files attached to this "+p(((w=z.details)==null?void 0:w.type)??"item")+". ",1),s("div",Vs,[(d(!0),r(y,null,A(nt.value,l=>(d(),r("div",{key:l._id,class:"rounded-2xl overflow-hidden border border-orchit-white/10 bg-orchit-white/5 hover:bg-orchit-white/8 transition group"},[s("div",Is,[l.kind==="image"?(d(),r("div",Ps,[s("img",{src:l.url,class:"w-full h-40 object-cover group-hover:scale-[1.02] transition"},null,8,Ts)])):l.kind==="video"?(d(),r("div",Us,[s("video",{src:l.url,controls:"",class:"w-full h-40 object-cover"},null,8,As)])):(d(),r("div",Ls,t[29]||(t[29]=[s("i",{class:"fa-regular fa-file text-3xl text-text-secondary"},null,-1)]))),s("div",Os,[s("div",zs,p(l.name),1),s("div",Bs,p(l.kind),1)])]),s("div",Ms,[s("a",{href:l.url,target:"_blank",rel:"noopener",class:"w-full inline-flex items-center justify-center gap-2 h-9 rounded-lg bg-accent text-orchit-white text-sm hover:opacity-90 transition"},t[30]||(t[30]=[s("i",{class:"fa-regular fa-arrow-up-right-from-square"},null,-1),Y(" View ")]),8,Qs)])]))),128))])]))]}),_:1})])]))],2),[[Vt,z.showPanel]])]}),_:1}))}}),Fs=It(Rs,[["__scopeId","data-v-f4679b51"]]);export{Fs as default};
