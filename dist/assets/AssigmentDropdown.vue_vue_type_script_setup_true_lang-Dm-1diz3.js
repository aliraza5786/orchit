import{d as z,ad as N,r as m,c as D,p as I,O as K,l as S,h as n,L as H,f as x,i as U,F as V,J as q,t as p,b as l,y as J,a4 as O,v as T,o as a}from"./index-DfPzAmTM.js";import{u as W}from"./useQueryParams-Cc07jdKX.js";const $=["src"],G=["disabled"],P={class:"p-3"},Q={class:"max-h-80 overflow-auto py-1"},X=["onClick"],Y={class:"flex items-center gap-3 min-w-0"},Z=["src"],ee={class:"min-w-0"},te={class:"text-xs font-medium truncate"},se={class:"text-[10px] text-text-secondary text-secondary-400 truncate"},oe={key:0,class:"px-4 pb-2 text-sm text-text-secondary -500 text-secondary-400"},ie=z({__name:"AssigmentDropdown",props:{assigneeId:{},disabled:{type:Boolean},seat:{}},emits:["update:modelValue","assign","unassign"],setup(ne,{emit:A}){const{workspaceId:M}=W(),{data:R}=N(M.value),r=m(null),b=D(()=>[{_id:null,name:"Unassign",email:""},...R.value]),g=A,d=m(!1),u=m(""),y=m(null),h=D(()=>{const t=u.value.trim().toLowerCase(),e=b.value;return t?e.filter(s=>(s.title||"").toLowerCase().includes(t)||(s.email||"").toLowerCase().includes(t)):e});function v(){d.value=!d.value}function f(){d.value=!1}function _(){d.value&&f()}I(()=>document.addEventListener("click",_)),K(()=>document.removeEventListener("click",_)),S(d,t=>{t?requestAnimationFrame(()=>{var e;return(e=y.value)==null?void 0:e.focus()}):u.value=""});function j(t){const e=b.value.find(s=>s._id===t);console.log(e),e&&(r.value=e,g("assign",e),g("update:modelValue",t)),f()}function w(t){var i;const e=(t||"").trim();if(!e)return"?";const s=e.split(/\s+/);return(s[0][0]+(((i=s[1])==null?void 0:i[0])||s[0][1]||"")).toUpperCase()}function k(t){const e=(t._id||t.email||t.name||"").split("").reduce((i,c)=>i*31+c.charCodeAt(0)>>>0,7),s=["#8B5CF6","#F59E0B","#10B981","#EF4444","#3B82F6","#EC4899","#22D3EE","#84CC16","#FB7185","#F97316"];return s[e%s.length]}return(t,e)=>{var s,i,c,C,B,F,E,L;return a(),n("div",{class:"relative",onClick:e[2]||(e[2]=x(()=>{},["stop"])),onKeydown:H(f,["esc"])},[(s=r.value)!=null&&s.avatar_url||(i=r.value)!=null&&i._id||(c=t.seat)!=null&&c._id?(a(),n(V,{key:0},[(C=r.value)!=null&&C.avatar_url?(a(),n("img",{key:0,onClick:v,src:(B=r.value)==null?void 0:B.avatar_url,class:"w-6 h-6 rounded-full",alt:""},null,8,$)):(a(),n("div",{key:1,onClick:v,class:"w-6 aspect-square rounded-full text-[10px] font-semibold text-text-primary flex items-center justify-center",style:q({backgroundColor:k(r.value??t.seat)})},p(w(((F=r.value)==null?void 0:F.u_full_name)??((E=r.value)==null?void 0:E.title)??((L=t.seat)==null?void 0:L.title))),5))],64)):(a(),n("button",{key:1,type:"button",class:"inline-flex items-center gap-2 rounded-full border border-border px-1 py-1 text-xs bg-bg-dropdown cursor-pointer hover:bg-bg-dropdown-menu-hover transition",onClick:v,disabled:t.disabled},e[3]||(e[3]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 opacity-70",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2h6z"})],-1)]),8,G)),d.value?(a(),n("div",{key:2,class:"absolute right-0 z-50 mt-2 w-60 rounded-md border border-border bg-bg-dropdown shadow-xl",onClick:e[1]||(e[1]=x(()=>{},["stop"]))},[l("div",P,[J(l("input",{ref_key:"searchRef",ref:y,"onUpdate:modelValue":e[0]||(e[0]=o=>u.value=o),type:"text",placeholder:"Add people by name or email",class:"w-full rounded-md border border-border h-[30px] bg-bg-input px-3 outline-none text-xs"},null,512),[[O,u.value]])]),l("ul",Q,[(a(!0),n(V,null,T(h.value,o=>(a(),n("li",{key:o._id,onClick:x(ae=>j(o._id),["stop"]),class:"flex items-center justify-between px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer"},[l("div",Y,[o.avatar_url?(a(),n("img",{key:0,src:o.avatar_url,class:"w-8 h-8 rounded-full",alt:""},null,8,Z)):(a(),n("div",{key:1,class:"w-6 min-w-6 aspect-square rounded-full text-xs font-semibold text-text-primary flex items-center justify-center",style:q({backgroundColor:k(o)})},p(w(o.name||o.title)),5)),l("div",ee,[l("div",te,p(o.name||o.title),1),l("div",se,p(o.email),1)])])],8,X))),128)),h.value.length?U("",!0):(a(),n("li",oe,"No matches "))])])):U("",!0)],32)}}});export{ie as _};
