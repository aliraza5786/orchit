import{_ as R}from"./whitePlus-Cs_P7rE9.js";import{d as M,r as w,ar as S,p as B,h as o,b as a,t as l,F as g,v as h,i as v,e as r,g as m,w as u,B as x,o as i}from"./index-rFytiIBb.js";import{_ as D}from"./BaseTextField.vue_vue_type_script_setup_true_lang-BUI_Kz_I.js";import{_ as P}from"./BaseTextAreaField.vue_vue_type_script_setup_true_lang-CIvv4thi.js";import{_ as U}from"./BaseEmailChip.vue_vue_type_script_setup_true_lang-BMCU_Nvm.js";import{u as q}from"./workspace-C0mwNU9d.js";import"./info-DjaLHeD_.js";const F={class:"w-full pt-4"},J={class:"text-sm md:text-lg text-text-secondary"},O={class:"space-y-3 w-full pb-4"},G={class:"flex items-center justify-between mb-2"},H={class:"flex gap-4 items-center text-2xl justify-between w-full"},K={class:"flex flex-col text-text-primary text-lg font-semibold"},Q={key:0,class:"text-xl mr-2"},X={class:"text-sm text-text-secondary"},Y={class:"flex items-center gap-3 text-text-primary"},Z=["onClick"],ee={class:"text-lg"},te=["onClick"],se={class:"text-text-primary"},ae={class:"text-sm font-medium text-text-secondary mb-2 flex justify-between items-center gap-2.5"},ne={class:"flex items-center gap-2"},oe={class:"text-xs text-text-secondary"},ie={key:0,class:"text-sm text-text-secondary mb-3"},le={class:"text-sm font-medium capitalize"},pe={class:"text-xs text-text-secondary"},me=["onClick"],re={key:1,class:"mt-2 space-y-2"},ce={class:"flex items-center justify-end gap-2"},de={key:1,class:"bg-bg-surface mt-2 cursor-pointer rounded-xl p-6"},ue={class:"flex gap-2 mt-6 justify-end"},Ce=M({__name:"StepThree",props:{ai:{type:Boolean}},emits:["next","back"],setup(xe,{emit:_e}){const y=q(),_=w(!1),p=w({name:"",description:""}),f=S({roles:[]}),k=/^[^\s@]+@[^\s@]+\.[^\s@]+$/i,C=e=>k.test(e);function E(e){e.showInput=!0,e.capacityWarning=e.people.length>=e.max_num_people}function b(e){for(;e.people.length>e.max_num_people;)e.people.pop();e.capacityWarning=e.people.length>=e.max_num_people,c()}function j(e,s){e.people.some(t=>t.email.toLowerCase()===s.toLowerCase())||e.people.push({name:s.split("@")[0],email:s})}function I(e,s){const[t]=e.people.splice(s,1),n=e.emailList.findIndex(d=>d.toLowerCase()===t.email.toLowerCase());n!==-1&&e.emailList.splice(n,1),e.capacityWarning=e.people.length>=e.max_num_people,c()}function L(e,s){e.emailError=s.length?`Invalid: ${s.join(", ")}`:""}function V(e,s){s.forEach(t=>{C(t)&&(e.people.length<e.max_num_people?j(e,t):e.capacityWarning=!0)}),c()}function W(e,s){const t=e.people.findIndex(n=>n.email.toLowerCase()===s.toLowerCase());t!==-1&&e.people.splice(t,1),e.capacityWarning=e.people.length>=e.max_num_people,c()}function $(e){e.showInput=!1,e.capacityWarning=e.people.length>=e.max_num_people,c()}function N(e){e.showInput=!1,e.emailError="",e.capacityWarning=e.people.length>=e.max_num_people}function T(){const e={id:`role-${Date.now()}`,title:p.value.name,description:p.value.description,people:[],showInput:!1,max_num_people:1,role_emoji:"",emailList:[],emailError:"",capacityWarning:!1};f.roles.push(e),c(),p.value.name="",p.value.description="",_.value=!1}function c(){const e=y.workspace,s=e?JSON.parse(e):{variables:{roles:[]}};s.variables.roles=f.roles,y.setWorkspace(s)}B(()=>{try{const e=y.workspace;if(e){const s=e;f.roles=(s.variables.roles||[]).map(t=>{var n;return{...t,showInput:t.showInput??!1,emailList:t.emailList??((n=t.people)==null?void 0:n.map(d=>d.email))??[],emailError:"",capacityWarning:!1,max_num_people:typeof t.max_num_people=="number"?t.max_num_people:1,role_emoji:t.role_emoji??""}})}}catch(e){console.error("Error parsing workspace from localStorage",e)}});function A(e){e.max_num_people>1&&(e.max_num_people--,b(e))}function z(e){e.max_num_people++,b(e)}return(e,s)=>(i(),o(g,null,[a("div",F,[s[4]||(s[4]=a("h2",{class:"text-xl md:text-4xl font-semibold text-text-primary mb-1"},"Team Resources",-1)),a("p",J,l(e.ai?" AI-recommended team composition for your project":"Team composition for your project"),1)]),a("div",O,[(i(!0),o(g,null,h(f.roles,t=>(i(),o("div",{key:t.id,class:"bg-bg-surface rounded-xl p-6"},[a("div",G,[a("div",H,[a("div",K,[a("span",null,[t!=null&&t.role_emoji?(i(),o("span",Q,l(t.role_emoji),1)):v("",!0),r(" "+l(t.title),1)]),a("p",X,l(t.description),1)]),a("div",Y,[a("button",{onClick:n=>A(t),class:"w-8 h-8 aspect-square rounded-full bg-bg-card flex items-center justify-center text-xl"},"−",8,Z),a("span",ee,l(t.max_num_people),1),a("button",{onClick:n=>z(t),class:"w-8 h-8 aspect-square rounded-full bg-bg-card flex items-center justify-center text-xl"},"+",8,te)])])]),a("div",se,[a("p",ae,[s[6]||(s[6]=r(" Team Members ")),a("span",ne,[a("span",oe,l(t.people.length)+"/"+l(t.max_num_people),1),m(x,{size:"sm",variant:"secondary",onClick:n=>E(t),disabled:t.people.length>=t.max_num_people,title:"Add people by email"},{default:u(()=>s[5]||(s[5]=[r(" Add people ")])),_:2,__:[5]},1032,["onClick","disabled"])])]),t.people.length===0?(i(),o("div",ie," No team members assigned yet ")):v("",!0),(i(!0),o(g,null,h(t.people,(n,d)=>(i(),o("div",{key:d,class:"flex justify-between items-center mb-3"},[a("div",null,[a("p",le,l(n.name),1),a("p",pe,l(n.email),1)]),a("button",{onClick:fe=>I(t,d),class:"text-text-primary w-8 h-8 bg-bg-card rounded-md cursor-pointer"},"✕",8,me)]))),128)),t.showInput?(i(),o("div",re,[m(U,{modelValue:t.emailList,"onUpdate:modelValue":n=>t.emailList=n,error:!!t.emailError||t.capacityWarning,message:t.capacityWarning?`Reached role capacity (${t.max_num_people}).`:t.emailError||"Press Enter, comma, semicolon, or space to add. Invalid entries won’t be added.",showName:"",onInvalid:n=>L(t,n),onAdd:n=>V(t,n),onRemove:n=>W(t,n)},null,8,["modelValue","onUpdate:modelValue","error","message","onInvalid","onAdd","onRemove"]),a("div",ce,[m(x,{onClick:n=>$(t),variant:"primary"},{default:u(()=>s[7]||(s[7]=[r("Done")])),_:2,__:[7]},1032,["onClick"]),m(x,{onClick:n=>N(t),variant:"secondary"},{default:u(()=>s[8]||(s[8]=[r("Cancel")])),_:2,__:[8]},1032,["onClick"])])])):v("",!0)])]))),128)),_.value?(i(),o("div",de,[s[12]||(s[12]=a("h1",{class:"text-lg text-text-primary font-semibold"},"Add New Team",-1)),s[13]||(s[13]=a("br",null,null,-1)),m(D,{label:"Team Name",modelValue:p.value.name,"onUpdate:modelValue":s[1]||(s[1]=t=>p.value.name=t),placeholder:"Enter Team Name",size:"lg"},null,8,["modelValue"]),m(P,{label:"Description",class:"mt-4",modelValue:p.value.description,"onUpdate:modelValue":s[2]||(s[2]=t=>p.value.description=t),placeholder:"Enter Description",size:"lg"},null,8,["modelValue"]),a("div",ue,[m(x,{size:"md",variant:"primary",onClick:T},{default:u(()=>s[10]||(s[10]=[r(" Add Team ")])),_:1,__:[10]}),m(x,{size:"md",variant:"secondary",onClick:s[3]||(s[3]=t=>_.value=!1)},{default:u(()=>s[11]||(s[11]=[r("Cancel")])),_:1,__:[11]})])])):(i(),o("div",{key:0,class:"bg-bg-surface mt-2 cursor-pointer rounded-xl p-6 flex flex-col justify-center items-center",onClick:s[0]||(s[0]=t=>_.value=!0)},s[9]||(s[9]=[a("div",{class:"p-2.5 bg-accent w-8 h-8 rounded-full"},[a("img",{class:"w-3",src:R,alt:""})],-1),a("h3",{class:"font-medium text-text-primary capitalize text-sm mt-4"},"Add New Team",-1),a("p",{class:"text-[11px] text-text-secondary mt-1 text-start line-clamp-1"},"Create a custom resource type",-1)])))])],64))}});export{Ce as default};
