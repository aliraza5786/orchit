const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CreateTaskModal-DPK_4BUQ.js","assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-BXLrInBo.js","assets/index-BZn88Tk7.js","assets/index-BrDZX1sQ.css","assets/BaseModal-Lpve6HiZ.js","assets/cross-DvraoB0R.js","assets/BaseModal-FRlOKCB_.css","assets/BaseTextField.vue_vue_type_script_setup_true_lang-DmEZLbRb.js","assets/info-DjaLHeD_.js","assets/BaseSelectField.vue_vue_type_script_setup_true_lang-CfXGO0EQ.js","assets/KanbanSkeleton-Z7y0jmeQ.js","assets/index-BgzE4qkI.js","assets/KanbanSkeleton-D86JubvK.css","assets/useQueryParams-B2NYtDZ6.js","assets/BaseRichTextEditor-CM4BKY37.js","assets/useCommon-CYDrtqAj.js","assets/BaseRichTextEditor-5b2PDTLF.css","assets/DatePicker-BM62v5um.js","assets/DatePicker-CaK9YdY3.css","assets/ConfirmDeleteModal-BLfF8M4a.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-BDBc1WWg.js","assets/SidePanel-C1AsDbFL.js","assets/AssigmentDropdown.vue_vue_type_script_setup_true_lang-CYCBhx5V.js","assets/SwitchTab-D0sbUn_B.js","assets/SwitchTab-xAML-a-k.css","assets/SidePanel-fKwN4j-K.css","assets/KanbanBoard-B39BAdc-.js","assets/DropMenu.vue_vue_type_script_setup_true_lang-MsxGxSnx.js","assets/workspace-CuSgw95J.js","assets/KanbanBoard-DJX1cgam.css"])))=>i.map(i=>d[i]);
import{E as ie,G as R,J as ke,n as p,r as w,m as ee,K as ce,c as A,L as pe,d as de,i as F,e as s,g as le,y as me,b as te,h as M,B as se,w as P,f as U,t as q,T as Je,o as B,M as Ze,q as at,N as nt,z as Z,O as ye,P as Ie,_ as rt,j as ue,a as Qe,F as Ae,A as qe,Q as $e,R as Me,p as lt}from"./index-BZn88Tk7.js";import{u as We,a as it}from"./useQueryParams-B2NYtDZ6.js";import{B as Xe}from"./BaseModal-Lpve6HiZ.js";import{_ as dt}from"./BaseTextField.vue_vue_type_script_setup_true_lang-DmEZLbRb.js";import{u as ut,a as ct,b as pt,R as mt,c as ft,K as gt,D as vt}from"./KanbanSkeleton-Z7y0jmeQ.js";import{_ as Ye}from"./SearchBar.vue_vue_type_script_setup_true_lang-rZC85x-v.js";import{_ as bt}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-BDBc1WWg.js";import{D as Re}from"./DatePicker-BM62v5um.js";import{u as yt}from"./workspace-CuSgw95J.js";import"./cross-DvraoB0R.js";import"./info-DjaLHeD_.js";import"./index-BgzE4qkI.js";const et="data:image/svg+xml,%3csvg%20width='60'%20height='60'%20viewBox='0%200%2060%2060'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M9.375%2030C11.6402%2030%2013.4766%2028.1637%2013.4766%2025.8984C13.4766%2023.6332%2011.6402%2021.7969%209.375%2021.7969C7.10977%2021.7969%205.27344%2023.6332%205.27344%2025.8984C5.27344%2028.1637%207.10977%2030%209.375%2030Z'%20fill='%23AE2A19'/%3e%3cpath%20d='M26.25%2024.375C28.5152%2024.375%2030.3516%2022.5387%2030.3516%2020.2734C30.3516%2018.0082%2028.5152%2016.1719%2026.25%2016.1719C23.9848%2016.1719%2022.1484%2018.0082%2022.1484%2020.2734C22.1484%2022.5387%2023.9848%2024.375%2026.25%2024.375Z'%20fill='%23BF63F3'/%3e%3cpath%20d='M15.3931%2035.8594H11.0159V33.0938C9.93587%2033.3387%208.81469%2033.3387%207.73465%2033.0938V35.8594H1.87528C1.55115%2035.8601%201.2345%2035.9568%200.965283%2036.1373C0.696064%2036.3178%200.486343%2036.574%200.362583%2036.8736C0.238824%2037.1731%200.206573%2037.5027%200.269899%2037.8205C0.333226%2038.1384%200.489292%2038.4304%200.718404%2038.6597L7.05872%2045L0.718404%2051.3403C0.489292%2051.5696%200.333226%2051.8616%200.269899%2052.1795C0.206573%2052.4973%200.238824%2052.8269%200.362583%2053.1264C0.486343%2053.426%200.696064%2053.6822%200.965283%2053.8627C1.2345%2054.0432%201.55115%2054.1399%201.87528%2054.1406H15.3931L21.7503%2045L15.3931%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M34.4562%2035.8594H27.8937V27.4688C26.8137%2027.7138%2025.6925%2027.7138%2024.6125%2027.4688V35.8594H19.3896L25.7487%2045L19.3896%2054.1406H34.4562L40.8143%2045L34.4562%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M43.8281%2019.6875H55.3125C55.7475%2019.6873%2056.1647%2019.5143%2056.4723%2019.2067C56.7799%2018.8991%2056.9529%2018.4819%2056.9531%2018.0469V9.375C56.9529%208.93996%2056.7799%208.5228%2056.4723%208.21518C56.1647%207.90755%2055.7475%207.73462%2055.3125%207.73438H43.8281V7.5C43.8281%207.06488%2043.6553%206.64758%2043.3476%206.3399C43.0399%206.03223%2042.6226%205.85938%2042.1875%205.85938C41.7524%205.85938%2041.3351%206.03223%2041.0274%206.3399C40.7197%206.64758%2040.5469%207.06488%2040.5469%207.5V32.5781H43.8281V19.6875Z'%20fill='%23FCA700'/%3e%3cpath%20d='M59.2843%2043.8403L51.7843%2036.3403C51.6322%2036.1878%2051.4514%2036.0668%2051.2524%2035.9842C51.0534%2035.9017%2050.8401%2035.8593%2050.6246%2035.8594H38.4521L44.8121%2045L38.4531%2054.1406H50.6246C50.8401%2054.1407%2051.0534%2054.0983%2051.2524%2054.0158C51.4514%2053.9332%2051.6322%2053.8122%2051.7843%2053.6597L59.2843%2046.1597C59.4368%2046.0075%2059.5577%2045.8267%2059.6402%2045.6277C59.7228%2045.4287%2059.7652%2045.2154%2059.7652%2045C59.7652%2044.7846%2059.7228%2044.5713%2059.6402%2044.3723C59.5577%2044.1733%2059.4368%2043.9925%2059.2843%2043.8403Z'%20fill='%2382B536'/%3e%3c/g%3e%3c/svg%3e",kt="data:image/svg+xml,%3csvg%20width='60'%20height='46'%20viewBox='0%200%2060%2046'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M59.7443%2034.8967L50.5682%2025.7206C50.4457%2025.5984%2050.2897%2025.5152%2050.1199%2025.4816C49.9501%2025.4479%2049.7742%2025.4653%2049.6143%2025.5315C49.4544%2025.5976%2049.3176%2025.7097%2049.2213%2025.8535C49.125%2025.9973%2049.0734%2026.1664%2049.073%2026.3394V30.517H25.9775V40.5114H49.0755V44.689C49.0759%2044.8621%2049.1275%2045.0312%2049.2238%2045.175C49.3201%2045.3187%2049.4569%2045.4308%2049.6168%2045.497C49.7767%2045.5632%2049.9527%2045.5805%2050.1224%2045.5468C50.2922%2045.5132%2050.4482%2045.43%2050.5708%2045.3078L59.7468%2036.1318C59.9095%2035.9672%2060.0005%2035.7451%2060.0001%2035.5137C59.9996%2035.2823%2059.9076%2035.0605%2059.7443%2034.8967Z'%20fill='%23C6DBA9'/%3e%3cpath%20d='M32.3149%2030.5293C30.664%2031.5967%2028.7394%2032.1633%2026.7734%2032.1609V40.5237H34.7295C39.2829%2038.5638%2042.9649%2035.0102%2045.0851%2030.5293H32.3149Z'%20fill='url(%23paint0_linear_250_16424)'/%3e%3cpath%20d='M46.2209%2020.2832C46.2317%2015.0884%2044.2448%2010.0884%2040.6714%206.3179C37.0981%202.54738%2032.2119%200.295026%2027.024%200.0269855C21.8362%20-0.241055%2016.7439%201.49574%2012.801%204.87791C8.85809%208.26009%206.36647%2013.0287%205.84178%2018.1969L2.46233%2017.8913C2.31055%2017.8782%202.15829%2017.9103%202.02467%2017.9835C1.89106%2018.0566%201.78205%2018.1677%201.71134%2018.3026C1.64063%2018.4376%201.61138%2018.5904%201.62726%2018.7419C1.64313%2018.8934%201.70343%2019.0368%201.80058%2019.1542L9.51927%2028.406C9.79205%2028.7344%2010.277%2028.7773%2010.378%2028.5045L19.6298%2020.7833C20.3876%2020.3413%2020.1173%2019.4825%2019.4328%2019.4194L15.8008%2019.091C16.0297%2017.1283%2016.8213%2015.2735%2018.0802%2013.7503C19.3391%2012.2271%2021.0115%2011.1004%2022.8961%2010.5059C24.7806%209.9114%2026.7969%209.8745%2028.7019%2010.3996C30.6069%2010.9248%2032.3195%2011.9896%2033.6332%2013.4657C34.947%2014.9419%2035.8059%2016.7664%2036.1065%2018.7195C36.4071%2020.6726%2036.1365%2022.6709%2035.3274%2024.4738C34.5183%2026.2766%2033.2051%2027.8071%2031.5462%2028.8807C29.8872%2029.9544%2027.9531%2030.5254%2025.977%2030.5251H25.9283V40.5094C31.2249%2040.4031%2036.7093%2038.2263%2040.4202%2034.4455C44.1311%2030.6648%2046.2134%2025.5808%2046.2209%2020.2832Z'%20fill='%23D7A39E'/%3e%3cpath%20d='M25.9773%2030.5293H0V40.5237H25.9773V30.5293Z'%20fill='url(%23paint1_linear_250_16424)'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_250_16424'%20x1='6.53714'%20y1='35.5252'%20x2='47.0198'%20y2='35.5252'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%236C798F'/%3e%3cstop%20offset='1'%20stop-color='%236C798F'%20stop-opacity='0.1'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_250_16424'%20x1='0'%20y1='36'%20x2='26'%20y2='36'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23E8D4D3'%20stop-opacity='0'/%3e%3cstop%20offset='1'%20stop-color='%23E2A39F'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",xt=(r,a={})=>ke({queryKey:["sprint-list"],queryFn:({signal:g})=>R({url:`sprints/${r}`,method:"GET",signal:g}),...a}),St=(r,a={})=>ke({queryKey:["sprint-cards",r],queryFn:({signal:g})=>R({url:`sprints/${p(r)}/backlog`,method:"GET",signal:g}),...a}),Ct=(r,a={})=>ke({queryKey:["sprint-kanban",r],queryFn:({signal:g})=>R({url:`workspace/cards/sprintgrouped?sprint_id=${p(r)}&variable_id=68b6c96e0a95eef7d14e6981`,method:"GET",signal:g}),...a}),_t=(r,a={})=>ie({key:["sprint-complete"]},{mutationFn:g=>R({url:`sprints/${p(r)}/complete`,method:"POST",data:g.payload}),...a}),wt=(r,a={})=>ke({queryKey:["sprint-detail",r],queryFn:({signal:g})=>R({url:`sprints/detail/${p(r)}?include_cards=true`,method:"GET",signal:g}),...a}),tt=(r,a={})=>ke({queryKey:["backlog-list",r],queryFn:({signal:g})=>R({url:`sprints/workspace/${p(r)}/cards?include_sprint_cards=false`,method:"GET",signal:g}),...a}),ht=(r={})=>ie({key:["add-sprint"]},{mutationFn:a=>R({url:"/sprints",method:"POST",data:a.payload}),...r}),st=(r={})=>ie({key:["move-card-to-sprint"]},{mutationFn:a=>R({url:`/sprints/${a.id}/cards`,method:"POST",data:a.payload}),...r}),Ke=(r={})=>ie({key:["add-sprint"]},{mutationFn:a=>R({url:`/sprints/${a.id}`,method:"PUT",data:a.payload}),...r}),Tt=(r={})=>ie({key:["start-sprint"]},{mutationFn:a=>R({url:`/sprints/${a.id}/start`,method:"POST",data:a.payload}),...r}),Dt=(r={})=>ie({key:["delete-sprint"]},{mutationFn:a=>R({url:`/sprints/${a}`,method:"DELETE"}),...r}),Vt=(r={})=>ie({key:["remove-card-from-sprint"]},{mutationFn:a=>R({url:`sprints/${p(a.sprintId)}/cards/remove `,method:"POST",data:{card_ids:[a.cardId]}}),...r}),ot="jira-like:";function je(r="id"){return`${r}_${Math.random().toString(36).slice(2,9)}`}function ze(r,a){try{localStorage.setItem(ot+r,JSON.stringify(a))}catch{}}function Ge(r,a){try{const g=localStorage.getItem(ot+r);return g?JSON.parse(g):a}catch{return a}}function Ue(r){switch(r){case"Highest":return"rounded-md bg-red-50 px-2 py-0.5 text-xs text-red-700";case"High":return"rounded-md bg-orange-50 px-2 py-0.5 text-xs text-orange-700";case"Medium":return"rounded-md bg-amber-50 px-2 py-0.5 text-xs text-amber-700";case"Low":return"rounded-md bg-gray-100 px-2 py-0.5 text-xs text-gray-600"}}function He(){const r=w(Ge("backlog",[])),a=w(Ge("sprints",[]));if(a.value.length===0)a.value.push({id:je("sprint"),name:"Sprint 1",goal:"",start:"",end:"",started:!1,tickets:[]});else if(a.value.length>1){for(let o=1;o<a.value.length;o++)r.value.push(...a.value[o].tickets);a.value=[a.value[0]]}const g=w(a.value[0].id);ee([r,a],()=>{ze("backlog",r.value),ze("sprints",a.value)},{deep:!0});const h=w([]),x=ce({}),i=A(()=>r.value.length>0&&h.value.length===r.value.length),b=o=>{var t;const e=a.value.find(n=>n.id===o);return!!e&&e.tickets.length>0&&(((t=x[o])==null?void 0:t.length)||0)===e.tickets.length};function S(o,e,t){const n=e.target.checked;if(o==="backlog")h.value=n?r.value.map(k=>k.id):[];else if(t){const k=a.value.find(f=>f.id===t);x[t]=n&&k?k.tickets.map(f=>f.id):[]}}function D(o,e,t,n){const k=t.target.checked,f=o==="backlog"?h.value:x[n]||(x[n]=[]);if(k&&!f.includes(e)&&f.push(e),!k){const K=f.indexOf(e);K>=0&&f.splice(K,1)}}function m(){return a.value.find(o=>o.id===g.value)||a.value[0]}function d(){const e=[...r.value,...a.value.flatMap(n=>n.tickets)].map(n=>Number(String(n.key).replace(/[^0-9]/g,""))).filter(n=>!Number.isNaN(n));return`PRJ-${e.length?Math.max(...e)+1:1}`}const{mutate:c}=st({onSuccess:()=>{pe.success("Cards moved to sprint successfully")},onError:o=>{pe.error("Failed to move cards: "+(o.message||"Unknown error"))}});function T(){var n,k;const o=m();if(!o||!h.value.length)return;const e=[],t=[];for(const f of r.value)(h.value.includes(f.id)?t:e).push(f);r.value=e,o.tickets.push(...t),h.value=[],t.length>0&&c({id:o.id,payload:{card_ids:t.map(f=>f.id),priority:((k=(n=t[0])==null?void 0:n.priority)==null?void 0:k.toLowerCase())||"medium",story_points:t.reduce((f,K)=>f+(K.storyPoints||0),0)}})}function C(o){const e=a.value.find(f=>f.id===o);if(!e)return;const t=x[o]||[],n=[],k=[];for(const f of e.tickets)(t.includes(f.id)?k:n).push(f);e.tickets=n,r.value.push(...k),x[o]=[]}function $(o,e){if(o==="backlog")r.value=r.value.filter(t=>!h.value.includes(t.id)),h.value=[];else if(e){const t=x[e]||[],n=a.value.find(k=>k.id===e);if(!n)return;n.tickets=n.tickets.filter(k=>!t.includes(k.id)),x[e]=[]}}function H(o,e){const t={id:je("T"),key:d(),createdAt:new Date().toISOString(),...e};if(o==="backlog")r.value.push(t);else{const n=m();n==null||n.tickets.push(t)}}function y(o){const e=m();e&&(e.name=o.name??e.name,e.goal=o.goal??e.goal,e.start=o.start??e.start,e.end=o.end??e.end)}function _(){const o=m();o&&(o.started=!o.started)}function O(o){return o.tickets.reduce((e,t)=>e+(t.storyPoints||0),0)}return{backlog:r,sprints:a,activeSprintId:g,selectedBacklogIds:h,selectedSprintIds:x,allBacklogChecked:i,allSprintChecked:b,toggleAll:S,toggleOne:D,getActiveSprint:m,createTicket:H,saveSprintMeta:y,toggleStartSprint:_,sprintPoints:O,moveSelectedToSprint:T,moveSelectedToBacklog:C,deleteSelected:$,priorityClass:Ue}}const $t={class:"space-y-3 flex flex-col overflow-y-auto"},Mt={key:0,class:"empty-state flex flex-col justify-center items-center h-full"},Pt=["checked"],Bt=["checked","onChange"],Lt={class:"flex items-center gap-2"},Ot={class:"inline-block rounded-full border px-2 py-0.5 text-xs"},Et={class:"truncate"},At=["onDragstart"],Ut=de({__name:"BacklogTable",props:{sorters:{}},emits:["ticket-dragged-to-sprint","open-ticket","ticket-moved-to-backlog"],setup(r,{emit:a}){const g=a,{workspaceId:h}=We(),{data:x,isPending:i}=tt(h),b=w([]);ee(x,o=>{o!=null&&o.cards&&(b.value=o.cards.map(e=>{var K,G,N,oe,j;const t=((K=e.card)==null?void 0:K.variables)??{},n=((G=e.card)==null?void 0:G._id)??e.card_id,k=String(t["card-status"]??"").trim(),f=String(t.priority??"").trim();return{id:n,key:t["card-code"]||(n==null?void 0:n.slice(-6))||"PRJ-?",summary:t["card-title"]||"(untitled)",type:"Story",status:S(k),assignee:((oe=(N=e.card)==null?void 0:N.assigned_to)==null?void 0:oe.name)??"Unassigned",storyPoints:Number(e.story_points??0)||0,priority:D(f),createdAt:((j=e.card)==null?void 0:j.created_at)??new Date().toISOString(),description:t["card-description"]||""}}))},{immediate:!0});function S(o){const e=o.toLowerCase();return e.includes("progress")?"In Progress":e.includes("done")||e.includes("complete")?"Done":"Todo"}function D(o){const e=String(o??"").toLowerCase();return e==="highest"||e==="blocker"||e==="critical"?"Highest":e==="high"||e==="major"?"High":e==="medium"||e==="normal"?"Medium":"Low"}const{selectedBacklogIds:m,allBacklogChecked:d,toggleAll:c,toggleOne:T}=He(),C=w(!1),$=w(null);function H(o,e,t){var k;$.value=e.id;const n=JSON.stringify({id:e.id,from:t,ticket:e});(k=o.dataTransfer)==null||k.setData("text/plain",n),o.dataTransfer&&(o.dataTransfer.effectAllowed="move")}function y(o){var e;C.value=!1,((e=o.dataTransfer)==null?void 0:e.dropEffect)!=="none"&&$.value&&(b.value=b.value.filter(t=>t.id!==$.value)),$.value=null}function _(o){var e;o.preventDefault(),C.value=!1;try{const t=(e=o.dataTransfer)==null?void 0:e.getData("text/plain");if(!t)return;const n=JSON.parse(t);if(n.from!=="sprint"||b.value.some(f=>f.id===n.id))return;b.value.push(n.ticket),g("ticket-moved-to-backlog",n.id,n.sprintId)}catch(t){console.error("Drop error:",t)}}const O=A(()=>[{key:"select",label:"",width:36},{key:"summary",label:"Summary",sortable:!1},{key:"status",label:"Status",width:120,sortable:!1},{key:"assignee",label:"",width:120,sortable:!1}]);return(o,e)=>(B(),F("section",$t,[s("div",{class:me(["rounded-lg border h-[300px] border-border flex flex-col",C.value?"ring-2 ring-blue-400":""]),onDragover:e[5]||(e[5]=le(()=>{},["prevent"])),onDragenter:e[6]||(e[6]=t=>C.value=!0),onDragleave:e[7]||(e[7]=t=>C.value=!1),onDrop:e[8]||(e[8]=t=>_(t))},[!p(i)&&b.value.length===0?(B(),F("div",Mt,[e[10]||(e[10]=s("img",{src:kt,class:"mb-4",alt:"backlog-plan"},null,-1)),e[11]||(e[11]=s("h6",{class:"text-sm text-text-primary font-semibold mb-1"},"Get started in the backlog",-1)),e[12]||(e[12]=s("p",{class:"text-sm text-text-primary/90 mb-3"},"Plan and start a sprint to see issues here.",-1)),M(se,null,{default:P(()=>e[9]||(e[9]=[U("Add Task Backlog")])),_:1,__:[9]})])):(B(),te(Je,{key:1,showHeader:!1,pagination:!1,class:"flex-grow h-full",rowDraggable:!0,onRowDragstart:e[2]||(e[2]=({row:t,$event:n})=>H(n,t,"backlog")),onRowDragend:e[3]||(e[3]=({$event:t})=>y(t)),columns:O.value,rows:b.value,"page-size":20,hover:!0,striped:"",itemKey:t=>t.id,sorters:o.sorters,onRowClick:e[4]||(e[4]=({row:t})=>o.$emit("open-ticket",t))},{"select-header":P(()=>[s("input",{type:"checkbox",checked:p(d),onChange:e[0]||(e[0]=t=>p(c)("backlog",t))},null,40,Pt)]),select:P(({row:t})=>[s("input",{type:"checkbox",checked:p(m).includes(t.id),onChange:n=>p(T)("backlog",t.id,n)},null,40,Bt)]),summary:P(({row:t})=>[s("div",Lt,[s("span",Ot,q(t.key),1),s("span",Et,q(t.summary),1)])]),priority:P(({row:t})=>[s("span",{class:me(p(Ue)(t.priority))},q(t.priority),3)]),drag:P(({row:t})=>[s("button",{class:"cursor-grab",title:"Drag to Sprint",draggable:"",onClick:e[1]||(e[1]=le(()=>{},["stop"])),onDragstart:n=>H(n,t,"backlog"),onDragend:y},"↕",40,At)]),_:1},8,["columns","rows","itemKey","sorters"]))],34)]))}}),Ht={class:"rounded-lg flex flex-col"},Ft=["checked"],Nt=["checked","onChange"],It={class:"flex items-center gap-2"},qt={class:"inline-block rounded-full border px-2 py-0.5 text-xs"},Rt={class:"truncate"},Kt=["onDragstart"],jt={key:1,class:"empty-state flex flex-col h-full justify-center items-center border-dashed border border-border"},zt=de({__name:"SprintCard",props:{sprint:{},sprintId:{}},emits:["edit-sprint","toggle-start","open-ticket","move-selected-to-backlog","delete-selected-sprint","refresh"],setup(r,{emit:a}){const g=r,h=a,x=He(),{selectedSprintIds:i,allSprintChecked:b,toggleAll:S,toggleOne:D}=x,m=w([]);ee(()=>g.sprint.tickets,o=>{m.value=[...o||[]]},{immediate:!0,deep:!0});const d=w(!1),c=w(null),{mutate:T}=st({onSuccess:()=>{pe.success("Card moved to sprint successfully"),h("refresh")},onError:o=>{pe.error("Failed to move card: "+(o.message||"Unknown error"))}});function C(o,e,t,n){var f;c.value=e.id;const k=JSON.stringify({id:e.id,from:t,sprintId:n,ticket:e});(f=o.dataTransfer)==null||f.setData("text/plain",k),o.dataTransfer&&(o.dataTransfer.effectAllowed="move")}function $(o){var e;d.value=!1,((e=o.dataTransfer)==null?void 0:e.dropEffect)!=="none"&&c.value&&(m.value=m.value.filter(t=>t.id!==c.value)),c.value=null}function H(){d.value=!0}function y(){d.value=!1}function _(o){var e;o.preventDefault(),d.value=!1;try{const t=(e=o.dataTransfer)==null?void 0:e.getData("text/plain");if(!t)return;const n=JSON.parse(t);if(n.from!=="backlog"||m.value.some(f=>f.id===n.id))return;m.value.push(n.ticket),T({id:g.sprintId,payload:{card_ids:[n.ticket.id],priority:n.ticket.priority.toLowerCase(),story_points:n.ticket.storyPoints||0}})}catch(t){console.error("Drop error:",t)}}const O=[{key:"select",label:"",width:36},{key:"summary",label:"Summary",sortable:!0},{key:"status",label:"Status",width:120,sortable:!0},{key:"assignee",label:"Assignee",width:120,sortable:!0}];return(o,e)=>(B(),F("div",Ht,[s("div",{class:me(["h-[300px]",d.value?"ring-2 ring-blue-400 rounded-lg":""]),onDragover:e[5]||(e[5]=le(()=>{},["prevent"])),onDragenter:H,onDragleave:y,onDrop:_},[m.value.length>0?(B(),te(Je,{key:0,showHeader:!1,pagination:!1,"row-draggable":!0,class:"h-full",onRowDragstart:e[2]||(e[2]=({row:t,$event:n})=>C(n,t,"sprint",o.sprint.id)),onRowDragend:e[3]||(e[3]=({$event:t})=>$(t)),columns:O,rows:m.value,"page-size":100,hover:!0,striped:"","item-key":t=>t.id,onRowClick:e[4]||(e[4]=({row:t})=>o.$emit("open-ticket",t))},{"select-header":P(()=>[s("input",{type:"checkbox",checked:p(b)(o.sprint.id),onChange:e[0]||(e[0]=t=>p(S)("sprint",t,o.sprint.id))},null,40,Ft)]),select:P(({row:t})=>[s("input",{type:"checkbox",checked:(p(i)[o.sprint.id]||[]).includes(t.id),onChange:n=>p(D)("sprint",t.id,n,o.sprint.id)},null,40,Nt)]),summary:P(({row:t})=>[s("div",It,[s("span",qt,q(t.key),1),s("span",Rt,q(t.summary),1)])]),priority:P(({row:t})=>[s("span",{class:me(p(Ue)(t.priority))},q(t.priority),3)]),drag:P(({row:t})=>[s("button",{class:"cursor-grab",title:"Drag to Backlog",draggable:"",onClick:e[1]||(e[1]=le(()=>{},["stop"])),onDragstart:n=>C(n,t,"sprint",o.sprint.id),onDragend:$},"↕",40,Kt)]),_:1},8,["rows","item-key"])):(B(),F("div",jt,e[6]||(e[6]=[Ze('<img src="'+et+'" class="mb-4" alt="backlog-plan"><h6 class="text-sm text-text-primary font-semibold mb-1 text-center">Plan your sprint</h6><p class="text-sm text-text-primary/90 mb-3 max-w-120 text-center">Drag work items from the <span class="font-bold"> Backlog </span> section or create new ones to plan the work for this sprint. Select <span class="font-bold">Start sprint</span> when you&#39;re ready.</p>',3)])))],34)]))}}),Gt={class:"text-lg font-semibold"},Jt={class:"grid grid-cols-1 gap-3"},Zt={class:"space-y-1"},Qt={class:"grid grid-cols-2 gap-3"},Wt={class:"space-y-1"},Xt={class:"space-y-1"},Yt={class:"grid grid-cols-2 gap-3"},es={class:"space-y-1"},ts={class:"space-y-1"},ss={class:"space-y-1"},os=de({__name:"TicketModal",props:{modelValue:{type:Boolean},editing:{type:Boolean},ticket:{}},emits:["update:modelValue","save","close"],setup(r,{emit:a}){const g=r,h=a,x=w(),i=ce({type:"Story",priority:"Medium",storyPoints:1,status:"Todo"});function b(){var m;(m=x.value)==null||m.showModal()}function S(){var m;(m=x.value)==null||m.close(),h("update:modelValue",!1)}ee(()=>g.modelValue,m=>{m?b():S()}),ee(()=>g.ticket,m=>{Object.assign(i,{summary:"",type:"Story",priority:"Medium",storyPoints:1,status:"Todo",assignee:"",description:""}),m&&Object.assign(i,m)});function D(){var m;(m=i.summary)!=null&&m.trim()&&(h("save",{...i}),S())}return at(()=>{g.modelValue&&b()}),nt(S),(m,d)=>(B(),F("dialog",{ref_key:"dlg",ref:x,class:"modal",onClose:d[7]||(d[7]=c=>m.$emit("close"))},[s("form",{method:"dialog",class:"modal-box max-w-lg space-y-4",onSubmit:d[6]||(d[6]=le(()=>{},["prevent"]))},[s("h3",Gt,q(m.editing?"Edit":"Create")+" Ticket",1),s("div",Jt,[s("label",Zt,[d[8]||(d[8]=s("span",{class:"text-sm"},"Summary",-1)),Z(s("input",{"onUpdate:modelValue":d[0]||(d[0]=c=>i.summary=c),class:"w-full rounded-md border px-3 py-2",placeholder:"As a user, I want…"},null,512),[[ye,i.summary]])]),s("div",Qt,[s("label",Wt,[d[10]||(d[10]=s("span",{class:"text-sm"},"Type",-1)),Z(s("select",{"onUpdate:modelValue":d[1]||(d[1]=c=>i.type=c),class:"w-full rounded-md border px-3 py-2"},d[9]||(d[9]=[s("option",null,"Story",-1),s("option",null,"Bug",-1),s("option",null,"Task",-1)]),512),[[Ie,i.type]])]),s("label",Xt,[d[12]||(d[12]=s("span",{class:"text-sm"},"Priority",-1)),Z(s("select",{"onUpdate:modelValue":d[2]||(d[2]=c=>i.priority=c),class:"w-full rounded-md border px-3 py-2"},d[11]||(d[11]=[s("option",null,"Highest",-1),s("option",null,"High",-1),s("option",null,"Medium",-1),s("option",null,"Low",-1)]),512),[[Ie,i.priority]])])]),s("div",Yt,[s("label",es,[d[13]||(d[13]=s("span",{class:"text-sm"},"Story Points",-1)),Z(s("input",{type:"number",min:"0","onUpdate:modelValue":d[3]||(d[3]=c=>i.storyPoints=c),class:"w-full rounded-md border px-3 py-2"},null,512),[[ye,i.storyPoints,void 0,{number:!0}]])]),s("label",ts,[d[14]||(d[14]=s("span",{class:"text-sm"},"Assignee",-1)),Z(s("input",{"onUpdate:modelValue":d[4]||(d[4]=c=>i.assignee=c),class:"w-full rounded-md border px-3 py-2",placeholder:"Unassigned"},null,512),[[ye,i.assignee]])])]),s("label",ss,[d[15]||(d[15]=s("span",{class:"text-sm"},"Description",-1)),Z(s("textarea",{"onUpdate:modelValue":d[5]||(d[5]=c=>i.description=c),class:"w-full rounded-md border px-3 py-2",rows:"3"},null,512),[[ye,i.description]])])]),s("div",{class:"modal-action"},[s("button",{type:"button",class:"rounded-md border px-3 py-1.5",onClick:S},"Cancel"),s("button",{type:"button",class:"rounded-md bg-blue-600 px-3 py-1.5 text-white",onClick:D},"Save")])],32)],544))}}),as=rt(os,[["__scopeId","data-v-124bfadf"]]),ns={class:"px-6 gap-4"},rs={class:"flex justify-end gap-2 p-6 mt-8 sticky bottom-0 bg-bg-body border-t border-border"},ls=de({__name:"SprintModal",props:{modelValue:{type:Boolean,default:!1},sprint:{},creatingSprint:{type:Boolean}},emits:["update:modelValue","save","close"],setup(r,{emit:a}){const g=a,h=r,x=A({get:()=>h.modelValue,set:T=>g("update:modelValue",T)}),i=ce({name:""}),b=ce({name:!1}),S=A(()=>b.name&&!String(i.name||"").trim()?"Name is required":""),D=A(()=>!!String(i.name||"").trim()&&!S.value);function m(){x.value=!1,g("close")}function d(){b.name=!0,D.value&&g("save",{name:String(i.name||"").trim()})}function c(){b.name=!1}return ee(()=>h.sprint,T=>{if(!T){i.name="";return}i.name=T.name??(T==null?void 0:T.title)??"",c()},{immediate:!0}),(T,C)=>(B(),te(Xe,{modelValue:x.value,"onUpdate:modelValue":C[2]||(C[2]=$=>x.value=$),modalClass:"!py-0",size:"md"},{default:P(()=>[C[5]||(C[5]=s("div",{class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-body pb-4 mb-4"},[s("h2",{class:"text-xl font-semibold"},"Add Sprint"),s("p",{class:"text-sm text-text-secondary mt-1"},[U(" Add sprint name and then click "),s("span",{class:"font-medium"},"Save"),U(". ")])],-1)),s("div",ns,[M(dt,{modelValue:i.name,"onUpdate:modelValue":C[0]||(C[0]=$=>i.name=$),label:"Name",placeholder:"Sprint 1",error:!!S.value,message:S.value,onBlur:C[1]||(C[1]=$=>b.name=!0)},null,8,["modelValue","error","message"]),C[3]||(C[3]=s("div",null,null,-1))]),s("div",rs,[M(se,{variant:"secondary",onClick:m},{default:P(()=>C[4]||(C[4]=[U("Cancel")])),_:1,__:[4]}),M(se,{variant:"primary",disabled:!D.value,onClick:d},{default:P(()=>[U(q(T.creatingSprint?"Saving...":"Save"),1)]),_:1},8,["disabled"])])]),_:1,__:[5]},8,["modelValue"]))}}),is={class:"px-6 grid grid-cols-2 gap-4"},ds={class:"flex gap-1 flex-col"},us={key:0,class:"text-xs text-red-500"},cs={class:"flex gap-1 flex-col"},ps={key:0,class:"text-xs text-red-500"},ms={class:"flex flex-col col-span-2"},fs={class:"flex justify-end gap-2 p-6 mt-8 sticky bottom-0 bg-bg-body border-t border-border"},gs=de({__name:"StartSprintModal",props:{modelValue:{type:Boolean,default:!1},sprint:{}},emits:["update:modelValue","save","close"],setup(r,{emit:a}){const g=a,h=r,x=A({get:()=>h.modelValue,set:y=>g("update:modelValue",y)}),i=ce({goal:"",start:"",end:""});ee(()=>h.sprint,y=>{y&&(i.goal=y.goal??"",i.start=y.start??"",i.end=y.end??"",$())},{immediate:!0});const b=ce({start:!1,end:!1}),S=A(()=>""),D=A(()=>{if(!b.end)return"";if(i.start&&i.end){const y=H(i.start),_=H(i.end);if(Number.isFinite(y)&&Number.isFinite(_)&&_<y)return"End date cannot be before start date"}return""}),m=A(()=>!D.value);function d(y){i.start=y||"",b.start=!0}function c(y){i.end=y||"",b.end=!0}function T(){x.value=!1,g("close")}function C(){b.start=!0,b.end=!0,m.value&&g("save",{goal:i.goal??"",start:i.start||"",end:i.end||""})}function $(){b.start=!1,b.end=!1}function H(y){return y?new Date(`${y}T00:00:00`).getTime():NaN}return(y,_)=>(B(),te(Xe,{modelValue:x.value,"onUpdate:modelValue":_[1]||(_[1]=O=>x.value=O),modalClass:"!py-0",size:"md"},{default:P(()=>[_[7]||(_[7]=s("div",{class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-body pb-4 mb-4"},[s("h2",{class:"text-xl font-semibold"},"Start Sprint"),s("p",{class:"text-sm text-text-secondary mt-1"},[U(" Update sprint name, goal, and dates, then click "),s("span",{class:"font-medium"},"Start"),U(". ")])],-1)),s("div",is,[s("div",ds,[_[2]||(_[2]=s("label",{class:"text-sm"},"Start date",-1)),s("div",{class:me(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",S.value?"border-red-500":""])},[M(Re,{placeholder:"Set start date",class:"w-full","model-value":i.start,"emit-as":"ymd","onUpdate:modelValue":d},null,8,["model-value"])],2),S.value?(B(),F("p",us,q(S.value),1)):ue("",!0)]),s("div",cs,[_[3]||(_[3]=s("label",{class:"text-sm"},"End date",-1)),s("div",{class:me(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",D.value?"border-red-500":""])},[M(Re,{placeholder:"Set end date",class:"w-full","model-value":i.end,"emit-as":"ymd","onUpdate:modelValue":c},null,8,["model-value"])],2),D.value?(B(),F("p",ps,q(D.value),1)):ue("",!0)]),s("div",ms,[_[4]||(_[4]=s("label",{class:"text-sm"},"Goal (optional)",-1)),Z(s("textarea",{"onUpdate:modelValue":_[0]||(_[0]=O=>i.goal=O),class:"w-full rounded-lg border border-border px-3 py-2 bg-bg-input",rows:"2",placeholder:"Ship onboarding flow"},null,512),[[ye,i.goal]])])]),s("div",fs,[M(se,{variant:"secondary",onClick:T},{default:P(()=>_[5]||(_[5]=[U("Cancel")])),_:1,__:[5]}),M(se,{variant:"primary",disabled:!m.value,onClick:C},{default:P(()=>_[6]||(_[6]=[U("Start")])),_:1,__:[6]},8,["disabled"])])]),_:1,__:[7]},8,["modelValue"]))}}),vs={class:"flex-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur rounded-2xl shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] flex-grow h-full bg-bg-card border border-border overflow-x-auto flex-col flex"},bs={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},ys={class:"flex gap-3 items-center"},ks={class:"flex overflow-x-auto gap-3 p-4"},xs={key:0,class:"mx-auto text-text-secondary/80 m-2 w-[90%] h-full justify-center flex items-center border border-dashed border-border"},Ss=de({__name:"ActiveSprint",props:{sptint_id:{}},setup(r){const a=r,g=$e(()=>Me(()=>import("./CreateTaskModal-DPK_4BUQ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]))),h=$e(()=>Me(()=>import("./ConfirmDeleteModal-BLfF8M4a.js"),__vite__mapDeps([19,20,2,3,4,5,6]))),x=$e(()=>Me(()=>import("./SidePanel-C1AsDbFL.js"),__vite__mapDeps([21,2,3,14,15,9,8,7,16,10,11,12,17,18,22,13,23,24,25]))),i=$e(()=>Me(()=>import("./KanbanBoard-B39BAdc-.js"),__vite__mapDeps([26,2,3,17,18,10,11,12,27,20,4,5,6,22,13,28,29]))),b=lt(),{workspaceId:S,moduleId:D}=it(),{data:m}=ut(S.value,D.value),d=Qe(),{mutate:c,isPending:T}=ct({onSuccess:()=>{d.invalidateQueries({queryKey:["sheet-list"]}),Se.value="",Q.value=!1,Le.value=!1,Q.value=!1}}),C=v=>{c({workspace_id:S.value,module_id:D.value,variable_id:O.value,value:v})},{data:$}=pt({workspace_id:S,workspace_module_id:D}),H=A(()=>{var v;return $.value?(v=$.value[0])==null?void 0:v._id:""}),y=w(H),_=A(()=>{var v;return m.value?(v=m.value[0])==null?void 0:v._id:""}),O=w(_),o=yt(),e=A(()=>a.sptint_id),{mutate:t,isPending:n}=_t(e),{data:k,isPending:f}=Ct(e),K=()=>{t({})},G=w(!1),N=w(),oe=v=>{N.value=v},j=mt(),xe=ft();function Pe(v){v.type=="column"?j.mutate({payload:{workspace_id:S.value,workspace_module_id:D.value,variable_id:O.value,moved_value:v.meta.id,new_index:v.meta.newIndex}}):xe.mutate({payload:{workspace_id:S.value,card_id:v.meta.moved._id,group_value:v.meta.fromColumnId,group_variable_id:O.value,new_index:v.meta.newIndex,sheet_id:y.value}})}const Be=v=>{};ee($,v=>{var V;(v==null?void 0:v.length)>0&&(y.value=(V=v[0])==null?void 0:V._id)});const Le=w(!1),Se=w(""),Oe=v=>{c({workspace_id:b.params.id,module_id:b.params.module_id,new_value:v.title,value:v.oldTitle,variable_id:O.value})},Q=w(!1),z=w(),W=()=>{c({value:z.value.title,workspace_id:S.value,module_id:D.value,newValue:z.value.title,variable_id:O.value,is_trash:!0})},fe=v=>{Q.value=!0,z.value=v},Ee=v=>{G.value=!0,z.value=v};return(v,V)=>{var J,Ce,ae,_e,we;return B(),F(Ae,null,[s("div",vs,[s("div",bs,[V[8]||(V[8]=U(" Sprint ")),s("div",ys,[M(Ye,{placeholder:"Search in Orchit AI space"}),M(se,{size:"sm",onClick:K},{default:P(()=>[U(q(p(n)?"Ending...":"End"),1)]),_:1})])]),Z(M(gt,null,null,512),[[qe,p(f)]]),Z(s("div",ks,[M(p(i),{onOnPlus:Ee,"onDelete:column":V[0]||(V[0]=I=>fe(I)),"onUpdate:column":V[1]||(V[1]=I=>Oe(I)),onReorder:Pe,onAddColumn:C,"onSelect:ticket":oe,board:p(k),onOnBoardUpdate:Be,variable_id:O.value,sheet_id:y.value},{"column-footer":P(I=>{var he,Te,ge,De,Ve;return[(Te=(he=p(o))==null?void 0:he.transitions)!=null&&Te.all_allowed&&!((Ve=(De=(ge=p(o))==null?void 0:ge.transitions)==null?void 0:De.all_allowed)!=null&&Ve.includes(I.column.title))&&p(o).transitions.currentColumn!=I.column.title?(B(),F("div",xs," Disbale ( you can't drop here )")):ue("",!0)]}),_:1},8,["board","variable_id","sheet_id"])],512),[[qe,!p(f)]])]),M(p(h),{onClick:V[2]||(V[2]=le(()=>{},["stop"])),modelValue:Q.value,"onUpdate:modelValue":V[3]||(V[3]=I=>Q.value=I),title:"Delete List",itemLabel:"list",itemName:(J=z.value)==null?void 0:J.title,requireMatchText:(Ce=z.value)==null?void 0:Ce.title,confirmText:"Delete workspace",cancelText:"Cancel",size:"md",loading:p(T),onConfirm:W,onCancel:V[4]||(V[4]=()=>{Q.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),G.value?(B(),te(p(g),{selectedVariable:O.value,listId:(ae=z.value)==null?void 0:ae.title,sheet_id:y.value,key:"createTaskModalKey",modelValue:G.value,"onUpdate:modelValue":V[5]||(V[5]=I=>G.value=I),onSubmit:V[6]||(V[6]=()=>{})},null,8,["selectedVariable","listId","sheet_id","modelValue"])):ue("",!0),(_e=N.value)!=null&&_e._id?(B(),te(p(x),{key:1,details:N.value,onClose:V[7]||(V[7]=()=>{oe({variables:{}})}),showPanel:!!((we=N.value)!=null&&we._id)},null,8,["details","showPanel"])):ue("",!0)],64)}}}),Cs={key:0,class:"flex-auto flex-grow h-full bg-bg-card rounded-lg border border-border overflow-x-auto flex-col flex"},_s={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},ws={class:"flex gap-3 items-center"},hs={class:"space-y-6 p-4 w-full flex-auto overflow-y-auto"},Ts={class:"flex flex-col gap-6"},Ds={class:"space-y-4 bg-bg-surface/30 p-4 rounded-md"},Vs={class:"space-y-4 bg-bg-surface/30 p-4 rounded-md"},$s={class:"flex items-center justify-between"},Ms={class:"text-sm font-semibold"},Ps={key:1,class:"flex-auto flex-grow h-full bg-bg-card rounded-lg border border-border overflow-x-auto flex-col flex"},Bs={class:"empty-state w-full flex flex-col h-full justify-center items-center"},js=de({__name:"Plan",setup(r){const{workspaceId:a}=We(),g=w(!1),{moveSelectedToSprint:h,moveSelectedToBacklog:x,deleteSelected:i,createTicket:b,saveSprintMeta:S,toggleStartSprint:D}=He(),{mutate:m,isPending:d}=Dt({onSuccess:()=>{ae.invalidateQueries({queryKey:["sprint-list"]}),T.value=!1}}),c=w(null),T=w(!1),C=()=>{var u;m((u=c.value)==null?void 0:u._id)},{mutate:$,isPending:H}=Ke({onSuccess:u=>{S({name:u.title}),y({id:f.value}),G(),ae.invalidateQueries({queryKey:["sprint-list"]}),N.value=!1}}),{mutate:y,isPending:_}=Tt(),O=u=>{console.log("helo",c.value,u),$({id:f.value,payload:{goal:u.goal,start_date:u.start,end_date:u.end}})},{data:o,refetch:e}=xt(a.value),{data:t,refetch:n}=tt(a),k=A(()=>{var u,l;return(l=(u=o==null?void 0:o.value)==null?void 0:u.sprints[0])==null?void 0:l._id}),f=w(k),{data:K,refetch:G}=wt(k),N=w(!1),oe=()=>{N.value=!0},{data:j}=St(f),xe=A(()=>{var ne,X;const u=(ne=j==null?void 0:j.value)==null?void 0:ne.backlog_items;if(!u)return null;const l=(((X=j==null?void 0:j.value)==null?void 0:X.backlog_items)||[]).map(L=>{var ve,be,E,Fe,Ne;const Y=((ve=L==null?void 0:L.card)==null?void 0:ve.variables)||{},re=((be=L==null?void 0:L.card)==null?void 0:be._id)||L.card_id;return{id:re,key:Y["card-code"]||(re==null?void 0:re.slice(-6))||"PRJ-?",summary:Y["card-title"]||"(untitled)",type:"Story",status:Pe(String(Y["card-status"]||"").trim()),assignee:((Fe=(E=L==null?void 0:L.card)==null?void 0:E.assigned_to)==null?void 0:Fe.name)||"Unassigned",storyPoints:Number(L.story_points||0),priority:Be(String(Y.priority||"").trim()),createdAt:((Ne=L==null?void 0:L.card)==null?void 0:Ne.created_at)||new Date().toISOString(),description:Y["card-description"]||""}});return{id:u._id,name:u.title||"Sprint 1",title:u.title,goal:"",start:"",end:"",started:!1,tickets:l}});function Pe(u){const l=u.toLowerCase();return l.includes("progress")?"In Progress":l.includes("done")||l.includes("complete")?"Done":"Todo"}function Be(u){const l=u.toLowerCase();return l==="highest"||l==="blocker"||l==="critical"?"Highest":l==="high"||l==="major"?"High":l==="medium"||l==="normal"?"Medium":"Low"}const{mutate:Le}=Vt({onSuccess:()=>{pe.success("Card removed from sprint successfully"),Se()},onError:u=>{pe.error("Failed to remove card from sprint"),console.error("Failed to remove card from sprint:",u)}});function Se(){e(),n(),G()}function Oe(u){console.log(">>> moving back to backlog"),f&&Le({sprintId:f,cardId:u})}const Q={createdAt:(u,l,ne)=>{const X=new Date(u.createdAt).getTime(),L=new Date(l.createdAt).getTime();return ne==="asc"?X-L:L-X}},z=w(!1),W=w(null);let fe="backlog";function Ee(){g.value=!0,W.value=null,fe="backlog"}function v(u){W.value=u,fe="backlog",z.value=!0}function V(u){var l;W.value?Object.assign(W.value,u):b(fe,{summary:u.summary,type:u.type,status:u.status||"Todo",assignee:((l=u.assignee)==null?void 0:l.trim())||"Unassigned",storyPoints:Number(u.storyPoints)||0,priority:u.priority,description:u.description||""})}const J=w(!1);function Ce(){J.value=!0}const ae=Qe(),{mutate:_e,isPending:we}=ht({onSuccess:u=>{S({name:u.title}),ae.invalidateQueries({queryKey:["sprint-list"]}),J.value=!1}}),{mutate:I,isPending:he}=Ke({onSuccess:u=>{S({name:u.title}),ae.invalidateQueries({queryKey:["sprint-list"]}),J.value=!1}});function Te(u){var l;c.value?I({id:(l=c.value)==null?void 0:l._id,payload:{workspace_id:a.value,title:u.name}}):_e({payload:{workspace_id:a.value,title:u.name}})}function ge(){c.value=null,J.value=!0}function De(u){c.value=u,J.value=!0}function Ve(u){c.value=u,T.value=!0}return(u,l)=>{var ne,X,L,Y,re,ve,be;return B(),F(Ae,null,[((ne=p(K))==null?void 0:ne.status)=="active"?(B(),te(Ss,{key:0,sptint_id:f.value},null,8,["sptint_id"])):(B(),F(Ae,{key:1},[((X=p(o))==null?void 0:X.sprints.length)>0?(B(),F("div",Cs,[s("div",_s,[M(vt,{prefix:"View By",modelValue:f.value,"onUpdate:modelValue":l[1]||(l[1]=E=>f.value=E),options:(L=p(o))==null?void 0:L.sprints,variant:"secondary",onEditOption:De,onDeleteOption:Ve},{more:P(()=>[s("div",{onClick:l[0]||(l[0]=E=>ge()),class:"capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},l[10]||(l[10]=[s("i",{class:"fa-solid fa-plus"},null,-1),U(" Add new ")]))]),_:1},8,["modelValue","options"]),s("div",ws,[M(Ye,{placeholder:"Search in Orchit AI space"}),M(se,{size:"sm",onClick:oe},{default:P(()=>l[11]||(l[11]=[U("Start Sprint")])),_:1,__:[11]})])]),s("div",hs,[s("div",Ts,[s("section",Ds,[l[12]||(l[12]=s("div",{class:"flex items-center justify-between"},[s("h2",{class:"text-sm font-semibold"},"Sprint (100 Taks)")],-1)),xe.value?(B(),te(zt,{key:0,sprintId:f.value,sprint:xe.value,onOpenTicket:v,onEditSprint:Ce,onToggleStart:p(D),onMoveSelectedToBacklog:p(x),onDeleteSelectedSprint:l[2]||(l[2]=E=>p(i)("sprint",E)),onRefresh:Se},null,8,["sprintId","sprint","onToggleStart","onMoveSelectedToBacklog"])):ue("",!0)]),s("section",Vs,[s("div",$s,[s("h2",Ms,"Backlog ("+q((re=(Y=p(t))==null?void 0:Y.backlog_items)==null?void 0:re.length)+" Taks)",1),s("div",{class:"flex items-center gap-2"},[s("button",{class:"w-8 h-8 rounded-md border cursor-pointer aspect-square text-sm border-border hover:bg-gray-50",onClick:Ee},l[13]||(l[13]=[s("i",{class:"text-text-primary fa-regular fa-plus"},null,-1)]))])]),M(Ut,{sorters:Q,onMoveSelectedToSprint:p(h),onDeleteSelectedBacklog:l[3]||(l[3]=E=>p(i)("backlog")),onOpenTicket:v,onTicketMovedToBacklog:Oe},null,8,["onMoveSelectedToSprint"])])])])])):(B(),F("div",Ps,[s("div",Bs,[l[15]||(l[15]=Ze('<img src="'+et+'" class="mb-4" alt="backlog-plan"><h6 class="text-sm text-text-primary font-semibold mb-1 text-center">Plan your sprint</h6><p class="text-sm text-text-primary/90 mb-3 max-w-120 text-center">Drag work items from the <span class="font-bold"> Backlog </span> section or create new ones to plan the work for this sprint. Select <span class="font-bold">Start sprint</span> when you&#39;re ready.</p>',3)),M(se,{onClick:ge},{default:P(()=>l[14]||(l[14]=[U("Create Sprint")])),_:1,__:[14]})])]))],64)),M(bt,{onClick:l[4]||(l[4]=le(()=>{},["stop"])),modelValue:T.value,"onUpdate:modelValue":l[5]||(l[5]=E=>T.value=E),title:"Delete Sprint",itemLabel:"Sprint",itemName:(ve=c.value)==null?void 0:ve.title,requireMatchText:(be=c.value)==null?void 0:be.title,confirmText:"Delete Ticket",cancelText:"Cancel",size:"md",loading:p(d),onConfirm:C,onCancel:l[6]||(l[6]=()=>{c.value=null,T.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),M(as,{modelValue:z.value,"onUpdate:modelValue":l[7]||(l[7]=E=>z.value=E),editing:!!W.value,ticket:W.value,onSave:V},null,8,["modelValue","editing","ticket"]),M(ls,{modelValue:J.value,"onUpdate:modelValue":l[8]||(l[8]=E=>J.value=E),onSave:Te,sprint:c.value,creatingSprint:c.value?p(he):p(we)},null,8,["modelValue","sprint","creatingSprint"]),M(gs,{sprint:c.value,modelValue:N.value,"onUpdate:modelValue":l[9]||(l[9]=E=>N.value=E),onSave:O,creatingSprint:p(_)||p(H)},null,8,["sprint","modelValue","creatingSprint"])],64)}}});export{js as default};
