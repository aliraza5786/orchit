import{d as C,u as M,a as R,r as y,c as a,b as z,e as D,w as i,o as _,f as u,s as m,g as s,h as T,i as n,j as q,k as H,_ as I,t as E,B as O,l as U,m as W}from"./index-j3-bp8Lo.js";import{_ as j}from"./AuthLayout.vue_vue_type_script_setup_true_lang--s1SOOWl.js";import{l as J}from"./auth-CT7yK0BN.js";import"./favicon-BAFXWHLW.js";import"./Header-DHaWo7Pg.js";import"./useTheme-CRIxJ4Dy.js";import"./dark-logo-Mcb_sJlF.js";const G={class:"max-w-[500px] md:mx-auto w-full text-text-primary bg-bg-body"},K={key:0,class:"text-red-500 text-sm text-center mt-2"},Q={class:"text-center mt-4"},ae=C({name:"LoginPage",__name:"Login",setup(X){const b=M(),V=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,B=R(),d=y(""),p=y(""),r=y(""),l={email:!1,password:!1},v=a(()=>l.email?d.value.trim()?V.test(d.value)?"":"Invalid email":"Email is required":""),P=a(()=>!!v.value),g=a(()=>l.password?p.value?p.value.length<6?"Password must be at least 6 characters":"":"Password is required":""),L=a(()=>!!g.value),h=a(()=>!v.value&&!g.value),c=W(),{mutateAsync:F,isPending:w}=z({mutationFn:J}),N=a(()=>w.value),$=a(()=>w.value?"Signing In...":"Sign in");function S(){r.value&&(r.value="")}async function A(){var x,e,o;if(r.value="",l.email=!0,l.password=!0,!h.value){r.value="Please fill all fields correctly.";return}try{const t=await F({u_email:d.value,u_password:p.value});localStorage.setItem("token",(x=t==null?void 0:t.data)==null?void 0:x.token),await B.bootstrap();const k=localStorage.getItem("post_auth_intent");if(k)try{const f=JSON.parse(k);localStorage.removeItem("post_auth_intent"),f.aiResponse&&b.setWorkspace(f.aiResponse),c.push(f.path||"/dashboard");return}catch(f){console.error("Failed to parse post_auth_intent",f),localStorage.removeItem("post_auth_intent")}b.pricing?c.push("/dashboard?stripePayment=true"):c.push("/dashboard")}catch(t){r.value=((o=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:o.message)||"Login failed. Please try again."}}return(x,e)=>{const o=U("router-link");return _(),D(j,null,{form:i(()=>[u("div",G,[e[0]||(m(-1,!0),(e[0]=u("h2",{class:"text-[32px] font-medium mb-12 text-center text-text-primary"},[e[7]||(e[7]=s(" Sign in to Orchit AI "))])).cacheIndex=0,m(1),e[0]),u("form",{onSubmit:T(A,["prevent"]),class:"space-y-4 w-full"},[n(I,{modelValue:d.value,"onUpdate:modelValue":[e[1]||(e[1]=t=>d.value=t),S],label:"Email",placeholder:"Email address",size:"lg",error:P.value,message:v.value,onBlur:e[2]||(e[2]=t=>l.email=!0)},null,8,["modelValue","error","message"]),n(I,{modelValue:p.value,"onUpdate:modelValue":[e[3]||(e[3]=t=>p.value=t),S],label:"Password",placeholder:"Enter your password",size:"lg",type:"password",error:L.value,message:g.value,onBlur:e[4]||(e[4]=t=>l.password=!0)},null,8,["modelValue","error","message"]),n(O,{disabled:N.value,size:"lg",block:!0,type:"submit"},{default:i(()=>[s(E($.value),1)]),_:1},8,["disabled"]),r.value?(_(),q("p",K,E(r.value),1)):H("",!0),u("div",Q,[n(o,{to:"/forgot-password",class:"text-sm text-accent hover:underline"},{default:i(()=>e[8]||(e[8]=[s(" Forgot password? ")])),_:1,__:[8]})])],32),e[5]||(m(-1,!0),(e[5]=u("p",{class:"text-sm font-medium text-text-secondary text-center mt-6"},[e[11]||(e[11]=s(" By signing in, you agree to the ")),n(o,{to:"/privacy-policy",class:"text-text-primary font-bold hover:underline"},{default:i(()=>e[9]||(e[9]=[s(" Privacy Policy ")])),_:1,__:[9]}),e[12]||(e[12]=s(" and ")),n(o,{to:"/terms-of-services",class:"text-text-primary font-bold hover:underline"},{default:i(()=>e[10]||(e[10]=[s(" Terms of Service ")])),_:1,__:[10]})])).cacheIndex=5,m(1),e[5]),e[6]||(m(-1,!0),(e[6]=u("p",{class:"text-sm font-medium text-text-secondary text-center mt-8"},[e[14]||(e[14]=s(" Donâ€™t have an account? ")),n(o,{to:"/register",class:"text-text-primary font-bold underline"},{default:i(()=>e[13]||(e[13]=[s("Sign up")])),_:1,__:[13]})])).cacheIndex=6,m(1),e[6])])]),_:1})}}});export{ae as default};
