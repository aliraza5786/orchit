<<<<<<<< HEAD:dist/assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-CkjTGyhX.js
import{d as X,a as Y,W as ee,a0 as te,Z as ae,$ as le,c as i,M as T,m as c,b as U,S as se,w as S,e as r,f as D,h as o,i as u,j as p,_ as re,G as z,F as ie,x as de,A as ne,C as oe,y as I,U as q,t as g,a1 as ue,B as A,n as $,o as d}from"./index-C0EDYk9O.js";const ce={class:"px-6 grid grid-cols-2 gap-4"},pe={key:0,class:"flex flex-col"},me={key:1,class:"flex gap-1 flex-col"},fe={key:0,class:"text-xs text-red-500"},be={key:2,class:"flex gap-1 flex-col"},ve={key:0,class:"text-xs text-red-500"},De={class:"px-6 mt-2"},ge={key:0,class:"text-xs text-red-500 mt-1 px-1"},_e={class:"flex justify-end gap-2 p-6 mt-8 sticky bottom-0 bg-bg-body border-t border-border"},Ve=X({__name:"CreateTaskModal",props:{modelValue:{type:Boolean,default:!1},sheet_id:{},listId:{},selectedVariable:{},pin:{},size:{default:"lg"}},emits:["update:modelValue","created"],setup(L,{emit:N}){const O=N,n=L,M=Y(),{workspaceId:_,moduleId:P}=ee(),{mutate:j,isPending:x}=te({onSuccess:()=>{E(),M.invalidateQueries({queryKey:["sheet-list"]}),f.value=!1}}),{data:V}=ae(_.value),{data:m}=le(_.value,P.value),f=i({get:()=>n.modelValue,set:e=>O("update:modelValue",e)}),C=i(()=>((m==null?void 0:m.value)??[]).filter(e=>{var a;return((a=e==null?void 0:e.type)==null?void 0:a.title)==="Select"})),F=e=>e.map(a=>({_id:a,title:a})),w=i(()=>((V==null?void 0:V.value)??[]).map(e=>{var a;return{_id:e._id,title:((a=e==null?void 0:e.variables)==null?void 0:a["lane-title"])??String(e._id)}})),B=e=>e.slug,t=T({title:"",description:"",startDate:null,endDate:null,lane_id:null,variables:{}});c(C,e=>{for(const a of e){const s=B(a);s in t.variables||(t.variables[s]=null)}},{immediate:!0});const l=T({title:!1,description:!1,startDate:!1,endDate:!1,lane:!1}),K=i(()=>!!t.title.trim()&&(n.pin?!0:!!t.startDate&&!!t.endDate)&&!k.value&&!b.value&&!v.value&&!y.value&&!h.value);function Q(e){t.startDate=e,l.startDate=!0}function R(e){t.endDate=e,l.endDate=!0}function W(e){t.lane_id=e,l.lane=!0}function G(){f.value=!1,E()}function E(){t.title="",t.description="",t.startDate=null,t.endDate=null,t.lane_id=null,t.variables={},l.title=!1,l.description=!1,l.startDate=!1,l.endDate=!1,l.lane=!1}const Z=i(()=>m.value.find(e=>(e==null?void 0:e._id)==n.selectedVariable)),k=i(()=>l.title&&!t.title.trim()?"Title is required":""),b=i(()=>l.startDate?t.startDate?"":"Start date is required":""),v=i(()=>l.endDate?t.endDate?t.startDate&&t.endDate&&t.endDate<t.startDate?"End date cannot be before start date":"":"End date is required":""),y=i(()=>l.lane?t.lane_id?"":"Lane is required":""),h=i(()=>l.description&&!t.description.trim()?"Description is required":"");function H(){var a;if(l.title=!0,l.description=!0,n.pin||(l.startDate=!0,l.endDate=!0),!K.value||x.value)return;const e={sheet_list_id:n.listId,workspace_id:_.value,sheet_id:n.sheet_id,workspace_lane_id:t.lane_id,variables:{...t.variables,[`${(a=Z.value)==null?void 0:a.slug}`]:n.listId,"card-title":t.title.trim(),"card-description":t.description.trim(),"start-date":t.startDate,"end-date":t.endDate},createdAt:new Date().toISOString()};j(e)}return c(()=>t.title,e=>{e!=null&&e.trim()&&l.title&&(l.title=!1)}),c(()=>t.lane_id,e=>{e&&l.lane&&(l.lane=!1)}),c(()=>t.startDate,e=>{e&&l.startDate&&(l.startDate=!1)}),c(()=>t.endDate,e=>{e&&l.endDate&&(l.endDate=!1)}),c(()=>t.description,e=>{e!=null&&e.trim()&&l.description&&(l.description=!1)}),(e,a)=>(d(),U(se,{modelValue:f.value,"onUpdate:modelValue":a[4]||(a[4]=s=>f.value=s),modalClass:"!py-0",size:e.size},{default:S(()=>[a[8]||(a[8]=r("div",{class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-body pb-4 mb-4"},[r("h2",{class:"text-xl font-semibold"},"Create Ticket"),r("p",{class:"text-sm text-text-secondary mt-1"},[D(" Provide the details below and click "),r("span",{class:"font-medium"},"Add Ticket"),D(". ")])],-1)),r("div",ce,[o(re,{modelValue:t.title,"onUpdate:modelValue":a[0]||(a[0]=s=>t.title=s),label:"Ticket Title",placeholder:"e.g., Implement real-time notifications",error:!!k.value,message:k.value,onBlur:a[1]||(a[1]=s=>l.title=!0)},null,8,["modelValue","error","message"]),w.value.length>0?(d(),u("div",pe,[o(z,{size:"md",label:"Lane",options:w.value,placeholder:"Select lane",allowCustom:!1,"model-value":t.lane_id,"onUpdate:modelValue":W,error:!!y.value,message:y.value},null,8,["options","model-value","error","message"])])):p("",!0),(d(!0),u(ie,null,de(C.value,s=>ne((d(),U(z,{size:"md",key:B(s),modelValue:t.variables[s.slug],"onUpdate:modelValue":J=>t.variables[s.slug]=J,options:F(s.data),label:s.title,placeholder:"Select value",allowCustom:!0},null,8,["modelValue","onUpdate:modelValue","options","label"])),[[oe,(s==null?void 0:s._id)!=e.selectedVariable]])),128)),e.pin?p("",!0):(d(),u("div",me,[a[5]||(a[5]=r("label",{class:"text-sm"},"Start date",-1)),r("div",{class:I(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",b.value?"border-red-500":""])},[o(q,{placeholder:"Set start date",class:"w-full","model-value":t.startDate,"emit-as":"ymd","onUpdate:modelValue":Q},null,8,["model-value"])],2),b.value?(d(),u("p",fe,g(b.value),1)):p("",!0)])),e.pin?p("",!0):(d(),u("div",be,[a[6]||(a[6]=r("label",{class:"text-sm"},"End date",-1)),r("div",{class:I(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",v.value?"border-red-500":""])},[o(q,{placeholder:"Set end date",class:"w-full","model-value":t.endDate,"emit-as":"ymd","onUpdate:modelValue":R},null,8,["model-value"])],2),v.value?(d(),u("p",ve,g(v.value),1)):p("",!0)]))]),r("div",De,[o(ue,{label:"Description",placeholder:"What needs to be done, acceptance criteria, links…",modelValue:t.description,"onUpdate:modelValue":a[2]||(a[2]=s=>t.description=s),onBlur:a[3]||(a[3]=s=>l.description=!0)},null,8,["modelValue"]),h.value?(d(),u("p",ge,g(h.value),1)):p("",!0)]),r("div",_e,[o(A,{variant:"secondary",onClick:G},{default:S(()=>a[7]||(a[7]=[D("Cancel")])),_:1,__:[7]}),o(A,{variant:"primary",disabled:$(x),onClick:H},{default:S(()=>[D(g($(x)?"Adding…":"Add Ticket"),1)]),_:1},8,["disabled"])])]),_:1,__:[8]},8,["modelValue","size"]))}});export{Ve as _};
========
import{d as X,a as Y,W as ee,a0 as te,Z as ae,$ as le,c as i,M as T,m as c,b as U,S as se,w as S,e as r,f as D,h as o,i as u,j as p,_ as re,G as z,F as ie,x as de,A as ne,C as oe,y as I,U as q,t as g,a1 as ue,B as A,n as $,o as d}from"./index-BRH08Fos.js";const ce={class:"px-6 grid grid-cols-2 gap-4"},pe={key:0,class:"flex flex-col"},me={key:1,class:"flex gap-1 flex-col"},fe={key:0,class:"text-xs text-red-500"},be={key:2,class:"flex gap-1 flex-col"},ve={key:0,class:"text-xs text-red-500"},De={class:"px-6 mt-2"},ge={key:0,class:"text-xs text-red-500 mt-1 px-1"},_e={class:"flex justify-end gap-2 p-6 mt-8 sticky bottom-0 bg-bg-body border-t border-border"},Ve=X({__name:"CreateTaskModal",props:{modelValue:{type:Boolean,default:!1},sheet_id:{},listId:{},selectedVariable:{},pin:{},size:{default:"lg"}},emits:["update:modelValue","created"],setup(L,{emit:N}){const O=N,n=L,M=Y(),{workspaceId:_,moduleId:P}=ee(),{mutate:j,isPending:x}=te({onSuccess:()=>{E(),M.invalidateQueries({queryKey:["sheet-list"]}),f.value=!1}}),{data:V}=ae(_.value),{data:m}=le(_.value,P.value),f=i({get:()=>n.modelValue,set:e=>O("update:modelValue",e)}),C=i(()=>((m==null?void 0:m.value)??[]).filter(e=>{var a;return((a=e==null?void 0:e.type)==null?void 0:a.title)==="Select"})),F=e=>e.map(a=>({_id:a,title:a})),w=i(()=>((V==null?void 0:V.value)??[]).map(e=>{var a;return{_id:e._id,title:((a=e==null?void 0:e.variables)==null?void 0:a["lane-title"])??String(e._id)}})),B=e=>e.slug,t=T({title:"",description:"",startDate:null,endDate:null,lane_id:null,variables:{}});c(C,e=>{for(const a of e){const s=B(a);s in t.variables||(t.variables[s]=null)}},{immediate:!0});const l=T({title:!1,description:!1,startDate:!1,endDate:!1,lane:!1}),K=i(()=>!!t.title.trim()&&(n.pin?!0:!!t.startDate&&!!t.endDate)&&!k.value&&!b.value&&!v.value&&!y.value&&!h.value);function Q(e){t.startDate=e,l.startDate=!0}function R(e){t.endDate=e,l.endDate=!0}function W(e){t.lane_id=e,l.lane=!0}function G(){f.value=!1,E()}function E(){t.title="",t.description="",t.startDate=null,t.endDate=null,t.lane_id=null,t.variables={},l.title=!1,l.description=!1,l.startDate=!1,l.endDate=!1,l.lane=!1}const Z=i(()=>m.value.find(e=>(e==null?void 0:e._id)==n.selectedVariable)),k=i(()=>l.title&&!t.title.trim()?"Title is required":""),b=i(()=>l.startDate?t.startDate?"":"Start date is required":""),v=i(()=>l.endDate?t.endDate?t.startDate&&t.endDate&&t.endDate<t.startDate?"End date cannot be before start date":"":"End date is required":""),y=i(()=>l.lane?t.lane_id?"":"Lane is required":""),h=i(()=>l.description&&!t.description.trim()?"Description is required":"");function H(){var a;if(l.title=!0,l.description=!0,n.pin||(l.startDate=!0,l.endDate=!0),!K.value||x.value)return;const e={sheet_list_id:n.listId,workspace_id:_.value,sheet_id:n.sheet_id,workspace_lane_id:t.lane_id,variables:{...t.variables,[`${(a=Z.value)==null?void 0:a.slug}`]:n.listId,"card-title":t.title.trim(),"card-description":t.description.trim(),"start-date":t.startDate,"end-date":t.endDate},createdAt:new Date().toISOString()};j(e)}return c(()=>t.title,e=>{e!=null&&e.trim()&&l.title&&(l.title=!1)}),c(()=>t.lane_id,e=>{e&&l.lane&&(l.lane=!1)}),c(()=>t.startDate,e=>{e&&l.startDate&&(l.startDate=!1)}),c(()=>t.endDate,e=>{e&&l.endDate&&(l.endDate=!1)}),c(()=>t.description,e=>{e!=null&&e.trim()&&l.description&&(l.description=!1)}),(e,a)=>(d(),U(se,{modelValue:f.value,"onUpdate:modelValue":a[4]||(a[4]=s=>f.value=s),modalClass:"!py-0",size:e.size},{default:S(()=>[a[8]||(a[8]=r("div",{class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-body pb-4 mb-4"},[r("h2",{class:"text-xl font-semibold"},"Create Ticket"),r("p",{class:"text-sm text-text-secondary mt-1"},[D(" Provide the details below and click "),r("span",{class:"font-medium"},"Add Ticket"),D(". ")])],-1)),r("div",ce,[o(re,{modelValue:t.title,"onUpdate:modelValue":a[0]||(a[0]=s=>t.title=s),label:"Ticket Title",placeholder:"e.g., Implement real-time notifications",error:!!k.value,message:k.value,onBlur:a[1]||(a[1]=s=>l.title=!0)},null,8,["modelValue","error","message"]),w.value.length>0?(d(),u("div",pe,[o(z,{size:"md",label:"Lane",options:w.value,placeholder:"Select lane",allowCustom:!1,"model-value":t.lane_id,"onUpdate:modelValue":W,error:!!y.value,message:y.value},null,8,["options","model-value","error","message"])])):p("",!0),(d(!0),u(ie,null,de(C.value,s=>ne((d(),U(z,{size:"md",key:B(s),modelValue:t.variables[s.slug],"onUpdate:modelValue":J=>t.variables[s.slug]=J,options:F(s.data),label:s.title,placeholder:"Select value",allowCustom:!0},null,8,["modelValue","onUpdate:modelValue","options","label"])),[[oe,(s==null?void 0:s._id)!=e.selectedVariable]])),128)),e.pin?p("",!0):(d(),u("div",me,[a[5]||(a[5]=r("label",{class:"text-sm"},"Start date",-1)),r("div",{class:I(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",b.value?"border-red-500":""])},[o(q,{placeholder:"Set start date",class:"w-full","model-value":t.startDate,"emit-as":"ymd","onUpdate:modelValue":Q},null,8,["model-value"])],2),b.value?(d(),u("p",fe,g(b.value),1)):p("",!0)])),e.pin?p("",!0):(d(),u("div",be,[a[6]||(a[6]=r("label",{class:"text-sm"},"End date",-1)),r("div",{class:I(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",v.value?"border-red-500":""])},[o(q,{placeholder:"Set end date",class:"w-full","model-value":t.endDate,"emit-as":"ymd","onUpdate:modelValue":R},null,8,["model-value"])],2),v.value?(d(),u("p",ve,g(v.value),1)):p("",!0)]))]),r("div",De,[o(ue,{label:"Description",placeholder:"What needs to be done, acceptance criteria, links…",modelValue:t.description,"onUpdate:modelValue":a[2]||(a[2]=s=>t.description=s),onBlur:a[3]||(a[3]=s=>l.description=!0)},null,8,["modelValue"]),h.value?(d(),u("p",ge,g(h.value),1)):p("",!0)]),r("div",_e,[o(A,{variant:"secondary",onClick:G},{default:S(()=>a[7]||(a[7]=[D("Cancel")])),_:1,__:[7]}),o(A,{variant:"primary",disabled:$(x),onClick:H},{default:S(()=>[D(g($(x)?"Adding…":"Add Ticket"),1)]),_:1},8,["disabled"])])]),_:1,__:[8]},8,["modelValue","size"]))}});export{Ve as _};
>>>>>>>> origin/prod:dist/assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-CYZ2prqW.js
