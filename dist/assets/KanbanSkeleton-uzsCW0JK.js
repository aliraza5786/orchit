import{d as Y,r as T,c as o,m as de,i,e as a,h as ie,y as p,j as g,b as U,ao as X,t as A,$ as ue,w as ce,g as S,I as pe,F as I,x as P,o as r,_ as Z,E as b,J as z,n as c,G as _,C as ve,M as me}from"./index-lr5JxJGD.js";import{o as fe}from"./index-IINEE0ld.js";const he=["src"],xe={key:0,class:"font-bold"},ye={class:"text-nowrap"},be=["onClick"],we={class:"flex items-center gap-2 min-w-0 flex-1"},ke=["src"],ge={class:"flex flex-col gap-1 max-w-40"},_e={class:"overflow-hidden font-semibold overflow-ellipsis"},Ce={key:0,class:"min-w-40 line-clamp-2 text-wrap text-text-secondary text-xs"},Se={class:"pl-2 flex items-center relative"},$e=["onClick","aria-expanded","aria-label"],Te=["onClick"],Ae=["onClick"],ze=Y({__name:"Dropdown",props:{prefix:{},options:{default:()=>[]},modelValue:{default:""},variant:{default:"primary"},icon:{},size:{default:"md"}},emits:["update:modelValue","edit-option","delete-option"],setup(e,{emit:s}){const n=e,u=s,v=T(!1),t=T(null),w=o({get:()=>n.modelValue,set:d=>u("update:modelValue",d)}),m=o(()=>n.options.find(d=>d._id===w.value)??null);function f(){v.value=!v.value}function k(d){w.value=d._id,v.value=!1}const h=T(null),x=T(null);function D(d){x.value=null,h.value=h.value===d?null:d}function ee(d){u("edit-option",d),h.value=null,x.value=null}function se(d){u("delete-option",d),h.value=null,x.value=null}fe(t,()=>{v.value=!1,h.value=null,x.value=null});const y=o(()=>n.size==="sm"),ae=o(()=>y.value?"px-2 py-1 text-xs":"px-3 py-1.5 text-sm"),te=o(()=>y.value?"text-xs":"text-sm"),re=o(()=>y.value?"text-xs":"text-sm"),oe=o(()=>y.value?"px-3 py-1":"px-4 py-2"),V=o(()=>y.value?"w-3.5 h-3.5":"w-4 h-4"),$=o(()=>y.value?"w-3.5 h-3.5":"w-4 h-4"),B=o(()=>y.value?"text-base":"text-lg"),le=o(()=>y.value?"w-3.5 h-3.5":"w-4 h-4"),ne=o(()=>"dark:border-light-black border-border-gray");return de(()=>n.options,()=>{},{deep:!0}),(d,C)=>{var F,L,O,q,N,j,K,M,R,G,H;return r(),i("div",{ref_key:"dropdownRef",ref:t,class:"relative inline-block text-left"},[a("button",{onClick:f,type:"button",class:p(["text-nowrap inline-flex justify-between items-center gap-1 border rounded-md font-medium cursor-pointer transition bg-bg-surface",[ae.value,d.variant==="secondary"?"!bg-bg-body border-0":"border-border"]])},[(F=m.value)!=null&&F.prefix?(r(),i("span",{key:0,class:p(V.value)},[typeof((L=m.value)==null?void 0:L.prefix)=="string"?(r(),i("img",{key:0,src:(O=m.value)==null?void 0:O.prefix,class:p($.value)},null,10,he)):(r(),U(X((q=m.value)==null?void 0:q.prefix),{key:1,class:p($.value)},null,8,["class"]))],2)):g("",!0),a("i",{class:p(`${(j=(N=m.value)==null?void 0:N.icon)==null?void 0:j.prefix} ${(M=(K=m.value)==null?void 0:K.icon)!=null&&M.iconName?(G=(R=m.value)==null?void 0:R.icon)==null?void 0:G.iconName:"file"} ${B.value}`)},null,2),a("span",{class:p(te.value)},[d.prefix?(r(),i("span",xe,A(d.prefix)+":",1)):g("",!0),a("span",ye,A((H=m.value)==null?void 0:H.title),1)],2),(r(),i("svg",{class:p([le.value,"text-text-secondary"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},C[2]||(C[2]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))],2),ie(ue,{name:"fade-scale","enter-active-class":"transition duration-200 ease-out","leave-active-class":"transition duration-150 ease-in","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:ce(()=>[v.value?(r(),i("div",{key:0,class:p(["absolute max-h-[500px] overflow-y-auto z-12 mt-1 w-full min-w-fit rounded-md border border-border shadow-lg bg-bg-dropdown",ne.value]),onClick:C[1]||(C[1]=S(()=>{},["stop"]))},[a("ul",{class:p(["py-1 z-[2]",re.value])},[(r(!0),i(I,null,P(d.options,l=>{var W,J,Q;return r(),i("li",{key:l._id,class:p(["group cursor-pointer flex items-stretch text-nowrap hover:bg-bg-dropdown-menu-hover",oe.value]),onClick:E=>k(l)},[a("div",we,[l.prefix?(r(),i("span",{key:0,class:p(V.value)},[typeof l.prefix=="string"?(r(),i("img",{key:0,src:l.prefix,class:p($.value)},null,10,ke)):(r(),U(X(l.prefix),{key:1,class:p(["text-text-primary",$.value])},null,8,["class"]))],2)):g("",!0),a("i",{class:p(`${(W=l.icon)==null?void 0:W.prefix} ${(J=l.icon)!=null&&J.iconName?(Q=l.icon)==null?void 0:Q.iconName:"file"} ${B.value}`)},null,2),a("div",ge,[a("span",_e,A(l.title),1),l.description?(r(),i("p",Ce,A(l.description),1)):g("",!0)])]),a("div",Se,[a("button",{class:"opacity-0 cursor-pointer group-hover:opacity-100 focus:opacity-100 transition rounded-md px-1.5 py-1 text-text-secondary hover:bg-bg-dropdown-menu-hover",onClick:S(E=>D(l._id),["stop"]),"aria-expanded":h.value===l._id?"true":"false","aria-label":`Actions for ${l.title}`}," â‹¯ ",8,$e),h.value===l._id&&x.value!==l._id?(r(),i("div",{key:0,class:"ml-1 inline-flex items-center gap-1",onClick:C[0]||(C[0]=S(()=>{},["stop"]))},[a("button",{class:"rounded-md cursor-pointer px-2 py-1 text-xs border border-border hover:bg-bg-dropdown-menu-hover",onClick:S(E=>ee(l),["stop"])}," Edit ",8,Te),a("button",{class:"rounded-md cursor-pointer px-2 py-1 text-xs border border-border hover:bg-red-50 text-red-600",onClick:S(E=>se(l),["stop"])}," Delete ",8,Ae)])):g("",!0)])],10,be)}),128)),pe(d.$slots,"more",{},void 0,!0)],2)],2)):g("",!0)]),_:3})],512)}}}),Le=Z(ze,[["__scopeId","data-v-6155b152"]]),De={sheets:(e,s)=>["sheets",e,s],sheetList:(e,s,n,u)=>["sheet-list",e,s,n,u]},Oe=(e={})=>b({key:["product-sheet"],url:"/sheets/add",method:"POST"},e),qe=(e={})=>b({key:["move-card"],url:"/workspace/cards/update",method:"PATCH"},e),Ne=(e={})=>b({key:["add-list"],url:"/workspace/catalog/variable/value",method:"POST"},e),je=(e={})=>b({key:["add-ticket"],url:"/workspace/cards/add",method:"POST"},e),Ke=(e,s={})=>b({key:["delete-ticket"],url:`workspace/card/${e}`,method:"DELETE"},s),Me=(e,s={})=>{const n=o(()=>c(e.workspace_module_id)),u=o(()=>c(e.workspace_id));return z({queryKey:De.sheets(n.value,u.value),enabled:o(()=>!!n.value),queryFn:({signal:v})=>_({url:"/sheets",method:"GET",params:{workspace_module_id:n.value,workspace_id:u.value},signal:v}).then(t=>t),...s})};function Re(e,s,n,u,v={}){const t=o(()=>{const f=c(n);return f==null?void 0:Array.isArray(f)?Array.from(new Set(f.map(x=>String(x).trim()).filter(Boolean))).join(",")||void 0:String(f).trim()||void 0}),w=o(()=>["sheet-list",c(e),c(s),c(t),c(u),,]),m=o(()=>!!(c(e)&&c(s)&&c(u)));return z({retry:0,queryKey:w,enabled:m,placeholderData:f=>f,queryFn:async()=>{const f={module_id:c(e),sheet_id:c(s),variable_id:c(u),...c(t)?{lane_ids:c(t)}:{}};return _({url:"/workspace/cards/grouped",method:"GET",params:f})},...v})}const Ge=(e,s,n={})=>z({queryKey:["all-module-variables"],queryFn:({signal:u})=>_({url:`/workspace/catalog/${e}/card-variables/${s}`,method:"GET",signal:u}),...n}),He=(e,s={})=>z({queryKey:["all-module-lanes"],queryFn:({signal:n})=>_({url:`/workspace/lane-by-workspace/${e}`,method:"GET",signal:n}),...s}),We=(e={})=>b({key:["addVariables"]},{mutationFn:s=>_({url:"workspace/catalog/variable/add",method:"POST",data:s.payload}),...e}),Je=(e={})=>b({key:["reorder-list"]},{mutationFn:s=>_({url:"workspace/cards/group-order",method:"PATCH",data:s.payload}),...e}),Qe=(e={})=>b({key:["reorder-card"]},{mutationFn:s=>_({url:"workspace/cards/group-card-order",method:"PATCH",data:s.payload}),...e}),Ee={class:"p-4 overflow-x-auto flex-auto flex gap-6","aria-busy":"true","aria-live":"polite"},Ie={class:"flex-1 w-full overflow-y-auto space-y-3 px-2 pb-2",role:"presentation"},Pe={key:0,class:"min-w-[328px]",role:"presentation"},Ve=Y({__name:"KanbanSkeleton",props:{columns:{default:3},cardsPerColumn:{default:3},showAddList:{type:Boolean,default:!0}},setup(e){const s=e,n=o(()=>Array.from({length:s.columns},(v,t)=>t)),u=o(()=>Array.from({length:s.cardsPerColumn},(v,t)=>t));return(v,t)=>(r(),i("div",Ee,[(r(!0),i(I,null,P(n.value,(w,m,f,k)=>{const h=[s.cardsPerColumn];if(k&&k.key===w&&ve(k,h))return k;const x=(r(),i("div",{key:w,class:"kanban-col max-w-[328px] min-w-[328px] min-h-[555px] h-full bg-bg-body rounded-lg p-2 flex flex-col",role:"presentation"},[t[4]||(t[4]=a("div",{class:"flex justify-between items-center py-3 px-4 sticky top-0 bg-bg-body rounded-xl mb-2 z-10",role:"presentation"},[a("div",{class:"flex items-center gap-2"},[a("div",{class:"h-4 w-24 rounded shimmer","aria-hidden":"true"}),a("div",{class:"h-4 w-4 rounded-full shimmer","aria-hidden":"true"})]),a("div",{class:"flex items-center gap-2"},[a("div",{class:"h-4 w-4 rounded shimmer","aria-hidden":"true"}),a("div",{class:"h-4 w-4 rounded shimmer","aria-hidden":"true"})])],-1)),a("div",Ie,[(r(!0),i(I,null,P(u.value,D=>(r(),i("div",{key:D,class:"bg-bg-card rounded-xl border border-border p-3 space-y-3 shadow-sm",role:"presentation"},t[2]||(t[2]=[me('<div class="flex gap-2" data-v-5a4807f3><div class="h-5 w-14 rounded-full shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="h-5 w-10 rounded-full shimmer" aria-hidden="true" data-v-5a4807f3></div></div><div data-v-5a4807f3><div class="h-4 w-3/4 rounded shimmer mb-2" aria-hidden="true" data-v-5a4807f3></div><div class="h-3 w-full rounded shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="h-3 w-5/6 rounded shimmer mt-1" aria-hidden="true" data-v-5a4807f3></div></div><div class="flex justify-between items-center" data-v-5a4807f3><div class="h-4 w-20 rounded shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="flex -space-x-2" data-v-5a4807f3><div class="w-6 h-6 rounded-full border-2 border-border shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="w-6 h-6 rounded-full border-2 border-border shimmer" aria-hidden="true" data-v-5a4807f3></div></div></div>',3)])))),128)),t[3]||(t[3]=a("div",{class:"h-9 rounded shimmer mt-3","aria-hidden":"true"},null,-1))])]));return x.memo=h,x},t,0),128)),s.showAddList?(r(),i("div",Pe,t[5]||(t[5]=[a("div",{class:"bg-bg-body rounded-lg p-4"},[a("div",{class:"h-9 rounded shimmer","aria-hidden":"true"})],-1)]))):g("",!0)]))}}),Ue=Z(Ve,[["__scopeId","data-v-5a4807f3"]]);export{Le as D,Ue as K,Je as R,Ne as a,Me as b,Qe as c,qe as d,Ke as e,Re as f,je as g,He as h,Oe as i,We as j,Ge as u};
