import{d as Q,c as g,r as i,I as $,a as G,w as m,b as l,g as n,h as x,i as K,e as y,B as V,y as L,aO as R,F as H,v as J,t as B,m as I,o as v}from"./index-DXbJhmZM.js";import{B as W}from"./BaseModal-CYaJn66w.js";import{_}from"./BaseTextField.vue_vue_type_script_setup_true_lang-DKWFnRpb.js";import{u as X}from"./useQueryParams-CVLohy2L.js";import{j as Y}from"./KanbanSkeleton-hddt7cly.js";import"./cross-DvraoB0R.js";import"./info-DjaLHeD_.js";import"./index-Caw7Me_z.js";const Z={class:"px-6 py-4 flex flex-col gap-4"},ee={class:"flex gap-2 items-start"},te={class:"flex-1 flex flex-col gap-1"},le={class:"flex items-center gap-2 select-none"},oe={key:0,class:"mt-2 border border-border rounded-md p-2 bg-bg-input max-h-48 overflow-auto"},ae={class:"font-medium"},re=["onClick"],se={class:"flex justify-end gap-2 px-6 py-4 border-t border-border sticky bottom-0 bg-bg-body"},be=Q({__name:"CreateVariableModal",props:{modelValue:{type:Boolean,default:!1},sheetID:{}},emits:["update:modelValue"],setup(T,{emit:M}){const{moduleId:E,workspaceId:U}=X(),q=M,h=T,u=g({get:()=>h.modelValue,set:t=>q("update:modelValue",t)}),r=i(""),a=i(""),p=i(""),s=i([]),c=i(!0),f=i(""),d=i("");function N(){f.value=r.value.trim()?r.value.length>30?"Maximum 30 characters allowed":"":"Dropdown title is required"}function j(){d.value=a.value.trim()?a.value.length>30?"Maximum 30 characters allowed":"":"Option title is required"}const w=g(()=>!d.value&&a.value.trim()!=="");function z(){w.value&&(s.value.push(a.value.trim()),a.value="",d.value="")}function F(t){s.value.splice(t,1)}const k=g(()=>{const t=r.value.trim();return t.length>0&&t.length<=30&&s.value.length>0}),S=$(),{mutate:b,isPending:C}=Y({onSuccess:()=>{O(),S.invalidateQueries({queryKey:["all-module-variables"]}),u.value=!1},onError:t=>{console.error("Mutation failed:",(t==null?void 0:t.response)??t)}});function A(){if(!k.value)return;const t={description:p.value,title:r.value.trim(),data:s.value,workspace_module_id:E.value,workspace_id:U.value,filterable:c.value,visible_on_card:!1,type_id:"",sheet_id:h.sheetID};if(console.log(">>> helo",t),typeof b!="function"){console.error("createVariable is not a function. Got:",b);return}b({payload:t})}function P(){O(),u.value=!1}function O(){r.value="",a.value="",p.value="",s.value=[],f.value="",d.value="",c.value=!0}return(t,e)=>(v(),G(W,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=o=>u.value=o),size:"sm"},{default:m(()=>[e[8]||(e[8]=l("div",{class:"flex flex-col gap-1 px-6 pb-6 border-b border-border sticky top-0 bg-bg-body z-10"},[l("h2",{class:"text-lg font-semibold"},"Create Dropdown"),l("p",{class:"text-sm text-text-secondary"},"Provide a title and add options for your dropdown.")],-1)),l("div",Z,[n(_,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),label:"Dropdown Title",placeholder:"Enter dropdown title (max 30 chars)",error:f.value!="",maxlength:"30",onInput:N},null,8,["modelValue","error"]),n(_,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),label:"Option Description",placeholder:"Optional description"},null,8,["modelValue"]),l("div",ee,[l("div",te,[n(_,{modelValue:a.value,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value=o),label:"Option Title",placeholder:"Option title (max 30 chars)",error:!!d.value,maxlength:"30",onInput:j},null,8,["modelValue","error"])]),n(V,{class:"mt-6",size:"md",variant:"primary",disabled:!w.value,onClick:z},{default:m(()=>e[5]||(e[5]=[y(" Add ")])),_:1,__:[5]},8,["disabled"])]),l("label",le,[L(l("input",{id:"filterable-toggle",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=o=>c.value=o),class:"h-4 w-4 accent-primary"},null,512),[[R,c.value]]),e[6]||(e[6]=l("span",{class:"text-sm",for:"filterable-toggle"},"Show this dropdown in filters",-1))]),s.value.length?(v(),x("ul",oe,[(v(!0),x(H,null,J(s.value,(o,D)=>(v(),x("li",{key:D,class:"flex justify-between items-center px-2 py-1 border-b border-border last:border-b-0"},[l("div",null,[l("span",ae,B(o),1)]),l("button",{class:"text-red-500",onClick:ie=>F(D)},"âœ•",8,re)]))),128))])):K("",!0)]),l("div",se,[n(V,{variant:"secondary",onClick:P},{default:m(()=>e[7]||(e[7]=[y("Cancel")])),_:1,__:[7]}),n(V,{variant:"primary",disabled:!k.value||I(C),onClick:A},{default:m(()=>[y(B(I(C)?"Creating...":" Create Dropdown"),1)]),_:1},8,["disabled"])])]),_:1,__:[8]},8,["modelValue"]))}});export{be as default};
