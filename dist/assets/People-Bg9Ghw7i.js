const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KanbanBoard-YMuzLpDw.js","assets/lodash-B3d4OLnQ.js","assets/index-DS_2ctjY.js","assets/index-JY3uJpMk.css","assets/DropMenu.vue_vue_type_script_setup_true_lang-BKi-FgQg.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Dp8VXprM.js","assets/workspace-Dv9RuShl.js","assets/KanbanBoard-DlFwUlEB.css","assets/KanbanCard-BhFh-bcC.js","assets/usePeople-V-K881nY.js"])))=>i.map(i=>d[i]);
import{d as ge,Q as ke,r as m,m as q,c as re,a as be,aa as Ce,i as n,y as we,e as l,h as p,j as k,a6 as he,n as b,b0 as De,f as Q,t as f,M as Ve,aD as Ae,A as ue,L as Pe,a9 as ve,g as $,F as se,x as ne,b as _e,G as Se,ae as Le,o as d,H as $e,J as Te,q as Ue,b1 as Ie,C as pe,w as ae,B as fe,a3 as xe,_ as Ne,a4 as ye}from"./index-DS_2ctjY.js";import{D as Oe,K as Ee}from"./Dropdown-BmrrFKNb.js";import{b as Be,c as Ke,d as qe,e as Qe,f as je,g as Re,R as ze,h as Me}from"./usePeople-V-K881nY.js";import{_ as We}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Dp8VXprM.js";import{_ as Fe}from"./BaseEmailChip.vue_vue_type_script_setup_true_lang-Cv7MDmWy.js";import{_ as Je}from"./ProgressBar.vue_vue_type_script_setup_true_lang-WiJfuHe5.js";import{F as He}from"./fuse-Ch1WBRTM.js";import{l as Ye}from"./lodash-B3d4OLnQ.js";import{_ as Ge}from"./SearchBar.vue_vue_type_script_setup_true_lang-BIxkkv2R.js";const Ze={class:"py-4 flex justify-between items-center border-b border-border px-5 sticky top-0 bg-bg-card z-1"},Xe={class:"py-4 px-5"},et={class:"bg-bg-surface/50 p-2 rounded-lg flex gap-2 items-center"},tt=["src"],at={key:0,class:"fa-solid fa-user text-white"},st={class:"text-base font-medium text-text-primary cursor-pointer"},lt={class:"text-sm font-medium text-text-secondary cursor-pointer"},ot={class:"flex flex-col mt-2"},it={class:"text-sm text-text-secondary mt-2"},dt={key:0},nt={class:"mb-2 capitalize"},rt=["onKeydown"],ut={key:1,class:"mt-3"},ct={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},mt={class:"text-sm text-text-primary"},vt={key:2,class:"mt-3"},pt={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},ft={class:"text-sm text-text-primary"},xt=ge({__name:"DetailPanel",props:{showPanel:{type:Boolean,default:!0},details:{type:Object,default:()=>({})}},emits:["close","update:details","comment:post","priority:change"],setup(u,{emit:ce}){const le=ke({}),C=m("details"),N=[{label:"Details",value:"details"},{label:"Tasks",value:"tasks"},{label:"History",value:"history"}],{data:w}=Be(),{mutate:_}=Ke({onSuccess:()=>{g.invalidateQueries({queryKey:["people-lists"]})}}),a=u,r=m(!1),y=m(a.details["card-title"]??""),oe=m(a.details.workspace_lane_id??"");q(()=>a.details["card-title"],c=>{y.value=c,oe.value=a.details.workspace_lane_id});const O=m(a.details["card-description"]);q(()=>a.details,()=>{O.value=a.details["card-description"]});const T=m(null);function ie(){r.value=!0,Le(()=>{var c,s;(c=T.value)==null||c.focus(),(s=T.value)==null||s.select()})}function h(){y.value.trim()||(y.value=a.details["card-title"]??""),z.mutate({card_id:a.details._id,variables:{"card-title":y.value.trim()}}),r.value=!1}function j(){y.value=a.details["card-title"]??"",r.value=!1}const R=m({startDate:a.details["start-date"],endDate:a.details["end-date"]}),D=re(()=>a.details["start-date"]);q(D,c=>{R.value={...R.value,startDate:c}});const g=be(),z=Ce({onSuccess:()=>{g.invalidateQueries({queryKey:["get-sheets"]}),g.invalidateQueries({queryKey:["sheet-list"]}),g.invalidateQueries({queryKey:["roles"]})}}),de=(c,s)=>{console.log(s,"slug",c),_({id:a.details._id,payload:{variable_values:[{module_variable_id:s,value:c}]}})};function M(c){var s,V,A,P;if((s=a==null?void 0:a.details)!=null&&s.variable_values){const S=(V=a==null?void 0:a.details)==null?void 0:V.variable_values.filter(U=>U.module_variable_id==c);return console.log((A=S[0])==null?void 0:A.value,">>>"),(P=S[0])==null?void 0:P.value}}return(c,s)=>{var V,A,P,S,U,W,F,E,J,B,H,Y,G,Z;return d(),n("div",{class:we(`max-w-[358px] bg-bg-card  rounded-lg overflow-y-auto overflow-x-hidden relative ${u.showPanel?"!translate-x-0 w-full h-full min-w-[350px] overflow-y-auto":"!translate-x-100 w-0 h-0"} transition-all`)},[l("div",Ze,[s[4]||(s[4]=l("h5",{class:"text-[16px] font-medium"},"Profile",-1)),l("i",{class:"cursor-pointer text-text-primary fa-solid fa-close",onClick:s[0]||(s[0]=()=>{c.$emit("close")})})]),l("div",Xe,[l("div",et,[(V=u.details)!=null&&V.avatar?(d(),n("img",{key:0,src:(A=u.details)==null?void 0:A.avatar,class:"w-10 h-10 rounded-full",alt:"avartar"},null,8,tt)):(d(),n("div",{key:1,class:"min-w-10 max-h-10 aspect-square bg-bg-surface flex justify-center items-center rounded-full",style:he({backgroundColor:(P=u.details)!=null&&P.name?b(De)({email:(S=u.details)==null?void 0:S.email}):""})},[Q(f(b(Ve)((U=u.details)==null?void 0:U.name))+" ",1),(W=u.details)!=null&&W.name?k("",!0):(d(),n("i",at))],4)),l("div",null,[l("h1",st,f(u.details.name??u.details.title),1),l("p",lt,f(u.details.email),1)])]),p(Ae,{modelValue:C.value,"onUpdate:modelValue":s[1]||(s[1]=i=>C.value=i),class:"my-2",options:N},null,8,["modelValue"]),l("div",ot,[s[5]||(s[5]=l("h1",{class:"text-base font-medium text-text-primary cursor-pointer"}," Task Progress ",-1)),p(Je,{class:"mt-2",progress:(F=a==null?void 0:a.details)==null?void 0:F.assigned_cards_count,fillColor:"bg-accent ",indeterminate:!0},null,8,["progress"]),l("span",it,"Completed 10 tasks out of "+f((E=a==null?void 0:a.details)==null?void 0:E.assigned_cards_count),1)]),C.value=="details"?(d(),n("section",dt,[l("div",nt,[r.value?ue((d(),n("input",{key:0,ref_key:"titleInput",ref:T,"onUpdate:modelValue":s[2]||(s[2]=i=>y.value=i),onBlur:h,onKeydown:[ve($(h,["prevent"]),["enter"]),ve($(j,["prevent"]),["esc"])],class:"border border-border rounded px-2 py-1 w-full text-xl font-medium",type:"text"},null,40,rt)),[[Pe,y.value]]):(d(),n("h1",{key:1,class:"text-xl font-medium text-text-primary cursor-pointer",onClick:ie},f(y.value),1))]),l("div",null,[(d(!0),n(se,null,ne(b(w),(i,x)=>{var X;return d(),n("div",{key:x,class:"grid grid-cols-2 capitalize items-center gap-2 text-sm mt-4"},[Q(f(i.title)+" ",1),(d(),_e(Se,{size:"sm","model-value":le[i.slug],key:x,placeholder:` ${i.title}`,onClick:s[3]||(s[3]=$(()=>{},["stop"])),defaultValue:M(i==null?void 0:i._id),options:i==null?void 0:i.data.map(I=>({_id:I,title:I})),cardId:(X=u.details)==null?void 0:X._id,"onUpdate:modelValue":I=>de(I,i._id)},null,8,["model-value","placeholder","defaultValue","options","cardId","onUpdate:modelValue"]))])}),128))])])):k("",!0),C.value=="tasks"?(d(),n("section",ut,[s[7]||(s[7]=l("span",{class:"text-base text-text-primary"},"Worked On",-1)),((B=(J=u.details)==null?void 0:J.assigned_cards)==null?void 0:B.length)>0?(d(),n("ul",ct,[(d(!0),n(se,null,ne((H=u.details)==null?void 0:H.assigned_cards,(i,x)=>(d(),n("li",{class:"p-2",key:x},[l("h1",mt,f(i==null?void 0:i.title),1),s[6]||(s[6]=l("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):k("",!0)])):k("",!0),C.value=="history"?(d(),n("section",vt,[s[9]||(s[9]=l("span",{class:"text-base text-text-primary"},"history",-1)),((G=(Y=u.details)==null?void 0:Y.assignment_history)==null?void 0:G.length)>0?(d(),n("ul",pt,[(d(!0),n(se,null,ne((Z=u.details)==null?void 0:Z.assignment_history,(i,x)=>(d(),n("li",{class:"p-2",key:x},[l("h1",ft,f(i==null?void 0:i.title),1),s[8]||(s[8]=l("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):k("",!0)])):k("",!0)])],2)}}}),yt=$e(xt,[["__scopeId","data-v-4d21cbae"]]),gt={class:"flex-auto flex-grow h-full bg-bg-card rounded-lg border border-border overflow-x-auto flex-col flex"},bt={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},_t={class:"flex gap-3 items-center"},kt={class:"flex p-4 overflow-x-auto gap-3 custom_scroll_bar"},Ct=["onClick"],wt={key:1,class:"p-4 space-y-2 bg-bg-surface m-4 rounded-md"},ht={class:"text-sm text-text-primary"},Dt={class:"flex items-center mt-3 gap-3"},Nt=ge({__name:"People",setup(u){const ce=xe(()=>ye(()=>import("./KanbanBoard-YMuzLpDw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),le=xe(()=>ye(()=>import("./KanbanCard-BhFh-bcC.js"),__vite__mapDeps([8,2,3,4,5,9]))),C=[{title:"Role",_id:"role"},{title:"Team",_id:"team"},{title:"Status",_id:"status"}],N=m("role"),w=m(!1),_=m(),{workspaceId:a}=Te(),r=m([]),{mutate:y,isPending:oe}=qe({onSuccess:e=>{r.value=[...r.value||[],e],g.value="",D.value=!1}}),{data:O,isPending:T}=Qe(a.value,N);q(O,e=>{r.value=e?JSON.parse(JSON.stringify(e)):[]}),Ue(()=>{r.value=O.value?JSON.parse(JSON.stringify(O.value)):[]});const ie=m("kanban"),h=m(),j=e=>{h.value=e},R=e=>{},D=m(!1),g=m("");function z(){D.value=!D.value}function de(){console.log(">>> clicking on adding pepople ");const e=g.value.trim();M(e)}const M=e=>{console.log(">>> clicking on adding pepople ");const t={workspace_id:a.value,title:e,max_num_people:1};y({payload:t})},c=be(),s=Ie({onSuccess:()=>{c.invalidateQueries({queryKey:["people-lists"]})}}),V=e=>{const t={workspace_id:a.value,title:e==null?void 0:e.title,max_num_people:1};s.mutate({id:e._id,payload:t})},{mutate:A,isPending:P}=je({onSuccess:e=>{w.value=!1,r.value=r.value.filter(t=>{var v;return t._id!==((v=e.deletedRole)==null?void 0:v._id)})}}),S=()=>{var e;A({id:(e=_.value)==null?void 0:e.columnId})},U=e=>{w.value=!0,_.value=e},{mutate:W,isPending:F}=Re({onSuccess:e=>{g.value="",D.value=!1,console.log(_.value,">>>. id local column");const t=r.value.findIndex(te=>te._id===_.value._id);if(t===-1)return;console.log(t,"index>>>");const v=r.value[t],L=[...v.cards??[],e==null?void 0:e.assigned_seat],ee={...v,cards:L};r.value=[...r.value.slice(0,t),ee,...r.value.slice(t+1)],c.invalidateQueries({queryKey:["people-lists"]}),c.invalidateQueries({queryKey:["workspaceRoles"]})}}),E=e=>{_.value=e;const t={name:e!=null&&e.email?J(e==null?void 0:e.email[0]):"",email:e!=null&&e.email?e==null?void 0:e.email[0]:"",role_id:e==null?void 0:e._id,workspace_id:a==null?void 0:a.value,additional_seats:1};W({id:e._id,payload:t})};function J(e){const v=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return v.length?v.map(L=>L.charAt(0).toUpperCase()+L.slice(1).toLowerCase()).join(" "):e}const B=e=>{window.dispatchEvent(new CustomEvent("close-all-showADDNEW")),e.showADDNEW=!e.showADDNEW},H=e=>{E(e)},Y=e=>{h.value=e},G=ze(),Z=Me();function i(e){console.log(e,">>"),e.type=="column"?G.mutate({id:a.value,payload:{role_id:e.meta._id,new_sort_order:e.meta.newIndex}}):Z.mutate({id:e.meta.toColumnId,payload:{team_member_id:e.meta.moved._id,new_sort_order:e.meta.newIndex}})}const x=m(""),X=m("");q(x,Ye.debounce(e=>{X.value=e},200));const I=re(()=>{const e=r.value.flatMap(t=>t.cards.map(v=>({...v,columnId:t.title})));return new He(e,{keys:["title","name"],threshold:.3})}),me=re(()=>{if(!x.value)return r.value;const e=I.value.search(x.value).map(t=>t.item);return r.value.map(t=>({...t,cards:e.filter(v=>v.columnId===t.title)}))});return(e,t)=>{var v,L,ee,te;return d(),n(se,null,[l("div",gt,[l("div",bt,[p(Oe,{actions:!1,prefix:"View By",modelValue:N.value,"onUpdate:modelValue":t[0]||(t[0]=o=>N.value=o),options:C,variant:"secondary"},null,8,["modelValue"]),l("div",_t,[p(Ge,{class:"max-w-[250px]",onOnChange:t[1]||(t[1]=o=>{x.value=o}),placeholder:"Search in Orchit AI space"})])]),ue(p(Ee,null,null,512),[[pe,b(T)]]),ue(l("div",kt,[((v=me.value)==null?void 0:v.length)>0?(d(),_e(b(ce),{key:0,plusIcon:!1,onOnPlus:t[3]||(t[3]=o=>E(o)),"onDelete:column":t[4]||(t[4]=o=>U(o)),"onUpdate:column":t[5]||(t[5]=o=>V(o)),onReorder:i,onAddColumn:M,"onSelect:ticket":j,board:me.value,onOnBoardUpdate:R,variable_id:"",sheet_id:"selected_sheet_id"},{ticket:ae(({ticket:o})=>[p(b(le),{onClick:K=>Y(o),ticket:o},null,8,["onClick","ticket"])]),"column-footer":ae(({column:o})=>[o.showADDNEW?o.showADDNEW?(d(),n("div",wt,[l("p",ht,f(o.title)+" "+f(o.cards.length+1),1),p(Fe,{maxEmails:1,placeholder:"team member email",modelValue:o.email,"onUpdate:modelValue":K=>o.email=K},null,8,["modelValue","onUpdate:modelValue"]),t[14]||(t[14]=l("p",{class:"text-sm text-text-secondary"},"You can assign user later",-1)),p(fe,{size:"md",onClick:K=>H(o)},{default:ae(()=>[Q(f(b(F)?"Adding...":"Add Seat"),1)]),_:2},1032,["onClick"]),l("i",{class:"fa-solid fa-close cursor-pointer ml-2",onClick:t[2]||(t[2]=K=>B(""))})])):k("",!0):(d(),n("div",{key:0,onClick:K=>B(o),class:"flex py-3 px-3 justify-center text-sm text-text-primary items-center gap-3 border border-text-primary cursor-pointer border-dashed mb-4 mx-4 rounded-md"},t[13]||(t[13]=[l("i",{class:"fa-solid fa-plus"},null,-1),Q(" Add Seat ")]),8,Ct))]),_:1},8,["board"])):k("",!0),l("div",{class:"min-w-[328px]",onClick:t[8]||(t[8]=$(()=>{},["stop"]))},[D.value?(d(),n("form",{key:0,onSubmit:t[7]||(t[7]=$(()=>{},["prevent"])),class:"bg-bg-body rounded-lg p-4"},[p(Ne,{autofocus:!0,modelValue:g.value,"onUpdate:modelValue":t[6]||(t[6]=o=>g.value=o),placeholder:"Add New list"},null,8,["modelValue"]),t[15]||(t[15]=l("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),l("div",Dt,[p(fe,{onClick:de,type:"submit",variant:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:ae(()=>[Q(f(b(oe)?"Adding...":"Add Team"),1)]),_:1}),l("i",{class:"fa-solid fa-close cursor-pointer",onClick:z})])],32)):(d(),n("button",{key:1,class:"text-sm text-text-primary py-2.5 cursor-pointer font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",onClick:$(z,["stop"])}," + Add Team "))])],512),[[pe,ie.value=="kanban"&&!b(T)]])]),p(We,{onClick:t[9]||(t[9]=$(()=>{},["stop"])),modelValue:w.value,"onUpdate:modelValue":t[10]||(t[10]=o=>w.value=o),title:"Delete List",itemLabel:"list",itemName:(L=_.value)==null?void 0:L.title,requireMatchText:(ee=_.value)==null?void 0:ee.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:b(P),onConfirm:S,onCancel:t[11]||(t[11]=()=>{w.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),p(yt,{details:h.value,onClose:t[12]||(t[12]=()=>{j({})}),showPanel:!!((te=h.value)!=null&&te.title)},null,8,["details","showPanel"])],64)}}});export{Nt as default};
