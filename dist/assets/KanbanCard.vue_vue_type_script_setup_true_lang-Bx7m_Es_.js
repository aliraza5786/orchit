const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DropMenu-B-wtSGDc.js","assets/DropMenu.vue_vue_type_script_setup_true_lang-DhNQF2XC.js","assets/index-B6QqO5al.js","assets/index-l6RGGgFN.css","assets/index-BM_FmKdx.js","assets/AssignmentModal-BT927j6u.js","assets/ConfirmDeleteModal-BDywylse.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-DEGnXEGy.js"])))=>i.map(i=>d[i]);
import{d as ie,W as ae,r as w,X as ne,bG as oe,O as le,j as m,o as c,F as re,f as s,ah as P,k as j,q as a,ad as de,g as ue,t as f,Q as me,A as ce,i as v,ae as y,h as o,w as pe,l as ge,C}from"./index-B6QqO5al.js";import{h as fe,i as ve,j as ke,k as be}from"./usePeople-lfDU-7Hh.js";const we={class:"flex justify-between gap-2 items-start w-full relative"},ye={class:"flex items-start gap-2 w-[90%]"},Ce=["src"],he={key:0,class:"fa-solid fa-user text-white"},Ae={class:"max-w-[90%]"},xe={class:"text-sm font-medium mb-1 text-card-foreground leading-tight overflow-hidden overflow-ellipsis text-nowrap"},De={class:"text-text-secondary text-xs overflow-hidden overflow-ellipsis"},Te={key:0,class:"group-hover:flex justify-center items-center hidden w-6 h-6 bg-bg-surface/40 rounded-md"},Ve=ie({__name:"KanbanCard",props:{ticket:{}},setup(q,{emit:E}){const _=y(()=>C(()=>import("./DropMenu-B-wtSGDc.js"),__vite__mapDeps([0,1,2,3,4]))),z=y(()=>C(()=>import("./AssignmentModal-BT927j6u.js"),__vite__mapDeps([5,2,3]))),L=y(()=>C(()=>import("./ConfirmDeleteModal-BDywylse.js"),__vite__mapDeps([6,7,2,3]))),{canInviteUser:B,canEditUser:Q,canDeleteUser:K}=ae(),l=w(!1),k=E,r=q,{workspaceId:O}=ne(),{data:F}=oe(),{data:h}=fe(O.value,F),R=w([]),p=w(!1),b=le();function A(){var n,d,u;const e=((d=(n=r.ticket)==null?void 0:n.role_title)==null?void 0:d.toLowerCase())==="admin",t=!!((u=r.ticket)!=null&&u.name),i=[];return B.value&&!e&&i.push({label:"Assign User",danger:!0,action:()=>{l.value=!0},icon:{prefix:"fa-regular",iconName:"fa-user-plus"}}),t&&Q.value&&!e&&i.push({label:"UnAssign User",danger:!0,action:se,icon:{prefix:"fa-regular",iconName:"fa-user-minus"}}),K.value&&!e&&i.push({label:"Delete Seat",danger:!0,action:()=>{p.value=!0},icon:{prefix:"fa-regular",iconName:"fa-trash"}}),i}function H(e){te(e.invite)}const W=()=>{},{mutate:$,isPending:G}=ve({onSuccess:()=>{b.invalidateQueries({queryKey:["people-lists"]})}}),X=()=>{$({id:r.ticket._id}),k("deleted")},{mutate:Z,isPending:J}=ke({onSuccess:()=>{l.value=!1,b.invalidateQueries({queryKey:["people-lists"]}),k("assigned")}});function Y(e){const i=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return i.length?i.map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(" "):e}const{mutate:ee}=be({onSuccess:()=>{l.value=!1,b.invalidateQueries({queryKey:["people-lists"]}),k("unAssigned")}});function te(e){Z({id:r.ticket._id,payload:{name:Y(e.email),email:e.email}})}function se(){ee({id:r.ticket._id})}return(e,t)=>{var n,d,u,x,D,T,S,I,V,U,M,N;const i=ge("AssigmentDropdown");return c(),m(re,null,[s("div",{onClick:t[2]||(t[2]=g=>e.$emit("click")),class:"group bg-bg-card rounded-lg p-4 shadow-sm cursor-grab hover:shadow-md transition-all duration-200 active:cursor-grabbing",style:P({borderColor:(d=(n=e.ticket)==null?void 0:n.lane)==null?void 0:d.variables["lane-color"]})},[s("div",we,[s("div",ye,[(u=e.ticket)!=null&&u.avatar?(c(),m("img",{key:0,src:(x=e.ticket)==null?void 0:x.avatar,class:"min-w-10 w-10 h-10 rounded-full object-cover",alt:"avartar"},null,8,Ce)):(c(),m("div",{key:1,class:"w-10 min-w-10 overflow-hidden overflow-ellipsis aspect-square bg-bg-surface flex justify-center items-center rounded-full",style:P({backgroundColor:(D=e.ticket)!=null&&D.name?a(de)({email:(T=e.ticket)==null?void 0:T.email}):""})},[ue(f(a(me)((S=e.ticket)==null?void 0:S.name))+" ",1),(I=e.ticket)!=null&&I.name?j("",!0):(c(),m("i",he))],4)),s("div",Ae,[s("h3",xe,f(((V=e.ticket)==null?void 0:V.name)??e.ticket.title??"Team Member "),1),s("p",De,f((U=e.ticket)==null?void 0:U.email),1),s("div",{class:ce(["text-[8px] sm:text-[11px] mt-2 font-medium capitalize flex items-center gap-2 rounded-md w-fit px-2 py-1",{"bg-amber-600/10 text-amber-600":e.ticket.status==="pending","bg-red-600/10 text-red-600 ":e.ticket.status==="rejected","bg-green-600/10 text-green-600  ":e.ticket.status==="accepted","bg-bg-surface/60 text-text-secondary  ":e.ticket.status==="unassigned"}])},f(e.ticket.status),3)])]),A().length>0?(c(),m("div",Te,[v(a(_),{onClick:t[0]||(t[0]=o(()=>{},["stop"])),items:A()},{trigger:pe(()=>t[10]||(t[10]=[s("i",{class:"cursor-pointer fa-solid fa-ellipsis"},null,-1)])),_:1},8,["items"])])):j("",!0)]),s("div",{onClick:t[1]||(t[1]=o(()=>{},["stop"]))},[v(i,{users:R.value,onAssign:W,assigneeId:e.ticket.assigned_to},null,8,["users","assigneeId"])])],4),s("div",{class:"no-drag-zone",draggable:"false",onMousedown:t[7]||(t[7]=o(()=>{},["stop"])),onTouchstart:t[8]||(t[8]=o(()=>{},["stop"])),onPointerdown:t[9]||(t[9]=o(()=>{},["stop"]))},[v(a(L),{onClick:t[3]||(t[3]=o(()=>{},["stop"])),modelValue:p.value,"onUpdate:modelValue":t[4]||(t[4]=g=>p.value=g),title:"Delete Team seat",itemLabel:"Seat",itemName:e.ticket.title,requireMatchText:e.ticket.title,confirmText:"Delete Seat",cancelText:"Cancel",size:"md",loading:a(G),onConfirm:X,onCancel:t[5]||(t[5]=()=>{p.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),v(a(z),{isSubmitting:a(J),modelValue:l.value,"onUpdate:modelValue":t[6]||(t[6]=g=>l.value=g),members:(M=a(h))==null?void 0:M.people,directory:(N=a(h))==null?void 0:N.people,onSubmit:H},null,8,["isSubmitting","modelValue","members","directory"])],32)],64)}}});export{Ve as _};
