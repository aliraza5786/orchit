import{R as ae,S as Se,p as h,T as ee,d as se,r as p,n as ne,j as N,o as E,ad as st,f as o,i as _,L as ce,k as te,D as ve,ae as oe,h as Z,t as X,P as Ve,w as A,ak as ke,z as _e,J as he,N as Be,M as ge,F as Ce,W as lt,v as ze,x as nt,_ as pe,B as J,g as Q,c as G,e as ie,X as Le,bd as at,be as it,U as Te,an as je,bf as rt,ac as Ke,I as We,aw as dt,E as ut}from"./index-tfagm7Um.js";import{K as ct}from"./KanbanSkeleton-D2q6bmT8.js";import{D as Fe}from"./vuedraggable.umd-CgaWO4DV.js";import{_ as Oe}from"./DropMenu.vue_vue_type_script_setup_true_lang-D3eDHqZA.js";import{u as pt,_ as qe}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-DslWMS3t.js";import{u as mt,_ as ft,M as fe,a as vt,b as gt,c as xe,P as we,d as bt}from"./useLocalWorkflowState-BjxCY8Ks.js";import{_ as Ge}from"./BaseTextAreaField.vue_vue_type_script_setup_true_lang-ynPZsj6Q.js";import"./_commonjsHelpers-_d1bhYXs.js";const He=(b,i={})=>Se({queryKey:["process-groups-with-transitions",b],queryFn:({signal:l})=>{const C=h(b);return C?ee({url:`workspace/${C}/process-groups/with-transitions?sort=sort_order`,method:"GET",signal:l}):Promise.resolve(null)},enabled:!!h(b),...i}),yt=(b={})=>ae({key:["create-process-group"]},{mutationFn:i=>ee({url:`workspace/${i.workspace_id}/process-groups`,method:"POST",data:i}),...b}),xt=(b={})=>ae({key:["update-process-group"]},{mutationFn:i=>ee({url:`workspace/${i.workspace_id}/process-groups/${i.group_id}`,method:"PUT",data:i.payload}),...b}),wt=(b={})=>ae({key:["delete-process-group"]},{mutationFn:i=>ee({url:`workspace/${i.workspace_id}/process-groups/${i.group_id}`,method:"DELETE"}),...b}),kt=(b={})=>ae({key:["reorder-process-groups"]},{mutationFn:i=>ee({url:`workspace/${i.workspace_id}/process-groups/reorder`,method:"POST",data:{groups:i.groups}}),...b}),_t=(b={})=>ae({key:["create-process-transition"]},{mutationFn:i=>ee({url:`workspace/${i.workspace_id}/process-transitions`,method:"POST",data:i}),...b}),Ie=(b={})=>ae({key:["update-process-transition"]},{mutationFn:i=>ee({url:`workspace/${i.workspace_id}/process-transitions/${i.transition_id}`,method:"POST",data:i.payload}),...b}),ht=(b={})=>ae({key:["delete-process-transition"]},{mutationFn:i=>ee({url:`workspace/${i.workspace_id}/process-transitions/${i.transition_id}`,method:"DELETE"}),...b}),Ct=(b={})=>ae({key:["reorder-process-transitions"]},{mutationFn:i=>ee({url:`workspace/${i.workspace_id}/process-groups/${i.group_id}/transitions/reorder`,method:"POST",data:{transitions:i.transitions}}),...b}),Re=(b,i,l={})=>Se({queryKey:["process-transition",b,i],queryFn:({signal:C})=>{const m=h(b),d=h(i);return!m||!d?Promise.resolve(null):ee({url:`workspace/${m}/process-transitions/${d}`,method:"GET",signal:C})},enabled:!!h(b)&&!!h(i),...l}),Qe=(b,i={})=>Se({queryKey:["filtered-card-types",b],queryFn:({signal:l})=>{const C=h(b);return C?ee({url:`common/cardtypes-filtered?workspace_id=${C}&default=true`,method:"GET",signal:l}):Promise.resolve(null)},enabled:!!h(b),...i}),$t={class:"flex items-center justify-between w-full p-4 border-b border-border cursor-grab"},Tt={class:"flex items-center gap-2 flex-auto max-w-4/5"},St=["onKeydown"],Vt=["onKeydown"],It={class:"text-xs bg-muted bg-bg-card aspect-square flex justify-center items-center text-muted-foreground p-1 min-w-6 rounded-full"},Et=se({__name:"ProcessKanbanColumn",props:{column:{},canDragList:{type:Boolean},plusIcon:{type:Boolean},index:{},totalColumns:{},listOwnerId:{}},emits:["update:column","delete:column","onPlus","reorder","select:ticket","move:column","drag:start"],setup(b,{emit:i}){const l=b,C=i,m=()=>{C("drag:start",l.column._id)},d=()=>{},$=p(!1),f=p(l.column.title);ne(()=>l.column.title,n=>{f.value=n});const T=p(null);function D(){$.value=!0,ke(()=>{T.value&&(T.value.focus(),T.value.select())})}function M(){const n=(f.value??"").trim()||"Untitled";n!==l.column.title?C("update:column",{...l.column,title:n,oldTitle:l.column.title}):f.value=l.column.title,$.value=!1}function g(){f.value=l.column.title,$.value=!1}const a=p([...l.column.transitions??[]]);ne(()=>l.column.transitions,n=>{a.value=[...n??[]]});function y(n){var s,S;const v=n.moved??n.added;if(!v)return;const u=((S=(s=n.from)==null?void 0:s.dataset)==null?void 0:S.columnId)??null;C("reorder",{moved:v.element,fromColumnId:u,toColumnId:l.column._id,oldIndex:v.oldIndex??null,newIndex:v.newIndex??null})}function U(){const n=[];return n.push({label:"Delete",danger:!0,action:()=>x()}),n}const x=()=>{var n;C("delete:column",{title:l.column.title,columnId:(n=l.column)==null?void 0:n._id})};return(n,v)=>(E(),N("div",{class:"flex bg-bg-body flex-col min-h-[565px] h-full w-full rounded-lg transition-all duration-200",style:st({borderColor:n.column.color})},[o("div",$t,[o("div",Tt,[$.value?ve((E(),N("input",{key:1,autofocus:"",ref_key:"titleInputRef",ref:T,"onUpdate:modelValue":v[0]||(v[0]=u=>f.value=u),class:"font-semibold inline text-foreground px-1 py-0.5 rounded bg-transparent border border-border focus:outline-none focus:ring-1 focus:ring-border",onKeydown:[oe(Z(M,["prevent"]),["enter"]),oe(Z(g,["prevent"]),["esc"])],onBlur:M,onMousedown:v[1]||(v[1]=Z(()=>{},["stop"]))},null,40,Vt)),[[Ve,f.value]]):(E(),N("button",{key:0,class:"font-semibold overflow-ellipsis line-clamp-1 text-nowrap text-foreground px-1 py-0.5 rounded hover:bg-bg-card focus:outline-none focus:ring-1 focus:ring-border cursor-text",onClick:D,onKeydown:oe(Z(D,["prevent"]),["enter"]),title:"Click to rename"},X(f.value),41,St)),o("span",It,X(n.column.transitions?n.column.transitions.length:0),1)]),n.plusIcon?(E(),N("i",{key:0,class:"cursor-pointer fa-solid fa-plus",onClick:v[2]||(v[2]=u=>C("onPlus",n.column))})):te("",!0),_(Oe,{items:U()},{trigger:A(()=>v[4]||(v[4]=[o("i",{class:"fa-solid fa-ellipsis cursor-pointer"},null,-1)])),_:1},8,["items"])]),_(h(Fe),{disabled:!n.canDragList,modelValue:a.value,"onUpdate:modelValue":v[3]||(v[3]=u=>a.value=u),"item-key":"_id","data-column-id":n.column._id,class:"flex-1 p-4 space-y-3 overflow-y-auto",group:{name:"tickets",pull:!0,put:!0},animation:180,"ghost-class":"kanban-ghost","chosen-class":"kanban-chosen",onStart:m,onEnd:d,"drag-class":"kanban-dragging",onChange:y},{item:A(({element:u,index:s})=>[o("div",null,[ce(n.$slots,"ticket",{ticket:u,index:s})])]),footer:A(()=>[a.value.length?te("",!0):ce(n.$slots,"emptyState",{key:0,column:n.column})]),_:3},8,["disabled","modelValue","data-column-id"]),ce(n.$slots,"footer",{column:n.column})],4))}}),Pt={class:"h-full flex gap-3"},Dt=se({__name:"ProcessKanbanBoard",props:{board:{},onBoardUpdate:{},plusIcon:{type:Boolean,default:!0}},emits:["update:board","select:ticket","update:column","delete:column","onPlus","reorder"],setup(b,{emit:i}){const l=pt("(max-width: 650px)"),C=p(!0),m=p(null),d=()=>{C.value=!1},$=x=>{m.value=x},f=b,T=i,D=p(U(f.board));ne(()=>f.board,x=>{D.value=U(x)});function M(x){const n=x.oldIndex,v=x.newIndex,u=D.value.columns[v],s=u==null?void 0:u._id,S=u==null?void 0:u._id;s!=null&&a("column",{id:s,oldIndex:n,newIndex:v,_id:S}),C.value=!0}function g(x){!x.fromColumnId&&m.value&&(x.fromColumnId=m.value),a("ticket",x)}function a(x,n){var u;const v=D.value;T("update:board",v),T("reorder",{type:x,board:v,meta:n}),(u=f.onBoardUpdate)==null||u.call(f,v)}function y({direction:x,column:n}){const v=[...D.value.columns],u=v.findIndex(S=>S._id===n._id);if(u===-1)return;let s=u;if(x==="left"&&u>0?s=u-1:x==="right"&&u<v.length-1&&(s=u+1),s!==u){const[S]=v.splice(u,1);v.splice(s,0,S),D.value.columns=v;const L=v[s],O=L==null?void 0:L._id,q=L==null?void 0:L._id;O!=null&&a("column",{id:O,oldIndex:u,newIndex:s,_id:q})}}function U(x){return{columns:((x==null?void 0:x.length)>0?x:[]).map(n=>({...n,title:n==null?void 0:n.title,transitions:(n.transitions??[]).map(v=>({...v}))}))}}return(x,n)=>(E(),N("div",Pt,[_(h(Fe),{modelValue:D.value.columns,"onUpdate:modelValue":n[4]||(n[4]=v=>D.value.columns=v),"item-key":"_id",group:"columns",animation:180,"ghost-class":"kanban-ghost","chosen-class":"kanban-chosen","drag-class":"kanban-dragging","force-fallback":!0,disabled:h(l),class:_e(["flex gap-3",{"overflow-x-auto snap-x snap-mandatory w-full pb-4 mobile-scroll-visible":h(l),"min-w-max":!h(l)}]),direction:"horizontal",onEnd:M,onStart:d},{item:A(({element:v,index:u})=>[o("div",{class:_e(["rounded-lg bg-bg-surface h-full",{"snap-center min-w-[270px] max-w-[270px]":h(l),"min-w-[320px] max-w-[320px]":!h(l)}])},[_(Et,{listOwnerId:v._id,plusIcon:x.plusIcon,canDragList:!h(l),onOnPlus:n[0]||(n[0]=s=>T("onPlus",s)),"onUpdate:column":n[1]||(n[1]=s=>T("update:column",s)),index:u,totalColumns:D.value.columns.length,"onSelect:ticket":n[2]||(n[2]=s=>T("select:ticket",s)),"onDelete:column":n[3]||(n[3]=s=>T("delete:column",s)),column:v,onReorder:g,"onDrag:start":$,"onMove:column":y},{emptyState:A(({column:s})=>[ce(x.$slots,"emptyState",{column:s},void 0,!0)]),ticket:A(({ticket:s,index:S})=>[ce(x.$slots,"ticket",{ticket:s,index:S},void 0,!0)]),footer:A(({column:s})=>[ce(x.$slots,"column-footer",{column:s},void 0,!0)]),_:2},1032,["listOwnerId","plusIcon","canDragList","index","totalColumns","column"])],2)]),_:3},8,["modelValue","disabled","class"])]))}}),At=he(Dt,[["__scopeId","data-v-b07ae910"]]),Ut={class:"flex justify-between gap-2 items-start"},Nt={class:"flex items-start gap-3 flex-1"},Mt={class:"flex-1 min-w-0"},Bt={class:"text-sm font-semibold text-text-primary leading-tight mb-1"},zt={key:0,class:"text-xs text-text-secondary line-clamp-2"},Lt=se({__name:"ProcessKanbanCard",props:{ticket:{},index:{}},emits:["click","open-builder","dblclick"],setup(b,{emit:i}){const l=b,C=i,m=p(!1),d=Be(),{workspaceId:$}=ge();function f(){return[{label:"Open Workflow Builder",action:()=>{C("open-builder")},icon:{prefix:"fa-regular",iconName:"fa-diagram-project"}},{label:"Delete Process",danger:!0,action:()=>{m.value=!0},icon:{prefix:"fa-regular",iconName:"fa-trash"}}]}const{mutate:T,isPending:D}=ht({onSuccess:()=>{m.value=!1,d.invalidateQueries({queryKey:["process-groups-with-transitions"]})}}),M=()=>{T({workspace_id:$.value,transition_id:l.ticket._id})};return(g,a)=>{var y,U;return E(),N(Ce,null,[o("div",{onClick:a[1]||(a[1]=x=>g.$emit("click")),onDblclick:a[2]||(a[2]=x=>g.$emit("dblclick")),class:"bg-bg-card rounded-lg p-4 shadow-sm cursor-pointer hover:shadow-md transition-all duration-200 border border-border hover:border-accent"},[o("div",Ut,[o("div",Nt,[a[6]||(a[6]=o("div",{class:"w-10 h-10 bg-accent/20 flex justify-center items-center rounded-lg"},[o("i",{class:"fa-solid fa-diagram-project text-accent"})],-1)),o("div",Mt,[o("h3",Bt,X(((y=g.ticket)==null?void 0:y.title)??`Process ${g.index+1}`),1),(U=g.ticket)!=null&&U.description?(E(),N("p",zt,X(g.ticket.description),1)):te("",!0)])]),_(Oe,{onClick:a[0]||(a[0]=Z(()=>{},["stop"])),items:f()},{trigger:A(()=>a[7]||(a[7]=[o("i",{class:"cursor-pointer fa-solid fa-ellipsis text-text-secondary hover:text-text-primary"},null,-1)])),_:1},8,["items"])])],32),_(qe,{onClick:a[3]||(a[3]=Z(()=>{},["stop"])),modelValue:m.value,"onUpdate:modelValue":a[4]||(a[4]=x=>m.value=x),title:"Delete Process",itemLabel:"process",itemName:g.ticket.title,requireMatchText:g.ticket.title,confirmText:"Delete Process",cancelText:"Cancel",size:"md",loading:h(D),onConfirm:M,onCancel:a[5]||(a[5]=()=>{m.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"])],64)}}}),jt={class:"workflow-wrap"},Kt={class:"absolute bottom-20 right-2 flex flex-col gap-2 z-10 bg-accent p-1 rounded-lg shadow-md border border-accent"},Wt={class:"relative min-w-[60px] px-1.5 py-0.5 rounded-md text-xs"},Ft={class:"flex justify-between items-center gap-1.5"},Ot={class:"truncate"},qt={class:"flex items-center gap-1.5"},Gt=["onClick"],Ht=["onClick"],Rt={class:"modal border border-border !bg-bg-body text-text-primary"},Qt={class:"modal-actions mt-4"},Zt={class:"modal border border-border !bg-bg-body text-text-primary"},Jt={class:"modal-actions mt-4"},Xt=se({__name:"WorkflowCanvas",props:{processId:{},showTransitionLabels:{type:Boolean},workflowData:{}},emits:["edit:node","save","update:workflow","add:status","add:transition"],setup(b,{expose:i,emit:l}){const C=p(!1),m=p(""),d=p(null),$=p([]),f=p([]),{setNodes:T,updateNode:D,addEdges:M,setEdges:g,removeEdges:a,onNodesInitialized:y,fitView:U,updateNodeInternals:x,addNodes:n,project:v,getNodes:u,getEdges:s,zoomIn:S,zoomOut:L}=mt(),{workspaceId:O}=lt(),q=b;ne(()=>q.workflowData,async t=>{if(t){const e=t.flow_diagram||t,c=Array.isArray(e.nodes)?e.nodes.map(P):[],z=Array.isArray(e.edges)?e.edges.map(j):[];await ke(),T(c),y(async()=>{c.forEach(W=>x(W.id)),g(z),U({padding:.5,maxZoom:1})})}},{immediate:!0});function H(){const t=Ee();k("save",t)}function Y(){const t=Ee();console.log(" >>> saving workflow (process2)",t),k("save",t)}i({openCreateNodeModal:F,handleAddNode:B,saveWorkflow:Y,triggerSave:H,handleConfirmEdit:ue});function P(t){return{id:t.id,type:t.type??"default",position:t.position,data:t.data,style:t.style}}function I(t){const e=(t??"arrow").toLowerCase();return e==="arrow"?fe.Arrow:e==="arrowclosed"?fe.ArrowClosed:fe.Arrow}function j(t){var z,W,Ue,Ne,Me;const e=t.markerEnd||t.marker_end,c=t.style;return{id:t.id||((z=t.flow_metadata)==null?void 0:z.transition_id),type:t.type??"step",source:t.source??((Ue=(W=t.flow_metadata)==null?void 0:W.source_node)==null?void 0:Ue.id),target:t.target??((Me=(Ne=t.flow_metadata)==null?void 0:Ne.target_node)==null?void 0:Me.id),sourceHandle:t.sourceHandle??t.source_handle,targetHandle:t.targetHandle??t.target_handle,label:t.label,data:t.data,animated:t.animated??!1,style:c?{...c,strokeWidth:Number(c.strokeWidth??2)}:void 0,markerEnd:e?{type:I(e.type),color:e.color,width:Number(e.width??18),height:Number(e.height??18)}:void 0}}function me(t){V.value=t,le.value="",de.value=!0}function r(){var W;if(!V.value)return;const t=V.value,e=le.value.trim()||"Transition",c=`${t.source}-${t.target}-${((W=crypto.randomUUID)==null?void 0:W.call(crypto))??Math.random()}`,z={...t,id:c,type:"step",label:e,data:{name:e},style:{stroke:"#1152de",strokeWidth:2},markerEnd:{type:fe.Arrow,color:"#1152de",width:18,height:18},sourceHandle:t.sourceHandle,targetHandle:t.targetHandle};M(z),de.value=!1,V.value=null,le.value=""}function w(){de.value=!1,V.value=null,le.value=""}const K={type:"default",animated:!1,style:{strokeWidth:2},markerEnd:{type:fe.Arrow,color:"#3b82f6",width:18,height:18},labelBgPadding:[6,2],labelBgBorderRadius:6,updatable:!0},re=p(!1),be=p(""),de=p(!1),le=p(""),V=p(null),k=l;function F(){be.value="",re.value=!0}function R(t,e){const c=u.value.find(z=>z.id===t);console.log(c,">>>>"),c&&k("edit:node",{id:t,...c.data,status_color:e.status||"#6b7280"})}function ue(t,e){e&&D(t,c=>({...c,data:{...c.data,label:e.name,status:e.category},style:{border:"2px solid #64748b",borderRadius:"8px",background:e.status_color}})),ke()}async function B(t){const c=(()=>{var W;return((W=crypto.randomUUID)==null?void 0:W.call(crypto))??`n-${Date.now()}-${Math.random()}`})(),z=v({x:t.position_x,y:t.position_y});n({id:c,position:z,data:{label:t.name,status:t.status_name},style:{border:"2px solid #64748b",borderRadius:"8px",background:t.status_color}})}function $e(t){if(!t)return;const e=String(t).toLowerCase();return e.includes("arrowclosed")?"arrowclosed":e.includes("arrow")?"arrow":e.includes("circle")?"circle":e.includes("square")?"square":e.includes("diamond")?"diamond":e.includes("dot")?"dot":"arrow"}function ye(t){return{id:t.id,type:t.type??"default",position:t.position,data:t.data,style:t.style}}function Ze(t){const e=t.markerEnd,c=e?(()=>{const z=typeof e=="string"?e:e.type;return{type:$e(z),color:typeof e=="string"?void 0:e.color,width:typeof e=="string"?void 0:Number(e.width??18),height:typeof e=="string"?void 0:Number(e.height??18)}})():void 0;return{id:t.id,type:t.type??"step",source:t.source,target:t.target,source_handle:t.sourceHandle,target_handle:t.targetHandle,label:t.label,data:t.data,style:t.style?{...t.style,strokeWidth:Number(t.style.strokeWidth??2)}:void 0,marker_end:c,animated:!!t.animated}}function Ee(){const t=u.value,e=s.value;return{workspace_id:O.value,flow_diagram:{nodes:t.map(ye),edges:e.map(Ze)}}}window.addEventListener("beforeunload",()=>{});function Je(t){var e;console.log(t,"edge"),d.value=t.id,m.value=String(t.label??((e=t.data)==null?void 0:e.name)??""),C.value=!0}function Pe(){if(!d.value)return;const t=m.value.trim();g(e=>e.map(c=>{var z;return c.id===d.value?{...c,label:t||c.label,data:{...c.data??{},name:t||((z=c.data)==null?void 0:z.name)}}:c})),C.value=!1,d.value=null,m.value=""}function Xe(){d.value&&(a([d.value]),C.value=!1,d.value=null,m.value="")}function Ye(t){T(e=>e.filter(c=>c.id!==t)),g(e=>e.filter(c=>c.source!==t&&c.target!==t)),d.value=null}function et(t){window.confirm("Are you sure you want to delete this status? All transitions will also be removed.")&&Ye(t)}function tt(t){const{edge:e,connection:c}=t;!e||!c||g(z=>z.map(W=>W.id===e.id?{...W,source:c.source,target:c.target,sourceHandle:c.sourceHandle,targetHandle:c.targetHandle}:W))}function De(){C.value=!1,d.value=null,m.value=""}function ot({event:t,edge:e}){console.log(">>> click",e),Je(e),t.stopPropagation()}ze(()=>{window.addEventListener("workflow:zoom",Ae)}),nt(()=>{window.removeEventListener("workflow:zoom",Ae)});function Ae(t){const e=t.detail;e&&(e.action==="in"&&S(),e.action==="out"&&L(),e.action==="reset"&&U({padding:.12}))}return(t,e)=>(E(),N(Ce,null,[o("div",jt,[_(h(ft),{nodes:$.value,"onUpdate:nodes":e[3]||(e[3]=c=>$.value=c),edges:f.value,"onUpdate:edges":e[4]||(e[4]=c=>f.value=c),"default-edge-options":K,"nodes-draggable":!0,"nodes-connectable":!0,"elements-selectable":!0,"min-zoom":.01,"max-zoom":100,"fit-view-on-init":"",onConnect:me,onEdgeClick:ot,onEdgeUpdate:tt,"edge-updater-radius":20},{"node-default":A(({id:c,data:z})=>[o("div",Wt,[o("div",Ft,[o("span",Ot,X(z.label),1),o("div",qt,[o("i",{class:"fa-solid fa-edit cursor-pointer text-xs opacity-70 hover:opacity-100",onClick:Z(W=>R(c,z),["stop"])},null,8,Gt),o("i",{class:"fa-solid fa-trash cursor-pointer text-red-500/80 hover:text-red-500 text-xs",onClick:Z(W=>et(c),["stop"])},null,8,Ht)])]),_(h(xe),{id:"in-top",type:"target",position:h(we).Top},null,8,["position"]),_(h(xe),{id:"out-right",type:"source",position:h(we).Right},null,8,["position"]),_(h(xe),{id:"out-bottom",type:"source",position:h(we).Bottom},null,8,["position"]),_(h(xe),{id:"in-left",type:"target",position:h(we).Left},null,8,["position"])])]),default:A(()=>[_(h(vt)),_(h(gt),{"show-zoom":!1,"show-fit-view":!1,"show-interactive":!1,position:"top-right"}),o("div",Kt,[o("button",{onClick:e[0]||(e[0]=c=>h(S)()),class:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded text-white hover:text-gray-500 cursor-pointer",title:"Zoom In"},e[7]||(e[7]=[o("i",{class:"fa-solid fa-plus"},null,-1)])),o("button",{onClick:e[1]||(e[1]=c=>h(L)()),class:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded text-white hover:text-gray-500 cursor-pointer",title:"Zoom Out"},e[8]||(e[8]=[o("i",{class:"fa-solid fa-minus"},null,-1)])),o("button",{onClick:e[2]||(e[2]=c=>h(U)({padding:.2})),class:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded text-white hover:text-gray-500 cursor-pointer",title:"Fit View"},e[9]||(e[9]=[o("i",{class:"fa-solid fa-compress"},null,-1)]))])]),_:1},8,["nodes","edges"]),de.value?(E(),N("div",{key:0,class:"modal-backdrop",onClick:Z(w,["self"])},[o("div",Rt,[e[12]||(e[12]=o("h3",null,"Name this transition",-1)),_(pe,{modelValue:le.value,"onUpdate:modelValue":e[5]||(e[5]=c=>le.value=c),placeholder:"e.g., Start work, Complete",onKeyup:oe(r,["enter"]),autofocus:""},null,8,["modelValue"]),o("div",Qt,[_(J,{size:"sm",onClick:r},{default:A(()=>e[10]||(e[10]=[Q("Add Transition")])),_:1,__:[10]}),_(J,{variant:"secondary",size:"sm",onClick:w},{default:A(()=>e[11]||(e[11]=[Q("Cancel")])),_:1,__:[11]})])])])):te("",!0)]),C.value?(E(),N("div",{key:0,class:"modal-backdrop",onClick:Z(De,["self"])},[o("div",Zt,[e[16]||(e[16]=o("h3",null,"Edit transition",-1)),_(pe,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=c=>m.value=c),placeholder:"Transition name",onKeyup:oe(Pe,["enter"]),autofocus:""},null,8,["modelValue"]),o("div",Jt,[_(J,{size:"sm",onClick:Pe},{default:A(()=>e[13]||(e[13]=[Q("Save")])),_:1,__:[13]}),_(J,{variant:"secondary",size:"sm",onClick:De},{default:A(()=>e[14]||(e[14]=[Q("Cancel")])),_:1,__:[14]}),_(J,{size:"sm",variant:"danger",onClick:Xe},{default:A(()=>e[15]||(e[15]=[Q(" Delete ")])),_:1,__:[15]})])])])):te("",!0)],64))}}),Yt=he(Xt,[["__scopeId","data-v-ae4f0455"]]),eo={class:"p-6"},to={class:"text-lg font-semibold text-text-primary mb-4"},oo={class:"space-y-4"},so={class:"flex items-center gap-3"},lo={class:"mt-6 flex justify-end gap-2"},no=se({__name:"AddStatusModal",props:{modelValue:{type:Boolean},processId:{},editingStatus:{}},emits:["update:modelValue","status:added","edit:node"],setup(b,{emit:i}){const l=b,C=i,m=G({get:()=>l.modelValue,set:u=>C("update:modelValue",u)}),d=it("workflowState"),$=p(""),f=p("todo"),T=p("#6b7280"),D=p(!1),M=p(!1),g=p(!1),a={todo:"#6b7280",inprogress:"#3b82f6",done:"#10b981"},y=G(()=>!!l.editingStatus);ne(l,()=>{var u,s,S,L,O,q;$.value=((u=l.editingStatus)==null?void 0:u.label)||"",f.value=((s=l.editingStatus)==null?void 0:s.status)||"todo",T.value=((S=l.editingStatus)==null?void 0:S.status_color)||((L=l.editingStatus)==null?void 0:L.status)||"#6b7280",D.value=((O=l.editingStatus)==null?void 0:O.is_initial)||!1,M.value=((q=l.editingStatus)==null?void 0:q.is_final)||!1});function U(){T.value=a[f.value]}function x(){}function n(){$.value="",m.value=!1}function v(){if($.value.trim()){g.value=!0;try{if(y.value){console.log("editing mode on ");const u={...l.editingStatus,name:$.value.trim(),category:f.value,status_color:T.value,is_initial:D.value,is_final:M.value,status_name:$.value.trim()};d.updateStatus(l.editingStatus.id,u),C("edit:node",l.editingStatus.id,u)}else{console.log("editing mode close ");const u={process_id:l.processId,name:$.value.trim(),category:f.value,status_color:T.value,is_initial:D.value,is_final:M.value,status_name:f.value.trim(),position_x:Math.random()*400+100,position_y:Math.random()*300+100,order:d.localStatuses.value.length};d.addStatus(u),C("status:added",u)}n()}catch{Te.error(y.value?"Failed to update status":"Failed to add status")}finally{g.value=!1}}}return(u,s)=>(E(),ie(Le,{modelValue:m.value,"onUpdate:modelValue":s[4]||(s[4]=S=>m.value=S),size:"md"},{default:A(()=>[o("div",eo,[o("h3",to,X(y.value?"Edit Status":"Add Status"),1),o("div",oo,[o("div",null,[s[5]||(s[5]=o("label",{class:"text-sm font-medium text-text-primary mb-1.5 block"},"Status Name",-1)),_(pe,{modelValue:$.value,"onUpdate:modelValue":s[0]||(s[0]=S=>$.value=S),placeholder:"e.g., To Do, In Progress, Done",autofocus:!0},null,8,["modelValue"])]),o("div",null,[s[7]||(s[7]=o("label",{class:"text-sm font-medium text-text-primary mb-1.5 block"},"Category",-1)),ve(o("select",{"onUpdate:modelValue":s[1]||(s[1]=S=>f.value=S),onChange:U,class:"w-full px-3 py-2 text-sm bg-bg-surface border border-border rounded-md text-text-primary focus:outline-none focus:ring-1 focus:ring-accent"},s[6]||(s[6]=[o("option",{value:"todo"},"To Do",-1),o("option",{value:"inprogress"},"In Progress",-1),o("option",{value:"done"},"Done",-1)]),544),[[at,f.value]]),s[8]||(s[8]=o("p",{class:"text-xs text-text-secondary mt-1"},"Category cannot be changed after creation",-1))]),o("div",null,[s[9]||(s[9]=o("label",{class:"text-sm font-medium text-text-primary mb-1.5 block"},"Status Color",-1)),o("div",so,[ve(o("input",{type:"color","onUpdate:modelValue":s[2]||(s[2]=S=>T.value=S),onInput:x,class:"h-10 w-20 rounded border border-border cursor-pointer"},null,544),[[Ve,T.value]]),_(pe,{modelValue:T.value,"onUpdate:modelValue":s[3]||(s[3]=S=>T.value=S),placeholder:"#3b82f6",class:"flex-1"},null,8,["modelValue"])])])]),o("div",lo,[_(J,{onClick:n,variant:"secondary"},{default:A(()=>s[10]||(s[10]=[Q("Cancel")])),_:1,__:[10]}),_(J,{onClick:v,disabled:!$.value.trim()||g.value},{default:A(()=>[Q(X(g.value?y.value?"Updating...":"Adding...":y.value?"Update Status":"Add Status"),1)]),_:1},8,["disabled"])])])]),_:1},8,["modelValue"]))}}),ao={class:"relative flex h-full w-full flex-col bg-bg-body",role:"dialog","aria-modal":"true",tabindex:"0"},io={class:"border-b border-border px-[20px] sm:px-6 py-4 overflow-x-auto"},ro={class:"flex items-center justify-between max-w-content gap-3"},uo={class:"flex items-center gap-4"},co={class:"flex items-center gap-2 text-lg sm:text-xl font-semibold text-text-primary text-nowrap"},po={class:"flex items-center gap-3"},mo={class:"relative flex-1 overflow-hidden"},fo={key:0,class:"flex items-center justify-center h-full bg-bg-surface"},vo=se({__name:"ProcessWorkflowBuilderModal",props:{modelValue:{type:Boolean},process:{}},emits:["update:modelValue","close"],setup(b,{emit:i}){const l=b,C=i,m=p(null),d=p(!1),$=p(null),f=G(()=>l.modelValue),T=G(()=>{var P,I;return((P=l.process)==null?void 0:P._id)??((I=l.process)==null?void 0:I.id)??""}),D=G(()=>{var P;return((P=l.process)==null?void 0:P.title)??"Process Workflow"}),{workspaceId:M}=ge(),{data:g,isLoading:a,refetch:y}=Re(M,T,{enabled:G(()=>f.value&&!!T.value)}),U=bt();rt("workflowState",U),ne(()=>g.value,P=>{P&&f.value});const{mutate:x,isPending:n}=Ie({onSuccess:()=>{y()}}),v=G(()=>n.value?"Saving...":"Save Workflow");function u(){var P;(P=m.value)==null||P.triggerSave()}function s(P){x({workspace_id:M.value,transition_id:T.value,payload:{raw_object:P}})}function S(){C("update:modelValue",!1),C("close")}function L(){d.value=!0,$.value=""}function O(P){var I,j;d.value=!1,(j=(I=m.value)==null?void 0:I.handleAddNode)==null||j.call(I,P)}function q(P){$.value=P,d.value=!0}function H(P,I){var j;(j=m.value)==null||j.handleConfirmEdit(P,I)}function Y(){y()}return(P,I)=>(E(),N(Ce,null,[_(je,{name:"fade"},{default:A(()=>{var j;return[f.value?(E(),N("div",{key:0,class:"fixed inset-0 z-50 bottom-[60px] sm:bottom-0 flex items-center justify-center bg-black/80 backdrop-blur-sm",onKeydown:oe(S,["esc"])},[o("div",ao,[o("div",io,[o("div",ro,[o("div",uo,[o("h2",co,[I[1]||(I[1]=o("i",{class:"fa-solid fa-diagram-project text-accent","aria-hidden":"true"},null,-1)),Q(" Workflow for "+X(D.value),1)])]),o("div",po,[_(J,{variant:"secondary",size:"sm",onClick:L},{default:A(()=>I[2]||(I[2]=[o("i",{class:"fa-solid fa-plus mr-2","aria-hidden":"true"},null,-1),Q(" Add Status ")])),_:1,__:[2]}),_(J,{variant:"primary",size:"sm",disabled:h(n),onClick:u},{default:A(()=>[Q(X(v.value),1)]),_:1},8,["disabled"]),o("button",{class:"text-xl text-text-secondary hover:text-text-primary",onClick:S,"aria-label":"Close"},I[3]||(I[3]=[o("i",{class:"fa-solid fa-times","aria-hidden":"true"},null,-1)]))])])]),o("div",mo,[h(a)?(E(),N("div",fo,I[4]||(I[4]=[o("div",{class:"flex flex-col items-center gap-4"},[o("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-accent border-t-transparent"}),o("p",{class:"text-sm text-text-secondary"},"Loading workflow data...")],-1)]))):(E(),ie(Yt,{key:1,ref_key:"Canvas",ref:m,"process-id":T.value,"workflow-data":((j=h(g))==null?void 0:j.raw_object)||{},"show-transition-labels":!0,onSave:s,"onUpdate:workflow":Y,"onAdd:status":L,"onEdit:node":q},null,8,["process-id","workflow-data"]))])])],32)):te("",!0)]}),_:1}),_(no,{modelValue:d.value,"onUpdate:modelValue":I[0]||(I[0]=j=>d.value=j),"process-id":T.value,"editing-status":$.value,"onStatus:added":O,"onEdit:node":H},null,8,["modelValue","process-id","editing-status"])],64))}}),go=he(vo,[["__scopeId","data-v-8f8f110a"]]),bo={class:"p-6"},yo={class:"space-y-4"},xo={class:"space-y-2"},wo={class:"flex justify-end gap-3 mt-6"},ko=se({__name:"AddTransitionModal",props:{modelValue:{type:Boolean},group:{}},emits:["update:modelValue","created"],setup(b,{emit:i}){const l=b,C=i,{workspaceId:m}=ge(),d=p({title:"",description:"",variable_type:"",transition_type:"forward"});Ke(()=>{console.log(d.value.variable_type)});const{data:$}=Qe(m),f=G(()=>{var a;return $.value?(Array.isArray($.value)?$.value:((a=$.value)==null?void 0:a.data)||[]).map(y=>({title:y.title||y.name,_id:y._id||y.id})):[]}),{mutate:T,isPending:D}=_t({onSuccess:()=>{Te.success("Process created successfully"),C("created"),C("update:modelValue",!1),d.value={title:"",description:"",variable_type:"",transition_type:"forward"}},onError:g=>{Te.error((g==null?void 0:g.message)||"Failed to create process")}}),M=()=>{if(!d.value.title||!d.value.variable_type)return;const g=f.value.find(y=>y._id===d.value.variable_type),a=g?g.title:d.value.variable_type;T({workspace_id:m.value,group_id:l.group._id,...d.value,variable_type:a,sort_id:l.group.cards?l.group.cards.length:0})};return(g,a)=>(E(),ie(Le,{modelValue:g.modelValue,"onUpdate:modelValue":a[4]||(a[4]=y=>g.$emit("update:modelValue",y)),size:"md"},{default:A(()=>[o("div",bo,[a[8]||(a[8]=o("h2",{class:"text-xl font-semibold text-text-primary mb-6"},"Add Process Card",-1)),o("div",yo,[_(pe,{label:"Title",modelValue:d.value.title,"onUpdate:modelValue":a[0]||(a[0]=y=>d.value.title=y),placeholder:"e.g. Start Task",autofocus:!0},null,8,["modelValue"]),o("div",xo,[a[5]||(a[5]=o("label",{class:"block text-sm font-medium text-text-primary"},"Variable Type",-1)),_(We,{modelValue:d.value.variable_type,"onUpdate:modelValue":a[1]||(a[1]=y=>d.value.variable_type=y),options:f.value,placeholder:"Select Type",class:"w-full"},null,8,["modelValue","options"])]),_(Ge,{label:"Description",modelValue:d.value.description,"onUpdate:modelValue":a[2]||(a[2]=y=>d.value.description=y),placeholder:"Optional description"},null,8,["modelValue"]),o("div",wo,[_(J,{variant:"secondary",onClick:a[3]||(a[3]=y=>g.$emit("update:modelValue",!1))},{default:A(()=>a[6]||(a[6]=[Q("Cancel")])),_:1,__:[6]}),_(J,{variant:"primary",onClick:M,loading:h(D)},{default:A(()=>a[7]||(a[7]=[Q("Create Process")])),_:1,__:[7]},8,["loading"])])])])]),_:1},8,["modelValue"]))}}),_o={class:"sticky top-0 z-10 border-b border-border px-4 sm:px-6 py-[9px] flex items-center justify-between bg-bg-card"},ho={class:"flex items-center gap-2"},Co=["aria-label"],$o={key:0,class:"flex justify-center items-center h-40"},To={key:1,class:"py-5 px-4 sm:px-6 flex flex-col gap-5 flex-grow"},So={class:"capitalize"},Vo={key:0,class:"relative"},Io=["onKeydown"],Eo={class:"space-y-2"},Po=["innerHTML"],Do={key:1,class:"opacity-60"},Ao={class:"grid grid-cols-2 gap-4 mt-2"},Uo={class:"rounded-[6px] bg-orchit-white/5 border border-orchit-white/10 p-4 flex flex-col items-center justify-center"},No={class:"text-2xl font-bold text-accent"},Mo={class:"rounded-[6px] bg-orchit-white/5 border border-orchit-white/10 p-4 flex flex-col items-center justify-center"},Bo={class:"text-2xl font-bold text-accent"},zo=se({__name:"ProcessSidePanel",props:{showPanel:{type:Boolean},details:{}},emits:["close"],setup(b,{emit:i}){const l=b,C=i,m=p(!1),{workspaceId:d}=ge(),$=G(()=>{var r;return(r=l.details)==null?void 0:r._id}),{data:f,isLoading:T,refetch:D}=Re(d,$,{enabled:G(()=>!!$.value&&l.showPanel)}),{refetch:M}=He(d,{enabled:G(()=>!!$.value&&l.showPanel)}),{data:g}=Qe(d),a=G(()=>(g.value||[]).map(w=>({_id:w.slug||w.title||w._id,title:w.title}))),y=p(""),U=p(""),x=p("");ne(()=>f.value,r=>{r&&(y.value=r.title||"",U.value=r.description||"",x.value=r.variable_type||"")},{immediate:!0});const n=G(()=>{var w;const r=(w=f.value)==null?void 0:w.raw_object;return r!=null&&r.nodes&&Array.isArray(r.nodes)?r.nodes.length:r!=null&&r.elements&&Array.isArray(r.elements)?r.elements.filter(K=>!K.source).length:0}),v=G(()=>{var w;const r=(w=f.value)==null?void 0:w.raw_object;return r!=null&&r.edges&&Array.isArray(r.edges)?r.edges.length:r!=null&&r.elements&&Array.isArray(r.elements)?r.elements.filter(K=>K.source&&K.target).length:0}),{mutate:u}=Ie({onSuccess:()=>{D(),M()}}),s=p(!1),S=p(null);function L(){var r;y.value=((r=f.value)==null?void 0:r.title)||l.details.title,s.value=!0,ke(()=>{var w;return(w=S.value)==null?void 0:w.focus()})}function O(){var r;y.value.trim()!==((r=f.value)==null?void 0:r.title)&&u({workspace_id:d.value,transition_id:l.details._id,payload:{title:y.value.trim()}}),s.value=!1}function q(){var r;y.value=((r=f.value)==null?void 0:r.title)||"",s.value=!1}const H=p(!1),Y=p(null);function P(){H.value=!0}function I(){var r;U.value!==((r=f.value)==null?void 0:r.description)&&u({workspace_id:d.value,transition_id:l.details._id,payload:{description:U.value}}),H.value=!1}function j(r){var K;if(!H.value)return;const w=r.target;(K=Y.value)!=null&&K.contains(w)||I()}ze(()=>document.addEventListener("mousedown",j)),dt(()=>document.removeEventListener("mousedown",j));function me(r){x.value=r,u({workspace_id:d.value,transition_id:l.details._id,payload:{variable_type:r}})}return(r,w)=>(E(),ie(je,{name:"panel",appear:""},{default:A(()=>[ve(o("div",{class:_e(["flex flex-col h-full overflow-y-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur rounded-[6px] shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] border border-orchit-white/5 overflow-hidden transition-all duration-300 ease-in-out",m.value?"min-w-full max-w-full":"min-w-full max-w-[380px] sm:min-w-[380px]"]),role:"complementary","aria-label":"Details panel"},[o("div",_o,[w[5]||(w[5]=o("h5",{class:"text-[18px] font-semibold tracking-tight"},"Details",-1)),o("div",ho,[o("button",{class:"p-2 rounded-xl hover:bg-orchit-white/5 active:scale-[.98] cursor-pointer transition",onClick:w[0]||(w[0]=K=>m.value=!m.value),"aria-label":m.value?"Collapse details":"Expand details"},[o("i",{class:_e(["fa-solid",m.value?"fa-compress":"fa-expand","text-lg"])},null,2)],8,Co),o("button",{class:"p-2 rounded-xl hover:bg-orchit-white/5 active:scale-[.98] cursor-pointer transition",onClick:w[1]||(w[1]=()=>C("close")),"aria-label":"Close details"},w[4]||(w[4]=[o("i",{class:"fa-solid fa-xmark text-lg"},null,-1)]))])]),h(T)?(E(),N("div",$o,w[6]||(w[6]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-4 border-accent border-t-transparent"},null,-1)]))):(E(),N("div",To,[o("div",So,[s.value?(E(),N("div",Vo,[ve(o("input",{ref_key:"titleInput",ref:S,"onUpdate:modelValue":w[2]||(w[2]=K=>y.value=K),onBlur:O,onKeydown:[oe(Z(O,["prevent"]),["enter"]),oe(Z(q,["prevent"]),["esc"])],class:"w-full text-2xl font-semibold rounded-[6px] px-3 py-2 bg-orchit-white/5 border border-orchit-white/10 focus:outline-none focus:ring-2 focus:ring-accent/40 transition",type:"text"},null,40,Io),[[Ve,y.value]])])):(E(),N("h2",{key:1,class:"text-[20px] leading-[28px] font-semibold tracking-tight rounded-[6px] px-2 py-2 hover:bg-bg-dropdown transition cursor-text hover:border border-border",onClick:L},X(y.value||"Untitled"),1))]),o("div",Eo,[w[7]||(w[7]=o("div",{class:"mb-2 text-base font-semibold tracking-wide px-1"},"Variable Type",-1)),_(We,{options:a.value,placeholder:"Select Type","model-value":x.value,"onUpdate:modelValue":me,size:"md"},null,8,["options","model-value"])]),o("div",null,[w[8]||(w[8]=o("h3",{class:"mb-2 text-base font-semibold tracking-wide px-1"},"Description",-1)),H.value?(E(),N("div",{key:1,ref_key:"descEditorWrap",ref:Y,class:"rounded-[6px] overflow-hidden border border-orchit-white/10 shadow-sm"},[_(Ge,{modelValue:U.value,"onUpdate:modelValue":w[3]||(w[3]=K=>U.value=K),onFocusOut:I},null,8,["modelValue"])],512)):(E(),N("div",{key:0,class:"text-[15px] leading-6 text-text-secondary whitespace-pre-wrap rounded-[6px] px-4 py-3 border border-orchit-white/10 bg-orchit-white/5 hover:border-orchit-white/20 transition cursor-text",onClick:P},[U.value?(E(),N("div",{key:0,innerHTML:U.value},null,8,Po)):(E(),N("span",Do,"Click to add a descriptionâ€¦"))]))]),o("div",Ao,[o("div",Uo,[o("span",No,X(n.value),1),w[9]||(w[9]=o("span",{class:"text-xs uppercase tracking-wider text-text-secondary mt-1"},"Total Status",-1))]),o("div",Mo,[o("span",Bo,X(v.value),1),w[10]||(w[10]=o("span",{class:"text-xs uppercase tracking-wider text-text-secondary mt-1"},"Total Transitions",-1))])])]))],2),[[ut,r.showPanel]])]),_:1}))}}),Lo=he(zo,[["__scopeId","data-v-902e8438"]]),jo={class:"flex-auto flex-grow h-full bg-bg-card rounded-[6px] border border-border overflow-hidden flex flex-col"},Ko={key:1,class:"flex-1 w-full p-4 overflow-x-auto flex items-start gap-4"},Wo={class:"min-w-[300px] max-w-[300px] shrink-0"},Fo={key:1,class:"bg-bg-body rounded-lg p-3 border border-border shadow-sm"},Oo={class:"flex items-center gap-2"},Yo=se({__name:"Process2",setup(b){const{workspaceId:i}=ge(),{data:l,isPending:C}=He(i.value);Ke(()=>{console.log(l.value,"this ....")});const m=p([]);ne(l,V=>{var F;const k=((F=V==null?void 0:V.data)==null?void 0:F.groups)||(V==null?void 0:V.groups)||[];k&&(m.value=k.map(R=>({...R,cards:R.transitions||[]})))},{immediate:!0});const d=p(!1),$=p(""),f=Be(),{mutate:T,isPending:D}=yt({onSuccess:()=>{$.value="",d.value=!1,f.invalidateQueries({queryKey:["process-groups-with-transitions"]})}});function M(){const V=$.value.trim();V&&T({workspace_id:i.value,title:V,sort_order:m.value.length})}const g=p(!1),a=p(null),{mutate:y,isPending:U}=wt({onSuccess:()=>{g.value=!1,f.invalidateQueries({queryKey:["process-groups-with-transitions"]})}}),x=V=>{a.value=V,g.value=!0},n=()=>{a.value&&y({workspace_id:i.value,group_id:a.value.columnId})},{mutate:v}=xt({onSuccess:()=>{f.invalidateQueries({queryKey:["process-groups-with-transitions"]})}}),u=V=>{v({workspace_id:i.value,group_id:V._id,payload:{title:V.title}})},{mutate:s}=kt(),{mutate:S}=Ct(),{mutate:L}=Ie({onSuccess:()=>{f.invalidateQueries({queryKey:["process-groups-with-transitions"]})}}),O=V=>{if(V.type==="column"){const k=V.board.columns.map((F,R)=>({group_id:F._id,sort_order:R}));s({workspace_id:i.value,groups:k})}else if(V.type==="ticket"){const k=V.meta;if(console.log(m.value,"..."),console.log("hites",k),k.fromColumnId===k.toColumnId){const F=m.value.find(R=>R._id===k.toColumnId);if(F){const R=F.cards.map((ue,B)=>({transition_id:ue._id,sort_id:B}));S({workspace_id:i.value,group_id:k.toColumnId,transitions:R})}}else{const F=k.moved;F&&k.toColumnId&&L({workspace_id:i.value,transition_id:F._id,payload:{group_id:k.toColumnId}})}}},q=p(null),H=p(!1),Y=p(!1),P=p(null),I=p(null),j=V=>{q.value=V,H.value=!0,Y.value=!1},me=V=>{I.value&&(clearTimeout(I.value),I.value=null),j(V)},r=V=>{I.value&&clearTimeout(I.value),I.value=setTimeout(()=>{I.value=null,P.value=V,Y.value=!0},300)},w=()=>{H.value=!1,q.value=null},K=()=>{Y.value=!1,P.value=null},re=p(!1),be=p(null),de=V=>{be.value=V,re.value=!0},le=()=>{re.value=!1,f.invalidateQueries({queryKey:["process-groups-with-transitions"]})};return(V,k)=>{var F,R,ue;return E(),N(Ce,null,[o("div",jo,[h(C)?(E(),ie(ct,{key:0})):te("",!0),h(C)?te("",!0):(E(),N("div",Ko,[((F=m.value)==null?void 0:F.length)>0?(E(),ie(At,{key:0,"onDelete:column":k[0]||(k[0]=B=>x(B)),"onUpdate:column":k[1]||(k[1]=B=>u(B)),onOnPlus:de,"onSelect:ticket":r,board:m.value,onReorder:O},{ticket:A(({ticket:B,index:$e})=>[_(Lt,{onClick:ye=>r(B),onDblclick:ye=>me(B),onOpenBuilder:ye=>j(B),ticket:B,index:$e},null,8,["onClick","onDblclick","onOpenBuilder","ticket","index"])]),_:1},8,["board"])):te("",!0),o("div",Wo,[d.value?(E(),N("div",Fo,[_(pe,{size:"md",autofocus:!0,modelValue:$.value,"onUpdate:modelValue":k[3]||(k[3]=B=>$.value=B),placeholder:"Group Name...",class:"mb-3",onKeyup:oe(M,["enter"])},null,8,["modelValue"]),o("div",Oo,[_(J,{onClick:M,variant:"primary",size:"sm",loading:h(D)},{default:A(()=>k[11]||(k[11]=[Q(" Add Group ")])),_:1,__:[11]},8,["loading"]),o("i",{class:"fa-solid fa-close cursor-pointer text-text-secondary hover:text-text-primary px-2",onClick:k[4]||(k[4]=B=>d.value=!1)})])])):(E(),N("div",{key:0,onClick:k[2]||(k[2]=B=>d.value=!0),class:"max-w-82 ms-4 text-sm text-text-primary py-2.5 font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg cursor-pointer"},k[10]||(k[10]=[o("i",{class:"fa-solid fa-plus"},null,-1),o("span",{class:"font-medium"},"Add Process Group",-1)])))])]))]),_(qe,{onClick:k[5]||(k[5]=Z(()=>{},["stop"])),modelValue:g.value,"onUpdate:modelValue":k[6]||(k[6]=B=>g.value=B),title:"Delete Group",itemLabel:"group",itemName:(R=a.value)==null?void 0:R.title,requireMatchText:(ue=a.value)==null?void 0:ue.title,confirmText:"Delete Group",cancelText:"Cancel",size:"md",loading:h(U),onConfirm:n,onCancel:k[7]||(k[7]=()=>{g.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),_(ko,{modelValue:re.value,"onUpdate:modelValue":k[8]||(k[8]=B=>re.value=B),group:be.value,onCreated:le},null,8,["modelValue","group"]),_(go,{modelValue:H.value,"onUpdate:modelValue":k[9]||(k[9]=B=>H.value=B),process:q.value,onClose:w},null,8,["modelValue","process"]),P.value?(E(),ie(Lo,{key:0,showPanel:Y.value,details:P.value,onClose:K},null,8,["showPanel","details"])):te("",!0)],64)}}});export{Yo as default};
