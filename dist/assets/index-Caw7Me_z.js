import{l as L,aw as M,ax as C,c as W,au as d,m as j}from"./index-DXbJhmZM.js";function $(t){return M()?(C(t),!0):!1}const T=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const x=Object.prototype.toString,R=t=>x.call(t)==="[object Object]",p=()=>{},D=F();function F(){var t,i;return T&&((t=window==null?void 0:window.navigator)==null?void 0:t.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((i=window==null?void 0:window.navigator)==null?void 0:i.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function A(t){return Array.isArray(t)?t:[t]}function G(t,i,s){return L(t,i,{...s,immediate:!0})}const I=T?window:void 0;function h(t){var i;const s=d(t);return(i=s==null?void 0:s.$el)!=null?i:s}function S(...t){const i=[],s=()=>{i.forEach(r=>r()),i.length=0},c=(r,o,l,a)=>(r.addEventListener(o,l,a),()=>r.removeEventListener(o,l,a)),f=W(()=>{const r=A(d(t[0])).filter(o=>o!=null);return r.every(o=>typeof o!="string")?r:void 0}),g=G(()=>{var r,o;return[(o=(r=f.value)==null?void 0:r.map(l=>h(l)))!=null?o:[I].filter(l=>l!=null),A(d(f.value?t[1]:t[0])),A(j(f.value?t[2]:t[1])),d(f.value?t[3]:t[2])]},([r,o,l,a])=>{if(s(),!(r!=null&&r.length)||!(o!=null&&o.length)||!(l!=null&&l.length))return;const y=R(a)?{...a}:a;i.push(...r.flatMap(v=>o.flatMap(m=>l.map(b=>c(v,m,b,y)))))},{flush:"post"}),w=()=>{g(),s()};return $(s),w}let O=!1;function B(t,i,s={}){const{window:c=I,ignore:f=[],capture:g=!0,detectIframe:w=!1,controls:r=!1}=s;if(!c)return r?{stop:p,cancel:p,trigger:p}:p;if(D&&!O){O=!0;const e={passive:!0};Array.from(c.document.body.children).forEach(n=>n.addEventListener("click",p,e)),c.document.documentElement.addEventListener("click",p,e)}let o=!0;const l=e=>d(f).some(n=>{if(typeof n=="string")return Array.from(c.document.querySelectorAll(n)).some(u=>u===e.target||e.composedPath().includes(u));{const u=h(n);return u&&(e.target===u||e.composedPath().includes(u))}});function a(e){const n=d(e);return n&&n.$.subTree.shapeFlag===16}function y(e,n){const u=d(e),E=u.$.subTree&&u.$.subTree.children;return E==null||!Array.isArray(E)?!1:E.some(k=>k.el===n.target||n.composedPath().includes(k.el))}const v=e=>{const n=h(t);if(e.target!=null&&!(!(n instanceof Element)&&a(t)&&y(t,e))&&!(!n||n===e.target||e.composedPath().includes(n))){if("detail"in e&&e.detail===0&&(o=!l(e)),!o){o=!0;return}i(e)}};let m=!1;const b=[S(c,"click",e=>{m||(m=!0,setTimeout(()=>{m=!1},0),v(e))},{passive:!0,capture:g}),S(c,"pointerdown",e=>{const n=h(t);o=!l(e)&&!!(n&&!e.composedPath().includes(n))},{passive:!0}),w&&S(c,"blur",e=>{setTimeout(()=>{var n;const u=h(t);((n=c.document.activeElement)==null?void 0:n.tagName)==="IFRAME"&&!(u!=null&&u.contains(c.document.activeElement))&&i(e)},0)},{passive:!0})].filter(Boolean),P=()=>b.forEach(e=>e());return r?{stop:P,cancel:()=>{o=!1},trigger:e=>{o=!0,v(e),o=!1}}:P}export{B as o};
