import{d as R,r as b,n as J,c as g,l as i,o as n,z as y,m as d,h as f,i as B,C as E,t as v,aA as M,az as T,J as x,F as _,y as j,j as O,N as U}from"./index-BwPASTNm.js";const K={key:0,class:"inline-block text-text-secondary -400 ml-1 cursor-help"},P={class:"relative"},Z={key:0,class:"mr-1 text-text-secondary -500"},q={class:"flex flex-wrap gap-2 w-full items-center flex-1"},G={key:0,class:"font-medium"},H={key:1,class:"opacity-70 w-[90%] overflow-ellipsis overflow-hidden"},Q={key:2,class:"w-[90%] overflow-ellipsis overflow-hidden"},W=["onClick","disabled"],X=["placeholder","disabled"],Y={key:1,class:"ml-1 text-text-secondary"},le=R({__name:"BaseEmailChip",props:{modelValue:{default:()=>[]},label:{},tooltip:{},message:{},error:{type:Boolean,default:!1},placeholder:{default:"Add people by email… (Enter, comma, space)"},size:{default:"md"},theme:{default:"light"},disabled:{type:Boolean,default:!1},allowDuplicates:{type:Boolean,default:!1},showName:{type:Boolean,default:!1},validator:{},maxEmails:{default:void 0}},emits:["update:modelValue","invalid","add","remove","limit"],setup(C,{emit:D}){const r=C,o=D,w=b(null),m=b(""),a=b([...r.modelValue]);J(()=>r.modelValue,e=>{JSON.stringify(e)!==JSON.stringify(a.value)&&(a.value=[...e])});const p=g(()=>r.maxEmails&&r.maxEmails>0?r.maxEmails:1/0),h=g(()=>Math.max(0,p.value-a.value.length)),c=g(()=>h.value===0);function $(){var e;!r.disabled&&!c.value&&((e=w.value)==null||e.focus())}const z=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i;function I(e){return(r.validator??(t=>z.test(t)))(e)}function k(e){return e.split(/[\s,;]+/).map(t=>t.trim().toLowerCase()).filter(Boolean)}function N(e){if(h.value===0){o("limit",isFinite(p.value)?Number(p.value):1/0);return}const t=[],s=[],l=r.allowDuplicates?null:new Set(a.value);for(const u of e){if(h.value-t.length<=0)break;if(!I(u)){s.push(u);continue}l&&l.has(u)||(l&&l.add(u),a.value.push(u),t.push(u))}t.length&&o("add",t),s.length&&o("invalid",s),t.length&&s.length===0&&o("invalid",[]),(t.length||s.length)&&o("update:modelValue",[...a.value]),h.value===0&&o("limit",isFinite(p.value)?Number(p.value):1/0)}function V(){!m.value||c.value||(N(k(m.value)),m.value="")}function A(e){var s;if(c.value){e.preventDefault(),o("limit",Number(p.value));return}const t=((s=e.clipboardData)==null?void 0:s.getData("text"))||"";t&&(e.preventDefault(),N(k(t)))}function F(e){if(!r.disabled){if(e.key==="Enter"||e.key==="Tab"||e.key===","||e.key===" "){e.preventDefault(),V();return}if(e.key==="Backspace"&&!m.value&&a.value.length){const t=a.value.pop();o("remove",t),o("update:modelValue",[...a.value])}}}function S(e){if(r.disabled)return;const[t]=a.value.splice(e,1);o("remove",t),o("update:modelValue",[...a.value])}function L(e){const s=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return s.length?s.map(l=>l.charAt(0).toUpperCase()+l.slice(1).toLowerCase()).join(" "):e}return(e,t)=>{const s=T("tooltip");return n(),i("div",{class:y(e.theme==="dark"?"text-white":"text-text-primary")},[e.label?(n(),i("label",{key:0,class:y(["text-base font-medium mb-1 flex items-center",e.theme==="dark"?"text-white":"text-text-primary"])},[B(v(e.label)+" ",1),e.tooltip?E((n(),i("span",K,t[1]||(t[1]=[f("img",{src:M,alt:"info"},null,-1)]))),[[s,e.tooltip]]):d("",!0)],2)):d("",!0),f("div",P,[f("div",{class:y(["flex items-center gap-2 border rounded-[6px] px-3 py-2 w-full text-sm focus-within:ring-2",e.size==="md"?"min-h-10":"min-h-12",e.error?"border-red-500 focus-within:ring-red-500":"focus-within:ring-border",e.theme==="dark"?"bg-[#131318] border-border ":" border-border bg-bg-input",e.disabled?"opacity-60 cursor-not-allowed":""]),onClick:$},[e.$slots.prefix?(n(),i("span",Z,[x(e.$slots,"prefix")])):d("",!0),f("div",q,[(n(!0),i(_,null,j(a.value,(l,u)=>(n(),i("span",{key:l+u,class:"inline-flex items-center w-full gap-2 rounded-full px-2 py-1 text-xs bg-bg-body text-text-secondary"},[e.showName?(n(),i("span",G,v(L(l)),1)):d("",!0),e.showName?(n(),i("span",H,"<"+v(l)+">",1)):(n(),i("span",Q,v(l),1)),f("button",{type:"button",class:"ml-1 rounded hover:bg-bg-surface px-1",title:"Remove",onClick:O(ee=>S(u),["stop"]),disabled:e.disabled},"✕",8,W)]))),128)),E(f("input",{ref_key:"inputRef",ref:w,"onUpdate:modelValue":t[0]||(t[0]=l=>m.value=l),placeholder:c.value?"":a.value.length===0?e.placeholder:"",class:"flex-1 min-w-[160px] bg-transparent outline-none text-sm placeholder:text-text-secondary text-text-primary",disabled:e.disabled||c.value,onKeydown:F,onBlur:V,onPaste:A},null,40,X),[[U,m.value]])]),e.$slots.suffix?(n(),i("span",Y,[x(e.$slots,"suffix")])):d("",!0)],2)]),e.message?(n(),i("p",{key:1,class:y(["mt-2 text-xs flex items-center gap-1",e.error?"text-red-500":(e.theme==="dark","text-text-secondary ")])},[e.$slots.msgIcon?x(e.$slots,"msgIcon",{key:0}):d("",!0),B(" "+v(e.message),1)],2)):d("",!0)],2)}}});export{le as _};
