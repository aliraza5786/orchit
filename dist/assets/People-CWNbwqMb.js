const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KanbanBoard-BKGuvhyT.js","assets/lodash-B3d4OLnQ.js","assets/index-B_w4BlL9.js","assets/index-gkOi0uIN.css","assets/DropMenu.vue_vue_type_script_setup_true_lang-mMDvjKUv.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-DMFxbu7w.js","assets/workspace-U_Py0Doo.js","assets/KanbanBoard-roaNbm1A.css","assets/KanbanCard-BWYpVj9H.js","assets/usePeople-BvUYXi7w.js"])))=>i.map(i=>d[i]);
import{d as ge,Q as ke,r as c,m as $,c as B,a as _e,aa as we,i as n,y as Ce,e as l,h as f,j as k,a6 as he,n as y,b1 as Ve,f as Q,t as p,M as De,aE as Ae,A as oe,L as Se,a9 as pe,g as T,F as q,x as ae,b as be,G as Pe,b2 as Le,ae as $e,o as i,H as Te,J as Ue,q as Ie,b3 as Re,C as ve,w as le,B as fe,a3 as xe,_ as Ee,a4 as ye}from"./index-B_w4BlL9.js";import{D as Ne,K as Oe}from"./Dropdown-DKEptTdi.js";import{b as Ke,c as qe,d as Be,e as Qe,f as je,g as Me,h as ze,i as We,R as Fe,j as Je}from"./usePeople-BvUYXi7w.js";import{_ as He}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-DMFxbu7w.js";import{_ as Ye}from"./BaseEmailChip.vue_vue_type_script_setup_true_lang-CDOCfzJ5.js";import{_ as Ge}from"./ProgressBar.vue_vue_type_script_setup_true_lang-C5znVrM0.js";import{F as Ze}from"./fuse-Ch1WBRTM.js";import{l as Xe}from"./lodash-B3d4OLnQ.js";import{_ as et}from"./SearchBar.vue_vue_type_script_setup_true_lang-Dal04iIV.js";const tt={class:"py-4 flex justify-between items-center border-b border-border px-5 sticky top-0 bg-bg-card z-1"},st={class:"py-4 px-5"},at={class:"bg-bg-surface/50 p-2 rounded-lg flex gap-2 items-center"},lt=["src"],ot={key:0,class:"fa-solid fa-user text-white"},it={class:"text-base font-medium text-text-primary cursor-pointer"},dt={class:"text-sm font-medium text-text-secondary cursor-pointer"},nt={class:"flex flex-col mt-2"},rt={class:"text-sm text-text-secondary mt-2"},ut={key:0},ct={class:"mb-2 capitalize"},mt=["onKeydown"],pt={class:"mt-5 pt-3 border-t border-border-input relstive"},vt=["value"],ft={key:1,class:"mt-3"},xt={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},yt={class:"text-sm text-text-primary"},gt={key:2,class:"mt-3"},_t={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},bt={class:"text-sm text-text-primary"},kt=ge({__name:"DetailPanel",props:{showPanel:{type:Boolean,default:!0},details:{type:Object,default:()=>({})}},emits:["close","update:details","comment:post","priority:change"],setup(m,{emit:me}){var F;const ie=ke({}),w=c("details"),E=[{label:"Details",value:"details"},{label:"Tasks",value:"tasks"},{label:"History",value:"history"}],{data:C}=Ke(),{mutate:_}=qe({onSuccess:()=>{x.invalidateQueries({queryKey:["people-lists"]})}}),a=m,r=c(!1),g=c(a.details["card-title"]??""),de=c(a.details.workspace_lane_id??"");$(()=>a.details["card-title"],o=>{g.value=o,de.value=a.details.workspace_lane_id});const N=c(a.details["card-description"]);$(()=>a.details,()=>{N.value=a.details["card-description"]});const U=c(null);function ne(){r.value=!0,$e(()=>{var o,s;(o=U.value)==null||o.focus(),(s=U.value)==null||s.select()})}function h(){g.value.trim()||(g.value=a.details["card-title"]??""),z.mutate({card_id:a.details._id,variables:{"card-title":g.value.trim()}}),r.value=!1}function j(){g.value=a.details["card-title"]??"",r.value=!1}const M=c({startDate:a.details["start-date"],endDate:a.details["end-date"]}),V=B(()=>a.details["start-date"]);$(V,o=>{M.value={...M.value,startDate:o}});const x=_e(),z=we({onSuccess:()=>{x.invalidateQueries({queryKey:["get-sheets"]}),x.invalidateQueries({queryKey:["sheet-list"]}),x.invalidateQueries({queryKey:["roles"]})}}),re=(o,s)=>{console.log(s,"slug",o),_({id:a.details._id,payload:{variable_values:[{module_variable_id:s,value:o}]}})};function W(o){var s,D,A,b;if((s=a==null?void 0:a.details)!=null&&s.variable_values){const S=(D=a==null?void 0:a.details)==null?void 0:D.variable_values.filter(P=>P.module_variable_id==o);return console.log((A=S[0])==null?void 0:A.value,">>>"),(b=S[0])==null?void 0:b.value}}const I=B(()=>{var o;return(o=a.details)==null?void 0:o.workspace_id}),{data:ue}=Be(I,{enabled:B(()=>!!I.value)}),R=c(((F=a.details)==null?void 0:F.workspace_access_role_id)??""),{mutate:ce}=Qe({onSuccess:()=>{console.log("Role assigned successfully!"),x.invalidateQueries({queryKey:["workspaceRoles"]})},onError:o=>console.error(o)});return $(R,o=>{var s;ce({id:(s=a.details)==null?void 0:s._id,workspace_access_role_id:o})}),$(()=>{var o;return(o=a.details)==null?void 0:o.workspace_access_role_id},o=>{R.value=o??""}),(o,s)=>{var D,A,b,S,P,J,H,Y,G,Z,L,X,ee,O;return i(),n("div",{class:Ce(`max-w-[358px] bg-bg-card  rounded-lg overflow-y-auto overflow-x-hidden relative ${m.showPanel?"!translate-x-0 w-full h-full min-w-[350px] overflow-y-auto":"!translate-x-100 w-0 h-0"} transition-all`)},[l("div",tt,[s[5]||(s[5]=l("h5",{class:"text-[16px] font-medium"},"Profile",-1)),l("i",{class:"cursor-pointer text-text-primary fa-solid fa-close",onClick:s[0]||(s[0]=()=>{o.$emit("close")})})]),l("div",st,[l("div",at,[(D=m.details)!=null&&D.avatar?(i(),n("img",{key:0,src:(A=m.details)==null?void 0:A.avatar,class:"w-10 h-10 rounded-full",alt:"avartar"},null,8,lt)):(i(),n("div",{key:1,class:"min-w-10 max-h-10 aspect-square bg-bg-surface flex justify-center items-center rounded-full",style:he({backgroundColor:(b=m.details)!=null&&b.name?y(Ve)({email:(S=m.details)==null?void 0:S.email}):""})},[Q(p(y(De)((P=m.details)==null?void 0:P.name))+" ",1),(J=m.details)!=null&&J.name?k("",!0):(i(),n("i",ot))],4)),l("div",null,[l("h1",it,p(m.details.name??m.details.title),1),l("p",dt,p(m.details.email),1)])]),f(Ae,{modelValue:w.value,"onUpdate:modelValue":s[1]||(s[1]=e=>w.value=e),class:"my-2",options:E},null,8,["modelValue"]),l("div",nt,[s[6]||(s[6]=l("h1",{class:"text-base font-medium text-text-primary cursor-pointer"}," Task Progress ",-1)),f(Ge,{class:"mt-2",progress:(H=a==null?void 0:a.details)==null?void 0:H.assigned_cards_count,fillColor:"bg-accent ",indeterminate:!0},null,8,["progress"]),l("span",rt,"Completed 10 tasks out of "+p((Y=a==null?void 0:a.details)==null?void 0:Y.assigned_cards_count),1)]),w.value=="details"?(i(),n("section",ut,[l("div",ct,[r.value?oe((i(),n("input",{key:0,ref_key:"titleInput",ref:U,"onUpdate:modelValue":s[2]||(s[2]=e=>g.value=e),onBlur:h,onKeydown:[pe(T(h,["prevent"]),["enter"]),pe(T(j,["prevent"]),["esc"])],class:"border border-border rounded px-2 py-1 w-full text-xl font-medium",type:"text"},null,40,mt)),[[Se,g.value]]):(i(),n("h1",{key:1,class:"text-xl font-medium text-text-primary cursor-pointer",onClick:ne},p(g.value),1))]),l("div",null,[(i(!0),n(q,null,ae(y(C),(e,t)=>{var u;return i(),n("div",{key:t,class:"grid grid-cols-2 capitalize items-center gap-2 text-sm mt-4"},[Q(p(e.title)+" ",1),(i(),be(Pe,{size:"sm","model-value":ie[e.slug],key:t,placeholder:` ${e.title}`,onClick:s[3]||(s[3]=T(()=>{},["stop"])),defaultValue:W(e==null?void 0:e._id),options:e==null?void 0:e.data.map(v=>({_id:v,title:v})),cardId:(u=m.details)==null?void 0:u._id,"onUpdate:modelValue":v=>re(v,e._id)},null,8,["model-value","placeholder","defaultValue","options","cardId","onUpdate:modelValue"]))])}),128))]),l("div",pt,[s[8]||(s[8]=l("span",{class:"text-sm inline-block mb-1"},"Select Role",-1)),oe(l("select",{"onUpdate:modelValue":s[4]||(s[4]=e=>R.value=e),class:"custom-select outline-0"},[s[7]||(s[7]=l("option",{disabled:"",value:""},"Select Role",-1)),(i(!0),n(q,null,ae(y(ue),e=>(i(),n("option",{key:e._id,value:e._id},p(e.title),9,vt))),128))],512),[[Le,R.value]])])])):k("",!0),w.value=="tasks"?(i(),n("section",ft,[s[10]||(s[10]=l("span",{class:"text-base text-text-primary"},"Worked On",-1)),((Z=(G=m.details)==null?void 0:G.assigned_cards)==null?void 0:Z.length)>0?(i(),n("ul",xt,[(i(!0),n(q,null,ae((L=m.details)==null?void 0:L.assigned_cards,(e,t)=>(i(),n("li",{class:"p-2",key:t},[l("h1",yt,p(e==null?void 0:e.title),1),s[9]||(s[9]=l("p",{class:"text-xs text-text-secondary"}," Design Project . Olivia Updated on April 9, 2025 ",-1))]))),128))])):k("",!0)])):k("",!0),w.value=="history"?(i(),n("section",gt,[s[12]||(s[12]=l("span",{class:"text-base text-text-primary"},"history",-1)),((ee=(X=m.details)==null?void 0:X.assignment_history)==null?void 0:ee.length)>0?(i(),n("ul",_t,[(i(!0),n(q,null,ae((O=m.details)==null?void 0:O.assignment_history,(e,t)=>(i(),n("li",{class:"p-2",key:t},[l("h1",bt,p(e==null?void 0:e.title),1),s[11]||(s[11]=l("p",{class:"text-xs text-text-secondary"}," Design Project . Olivia Updated on April 9, 2025 ",-1))]))),128))])):k("",!0)])):k("",!0)])],2)}}}),wt=Te(kt,[["__scopeId","data-v-e4a87ad6"]]),Ct={class:"flex-auto flex-grow h-full bg-bg-card rounded-lg border border-border overflow-x-auto flex-col flex"},ht={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},Vt={class:"flex gap-3 items-center"},Dt={class:"flex p-4 overflow-x-auto gap-3 custom_scroll_bar"},At=["onClick"],St={key:1,class:"p-4 space-y-2 bg-bg-surface m-4 rounded-md"},Pt={class:"text-sm text-text-primary"},Lt={class:"flex items-center mt-3 gap-3"},qt=ge({__name:"People",setup(m){const me=xe(()=>ye(()=>import("./KanbanBoard-BKGuvhyT.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),ie=xe(()=>ye(()=>import("./KanbanCard-BWYpVj9H.js"),__vite__mapDeps([8,2,3,4,5,9]))),w=[{title:"Role",_id:"role"},{title:"Team",_id:"team"},{title:"Status",_id:"status"}],E=c("role"),C=c(!1),_=c(),{workspaceId:a}=Ue(),r=c([]),{mutate:g,isPending:de}=je({onSuccess:e=>{r.value=[...r.value||[],e],x.value="",V.value=!1}}),{data:N,isPending:U}=Me(a.value,E);$(N,e=>{r.value=e?JSON.parse(JSON.stringify(e)):[]}),Ie(()=>{r.value=N.value?JSON.parse(JSON.stringify(N.value)):[]});const ne=c("kanban"),h=c(),j=e=>{h.value=e},M=e=>{},V=c(!1),x=c("");function z(){V.value=!V.value}function re(){console.log(">>> clicking on adding pepople ");const e=x.value.trim();W(e)}const W=e=>{console.log(">>> clicking on adding pepople ");const t={workspace_id:a.value,title:e,max_num_people:1};g({payload:t})},I=_e(),ue=Re({onSuccess:()=>{I.invalidateQueries({queryKey:["people-lists"]})}}),R=e=>{const t={workspace_id:a.value,title:e==null?void 0:e.title,max_num_people:1};ue.mutate({id:e._id,payload:t})},{mutate:ce,isPending:F}=ze({onSuccess:e=>{C.value=!1,r.value=r.value.filter(t=>{var u;return t._id!==((u=e.deletedRole)==null?void 0:u._id)})}}),o=()=>{var e;ce({id:(e=_.value)==null?void 0:e.columnId})},s=e=>{C.value=!0,_.value=e},{mutate:D,isPending:A}=We({onSuccess:e=>{x.value="",V.value=!1,console.log(_.value,">>>. id local column");const t=r.value.findIndex(se=>se._id===_.value._id);if(t===-1)return;console.log(t,"index>>>");const u=r.value[t],v=[...u.cards??[],e==null?void 0:e.assigned_seat],te={...u,cards:v};r.value=[...r.value.slice(0,t),te,...r.value.slice(t+1)],I.invalidateQueries({queryKey:["people-lists"]}),I.invalidateQueries({queryKey:["workspaceRoles"]})}}),b=e=>{_.value=e;const t={name:e!=null&&e.email?S(e==null?void 0:e.email[0]):"",email:e!=null&&e.email?e==null?void 0:e.email[0]:"",role_id:e==null?void 0:e._id,workspace_id:a==null?void 0:a.value,additional_seats:1};D({id:e._id,payload:t})};function S(e){const u=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return u.length?u.map(v=>v.charAt(0).toUpperCase()+v.slice(1).toLowerCase()).join(" "):e}const P=e=>{window.dispatchEvent(new CustomEvent("close-all-showADDNEW")),e.showADDNEW=!e.showADDNEW},J=e=>{b(e)},H=e=>{h.value=e},Y=Fe(),G=Je();function Z(e){console.log(e,">>"),e.type=="column"?Y.mutate({id:a.value,payload:{role_id:e.meta._id,new_sort_order:e.meta.newIndex}}):G.mutate({id:e.meta.toColumnId,payload:{team_member_id:e.meta.moved._id,new_sort_order:e.meta.newIndex}})}const L=c(""),X=c("");$(L,Xe.debounce(e=>{X.value=e},200));const ee=B(()=>{const e=r.value.flatMap(t=>t.cards.map(u=>({...u,columnId:t.title})));return new Ze(e,{keys:["title","name"],threshold:.3})}),O=B(()=>{if(!L.value)return r.value;const e=ee.value.search(L.value).map(t=>t.item);return r.value.map(t=>({...t,cards:e.filter(u=>u.columnId===t.title)}))});return(e,t)=>{var u,v,te,se;return i(),n(q,null,[l("div",Ct,[l("div",ht,[f(Ne,{actions:!1,prefix:"View By",modelValue:E.value,"onUpdate:modelValue":t[0]||(t[0]=d=>E.value=d),options:w,variant:"secondary"},null,8,["modelValue"]),l("div",Vt,[f(et,{class:"max-w-[250px]",onOnChange:t[1]||(t[1]=d=>{L.value=d}),placeholder:"Search in Orchit AI space"})])]),oe(f(Oe,null,null,512),[[ve,y(U)]]),oe(l("div",Dt,[((u=O.value)==null?void 0:u.length)>0?(i(),be(y(me),{key:0,plusIcon:!1,onOnPlus:t[3]||(t[3]=d=>b(d)),"onDelete:column":t[4]||(t[4]=d=>s(d)),"onUpdate:column":t[5]||(t[5]=d=>R(d)),onReorder:Z,onAddColumn:W,"onSelect:ticket":j,board:O.value,onOnBoardUpdate:M,variable_id:"",sheet_id:"selected_sheet_id"},{ticket:le(({ticket:d})=>[f(y(ie),{onClick:K=>H(d),ticket:d},null,8,["onClick","ticket"])]),"column-footer":le(({column:d})=>[d.showADDNEW?d.showADDNEW?(i(),n("div",St,[l("p",Pt,p(d.title)+" "+p(d.cards.length+1),1),f(Ye,{maxEmails:1,placeholder:"team member email",modelValue:d.email,"onUpdate:modelValue":K=>d.email=K},null,8,["modelValue","onUpdate:modelValue"]),t[14]||(t[14]=l("p",{class:"text-sm text-text-secondary"},"You can assign user later",-1)),f(fe,{size:"md",onClick:K=>J(d)},{default:le(()=>[Q(p(y(A)?"Adding...":"Add Seat"),1)]),_:2},1032,["onClick"]),l("i",{class:"fa-solid fa-close cursor-pointer ml-2",onClick:t[2]||(t[2]=K=>P(""))})])):k("",!0):(i(),n("div",{key:0,onClick:K=>P(d),class:"flex py-3 px-3 justify-center text-sm text-text-primary items-center gap-3 border border-text-primary cursor-pointer border-dashed mb-4 mx-4 rounded-md"},t[13]||(t[13]=[l("i",{class:"fa-solid fa-plus"},null,-1),Q(" Add Seat ")]),8,At))]),_:1},8,["board"])):k("",!0),l("div",{class:"min-w-[328px]",onClick:t[8]||(t[8]=T(()=>{},["stop"]))},[V.value?(i(),n("form",{key:0,onSubmit:t[7]||(t[7]=T(()=>{},["prevent"])),class:"bg-bg-body rounded-lg p-4"},[f(Ee,{autofocus:!0,modelValue:x.value,"onUpdate:modelValue":t[6]||(t[6]=d=>x.value=d),placeholder:"Add New list"},null,8,["modelValue"]),t[15]||(t[15]=l("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),l("div",Lt,[f(fe,{onClick:re,type:"submit",variant:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:le(()=>[Q(p(y(de)?"Adding...":"Add Team"),1)]),_:1}),l("i",{class:"fa-solid fa-close cursor-pointer",onClick:z})])],32)):(i(),n("button",{key:1,class:"text-sm text-text-primary py-2.5 cursor-pointer font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",onClick:T(z,["stop"])}," + Add Team "))])],512),[[ve,ne.value=="kanban"&&!y(U)]])]),f(He,{onClick:t[9]||(t[9]=T(()=>{},["stop"])),modelValue:C.value,"onUpdate:modelValue":t[10]||(t[10]=d=>C.value=d),title:"Delete List",itemLabel:"list",itemName:(v=_.value)==null?void 0:v.title,requireMatchText:(te=_.value)==null?void 0:te.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:y(F),onConfirm:o,onCancel:t[11]||(t[11]=()=>{C.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),f(wt,{details:h.value,onClose:t[12]||(t[12]=()=>{j({})}),showPanel:!!((se=h.value)!=null&&se.title)},null,8,["details","showPanel"])],64)}}});export{qt as default};
