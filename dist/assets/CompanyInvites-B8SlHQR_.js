import{d as L,W as q,bb as z,r as p,i as a,e as t,n as o,R as K,t as r,h as m,w as x,B as h,f as v,k as M,j as b,P as Q,ba as E,l as X,o as d}from"./index-LNzwfNuY.js";const Z={class:"min-h-[100dvh] flex items-center justify-center bg-bg-body px-4"},$={class:"w-full max-w-xl"},ee={class:"rounded-2xl border border-border bg-bg-card 1F2430] shadow-sm overflow-hidden"},te={key:0,class:"p-6"},se={key:1,class:"p-6"},oe={class:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-800 dark:border-red-900/50 dark:bg-red-950/40 red-200"},ae={class:"text-sm leading-relaxed"},de={class:"mt-4 flex gap-2"},ne={key:2,class:"p-6"},ie={class:"rounded-lg border border-emerald-200 bg-emerald-50 p-4 text-emerald-800 emerald-200"},re={class:"text-sm leading-relaxed"},le={class:"mt-4 flex gap-2"},ce={key:3,class:"p-6"},ue={key:4,class:"p-6"},pe={class:"flex items-start gap-4"},ve=["src"],me={key:1,class:"h-12 w-12 bg-bg-surface flex justify-center items-center rounded-xl object-contain border border-border"},xe={class:"text-lg font-medium text-text-primary"},be={class:"text-sm text-text-secondary text-secondary-300"},ye={class:"font-medium"},_e={key:0},ge={class:"font-medium text-xs"},fe={key:0,class:"text-xs text-red-500 mt-1"},he={key:1,class:"text-xs text-text-secondary -500 text-secondary-400 mt-1"},ke={key:0,class:"mt-4 rounded-lg border p-3 text-sm text-text-secondary -700 text-secondary-200 dark:border-border 1F2430]"},we={class:"mt-6 flex flex-wrap gap-2"},Ce=["disabled"],je={key:0},Ie={key:1},Te={key:1,class:"mt-3 text-xs text-emerald-600 emerald-400"},Re=L({__name:"CompanyInvites",setup(Be){const k=X(),{token:y}=q(),{data:s,refetch:G,isPending:O}=z(y.value),c=p(null),l=p(!1),u=p(null),_=p(null),g=p(!1),w=p(!1);function P(n){return n?n.replace(/[_-]+/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}async function U(){var n,e;if(!(!s.value||s.value.status=="expired")){l.value=!0,u.value="accepted",c.value=null;try{await E.post("/common/invite-accept",{token:y.value}),g.value=!0}catch(i){c.value=((e=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:e.message)||"Could not accept the invitation."}finally{l.value=!1,u.value=null}}}async function H(){var n,e;if(s.value){l.value=!0,u.value="decline",c.value=null;try{await E.post("/common/invite-accept",{status:"rejected",token:encodeURIComponent(y.value)}),w.value=!0}catch(i){c.value=((e=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:e.message)||"Could not decline the invitation."}finally{l.value=!1,u.value=null}}}function f(){k.push({name:"home"}).catch(()=>{})}function J(){var n;(n=s.value)!=null&&n.workspace_id?k.push({name:"workspace",params:{id:s.value.workspace_id}}).catch(()=>{}):f()}return(n,e)=>{var C,j,I,T,B,N,R,V,S,W,D,F,Y,A;const i=M("router-link");return d(),a("div",Z,[t("div",$,[t("div",ee,[e[11]||(e[11]=t("div",{class:"px-6 py-5 border-b border-border"},[t("h1",{class:"text-2xl font-semibold text-text-primary"},"Space invitation"),t("p",{class:"text-sm text-text-secondary text-secondary-300 mt-1"}," Accept the invite to join this space, or decline to ignore it. ")],-1)),o(O)?(d(),a("div",te,e[1]||(e[1]=[K('<div class="animate-pulse space-y-4"><div class="h-5 w-56 bg-bg-surface"></div><div class="h-4 w-40 bg-bg-surface"></div><div class="h-24 w-full bg-bg-surface rounded-lg"></div><div class="flex gap-2"><div class="h-10 w-28 bg-bg-surface"></div><div class="h-10 w-28 bg-bg-surface"></div></div></div>',1)]))):c.value?(d(),a("div",se,[t("div",oe,[e[2]||(e[2]=t("div",{class:"font-medium mb-1"},"We couldn’t open this invite.",-1)),t("p",ae,r(c.value),1)]),t("div",de,[m(h,{variant:"secondary",class:"px-4 py-2 rounded-md border text-sm border-border",onClick:e[0]||(e[0]=()=>o(G)())},{default:x(()=>e[3]||(e[3]=[v("Try again")])),_:1,__:[3]}),m(h,{onClick:f},{default:x(()=>e[4]||(e[4]=[v("Go to home")])),_:1,__:[4]})])])):g.value?(d(),a("div",ne,[t("div",ie,[e[7]||(e[7]=t("div",{class:"font-medium mb-1"},"You’re in! 🎉",-1)),t("p",re,[e[5]||(e[5]=v(" You’ve joined ")),t("strong",null,r((j=(C=o(s))==null?void 0:C.company)==null?void 0:j.title),1),e[6]||(e[6]=v(". "))])]),t("div",le,[m(i,{to:"/"},{default:x(()=>[t("button",{class:"px-4 cursor-pointer py-2 rounded-md bg-black text-sm text-text-primary",onClick:J},"Open Orchit")]),_:1})])])):w.value?(d(),a("div",ce,[e[8]||(e[8]=t("div",{class:"rounded-lg border border-gray-200 bg-gray-50 p-4 text-text-secondary -800 dark:border-border 1F2430] dark:bg-[#171922] text-secondary-200"},[t("div",{class:"font-medium mb-1"},"Invite declined"),t("p",{class:"text-sm leading-relaxed"},"We’ve let the workspace know you won’t be joining.")],-1)),t("div",{class:"mt-4 flex gap-2"},[t("button",{class:"px-4 py-2 rounded-md bg-black text-white text-sm dark:bg-white text-primary",onClick:f},"Go to home")])])):(d(),a("div",ue,[t("div",pe,[(T=(I=o(s).company)==null?void 0:I.owner)!=null&&T.profile_image?(d(),a("img",{key:0,src:(N=(B=o(s).company)==null?void 0:B.owner)==null?void 0:N.profile_image,alt:"",class:"h-12 w-12 rounded-xl object-cover border border-border"},null,8,ve)):(d(),a("div",me,r(o(Q)((V=(R=o(s))==null?void 0:R.company)==null?void 0:V.title)),1)),t("div",null,[t("h2",xe,r((W=(S=o(s))==null?void 0:S.company)==null?void 0:W.title),1),t("p",be,[e[9]||(e[9]=v(" Invited by ")),t("span",ye,r(o(s).invited_by.name||o(s).email),1),o(s).role_title?(d(),a("span",_e," for the "+r(P(o(s).role_title))+" Role",1)):b("",!0),e[10]||(e[10]=t("br",null,null,-1)),t("span",ge,r(o(s).invited_by.email),1)]),(D=o(s))!=null&&D.is_expire?(d(),a("p",fe,"This invite has expired.")):(F=o(s))!=null&&F.is_expire?(d(),a("p",he," This Invitation Link has been Expire ")):b("",!0)])]),(Y=_.value)!=null&&Y.message?(d(),a("div",ke," “"+r(_.value.message)+"” ",1)):b("",!0),t("div",we,[m(h,{disabled:o(s).is_expire||l.value,onClick:U},{default:x(()=>[v(r(l.value&&u.value==="accepted"?"Joining…":"Accept invitation"),1)]),_:1},8,["disabled"]),t("button",{class:"px-4 py-2 cursor-pointer rounded-md text-sm border border-border disabled:opacity-60 disabled:cursor-not-allowed",disabled:l.value||o(s).is_expire,onClick:H},[l.value&&u.value==="decline"?(d(),a("span",je,"Declining…")):(d(),a("span",Ie,"Decline"))],8,Ce)]),((A=_.value)==null?void 0:A.status)==="accepted"&&!g.value?(d(),a("p",Te," You’ve already accepted this invite. ")):b("",!0)]))]),e[12]||(e[12]=t("p",{class:"text-center text-xs text-text-secondary -500 text-secondary-400 mt-4"}," If this wasn’t you, you can safely ignore this page. ",-1))])])}}});export{Re as default};
