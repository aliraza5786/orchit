import{d as L,Q as P,bq as Q,r as v,x as z,m as a,g as t,i as o,aB as K,t as r,h as m,w as x,B as b,k as c,n as f,aw as A,j as M,o as d,U as X,v as Z}from"./index-DEz25paR.js";const $={class:"min-h-[100dvh] flex items-center justify-center bg-bg-body px-4"},ee={class:"w-full max-w-xl"},te={class:"rounded-2xl border border-border bg-bg-card 1F2430] shadow-sm overflow-hidden"},se={key:0,class:"p-6"},oe={key:1,class:"p-6"},ae={class:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-800 dark:border-red-900/50 dark:bg-red-950/40 red-200"},de={class:"text-sm leading-relaxed"},ne={class:"mt-4 flex gap-2"},ie={key:2,class:"p-6"},re={class:"rounded-lg border border-emerald-200 bg-emerald-50 p-4 text-emerald-800 emerald-200"},le={class:"text-sm leading-relaxed"},ce={class:"mt-4 flex gap-2"},ue={key:3,class:"p-6"},pe={class:"mt-4 flex gap-2"},ve={key:4,class:"p-6"},me={class:"flex items-start gap-4"},xe=["src"],be={key:1,class:"h-12 w-12 bg-bg-surface flex justify-center items-center rounded-xl object-contain border border-border"},_e={class:"text-lg font-medium text-text-primary"},fe={class:"text-sm text-text-secondary text-secondary-300"},ge={class:"font-medium"},ye={key:0},he={class:"font-medium text-xs"},ke={key:0,class:"text-xs text-red-500 mt-1"},we={key:1,class:"text-xs text-text-secondary -500 text-secondary-400 mt-1"},Ce={key:0,class:"mt-4 rounded-lg border p-3 text-sm text-text-secondary -700 text-secondary-200 dark:border-border 1F2430]"},je={class:"mt-6 flex flex-wrap gap-2"},Ie=["disabled"],Te={key:0},Be={key:1},Ne={key:1,class:"mt-3 text-xs text-emerald-600 emerald-400"},Se=L({__name:"CompanyInvites",setup(Ve){const w=Z(),{token:g}=P(),{data:s,refetch:E,isPending:G}=Q(g.value),u=v(null),l=v(!1),p=v(null),y=v(null),_=v(!1),h=v(!1);function O(n){return n?n.replace(/[_-]+/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}async function q(){var n,e;if(!(!s.value||s.value.status=="expired")){l.value=!0,p.value="accepted",u.value=null;try{await A.post("/common/invite-accept",{token:g.value}),_.value=!0}catch(i){u.value=((e=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:e.message)||"Could not accept the invitation."}finally{l.value=!1,p.value=null}}}async function H(){var n,e;if(s.value){l.value=!0,p.value="decline",u.value=null;try{await A.post("/common/invite-accept",{status:"rejected",token:encodeURIComponent(g.value)}),h.value=!0}catch(i){u.value=((e=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:e.message)||"Could not decline the invitation."}finally{l.value=!1,p.value=null}}}function k(){w.push({name:"home"}).catch(()=>{})}function J(){var n;(n=s.value)!=null&&n.workspace_id?w.push({name:"workspace",params:{id:s.value.workspace_id}}).catch(()=>{}):k()}return z(()=>s.value,()=>{if(s.value.status=="rejected"){h.value=!0;return}if(s.value.status=="accepted"){_.value=!0;return}}),(n,e)=>{var C,j,I,T,B,N,V,R,S,D,F,U,W,Y;const i=M("router-link");return d(),a("div",$,[t("div",ee,[t("div",te,[e[13]||(e[13]=t("div",{class:"px-6 py-5 border-b border-border"},[t("h1",{class:"text-2xl font-semibold text-text-primary"},"Space invitation"),t("p",{class:"text-sm text-text-secondary text-secondary-300 mt-1"}," Accept the invite to join this space, or decline to ignore it. ")],-1)),o(G)?(d(),a("div",se,e[1]||(e[1]=[K('<div class="animate-pulse space-y-4"><div class="h-5 w-56 bg-bg-surface"></div><div class="h-4 w-40 bg-bg-surface"></div><div class="h-24 w-full bg-bg-surface rounded-lg"></div><div class="flex gap-2"><div class="h-10 w-28 bg-bg-surface"></div><div class="h-10 w-28 bg-bg-surface"></div></div></div>',1)]))):u.value?(d(),a("div",oe,[t("div",ae,[e[2]||(e[2]=t("div",{class:"font-medium mb-1"},"We couldnâ€™t open this invite.",-1)),t("p",de,r(u.value),1)]),t("div",ne,[m(b,{variant:"secondary",class:"px-4 py-2 rounded-md border text-sm border-border",onClick:e[0]||(e[0]=()=>o(E)())},{default:x(()=>e[3]||(e[3]=[c("Try again")])),_:1,__:[3]}),m(b,{onClick:k},{default:x(()=>e[4]||(e[4]=[c("Go to home")])),_:1,__:[4]})])])):_.value?(d(),a("div",ie,[t("div",re,[e[7]||(e[7]=t("div",{class:"font-medium mb-1"},"Youâ€™re in! ðŸŽ‰",-1)),t("p",le,[e[5]||(e[5]=c(" Youâ€™ve joined ")),t("strong",null,r((j=(C=o(s))==null?void 0:C.company)==null?void 0:j.title),1),e[6]||(e[6]=c(". "))])]),t("div",ce,[m(i,{to:"/"},{default:x(()=>[m(b,{onClick:J},{default:x(()=>e[8]||(e[8]=[c("Open Orchit")])),_:1,__:[8]})]),_:1})])])):h.value?(d(),a("div",ue,[e[10]||(e[10]=t("div",{class:"rounded-lg border border-gray-200 bg-gray-50 p-4 text-text-secondary -800 dark:border-border 1F2430] dark:bg-[#171922] text-secondary-200"},[t("div",{class:"font-medium mb-1"},"Invite declined"),t("p",{class:"text-sm leading-relaxed"},"Weâ€™ve let the workspace know you wonâ€™t be joining.")],-1)),t("div",pe,[m(b,{onClick:k},{default:x(()=>e[9]||(e[9]=[c("Go to home")])),_:1,__:[9]})])])):(d(),a("div",ve,[t("div",me,[(T=(I=o(s).company)==null?void 0:I.owner)!=null&&T.profile_image?(d(),a("img",{key:0,src:(N=(B=o(s).company)==null?void 0:B.owner)==null?void 0:N.profile_image,alt:"",class:"h-12 w-12 rounded-xl object-cover border border-border"},null,8,xe)):(d(),a("div",be,r(o(X)((R=(V=o(s))==null?void 0:V.company)==null?void 0:R.title)),1)),t("div",null,[t("h2",_e,r((D=(S=o(s))==null?void 0:S.company)==null?void 0:D.title),1),t("p",fe,[e[11]||(e[11]=c(" Invited by ")),t("span",ge,r(o(s).invited_by.name||o(s).email),1),o(s).role_title?(d(),a("span",ye," for the "+r(O(o(s).role_title))+" Role",1)):f("",!0),e[12]||(e[12]=t("br",null,null,-1)),t("span",he,r(o(s).invited_by.email),1)]),(F=o(s))!=null&&F.is_expire?(d(),a("p",ke,"This invite has expired.")):(U=o(s))!=null&&U.is_expire?(d(),a("p",we," This Invitation Link has been Expire ")):f("",!0)])]),(W=y.value)!=null&&W.message?(d(),a("div",Ce," â€œ"+r(y.value.message)+"â€ ",1)):f("",!0),t("div",je,[m(b,{disabled:o(s).is_expire||l.value,onClick:q},{default:x(()=>[c(r(l.value&&p.value==="accepted"?"Joiningâ€¦":"Accept invitation"),1)]),_:1},8,["disabled"]),t("button",{class:"px-4 py-2 cursor-pointer rounded-md text-sm border border-border disabled:opacity-60 disabled:cursor-not-allowed",disabled:l.value||o(s).is_expire,onClick:H},[l.value&&p.value==="decline"?(d(),a("span",Te,"Decliningâ€¦")):(d(),a("span",Be,"Decline"))],8,Ie)]),((Y=y.value)==null?void 0:Y.status)==="accepted"&&!_.value?(d(),a("p",Ne," Youâ€™ve already accepted this invite. ")):f("",!0)]))]),e[14]||(e[14]=t("p",{class:"text-center text-xs text-text-secondary -500 text-secondary-400 mt-4"}," If this wasnâ€™t you, you can safely ignore this page. ",-1))])])}}});export{Se as default};
