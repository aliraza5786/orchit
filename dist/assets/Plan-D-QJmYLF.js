const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CreateTaskModal-rrErnsSG.js","assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-CA2yZmP1.js","assets/index-By-MWQyp.js","assets/index-DBWkHu_f.css","assets/BaseModal-DlLGLIbU.js","assets/cross-DvraoB0R.js","assets/BaseModal-FRlOKCB_.css","assets/BaseTextField.vue_vue_type_script_setup_true_lang-D0tVbb66.js","assets/info-DjaLHeD_.js","assets/BaseSelectField.vue_vue_type_script_setup_true_lang-DrAMamBX.js","assets/KanbanSkeleton-CIY4vcrv.js","assets/index-DdjqC5kt.js","assets/KanbanSkeleton-D86JubvK.css","assets/useQueryParams-Cj5obHVe.js","assets/BaseRichTextEditor-CFeNLmcN.js","assets/useCommon-D8bKiM2G.js","assets/BaseRichTextEditor-5b2PDTLF.css","assets/DatePicker-CLYad3t_.js","assets/DatePicker-CaK9YdY3.css","assets/ConfirmDeleteModal-DMAhBbas.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-DYgGTIOu.js","assets/SidePanel-BKSZbflK.js","assets/AssigmentDropdown.vue_vue_type_script_setup_true_lang-CZiXTcXg.js","assets/SwitchTab-Cq4rvBiP.js","assets/SwitchTab-xAML-a-k.css","assets/SidePanel-fKwN4j-K.css","assets/KanbanBoard-6d92uia1.js","assets/DropMenu.vue_vue_type_script_setup_true_lang-CIk7r7kV.js","assets/workspace-jQGMSF7j.js","assets/KanbanBoard-DJX1cgam.css"])))=>i.map(i=>d[i]);
import{E as re,G as z,J as be,n as c,r as T,m as X,K as de,c as U,L as ue,d as le,i as N,e as s,g as ne,y as ce,b as Y,h as M,B as ee,w as P,f as H,t as j,T as Ge,o as L,M as Je,q as ot,N as at,z as Z,O as ve,P as Ne,_ as nt,j as ie,a as Ze,F as Ee,A as Ie,Q as De,R as Ve,p as rt}from"./index-By-MWQyp.js";import{u as Qe,a as lt}from"./useQueryParams-Cj5obHVe.js";import{B as We}from"./BaseModal-DlLGLIbU.js";import{_ as it}from"./BaseTextField.vue_vue_type_script_setup_true_lang-D0tVbb66.js";import{u as dt,a as ut,b as ct,R as pt,c as mt,K as ft,D as gt}from"./KanbanSkeleton-CIY4vcrv.js";import{_ as Xe}from"./SearchBar.vue_vue_type_script_setup_true_lang-Cp3sGc_5.js";import{_ as vt}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-DYgGTIOu.js";import{D as qe}from"./DatePicker-CLYad3t_.js";import{u as bt}from"./workspace-jQGMSF7j.js";import"./cross-DvraoB0R.js";import"./info-DjaLHeD_.js";import"./index-DdjqC5kt.js";const Ye="data:image/svg+xml,%3csvg%20width='60'%20height='60'%20viewBox='0%200%2060%2060'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M9.375%2030C11.6402%2030%2013.4766%2028.1637%2013.4766%2025.8984C13.4766%2023.6332%2011.6402%2021.7969%209.375%2021.7969C7.10977%2021.7969%205.27344%2023.6332%205.27344%2025.8984C5.27344%2028.1637%207.10977%2030%209.375%2030Z'%20fill='%23AE2A19'/%3e%3cpath%20d='M26.25%2024.375C28.5152%2024.375%2030.3516%2022.5387%2030.3516%2020.2734C30.3516%2018.0082%2028.5152%2016.1719%2026.25%2016.1719C23.9848%2016.1719%2022.1484%2018.0082%2022.1484%2020.2734C22.1484%2022.5387%2023.9848%2024.375%2026.25%2024.375Z'%20fill='%23BF63F3'/%3e%3cpath%20d='M15.3931%2035.8594H11.0159V33.0938C9.93587%2033.3387%208.81469%2033.3387%207.73465%2033.0938V35.8594H1.87528C1.55115%2035.8601%201.2345%2035.9568%200.965283%2036.1373C0.696064%2036.3178%200.486343%2036.574%200.362583%2036.8736C0.238824%2037.1731%200.206573%2037.5027%200.269899%2037.8205C0.333226%2038.1384%200.489292%2038.4304%200.718404%2038.6597L7.05872%2045L0.718404%2051.3403C0.489292%2051.5696%200.333226%2051.8616%200.269899%2052.1795C0.206573%2052.4973%200.238824%2052.8269%200.362583%2053.1264C0.486343%2053.426%200.696064%2053.6822%200.965283%2053.8627C1.2345%2054.0432%201.55115%2054.1399%201.87528%2054.1406H15.3931L21.7503%2045L15.3931%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M34.4562%2035.8594H27.8937V27.4688C26.8137%2027.7138%2025.6925%2027.7138%2024.6125%2027.4688V35.8594H19.3896L25.7487%2045L19.3896%2054.1406H34.4562L40.8143%2045L34.4562%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M43.8281%2019.6875H55.3125C55.7475%2019.6873%2056.1647%2019.5143%2056.4723%2019.2067C56.7799%2018.8991%2056.9529%2018.4819%2056.9531%2018.0469V9.375C56.9529%208.93996%2056.7799%208.5228%2056.4723%208.21518C56.1647%207.90755%2055.7475%207.73462%2055.3125%207.73438H43.8281V7.5C43.8281%207.06488%2043.6553%206.64758%2043.3476%206.3399C43.0399%206.03223%2042.6226%205.85938%2042.1875%205.85938C41.7524%205.85938%2041.3351%206.03223%2041.0274%206.3399C40.7197%206.64758%2040.5469%207.06488%2040.5469%207.5V32.5781H43.8281V19.6875Z'%20fill='%23FCA700'/%3e%3cpath%20d='M59.2843%2043.8403L51.7843%2036.3403C51.6322%2036.1878%2051.4514%2036.0668%2051.2524%2035.9842C51.0534%2035.9017%2050.8401%2035.8593%2050.6246%2035.8594H38.4521L44.8121%2045L38.4531%2054.1406H50.6246C50.8401%2054.1407%2051.0534%2054.0983%2051.2524%2054.0158C51.4514%2053.9332%2051.6322%2053.8122%2051.7843%2053.6597L59.2843%2046.1597C59.4368%2046.0075%2059.5577%2045.8267%2059.6402%2045.6277C59.7228%2045.4287%2059.7652%2045.2154%2059.7652%2045C59.7652%2044.7846%2059.7228%2044.5713%2059.6402%2044.3723C59.5577%2044.1733%2059.4368%2043.9925%2059.2843%2043.8403Z'%20fill='%2382B536'/%3e%3c/g%3e%3c/svg%3e",yt="data:image/svg+xml,%3csvg%20width='60'%20height='46'%20viewBox='0%200%2060%2046'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M59.7443%2034.8967L50.5682%2025.7206C50.4457%2025.5984%2050.2897%2025.5152%2050.1199%2025.4816C49.9501%2025.4479%2049.7742%2025.4653%2049.6143%2025.5315C49.4544%2025.5976%2049.3176%2025.7097%2049.2213%2025.8535C49.125%2025.9973%2049.0734%2026.1664%2049.073%2026.3394V30.517H25.9775V40.5114H49.0755V44.689C49.0759%2044.8621%2049.1275%2045.0312%2049.2238%2045.175C49.3201%2045.3187%2049.4569%2045.4308%2049.6168%2045.497C49.7767%2045.5632%2049.9527%2045.5805%2050.1224%2045.5468C50.2922%2045.5132%2050.4482%2045.43%2050.5708%2045.3078L59.7468%2036.1318C59.9095%2035.9672%2060.0005%2035.7451%2060.0001%2035.5137C59.9996%2035.2823%2059.9076%2035.0605%2059.7443%2034.8967Z'%20fill='%23C6DBA9'/%3e%3cpath%20d='M32.3149%2030.5293C30.664%2031.5967%2028.7394%2032.1633%2026.7734%2032.1609V40.5237H34.7295C39.2829%2038.5638%2042.9649%2035.0102%2045.0851%2030.5293H32.3149Z'%20fill='url(%23paint0_linear_250_16424)'/%3e%3cpath%20d='M46.2209%2020.2832C46.2317%2015.0884%2044.2448%2010.0884%2040.6714%206.3179C37.0981%202.54738%2032.2119%200.295026%2027.024%200.0269855C21.8362%20-0.241055%2016.7439%201.49574%2012.801%204.87791C8.85809%208.26009%206.36647%2013.0287%205.84178%2018.1969L2.46233%2017.8913C2.31055%2017.8782%202.15829%2017.9103%202.02467%2017.9835C1.89106%2018.0566%201.78205%2018.1677%201.71134%2018.3026C1.64063%2018.4376%201.61138%2018.5904%201.62726%2018.7419C1.64313%2018.8934%201.70343%2019.0368%201.80058%2019.1542L9.51927%2028.406C9.79205%2028.7344%2010.277%2028.7773%2010.378%2028.5045L19.6298%2020.7833C20.3876%2020.3413%2020.1173%2019.4825%2019.4328%2019.4194L15.8008%2019.091C16.0297%2017.1283%2016.8213%2015.2735%2018.0802%2013.7503C19.3391%2012.2271%2021.0115%2011.1004%2022.8961%2010.5059C24.7806%209.9114%2026.7969%209.8745%2028.7019%2010.3996C30.6069%2010.9248%2032.3195%2011.9896%2033.6332%2013.4657C34.947%2014.9419%2035.8059%2016.7664%2036.1065%2018.7195C36.4071%2020.6726%2036.1365%2022.6709%2035.3274%2024.4738C34.5183%2026.2766%2033.2051%2027.8071%2031.5462%2028.8807C29.8872%2029.9544%2027.9531%2030.5254%2025.977%2030.5251H25.9283V40.5094C31.2249%2040.4031%2036.7093%2038.2263%2040.4202%2034.4455C44.1311%2030.6648%2046.2134%2025.5808%2046.2209%2020.2832Z'%20fill='%23D7A39E'/%3e%3cpath%20d='M25.9773%2030.5293H0V40.5237H25.9773V30.5293Z'%20fill='url(%23paint1_linear_250_16424)'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_250_16424'%20x1='6.53714'%20y1='35.5252'%20x2='47.0198'%20y2='35.5252'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%236C798F'/%3e%3cstop%20offset='1'%20stop-color='%236C798F'%20stop-opacity='0.1'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_250_16424'%20x1='0'%20y1='36'%20x2='26'%20y2='36'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23E8D4D3'%20stop-opacity='0'/%3e%3cstop%20offset='1'%20stop-color='%23E2A39F'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",kt=(l,a={})=>be({queryKey:["sprint-list"],queryFn:({signal:m})=>z({url:`sprints/${l}`,method:"GET",signal:m}),...a}),xt=(l,a={})=>be({queryKey:["sprint-cards",l],queryFn:({signal:m})=>z({url:`sprints/${c(l)}/backlog`,method:"GET",signal:m}),...a}),St=(l,a={})=>be({queryKey:["sprint-kanban",l],queryFn:({signal:m})=>z({url:`workspace/cards/sprintgrouped?sprint_id=${c(l)}&variable_id=68b6c96e0a95eef7d14e6981`,method:"GET",signal:m}),...a}),_t=(l,a={})=>re({key:["sprint-complete"]},{mutationFn:m=>z({url:`sprints/${c(l)}/complete`,method:"POST",data:m.payload}),...a}),Ct=(l,a={})=>be({queryKey:["sprint-detail",l],queryFn:({signal:m})=>z({url:`sprints/detail/${c(l)}?include_cards=true`,method:"GET",signal:m}),...a}),et=(l,a={})=>be({queryKey:["backlog-list",l],queryFn:({signal:m})=>z({url:`sprints/workspace/${c(l)}/cards?include_sprint_cards=false`,method:"GET",signal:m}),...a}),wt=(l={})=>re({key:["add-sprint"]},{mutationFn:a=>z({url:"/sprints",method:"POST",data:a.payload}),...l}),tt=(l={})=>re({key:["move-card-to-sprint"]},{mutationFn:a=>z({url:`/sprints/${a.id}/cards`,method:"POST",data:a.payload}),...l}),Re=(l={})=>re({key:["add-sprint"]},{mutationFn:a=>z({url:`/sprints/${a.id}`,method:"PUT",data:a.payload}),...l}),ht=(l={})=>re({key:["start-sprint"]},{mutationFn:a=>z({url:`/sprints/${a.id}/start`,method:"POST",data:a.payload}),...l}),Tt=(l={})=>re({key:["delete-sprint"]},{mutationFn:a=>z({url:`/sprints/${a}`,method:"DELETE"}),...l}),Dt=(l={})=>re({key:["remove-card-from-sprint"]},{mutationFn:a=>z({url:`sprints/${c(a.sprintId)}/cards/remove `,method:"POST",data:{card_ids:[a.cardId]}}),...l}),st="jira-like:";function Ke(l="id"){return`${l}_${Math.random().toString(36).slice(2,9)}`}function je(l,a){try{localStorage.setItem(st+l,JSON.stringify(a))}catch{}}function ze(l,a){try{const m=localStorage.getItem(st+l);return m?JSON.parse(m):a}catch{return a}}function Ae(l){switch(l){case"Highest":return"rounded-md bg-red-50 px-2 py-0.5 text-xs text-red-700";case"High":return"rounded-md bg-orange-50 px-2 py-0.5 text-xs text-orange-700";case"Medium":return"rounded-md bg-amber-50 px-2 py-0.5 text-xs text-amber-700";case"Low":return"rounded-md bg-gray-100 px-2 py-0.5 text-xs text-gray-600"}}function Ue(){const l=T(ze("backlog",[])),a=T(ze("sprints",[]));if(a.value.length===0)a.value.push({id:Ke("sprint"),name:"Sprint 1",goal:"",start:"",end:"",started:!1,tickets:[]});else if(a.value.length>1){for(let o=1;o<a.value.length;o++)l.value.push(...a.value[o].tickets);a.value=[a.value[0]]}const m=T(a.value[0].id);X([l,a],()=>{je("backlog",l.value),je("sprints",a.value)},{deep:!0});const h=T([]),k=de({}),u=U(()=>l.value.length>0&&h.value.length===l.value.length),v=o=>{var t;const e=a.value.find(n=>n.id===o);return!!e&&e.tickets.length>0&&(((t=k[o])==null?void 0:t.length)||0)===e.tickets.length};function w(o,e,t){const n=e.target.checked;if(o==="backlog")h.value=n?l.value.map(f=>f.id):[];else if(t){const f=a.value.find(b=>b.id===t);k[t]=n&&f?f.tickets.map(b=>b.id):[]}}function D(o,e,t,n){const f=t.target.checked,b=o==="backlog"?h.value:k[n]||(k[n]=[]);if(f&&!b.includes(e)&&b.push(e),!f){const I=b.indexOf(e);I>=0&&b.splice(I,1)}}function p(){return a.value.find(o=>o.id===m.value)||a.value[0]}function r(){const e=[...l.value,...a.value.flatMap(n=>n.tickets)].map(n=>Number(String(n.key).replace(/[^0-9]/g,""))).filter(n=>!Number.isNaN(n));return`PRJ-${e.length?Math.max(...e)+1:1}`}const{mutate:g}=tt({onSuccess:()=>{ue.success("Cards moved to sprint successfully")},onError:o=>{ue.error("Failed to move cards: "+(o.message||"Unknown error"))}});function B(){var n,f;const o=p();if(!o||!h.value.length)return;const e=[],t=[];for(const b of l.value)(h.value.includes(b.id)?t:e).push(b);l.value=e,o.tickets.push(...t),h.value=[],t.length>0&&g({id:o.id,payload:{card_ids:t.map(b=>b.id),priority:((f=(n=t[0])==null?void 0:n.priority)==null?void 0:f.toLowerCase())||"medium",story_points:t.reduce((b,I)=>b+(I.storyPoints||0),0)}})}function S(o){const e=a.value.find(b=>b.id===o);if(!e)return;const t=k[o]||[],n=[],f=[];for(const b of e.tickets)(t.includes(b.id)?f:n).push(b);e.tickets=n,l.value.push(...f),k[o]=[]}function $(o,e){if(o==="backlog")l.value=l.value.filter(t=>!h.value.includes(t.id)),h.value=[];else if(e){const t=k[e]||[],n=a.value.find(f=>f.id===e);if(!n)return;n.tickets=n.tickets.filter(f=>!t.includes(f.id)),k[e]=[]}}function F(o,e){const t={id:Ke("T"),key:r(),createdAt:new Date().toISOString(),...e};if(o==="backlog")l.value.push(t);else{const n=p();n==null||n.tickets.push(t)}}function x(o){const e=p();e&&(e.name=o.name??e.name,e.goal=o.goal??e.goal,e.start=o.start??e.start,e.end=o.end??e.end)}function _(){const o=p();o&&(o.started=!o.started)}function V(o){return o.tickets.reduce((e,t)=>e+(t.storyPoints||0),0)}return{backlog:l,sprints:a,activeSprintId:m,selectedBacklogIds:h,selectedSprintIds:k,allBacklogChecked:u,allSprintChecked:v,toggleAll:w,toggleOne:D,getActiveSprint:p,createTicket:F,saveSprintMeta:x,toggleStartSprint:_,sprintPoints:V,moveSelectedToSprint:B,moveSelectedToBacklog:S,deleteSelected:$,priorityClass:Ae}}const Vt={class:"space-y-3 flex flex-col overflow-y-auto"},$t={key:0,class:"empty-state flex flex-col justify-center items-center h-full"},Mt=["checked"],Pt=["checked","onChange"],Bt={class:"flex items-center gap-2"},Lt={class:"inline-block rounded-full border px-2 py-0.5 text-xs"},Ot={class:"truncate"},Et=["onDragstart"],At=le({__name:"BacklogTable",props:{sorters:{}},emits:["ticket-dragged-to-sprint","open-ticket","ticket-moved-to-backlog"],setup(l,{emit:a}){const m=a,{workspaceId:h}=Qe(),{data:k,isPending:u}=et(h),v=T([]);X(k,o=>{o!=null&&o.cards&&(v.value=o.cards.map(e=>{var I,q,J,R,te;const t=((I=e.card)==null?void 0:I.variables)??{},n=((q=e.card)==null?void 0:q._id)??e.card_id,f=String(t["card-status"]??"").trim(),b=String(t.priority??"").trim();return{id:n,key:t["card-code"]||(n==null?void 0:n.slice(-6))||"PRJ-?",summary:t["card-title"]||"(untitled)",type:"Story",status:w(f),assignee:((R=(J=e.card)==null?void 0:J.assigned_to)==null?void 0:R.name)??"Unassigned",storyPoints:Number(e.story_points??0)||0,priority:D(b),createdAt:((te=e.card)==null?void 0:te.created_at)??new Date().toISOString(),description:t["card-description"]||""}}))},{immediate:!0});function w(o){const e=o.toLowerCase();return e.includes("progress")?"In Progress":e.includes("done")||e.includes("complete")?"Done":"Todo"}function D(o){const e=String(o??"").toLowerCase();return e==="highest"||e==="blocker"||e==="critical"?"Highest":e==="high"||e==="major"?"High":e==="medium"||e==="normal"?"Medium":"Low"}const{selectedBacklogIds:p,allBacklogChecked:r,toggleAll:g,toggleOne:B}=Ue(),S=T(!1),$=T(null);function F(o,e,t){var f;$.value=e.id;const n=JSON.stringify({id:e.id,from:t,ticket:e});(f=o.dataTransfer)==null||f.setData("text/plain",n),o.dataTransfer&&(o.dataTransfer.effectAllowed="move")}function x(o){var e;S.value=!1,((e=o.dataTransfer)==null?void 0:e.dropEffect)!=="none"&&$.value&&(v.value=v.value.filter(t=>t.id!==$.value)),$.value=null}function _(o){var e;o.preventDefault(),S.value=!1;try{const t=(e=o.dataTransfer)==null?void 0:e.getData("text/plain");if(!t)return;const n=JSON.parse(t);if(n.from!=="sprint"||v.value.some(b=>b.id===n.id))return;v.value.push(n.ticket),m("ticket-moved-to-backlog",n.id,n.sprintId)}catch(t){console.error("Drop error:",t)}}const V=U(()=>[{key:"select",label:"",width:36},{key:"summary",label:"Summary",sortable:!1},{key:"status",label:"Status",width:120,sortable:!1},{key:"assignee",label:"",width:120,sortable:!1}]);return(o,e)=>(L(),N("section",Vt,[s("div",{class:ce(["rounded-lg border h-[300px] border-border flex flex-col",S.value?"ring-2 ring-blue-400":""]),onDragover:e[5]||(e[5]=ne(()=>{},["prevent"])),onDragenter:e[6]||(e[6]=t=>S.value=!0),onDragleave:e[7]||(e[7]=t=>S.value=!1),onDrop:e[8]||(e[8]=t=>_(t))},[!c(u)&&v.value.length===0?(L(),N("div",$t,[e[10]||(e[10]=s("img",{src:yt,class:"mb-4",alt:"backlog-plan"},null,-1)),e[11]||(e[11]=s("h6",{class:"text-sm text-text-primary font-semibold mb-1"},"Get started in the backlog",-1)),e[12]||(e[12]=s("p",{class:"text-sm text-text-primary/90 mb-3"},"Plan and start a sprint to see issues here.",-1)),M(ee,null,{default:P(()=>e[9]||(e[9]=[H("Add Task Backlog")])),_:1,__:[9]})])):(L(),Y(Ge,{key:1,showHeader:!1,pagination:!1,class:"flex-grow h-full",rowDraggable:!0,onRowDragstart:e[2]||(e[2]=({row:t,$event:n})=>F(n,t,"backlog")),onRowDragend:e[3]||(e[3]=({$event:t})=>x(t)),columns:V.value,rows:v.value,"page-size":20,hover:!0,striped:"",itemKey:t=>t.id,sorters:o.sorters,onRowClick:e[4]||(e[4]=({row:t})=>o.$emit("open-ticket",t))},{"select-header":P(()=>[s("input",{type:"checkbox",checked:c(r),onChange:e[0]||(e[0]=t=>c(g)("backlog",t))},null,40,Mt)]),select:P(({row:t})=>[s("input",{type:"checkbox",checked:c(p).includes(t.id),onChange:n=>c(B)("backlog",t.id,n)},null,40,Pt)]),summary:P(({row:t})=>[s("div",Bt,[s("span",Lt,j(t.key),1),s("span",Ot,j(t.summary),1)])]),priority:P(({row:t})=>[s("span",{class:ce(c(Ae)(t.priority))},j(t.priority),3)]),drag:P(({row:t})=>[s("button",{class:"cursor-grab",title:"Drag to Sprint",draggable:"",onClick:e[1]||(e[1]=ne(()=>{},["stop"])),onDragstart:n=>F(n,t,"backlog"),onDragend:x},"↕",40,Et)]),_:1},8,["columns","rows","itemKey","sorters"]))],34)]))}}),Ut={class:"rounded-lg flex flex-col"},Ht=["checked"],Ft=["checked","onChange"],Nt={class:"flex items-center gap-2"},It={class:"inline-block rounded-full border px-2 py-0.5 text-xs"},qt={class:"truncate"},Rt=["onDragstart"],Kt={key:1,class:"empty-state flex flex-col h-full justify-center items-center border-dashed border border-border"},jt=le({__name:"SprintCard",props:{sprint:{},sprintId:{}},emits:["edit-sprint","toggle-start","open-ticket","move-selected-to-backlog","delete-selected-sprint","refresh"],setup(l,{emit:a}){const m=l,h=a,k=Ue(),{selectedSprintIds:u,allSprintChecked:v,toggleAll:w,toggleOne:D}=k,p=T([]);X(()=>m.sprint.tickets,o=>{p.value=[...o||[]]},{immediate:!0,deep:!0});const r=T(!1),g=T(null),{mutate:B}=tt({onSuccess:()=>{ue.success("Card moved to sprint successfully"),h("refresh")},onError:o=>{ue.error("Failed to move card: "+(o.message||"Unknown error"))}});function S(o,e,t,n){var b;g.value=e.id;const f=JSON.stringify({id:e.id,from:t,sprintId:n,ticket:e});(b=o.dataTransfer)==null||b.setData("text/plain",f),o.dataTransfer&&(o.dataTransfer.effectAllowed="move")}function $(o){var e;r.value=!1,((e=o.dataTransfer)==null?void 0:e.dropEffect)!=="none"&&g.value&&(p.value=p.value.filter(t=>t.id!==g.value)),g.value=null}function F(){r.value=!0}function x(){r.value=!1}function _(o){var e;o.preventDefault(),r.value=!1;try{const t=(e=o.dataTransfer)==null?void 0:e.getData("text/plain");if(!t)return;const n=JSON.parse(t);if(n.from!=="backlog"||p.value.some(b=>b.id===n.id))return;p.value.push(n.ticket),B({id:m.sprintId,payload:{card_ids:[n.ticket.id],priority:n.ticket.priority.toLowerCase(),story_points:n.ticket.storyPoints||0}})}catch(t){console.error("Drop error:",t)}}const V=[{key:"select",label:"",width:36},{key:"summary",label:"Summary",sortable:!0},{key:"status",label:"Status",width:120,sortable:!0},{key:"assignee",label:"Assignee",width:120,sortable:!0}];return(o,e)=>(L(),N("div",Ut,[s("div",{class:ce(["h-[300px]",r.value?"ring-2 ring-blue-400 rounded-lg":""]),onDragover:e[5]||(e[5]=ne(()=>{},["prevent"])),onDragenter:F,onDragleave:x,onDrop:_},[p.value.length>0?(L(),Y(Ge,{key:0,showHeader:!1,pagination:!1,"row-draggable":!0,class:"h-full",onRowDragstart:e[2]||(e[2]=({row:t,$event:n})=>S(n,t,"sprint",o.sprint.id)),onRowDragend:e[3]||(e[3]=({$event:t})=>$(t)),columns:V,rows:p.value,"page-size":100,hover:!0,striped:"","item-key":t=>t.id,onRowClick:e[4]||(e[4]=({row:t})=>o.$emit("open-ticket",t))},{"select-header":P(()=>[s("input",{type:"checkbox",checked:c(v)(o.sprint.id),onChange:e[0]||(e[0]=t=>c(w)("sprint",t,o.sprint.id))},null,40,Ht)]),select:P(({row:t})=>[s("input",{type:"checkbox",checked:(c(u)[o.sprint.id]||[]).includes(t.id),onChange:n=>c(D)("sprint",t.id,n,o.sprint.id)},null,40,Ft)]),summary:P(({row:t})=>[s("div",Nt,[s("span",It,j(t.key),1),s("span",qt,j(t.summary),1)])]),priority:P(({row:t})=>[s("span",{class:ce(c(Ae)(t.priority))},j(t.priority),3)]),drag:P(({row:t})=>[s("button",{class:"cursor-grab",title:"Drag to Backlog",draggable:"",onClick:e[1]||(e[1]=ne(()=>{},["stop"])),onDragstart:n=>S(n,t,"sprint",o.sprint.id),onDragend:$},"↕",40,Rt)]),_:1},8,["rows","item-key"])):(L(),N("div",Kt,e[6]||(e[6]=[Je('<img src="'+Ye+'" class="mb-4" alt="backlog-plan"><h6 class="text-sm text-text-primary font-semibold mb-1 text-center">Plan your sprint</h6><p class="text-sm text-text-primary/90 mb-3 max-w-120 text-center">Drag work items from the <span class="font-bold"> Backlog </span> section or create new ones to plan the work for this sprint. Select <span class="font-bold">Start sprint</span> when you&#39;re ready.</p>',3)])))],34)]))}}),zt={class:"text-lg font-semibold"},Gt={class:"grid grid-cols-1 gap-3"},Jt={class:"space-y-1"},Zt={class:"grid grid-cols-2 gap-3"},Qt={class:"space-y-1"},Wt={class:"space-y-1"},Xt={class:"grid grid-cols-2 gap-3"},Yt={class:"space-y-1"},es={class:"space-y-1"},ts={class:"space-y-1"},ss=le({__name:"TicketModal",props:{modelValue:{type:Boolean},editing:{type:Boolean},ticket:{}},emits:["update:modelValue","save","close"],setup(l,{emit:a}){const m=l,h=a,k=T(),u=de({type:"Story",priority:"Medium",storyPoints:1,status:"Todo"});function v(){var p;(p=k.value)==null||p.showModal()}function w(){var p;(p=k.value)==null||p.close(),h("update:modelValue",!1)}X(()=>m.modelValue,p=>{p?v():w()}),X(()=>m.ticket,p=>{Object.assign(u,{summary:"",type:"Story",priority:"Medium",storyPoints:1,status:"Todo",assignee:"",description:""}),p&&Object.assign(u,p)});function D(){var p;(p=u.summary)!=null&&p.trim()&&(h("save",{...u}),w())}return ot(()=>{m.modelValue&&v()}),at(w),(p,r)=>(L(),N("dialog",{ref_key:"dlg",ref:k,class:"modal",onClose:r[7]||(r[7]=g=>p.$emit("close"))},[s("form",{method:"dialog",class:"modal-box max-w-lg space-y-4",onSubmit:r[6]||(r[6]=ne(()=>{},["prevent"]))},[s("h3",zt,j(p.editing?"Edit":"Create")+" Ticket",1),s("div",Gt,[s("label",Jt,[r[8]||(r[8]=s("span",{class:"text-sm"},"Summary",-1)),Z(s("input",{"onUpdate:modelValue":r[0]||(r[0]=g=>u.summary=g),class:"w-full rounded-md border px-3 py-2",placeholder:"As a user, I want…"},null,512),[[ve,u.summary]])]),s("div",Zt,[s("label",Qt,[r[10]||(r[10]=s("span",{class:"text-sm"},"Type",-1)),Z(s("select",{"onUpdate:modelValue":r[1]||(r[1]=g=>u.type=g),class:"w-full rounded-md border px-3 py-2"},r[9]||(r[9]=[s("option",null,"Story",-1),s("option",null,"Bug",-1),s("option",null,"Task",-1)]),512),[[Ne,u.type]])]),s("label",Wt,[r[12]||(r[12]=s("span",{class:"text-sm"},"Priority",-1)),Z(s("select",{"onUpdate:modelValue":r[2]||(r[2]=g=>u.priority=g),class:"w-full rounded-md border px-3 py-2"},r[11]||(r[11]=[s("option",null,"Highest",-1),s("option",null,"High",-1),s("option",null,"Medium",-1),s("option",null,"Low",-1)]),512),[[Ne,u.priority]])])]),s("div",Xt,[s("label",Yt,[r[13]||(r[13]=s("span",{class:"text-sm"},"Story Points",-1)),Z(s("input",{type:"number",min:"0","onUpdate:modelValue":r[3]||(r[3]=g=>u.storyPoints=g),class:"w-full rounded-md border px-3 py-2"},null,512),[[ve,u.storyPoints,void 0,{number:!0}]])]),s("label",es,[r[14]||(r[14]=s("span",{class:"text-sm"},"Assignee",-1)),Z(s("input",{"onUpdate:modelValue":r[4]||(r[4]=g=>u.assignee=g),class:"w-full rounded-md border px-3 py-2",placeholder:"Unassigned"},null,512),[[ve,u.assignee]])])]),s("label",ts,[r[15]||(r[15]=s("span",{class:"text-sm"},"Description",-1)),Z(s("textarea",{"onUpdate:modelValue":r[5]||(r[5]=g=>u.description=g),class:"w-full rounded-md border px-3 py-2",rows:"3"},null,512),[[ve,u.description]])])]),s("div",{class:"modal-action"},[s("button",{type:"button",class:"rounded-md border px-3 py-1.5",onClick:w},"Cancel"),s("button",{type:"button",class:"rounded-md bg-blue-600 px-3 py-1.5 text-white",onClick:D},"Save")])],32)],544))}}),os=nt(ss,[["__scopeId","data-v-124bfadf"]]),as={class:"px-6 gap-4"},ns={class:"flex justify-end gap-2 p-6 mt-8 sticky bottom-0 bg-bg-body border-t border-border"},rs=le({__name:"SprintModal",props:{modelValue:{type:Boolean,default:!1},sprint:{},creatingSprint:{type:Boolean}},emits:["update:modelValue","save","close"],setup(l,{emit:a}){const m=a,h=l,k=U({get:()=>h.modelValue,set:B=>m("update:modelValue",B)}),u=de({name:""}),v=de({name:!1}),w=U(()=>v.name&&!String(u.name||"").trim()?"Name is required":""),D=U(()=>!!String(u.name||"").trim()&&!w.value);function p(){k.value=!1,m("close")}function r(){v.name=!0,D.value&&m("save",{name:String(u.name||"").trim()})}function g(){v.name=!1}return X(()=>h.sprint,B=>{if(!B){u.name="";return}u.name=B.name??(B==null?void 0:B.title)??"",g()},{immediate:!0}),(B,S)=>(L(),Y(We,{modelValue:k.value,"onUpdate:modelValue":S[2]||(S[2]=$=>k.value=$),modalClass:"!py-0",size:"md"},{default:P(()=>[S[5]||(S[5]=s("div",{class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-body pb-4 mb-4"},[s("h2",{class:"text-xl font-semibold"},"Add Sprint"),s("p",{class:"text-sm text-text-secondary mt-1"},[H(" Add sprint name and then click "),s("span",{class:"font-medium"},"Save"),H(". ")])],-1)),s("div",as,[M(it,{modelValue:u.name,"onUpdate:modelValue":S[0]||(S[0]=$=>u.name=$),label:"Name",placeholder:"Sprint 1",error:!!w.value,message:w.value,onBlur:S[1]||(S[1]=$=>v.name=!0)},null,8,["modelValue","error","message"]),S[3]||(S[3]=s("div",null,null,-1))]),s("div",ns,[M(ee,{variant:"secondary",onClick:p},{default:P(()=>S[4]||(S[4]=[H("Cancel")])),_:1,__:[4]}),M(ee,{variant:"primary",disabled:!D.value,onClick:r},{default:P(()=>[H(j(B.creatingSprint?"Saving...":"Save"),1)]),_:1},8,["disabled"])])]),_:1,__:[5]},8,["modelValue"]))}}),ls={class:"px-6 grid grid-cols-2 gap-4"},is={class:"flex gap-1 flex-col"},ds={key:0,class:"text-xs text-red-500"},us={class:"flex gap-1 flex-col"},cs={key:0,class:"text-xs text-red-500"},ps={class:"flex flex-col col-span-2"},ms={class:"flex justify-end gap-2 p-6 mt-8 sticky bottom-0 bg-bg-body border-t border-border"},fs=le({__name:"StartSprintModal",props:{modelValue:{type:Boolean,default:!1},sprint:{}},emits:["update:modelValue","save","close"],setup(l,{emit:a}){const m=a,h=l,k=U({get:()=>h.modelValue,set:x=>m("update:modelValue",x)}),u=de({goal:"",start:"",end:""});X(()=>h.sprint,x=>{x&&(u.goal=x.goal??"",u.start=x.start??"",u.end=x.end??"",$())},{immediate:!0});const v=de({start:!1,end:!1}),w=U(()=>""),D=U(()=>{if(!v.end)return"";if(u.start&&u.end){const x=F(u.start),_=F(u.end);if(Number.isFinite(x)&&Number.isFinite(_)&&_<x)return"End date cannot be before start date"}return""}),p=U(()=>!D.value);function r(x){u.start=x||"",v.start=!0}function g(x){u.end=x||"",v.end=!0}function B(){k.value=!1,m("close")}function S(){v.start=!0,v.end=!0,p.value&&m("save",{goal:u.goal??"",start:u.start||"",end:u.end||""})}function $(){v.start=!1,v.end=!1}function F(x){return x?new Date(`${x}T00:00:00`).getTime():NaN}return(x,_)=>(L(),Y(We,{modelValue:k.value,"onUpdate:modelValue":_[1]||(_[1]=V=>k.value=V),modalClass:"!py-0",size:"md"},{default:P(()=>[_[7]||(_[7]=s("div",{class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-body pb-4 mb-4"},[s("h2",{class:"text-xl font-semibold"},"Start Sprint"),s("p",{class:"text-sm text-text-secondary mt-1"},[H(" Update sprint name, goal, and dates, then click "),s("span",{class:"font-medium"},"Start"),H(". ")])],-1)),s("div",ls,[s("div",is,[_[2]||(_[2]=s("label",{class:"text-sm"},"Start date",-1)),s("div",{class:ce(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",w.value?"border-red-500":""])},[M(qe,{placeholder:"Set start date",class:"w-full","model-value":u.start,"emit-as":"ymd","onUpdate:modelValue":r},null,8,["model-value"])],2),w.value?(L(),N("p",ds,j(w.value),1)):ie("",!0)]),s("div",us,[_[3]||(_[3]=s("label",{class:"text-sm"},"End date",-1)),s("div",{class:ce(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",D.value?"border-red-500":""])},[M(qe,{placeholder:"Set end date",class:"w-full","model-value":u.end,"emit-as":"ymd","onUpdate:modelValue":g},null,8,["model-value"])],2),D.value?(L(),N("p",cs,j(D.value),1)):ie("",!0)]),s("div",ps,[_[4]||(_[4]=s("label",{class:"text-sm"},"Goal (optional)",-1)),Z(s("textarea",{"onUpdate:modelValue":_[0]||(_[0]=V=>u.goal=V),class:"w-full rounded-lg border border-border px-3 py-2 bg-bg-input",rows:"2",placeholder:"Ship onboarding flow"},null,512),[[ve,u.goal]])])]),s("div",ms,[M(ee,{variant:"secondary",onClick:B},{default:P(()=>_[5]||(_[5]=[H("Cancel")])),_:1,__:[5]}),M(ee,{variant:"primary",disabled:!p.value,onClick:S},{default:P(()=>_[6]||(_[6]=[H("Start")])),_:1,__:[6]},8,["disabled"])])]),_:1,__:[7]},8,["modelValue"]))}}),gs={class:"flex-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur rounded-2xl shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] flex-grow h-full bg-bg-card border border-border overflow-x-auto flex-col flex"},vs={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},bs={class:"flex gap-3 items-center"},ys={class:"flex overflow-x-auto gap-3 p-4"},ks={key:0,class:"mx-auto text-text-secondary/80 m-2 w-[90%] h-full justify-center flex items-center border border-dashed border-border"},xs=le({__name:"ActiveSprint",props:{sptint_id:{}},setup(l){const a=l,m=De(()=>Ve(()=>import("./CreateTaskModal-rrErnsSG.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]))),h=De(()=>Ve(()=>import("./ConfirmDeleteModal-DMAhBbas.js"),__vite__mapDeps([19,20,2,3,4,5,6]))),k=De(()=>Ve(()=>import("./SidePanel-BKSZbflK.js"),__vite__mapDeps([21,2,3,14,15,9,8,7,16,10,11,12,17,18,22,13,23,24,25]))),u=De(()=>Ve(()=>import("./KanbanBoard-6d92uia1.js"),__vite__mapDeps([26,2,3,17,18,10,11,12,27,20,4,5,6,22,13,28,29]))),v=rt(),{workspaceId:w,moduleId:D}=lt(),{data:p}=dt(w.value,D.value),r=Ze(),{mutate:g,isPending:B}=ut({onSuccess:()=>{r.invalidateQueries({queryKey:["sheet-list"]}),Be.value="",G.value=!1,ye.value=!1,G.value=!1}}),S=y=>{g({workspace_id:w.value,module_id:D.value,variable_id:V.value,value:y})},{data:$}=ct({workspace_id:w,workspace_module_id:D}),F=U(()=>{var y;return $.value?(y=$.value[0])==null?void 0:y._id:""}),x=T(F),_=U(()=>{var y;return p.value?(y=p.value[0])==null?void 0:y._id:""}),V=T(_),o=bt(),e=U(()=>a.sptint_id),{mutate:t,isPending:n}=_t(e),{data:f,isPending:b}=St(e),I=()=>{t({})},q=T(!1),J=T(),R=y=>{J.value=y},te=pt(),$e=mt();function Me(y){y.type=="column"?te.mutate({payload:{workspace_id:w.value,workspace_module_id:D.value,variable_id:V.value,moved_value:y.meta.id,new_index:y.meta.newIndex}}):$e.mutate({payload:{workspace_id:w.value,card_id:y.meta.moved._id,group_value:y.meta.fromColumnId,group_variable_id:V.value,new_index:y.meta.newIndex,sheet_id:x.value}})}const Pe=y=>{};X($,y=>{var C;(y==null?void 0:y.length)>0&&(x.value=(C=y[0])==null?void 0:C._id)});const ye=T(!1),Be=T(""),Le=y=>{g({workspace_id:v.params.id,module_id:v.params.module_id,new_value:y.title,value:y.oldTitle,variable_id:V.value})},G=T(!1),A=T(),pe=()=>{g({value:A.value.title,workspace_id:w.value,module_id:D.value,newValue:A.value.title,variable_id:V.value,is_trash:!0})},Oe=y=>{G.value=!0,A.value=y},ke=y=>{q.value=!0,A.value=y};return(y,C)=>{var xe,se,Se,_e,Ce;return L(),N(Ee,null,[s("div",gs,[s("div",vs,[C[8]||(C[8]=H(" Sprint ")),s("div",bs,[M(Xe,{placeholder:"Search in Orchit AI space"}),M(ee,{size:"sm",onClick:I},{default:P(()=>[H(j(c(n)?"Ending...":"End"),1)]),_:1})])]),Z(M(ft,null,null,512),[[Ie,c(b)]]),Z(s("div",ys,[M(c(u),{onOnPlus:ke,"onDelete:column":C[0]||(C[0]=K=>Oe(K)),"onUpdate:column":C[1]||(C[1]=K=>Le(K)),onReorder:Me,onAddColumn:S,"onSelect:ticket":R,board:c(f),onOnBoardUpdate:Pe,variable_id:V.value,sheet_id:x.value},{"column-footer":P(K=>{var we,me,he,Te,d;return[(me=(we=c(o))==null?void 0:we.transitions)!=null&&me.all_allowed&&!((d=(Te=(he=c(o))==null?void 0:he.transitions)==null?void 0:Te.all_allowed)!=null&&d.includes(K.column.title))&&c(o).transitions.currentColumn!=K.column.title?(L(),N("div",ks," Disbale ( you can't drop here )")):ie("",!0)]}),_:1},8,["board","variable_id","sheet_id"])],512),[[Ie,!c(b)]])]),M(c(h),{onClick:C[2]||(C[2]=ne(()=>{},["stop"])),modelValue:G.value,"onUpdate:modelValue":C[3]||(C[3]=K=>G.value=K),title:"Delete List",itemLabel:"list",itemName:(xe=A.value)==null?void 0:xe.title,requireMatchText:(se=A.value)==null?void 0:se.title,confirmText:"Delete workspace",cancelText:"Cancel",size:"md",loading:c(B),onConfirm:pe,onCancel:C[4]||(C[4]=()=>{G.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),q.value?(L(),Y(c(m),{selectedVariable:V.value,listId:(Se=A.value)==null?void 0:Se.title,sheet_id:x.value,key:"createTaskModalKey",modelValue:q.value,"onUpdate:modelValue":C[5]||(C[5]=K=>q.value=K),onSubmit:C[6]||(C[6]=()=>{})},null,8,["selectedVariable","listId","sheet_id","modelValue"])):ie("",!0),(_e=J.value)!=null&&_e._id?(L(),Y(c(k),{key:1,details:J.value,onClose:C[7]||(C[7]=()=>{R({variables:{}})}),showPanel:!!((Ce=J.value)!=null&&Ce._id)},null,8,["details","showPanel"])):ie("",!0)],64)}}}),Ss={key:0,class:"flex-auto flex-grow h-full bg-bg-card rounded-lg border border-border overflow-x-auto flex-col flex"},_s={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},Cs={class:"flex gap-3 items-center"},ws={class:"space-y-6 p-4 w-full flex-auto overflow-y-auto"},hs={class:"flex flex-col gap-6"},Ts={class:"space-y-4 bg-bg-surface/30 p-4 rounded-md"},Ds={class:"space-y-4 bg-bg-surface/30 p-4 rounded-md"},Vs={class:"flex items-center justify-between"},$s={class:"text-sm font-semibold"},Ms={key:1,class:"flex-auto flex-grow h-full bg-bg-card rounded-lg border border-border overflow-x-auto flex-col flex"},Ps={class:"empty-state w-full flex flex-col h-full justify-center items-center"},Ks=le({__name:"Plan",setup(l){const{workspaceId:a}=Qe(),{moveSelectedToSprint:m,moveSelectedToBacklog:h,deleteSelected:k,createTicket:u,saveSprintMeta:v,toggleStartSprint:w}=Ue(),{mutate:D,isPending:p}=Tt({onSuccess:()=>{se.invalidateQueries({queryKey:["sprint-list"]}),g.value=!1}}),r=T(null),g=T(!1),B=()=>{var d;console.log(r,">>>"),D((d=r.value)==null?void 0:d._id)},{mutate:S,isPending:$}=Re({onSuccess:d=>{v({name:d.title}),F({id:f.value}),I(),se.invalidateQueries({queryKey:["sprint-list"]}),q.value=!1}}),{mutate:F,isPending:x}=ht(),_=d=>{console.log("helo",r.value,d),S({id:f.value,payload:{goal:d.goal,start_date:d.start,end_date:d.end}})},{data:V,refetch:o}=kt(a.value),{data:e,refetch:t}=et(a),n=U(()=>{var d,i;return(i=(d=V==null?void 0:V.value)==null?void 0:d.sprints[0])==null?void 0:i._id}),f=T(n),{data:b,refetch:I}=Ct(n),q=T(!1),J=()=>{q.value=!0},{data:R}=xt(f),te=U(()=>{var oe,Q;const d=(oe=R==null?void 0:R.value)==null?void 0:oe.backlog_items;if(!d)return null;const i=(((Q=R==null?void 0:R.value)==null?void 0:Q.backlog_items)||[]).map(O=>{var fe,ge,E,He,Fe;const W=((fe=O==null?void 0:O.card)==null?void 0:fe.variables)||{},ae=((ge=O==null?void 0:O.card)==null?void 0:ge._id)||O.card_id;return{id:ae,key:W["card-code"]||(ae==null?void 0:ae.slice(-6))||"PRJ-?",summary:W["card-title"]||"(untitled)",type:"Story",status:$e(String(W["card-status"]||"").trim()),assignee:((He=(E=O==null?void 0:O.card)==null?void 0:E.assigned_to)==null?void 0:He.name)||"Unassigned",storyPoints:Number(O.story_points||0),priority:Me(String(W.priority||"").trim()),createdAt:((Fe=O==null?void 0:O.card)==null?void 0:Fe.created_at)||new Date().toISOString(),description:W["card-description"]||""}});return{id:d._id,name:d.title||"Sprint 1",title:d.title,goal:"",start:"",end:"",started:!1,tickets:i}});function $e(d){const i=d.toLowerCase();return i.includes("progress")?"In Progress":i.includes("done")||i.includes("complete")?"Done":"Todo"}function Me(d){const i=d.toLowerCase();return i==="highest"||i==="blocker"||i==="critical"?"Highest":i==="high"||i==="major"?"High":i==="medium"||i==="normal"?"Medium":"Low"}const{mutate:Pe}=Dt({onSuccess:()=>{ue.success("Card removed from sprint successfully"),ye()},onError:d=>{ue.error("Failed to remove card from sprint"),console.error("Failed to remove card from sprint:",d)}});function ye(){o(),t(),I()}function Be(d){console.log(">>> moving back to backlog"),f&&Pe({sprintId:f,cardId:d})}const Le={createdAt:(d,i,oe)=>{const Q=new Date(d.createdAt).getTime(),O=new Date(i.createdAt).getTime();return oe==="asc"?Q-O:O-Q}},G=T(!1),A=T(null);let pe="backlog";function Oe(){A.value=null,pe="backlog",G.value=!0}function ke(d){A.value=d,pe="backlog",G.value=!0}function y(d){var i;A.value?Object.assign(A.value,d):u(pe,{summary:d.summary,type:d.type,status:d.status||"Todo",assignee:((i=d.assignee)==null?void 0:i.trim())||"Unassigned",storyPoints:Number(d.storyPoints)||0,priority:d.priority,description:d.description||""})}const C=T(!1);function xe(){C.value=!0}const se=Ze(),{mutate:Se,isPending:_e}=wt({onSuccess:d=>{v({name:d.title}),se.invalidateQueries({queryKey:["sprint-list"]}),C.value=!1}}),{mutate:Ce,isPending:K}=Re({onSuccess:d=>{v({name:d.title}),se.invalidateQueries({queryKey:["sprint-list"]}),C.value=!1}});function we(d){var i;r.value?Ce({id:(i=r.value)==null?void 0:i._id,payload:{workspace_id:a.value,title:d.name}}):Se({payload:{workspace_id:a.value,title:d.name}})}function me(){r.value=null,C.value=!0}function he(d){r.value=d,C.value=!0}function Te(d){r.value=d,g.value=!0}return(d,i)=>{var oe,Q,O,W,ae,fe,ge;return L(),N(Ee,null,[((oe=c(b))==null?void 0:oe.status)=="active"?(L(),Y(xs,{key:0,sptint_id:f.value},null,8,["sptint_id"])):(L(),N(Ee,{key:1},[((Q=c(V))==null?void 0:Q.sprints.length)>0?(L(),N("div",Ss,[s("div",_s,[M(gt,{prefix:"View By",modelValue:f.value,"onUpdate:modelValue":i[1]||(i[1]=E=>f.value=E),options:(O=c(V))==null?void 0:O.sprints,variant:"secondary",onEditOption:he,onDeleteOption:Te},{more:P(()=>[s("div",{onClick:i[0]||(i[0]=E=>me()),class:"capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},i[10]||(i[10]=[s("i",{class:"fa-solid fa-plus"},null,-1),H(" Add new ")]))]),_:1},8,["modelValue","options"]),s("div",Cs,[M(Xe,{placeholder:"Search in Orchit AI space"}),M(ee,{size:"sm",onClick:J},{default:P(()=>i[11]||(i[11]=[H("Start Sprint")])),_:1,__:[11]})])]),s("div",ws,[s("div",hs,[s("section",Ts,[i[12]||(i[12]=s("div",{class:"flex items-center justify-between"},[s("h2",{class:"text-sm font-semibold"},"Sprint (100 Taks)")],-1)),te.value?(L(),Y(jt,{key:0,sprintId:f.value,sprint:te.value,onOpenTicket:ke,onEditSprint:xe,onToggleStart:c(w),onMoveSelectedToBacklog:c(h),onDeleteSelectedSprint:i[2]||(i[2]=E=>c(k)("sprint",E)),onRefresh:ye},null,8,["sprintId","sprint","onToggleStart","onMoveSelectedToBacklog"])):ie("",!0)]),s("section",Ds,[s("div",Vs,[s("h2",$s,"Backlog ("+j((ae=(W=c(e))==null?void 0:W.backlog_items)==null?void 0:ae.length)+" Taks)",1),s("div",{class:"flex items-center gap-2"},[s("button",{class:"w-8 h-8 rounded-md border cursor-pointer aspect-square text-sm border-border hover:bg-gray-50",onClick:Oe},i[13]||(i[13]=[s("i",{class:"text-text-primary fa-regular fa-plus"},null,-1)]))])]),M(At,{sorters:Le,onMoveSelectedToSprint:c(m),onDeleteSelectedBacklog:i[3]||(i[3]=E=>c(k)("backlog")),onOpenTicket:ke,onTicketMovedToBacklog:Be},null,8,["onMoveSelectedToSprint"])])])])])):(L(),N("div",Ms,[s("div",Ps,[i[15]||(i[15]=Je('<img src="'+Ye+'" class="mb-4" alt="backlog-plan"><h6 class="text-sm text-text-primary font-semibold mb-1 text-center">Plan your sprint</h6><p class="text-sm text-text-primary/90 mb-3 max-w-120 text-center">Drag work items from the <span class="font-bold"> Backlog </span> section or create new ones to plan the work for this sprint. Select <span class="font-bold">Start sprint</span> when you&#39;re ready.</p>',3)),M(ee,{onClick:me},{default:P(()=>i[14]||(i[14]=[H("Create Sprint")])),_:1,__:[14]})])]))],64)),M(vt,{onClick:i[4]||(i[4]=ne(()=>{},["stop"])),modelValue:g.value,"onUpdate:modelValue":i[5]||(i[5]=E=>g.value=E),title:"Delete Sprint",itemLabel:"Sprint",itemName:(fe=r.value)==null?void 0:fe.title,requireMatchText:(ge=r.value)==null?void 0:ge.title,confirmText:"Delete Ticket",cancelText:"Cancel",size:"md",loading:c(p),onConfirm:B,onCancel:i[6]||(i[6]=()=>{r.value=null,g.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),M(os,{modelValue:G.value,"onUpdate:modelValue":i[7]||(i[7]=E=>G.value=E),editing:!!A.value,ticket:A.value,onSave:y},null,8,["modelValue","editing","ticket"]),M(rs,{modelValue:C.value,"onUpdate:modelValue":i[8]||(i[8]=E=>C.value=E),onSave:we,sprint:r.value,creatingSprint:r.value?c(K):c(_e)},null,8,["modelValue","sprint","creatingSprint"]),M(fs,{sprint:r.value,modelValue:q.value,"onUpdate:modelValue":i[9]||(i[9]=E=>q.value=E),onSave:_,creatingSprint:c(x)||c($)},null,8,["sprint","modelValue","creatingSprint"])],64)}}});export{Ks as default};
