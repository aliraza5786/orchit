import{_ as S}from"./whitePlus-Cs_P7rE9.js";import{d as z,r as b,as as R,p as M,h as o,b as a,t as l,F as g,v as w,i as y,e as c,g as m,w as u,B as x,o as i}from"./index-4VVrnSvV.js";import{_ as B}from"./BaseTextField.vue_vue_type_script_setup_true_lang-BOTvTtsA.js";import{_ as D}from"./BaseTextAreaField.vue_vue_type_script_setup_true_lang-D7p97x9E.js";import{_ as P}from"./BaseEmailChip.vue_vue_type_script_setup_true_lang-B2PEtvYm.js";import"./info-DjaLHeD_.js";const U={class:"w-full pt-4"},J={class:"text-sm md:text-lg text-text-secondary"},O={class:"space-y-3 w-full pb-4"},q={class:"flex items-center justify-between mb-2"},F={class:"flex gap-4 items-center text-2xl justify-between w-full"},G={class:"flex flex-col text-text-primary text-lg font-semibold"},H={key:0,class:"text-xl mr-2"},K={class:"text-sm text-text-secondary"},Q={class:"flex items-center gap-3 text-text-primary"},X=["onClick"],Y={class:"text-lg"},Z=["onClick"],ee={class:"text-text-primary"},te={class:"text-sm font-medium text-text-secondary mb-2 flex justify-between items-center gap-2.5"},se={class:"flex items-center gap-2"},ae={class:"text-xs text-text-secondary"},ne={key:0,class:"text-sm text-text-secondary mb-3"},oe={class:"text-sm font-medium capitalize"},ie={class:"text-xs text-text-secondary"},le=["onClick"],pe={key:1,class:"mt-2 space-y-2"},me={class:"flex items-center justify-end gap-2"},ce={key:1,class:"bg-bg-surface mt-2 cursor-pointer rounded-xl p-6"},re={class:"flex gap-2 mt-6 justify-end"},we=z({__name:"StepThree",props:{ai:{type:Boolean}},emits:["next","back"],setup(de,{emit:ue}){const _=b(!1),p=b({name:"",description:""}),f=R({roles:[]}),h=/^[^\s@]+@[^\s@]+\.[^\s@]+$/i,k=e=>h.test(e);function C(e){e.showInput=!0,e.capacityWarning=e.people.length>=e.max_num_people}function v(e){for(;e.people.length>e.max_num_people;)e.people.pop();e.capacityWarning=e.people.length>=e.max_num_people,r()}function I(e,s){e.people.some(t=>t.email.toLowerCase()===s.toLowerCase())||e.people.push({name:s.split("@")[0],email:s})}function E(e,s){const[t]=e.people.splice(s,1),n=e.emailList.findIndex(d=>d.toLowerCase()===t.email.toLowerCase());n!==-1&&e.emailList.splice(n,1),e.capacityWarning=e.people.length>=e.max_num_people,r()}function j(e,s){e.emailError=s.length?`Invalid: ${s.join(", ")}`:""}function L(e,s){s.forEach(t=>{k(t)&&(e.people.length<e.max_num_people?I(e,t):e.capacityWarning=!0)}),r()}function V(e,s){const t=e.people.findIndex(n=>n.email.toLowerCase()===s.toLowerCase());t!==-1&&e.people.splice(t,1),e.capacityWarning=e.people.length>=e.max_num_people,r()}function $(e){e.showInput=!1,e.capacityWarning=e.people.length>=e.max_num_people,r()}function N(e){e.showInput=!1,e.emailError="",e.capacityWarning=e.people.length>=e.max_num_people}function W(){const e={id:`role-${Date.now()}`,title:p.value.name,description:p.value.description,people:[],showInput:!1,max_num_people:1,role_emoji:"",emailList:[],emailError:"",capacityWarning:!1};f.roles.push(e),r(),p.value.name="",p.value.description="",_.value=!1}function r(){const e=localStorage.getItem("workspace"),s=e?JSON.parse(e):{variables:{roles:[]}};s.variables.roles=f.roles,localStorage.setItem("workspace",JSON.stringify(s))}M(()=>{try{const e=localStorage.getItem("workspace");if(e){const s=JSON.parse(e);f.roles=(s.variables.roles||[]).map(t=>{var n;return{...t,showInput:t.showInput??!1,emailList:t.emailList??((n=t.people)==null?void 0:n.map(d=>d.email))??[],emailError:"",capacityWarning:!1,max_num_people:typeof t.max_num_people=="number"?t.max_num_people:1,role_emoji:t.role_emoji??""}})}}catch(e){console.error("Error parsing workspace from localStorage",e)}});function T(e){e.max_num_people>1&&(e.max_num_people--,v(e))}function A(e){e.max_num_people++,v(e)}return(e,s)=>(i(),o(g,null,[a("div",U,[s[4]||(s[4]=a("h2",{class:"text-xl md:text-4xl font-semibold text-text-primary mb-1"},"Team Resources",-1)),a("p",J,l(e.ai?" AI-recommended team composition for your project":"Team composition for your project"),1)]),a("div",O,[(i(!0),o(g,null,w(f.roles,t=>(i(),o("div",{key:t.id,class:"bg-bg-surface rounded-xl p-6"},[a("div",q,[a("div",F,[a("div",G,[a("span",null,[t!=null&&t.role_emoji?(i(),o("span",H,l(t.role_emoji),1)):y("",!0),c(" "+l(t.title),1)]),a("p",K,l(t.description),1)]),a("div",Q,[a("button",{onClick:n=>T(t),class:"w-8 h-8 aspect-square rounded-full bg-bg-card flex items-center justify-center text-xl"},"−",8,X),a("span",Y,l(t.max_num_people),1),a("button",{onClick:n=>A(t),class:"w-8 h-8 aspect-square rounded-full bg-bg-card flex items-center justify-center text-xl"},"+",8,Z)])])]),a("div",ee,[a("p",te,[s[6]||(s[6]=c(" Team Members ")),a("span",se,[a("span",ae,l(t.people.length)+"/"+l(t.max_num_people),1),m(x,{size:"sm",variant:"secondary",onClick:n=>C(t),disabled:t.people.length>=t.max_num_people,title:"Add people by email"},{default:u(()=>s[5]||(s[5]=[c(" Add people ")])),_:2,__:[5]},1032,["onClick","disabled"])])]),t.people.length===0?(i(),o("div",ne," No team members assigned yet ")):y("",!0),(i(!0),o(g,null,w(t.people,(n,d)=>(i(),o("div",{key:d,class:"flex justify-between items-center mb-3"},[a("div",null,[a("p",oe,l(n.name),1),a("p",ie,l(n.email),1)]),a("button",{onClick:xe=>E(t,d),class:"text-text-primary w-8 h-8 bg-bg-card rounded-md cursor-pointer"},"✕",8,le)]))),128)),t.showInput?(i(),o("div",pe,[m(P,{modelValue:t.emailList,"onUpdate:modelValue":n=>t.emailList=n,error:!!t.emailError||t.capacityWarning,message:t.capacityWarning?`Reached role capacity (${t.max_num_people}).`:t.emailError||"Press Enter, comma, semicolon, or space to add. Invalid entries won’t be added.",showName:"",onInvalid:n=>j(t,n),onAdd:n=>L(t,n),onRemove:n=>V(t,n)},null,8,["modelValue","onUpdate:modelValue","error","message","onInvalid","onAdd","onRemove"]),a("div",me,[m(x,{onClick:n=>$(t),variant:"primary"},{default:u(()=>s[7]||(s[7]=[c("Done")])),_:2,__:[7]},1032,["onClick"]),m(x,{onClick:n=>N(t),variant:"secondary"},{default:u(()=>s[8]||(s[8]=[c("Cancel")])),_:2,__:[8]},1032,["onClick"])])])):y("",!0)])]))),128)),_.value?(i(),o("div",ce,[s[12]||(s[12]=a("h1",{class:"text-lg text-text-primary font-semibold"},"Add New Team",-1)),s[13]||(s[13]=a("br",null,null,-1)),m(B,{label:"Team Name",modelValue:p.value.name,"onUpdate:modelValue":s[1]||(s[1]=t=>p.value.name=t),placeholder:"Enter Team Name",size:"lg"},null,8,["modelValue"]),m(D,{label:"Description",class:"mt-4",modelValue:p.value.description,"onUpdate:modelValue":s[2]||(s[2]=t=>p.value.description=t),placeholder:"Enter Description",size:"lg"},null,8,["modelValue"]),a("div",re,[m(x,{size:"md",variant:"primary",onClick:W},{default:u(()=>s[10]||(s[10]=[c(" Add Team ")])),_:1,__:[10]}),m(x,{size:"md",variant:"secondary",onClick:s[3]||(s[3]=t=>_.value=!1)},{default:u(()=>s[11]||(s[11]=[c("Cancel")])),_:1,__:[11]})])])):(i(),o("div",{key:0,class:"bg-bg-surface mt-2 cursor-pointer rounded-xl p-6 flex flex-col justify-center items-center",onClick:s[0]||(s[0]=t=>_.value=!0)},s[9]||(s[9]=[a("div",{class:"p-2.5 bg-accent w-8 h-8 rounded-full"},[a("img",{class:"w-3",src:S,alt:""})],-1),a("h3",{class:"font-medium text-text-primary capitalize text-sm mt-4"},"Add New Team",-1),a("p",{class:"text-[11px] text-text-secondary mt-1 text-start line-clamp-1"},"Create a custom resource type",-1)])))])],64))}});export{we as default};
