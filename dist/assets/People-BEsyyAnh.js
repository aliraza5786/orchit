const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KanbanSkeleton-Br7Pgt93.js","assets/index-BCXm2D5k.js","assets/index-BkThUD6V.css","assets/KanbanSkeleton-BjQaxKe3.css","assets/BaseTextField-B3lZpqmt.js","assets/ConfirmDeleteModal-C3g9FwrT.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Ds0MNnWK.js","assets/BaseEmailChip-CZw5OUVo.js","assets/BaseEmailChip.vue_vue_type_script_setup_true_lang-C6NaFIJW.js","assets/Dropdown-N0RXl4eD.js","assets/index-CPHFkODT.js","assets/Dropdown-P9l2osTz.css","assets/DetailPanel-CQnhiXlQ.js","assets/ProgressBar.vue_vue_type_script_setup_true_lang-CdwEtXDw.js","assets/usePeople-C-nuC1AB.js","assets/usePackages-DmUleHZp.js","assets/permissionUtils-fD2X1oS-.js","assets/fuse-Ch1WBRTM.js","assets/lodash-CQYOKM_D.js","assets/_commonjsHelpers-_d1bhYXs.js","assets/DetailPanel-C2euj6xm.css","assets/SearchBar-COk_sj9I.js","assets/SearchBar.vue_vue_type_script_setup_true_lang-BwztNeYZ.js","assets/KanbanBoard-D1wSZfqZ.js","assets/vuedraggable.umd-CSlpksUp.js","assets/DropMenu.vue_vue_type_script_setup_true_lang-DNIJ9Rx_.js","assets/KanbanBoard-Dffh696C.css","assets/KanbanCard-BwRMWWZ8.js","assets/KanbanCard.vue_vue_type_script_setup_true_lang-DZfrHoB_.js"])))=>i.map(i=>d[i]);
import{aY as Ae,d as Pe,W as Le,r,M as Se,n as N,v as Ve,N as Te,bd as Oe,c as H,j as C,f as i,i as c,e as G,D as Ie,p as a,E as Ne,k as Z,w as P,h as L,z as R,F as Re,o as p,ae as n,g as B,t as S,U as Be,A as d}from"./index-BCXm2D5k.js";import{e as Ue,f as Fe,g as je,b as Me,R as $e,h as qe}from"./usePeople-C-nuC1AB.js";import{F as ze}from"./fuse-Ch1WBRTM.js";import{l as We}from"./lodash-CQYOKM_D.js";const Je="https://backend.orchit.ai/api/v1/",Ke=Ae("sidePanel",{state:()=>({selectedCard:null,isFetching:!1,selectedCardPeople:null}),getters:{hasSelectedCard:f=>{var u;return!!((u=f.selectedCard)!=null&&u._id)}},actions:{async fetchSelectedCardDetails(f){this.isFetching=!0;try{const u=localStorage.getItem("token");if(!u)throw new Error("No auth token found");const x=await fetch(`${Je}workspace/card/${f}`,{method:"GET",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"}});if(!x.ok)throw new Error(`HTTP error! status: ${x.status}`);const V=await x.json();this.selectedCard=V}catch(u){console.error("Failed to fetch card details:",u)}finally{this.isFetching=!1}},selectCard(f){this.selectedCardPeople=f},clearCard(){this.selectedCardPeople=null}}}),Qe={class:"flex-auto flex-grow h-full bg-bg-card rounded-[6px] border border-border overflow-x-auto flex-col flex"},Ye={class:"overflow-x-auto shrink-0 border-b border-border"},He={class:"header px-4 py-3 flex items-center justify-between gap-2"},Ge={class:"flex gap-3 items-center"},Ze={key:1,class:"flex p-4 overflow-x-auto gap-3 custom_scroll_bar h-full"},Xe=["onClick","disabled"],et={key:1,class:"p-4 space-y-2 bg-bg-surface m-4 rounded-md"},tt={class:"text-sm text-text-primary"},st={class:"flex items-center mt-3 gap-3"},at=["disabled"],ot=Pe({__name:"People",setup(f){const u=n(()=>d(()=>import("./KanbanSkeleton-Br7Pgt93.js"),__vite__mapDeps([0,1,2,3]))),x=n(()=>d(()=>import("./BaseTextField-B3lZpqmt.js"),__vite__mapDeps([4,1,2]))),V=n(()=>d(()=>import("./ConfirmDeleteModal-C3g9FwrT.js"),__vite__mapDeps([5,6,1,2]))),U=n(()=>d(()=>import("./index-BCXm2D5k.js").then(e=>e.dp),__vite__mapDeps([1,2]))),X=n(()=>d(()=>import("./BaseEmailChip-CZw5OUVo.js"),__vite__mapDeps([7,8,1,2]))),ee=n(()=>d(()=>import("./Dropdown-N0RXl4eD.js"),__vite__mapDeps([9,1,2,10,11]))),te=n(()=>d(()=>import("./DetailPanel-CQnhiXlQ.js"),__vite__mapDeps([12,1,2,13,14,15,16,17,18,19,20]))),se=n(()=>d(()=>import("./SearchBar-COk_sj9I.js"),__vite__mapDeps([21,22,1,2]))),ae=n(()=>d(()=>import("./KanbanBoard-D1wSZfqZ.js"),__vite__mapDeps([23,24,19,1,2,25,10,26]))),oe=n(()=>d(()=>import("./KanbanCard-BwRMWWZ8.js"),__vite__mapDeps([27,28,1,2,25,10,14,6]))),{canCreateVariable:k,canInviteUser:T}=Le(),F=Ke(),le=[{title:"Role",_id:"role"},{title:"Team",_id:"team"},{title:"Status",_id:"status"}],O=r("team"),h=r(!1),_=r(),{workspaceId:m}=Se(),o=r([]),{mutate:ie,isPending:re}=Ue({onSuccess:e=>{o.value=[...o.value||[],e],y.value="",b.value=!1}}),{data:g,isPending:j,isFetching:M,refetch:$}=Fe(m,O);N(g,e=>{$(),o.value=e?JSON.parse(JSON.stringify(e)):[]}),Ve(()=>{$(),o.value=g.value?JSON.parse(JSON.stringify(g.value)):[]}),N(M,e=>{e?o.value=[]:o.value=g.value?JSON.parse(JSON.stringify(g.value)):[]});const ne=r("kanban"),q=r(),z=e=>{F.selectCard(e)},de=e=>{},b=r(!1),y=r("");function W(){b.value=!b.value}function ue(){const e=y.value.trim();if(!e){Be.error("Column name is required.");return}J(e)}const J=e=>{const t={workspace_id:m.value,title:e,max_num_people:1};ie({payload:t})},I=Te(),ce=Oe({onSuccess:()=>{I.invalidateQueries({queryKey:["people-lists"]})}}),pe=e=>{const t={workspace_id:m.value,title:e==null?void 0:e.title,max_num_people:1};ce.mutate({id:e._id,payload:t})},{mutate:me,isPending:ve}=je({onSuccess:e=>{h.value=!1,o.value=o.value.filter(t=>{var l;return t._id!==((l=e.deletedRole)==null?void 0:l._id)})}}),fe=()=>{var e;me({id:(e=_.value)==null?void 0:e.columnId})},_e=e=>{h.value=!0,_.value=e},{mutate:Ce,isPending:xe}=Me({onSuccess:e=>{y.value="",b.value=!1;const t=o.value.findIndex(A=>A._id===_.value._id);if(t===-1)return;const l=o.value[t],v=[...l.cards??[],e==null?void 0:e.assigned_seat],E={...l,cards:v};o.value=[...o.value.slice(0,t),E,...o.value.slice(t+1)],I.invalidateQueries({queryKey:["people-lists"]}),I.invalidateQueries({queryKey:["workspaceRoles"]})}}),K=e=>{_.value=e;const t={name:e!=null&&e.email?he(e==null?void 0:e.email[0]):"",email:e!=null&&e.email?e==null?void 0:e.email[0]:"",role_id:e==null?void 0:e._id,workspace_id:m==null?void 0:m.value,additional_seats:1};Ce({id:e._id,payload:t})};function he(e){const l=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return l.length?l.map(v=>v.charAt(0).toUpperCase()+v.slice(1).toLowerCase()).join(" "):e}const Q=e=>{T.value&&(window.dispatchEvent(new CustomEvent("close-all-showADDNEW")),e.showADDNEW=!e.showADDNEW)},ge=e=>{K(e)},be=e=>{q.value=e,F.selectCard(e)},ye=$e(),we=qe();function ke(e){e.type=="column"?ye.mutate({id:m.value,payload:{role_id:e.meta._id,new_sort_order:e.meta.newIndex}}):we.mutate({id:e.meta.toColumnId,payload:{team_member_id:e.meta.moved._id,new_sort_order:e.meta.newIndex}})}const D=r(""),De=r("");N(D,We.debounce(e=>{De.value=e},200));const Ee=H(()=>{const e=o.value.flatMap(t=>t.cards.map(l=>({...l,columnId:t.title})));return new ze(e,{keys:["title","name"],threshold:.3})}),Y=H(()=>{if(!D.value)return o.value;const e=Ee.value.search(D.value).map(t=>t.item);return o.value.map(t=>({...t,cards:e.filter(l=>l.columnId===t.title)})).filter(t=>t.cards.length>0)});return(e,t)=>{var l,v,E,A;return p(),C(Re,null,[i("div",Qe,[i("div",Ye,[i("div",He,[c(a(ee),{actions:!1,prefix:"View By",modelValue:O.value,"onUpdate:modelValue":t[0]||(t[0]=s=>O.value=s),options:le,variant:"secondary",customClasses:"fixed w-[135px]"},null,8,["modelValue"]),i("div",Ge,[c(a(se),{class:"max-w-[250px]",onOnChange:t[1]||(t[1]=s=>{D.value=s}),placeholder:"Search in Orchit AI space"})])])]),a(j)||a(M)?(p(),G(a(u),{key:0})):Ie((p(),C("div",Ze,[((l=Y.value)==null?void 0:l.length)>0?(p(),G(a(ae),{key:0,plusIcon:!1,onOnPlus:t[3]||(t[3]=s=>K(s)),"onDelete:column":t[4]||(t[4]=s=>_e(s)),"onUpdate:column":t[5]||(t[5]=s=>pe(s)),onReorder:ke,onAddColumn:J,"onSelect:ticket":z,board:Y.value,onOnBoardUpdate:de,variable_id:"",sheet_id:"selected_sheet_id"},{ticket:P(({ticket:s})=>[c(a(oe),{onClick:w=>be(s),ticket:s},null,8,["onClick","ticket"])]),"column-footer":P(({column:s})=>[s.showADDNEW?s.showADDNEW?(p(),C("div",et,[i("p",tt,S(s.title)+" "+S(s.cards.length+1),1),c(a(X),{maxEmails:1,placeholder:"team member email",modelValue:s.email,"onUpdate:modelValue":w=>s.email=w},null,8,["modelValue","onUpdate:modelValue"]),t[14]||(t[14]=i("p",{class:"text-sm text-text-secondary"},"You can assign user later",-1)),c(a(U),{size:"md",onClick:w=>ge(s)},{default:P(()=>[B(S(a(xe)?"Adding...":"Add Seat"),1)]),_:2},1032,["onClick"]),i("i",{class:"fa-solid fa-close cursor-pointer ml-2",onClick:t[2]||(t[2]=w=>Q(""))})])):Z("",!0):(p(),C("div",{key:0,onClick:w=>Q(s),disabled:!a(T),class:R([a(T)?"cursor-pointer":"cursor-not-allowed","flex py-3 px-3 justify-center text-sm text-text-primary items-center gap-3 border border-text-primary border-dashed mb-4 mx-4 rounded-md"])},t[13]||(t[13]=[i("i",{class:"fa-solid fa-plus"},null,-1),B(" Add Seat ")]),10,Xe))]),_:1},8,["board"])):Z("",!0),i("div",{class:"min-w-[270px] sm:min-w-[328px]",onClick:t[8]||(t[8]=L(()=>{},["stop"]))},[b.value?(p(),C("form",{key:0,onSubmit:t[7]||(t[7]=L(()=>{},["prevent"])),class:"bg-bg-body rounded-lg p-4"},[c(a(x),{autofocus:!0,modelValue:y.value,"onUpdate:modelValue":t[6]||(t[6]=s=>y.value=s),placeholder:"Add New list"},null,8,["modelValue"]),t[15]||(t[15]=i("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),i("div",st,[c(a(U),{disabled:!a(k),class:R([a(k)?"cursor-pointer":"cursor-not-allowed","px-3 py-1 bg-accent text-white rounded"]),onClick:ue,type:"submit",variant:"primary"},{default:P(()=>[B(S(a(re)?"Adding...":"Add Team"),1)]),_:1},8,["disabled","class"]),i("i",{class:"fa-solid fa-close cursor-pointer",onClick:W})])],32)):(p(),C("button",{key:1,class:R(["text-sm text-text-primary py-2.5 font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",a(k)?"cursor-pointer":"cursor-not-allowed"]),onClick:L(W,["stop"]),disabled:!a(k)}," + Add Team ",10,at))])],512)),[[Ne,ne.value=="kanban"&&!a(j)]])]),c(a(V),{onClick:t[9]||(t[9]=L(()=>{},["stop"])),modelValue:h.value,"onUpdate:modelValue":t[10]||(t[10]=s=>h.value=s),title:"Delete List",itemLabel:"list",itemName:(v=_.value)==null?void 0:v.title,requireMatchText:(E=_.value)==null?void 0:E.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:a(ve),onConfirm:fe,onCancel:t[11]||(t[11]=()=>{h.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),c(a(te),{onClose:t[12]||(t[12]=()=>{z({})}),showPanel:!!((A=q.value)!=null&&A.title)},null,8,["showPanel"])],64)}}}),dt=Object.freeze(Object.defineProperty({__proto__:null,default:ot},Symbol.toStringTag,{value:"Module"}));export{dt as P,Ke as u};
