const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CreateTaskModal-AgQfl3vR.js","assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-DwwrkqNO.js","assets/index-CtBe4ox5.js","assets/index-ClBG69LY.css","assets/CreateSheetModal-l4F5q2Af.js","assets/IconPicker-BGIhi4Xp.js","assets/IconPicker-CIMr_3tu.css","assets/AudioRecorder.vue_vue_type_script_setup_true_lang-DtB83FmT.js","assets/CreateSheetModal--7RYCgy-.css","assets/CreateVariableModal-FY-1Kcfo.js","assets/ConfirmDeleteModal-BzyRxjBa.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Xm3fBW8y.js","assets/SidePanel-RU5NVvJw.js","assets/SidePanel-U7OOMI6M.css","assets/KanbanBoard-DsviSv4J.js","assets/vuedraggable.umd-DlANSJns.js","assets/_commonjsHelpers-_d1bhYXs.js","assets/DropMenu.vue_vue_type_script_setup_true_lang-CVvgvz4c.js","assets/KanbanBoard-Dffh696C.css"])))=>i.map(i=>d[i]);
import{d as ra,W as ia,r as d,M as sa,N as da,c as V,a2 as ua,n as H,a0 as ca,a6 as va,u as pa,ar as fa,a7 as ba,a8 as ma,a9 as ga,a1 as ya,ac as k,Z as _a,ad as xa,Q as ka,ab as ha,a3 as wa,aa as Ca,ae as Sa,af as Va,j as _,f as n,i as C,e as I,k as y,w as Q,p as u,z as q,F as se,D as $e,E as tt,h as de,ah as at,_ as lt,B as ot,ag as Ce,t as ue,y as nt,P as Da,q as Ta,ai as rt,aj as Aa,o as c,g as Se,ak as Y,A as G,T as it,U as st,bn as La,al as Ea,J as Fa}from"./index-CtBe4ox5.js";import{D as dt}from"./Dropdown-CTtVx8fb.js";import{_ as Na}from"./SearchBar.vue_vue_type_script_setup_true_lang-Xtnw-J5J.js";import{K as Ia}from"./KanbanSkeleton-FzSqoIvp.js";import{K as qa}from"./KanbanTicket-DPWdE3RK.js";import{F as ut}from"./fuse-Ch1WBRTM.js";import{l as Pa}from"./lodash-CQYOKM_D.js";import{_ as ct,a as Ma,b as za,C as Ba,c as $a,T as Ua,k as Ra}from"./TimelineView-Bus0kZ7q.js";import"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Xm3fBW8y.js";import"./DropMenu.vue_vue_type_script_setup_true_lang-CVvgvz4c.js";import"./_commonjsHelpers-_d1bhYXs.js";const Oa={class:"flex-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur rounded-[6px] shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] flex-grow h-full bg-bg-card border border-border overflow-x-auto flex-col flex scrollbar-visible"},Wa={class:"overflow-x-auto shrink-0 sticky top-0 z-20 bg-bg-card"},ja={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1 min-w-max h-full"},Ka={class:"flex gap-3 items-center"},Ha={class:"flex items-center gap-3 bg-bg-surface/50 h-[32px] px-2 rounded-md"},Qa={class:"flex overflow-x-auto gap-3 p-4 scrollbar-visible h-full"},Ya={key:0,class:"mx-auto text-text-secondary/80 m-2 w-[90%] h-full justify-center flex items-center border border-dashed border-border"},Ga={key:0,class:"bg-bg-body rounded-lg p-4"},Ja={class:"flex items-center mt-3 gap-3"},Za=["disabled"],Xa={class:"relative w-full h-full flex overflow-hidden"},el={key:0,class:"format-sidebar h-full py-4 px-4 w-[320px] border-l bg-bg-card overflow-x-hidden overflow-y-auto flex flex-col"},tl={class:"flex items-center justify-between pb-3 mb-4 border-b"},al={class:"format-content space-y-6"},ll={class:"format-group relative mb-3"},ol={class:"text-xs text-secondary"},nl={key:0,class:"absolute z-50 mt-2 p-3 bg-bg-card rounded-lg shadow-lg border w-[240px]"},rl={class:"grid grid-cols-10 gap-1 mb-3"},il=["onClick"],sl={class:"flex items-center gap-2"},dl=["value"],ul=["value"],cl={class:"format-group relative mb-3"},vl={class:"text-xs text-secondary"},pl={key:0,class:"absolute z-50 mt-2 p-3 bg-bg-card rounded-lg shadow-lg border w-[240px]"},fl={class:"grid grid-cols-10 gap-1 mb-3"},bl=["onClick"],ml={class:"flex items-center gap-2"},gl=["value"],yl=["value"],_l={class:"grid grid-cols-1 gap-3"},xl=["value"],kl={class:"mt-6 pt-4"},hl=["disabled"],wl={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},Cl={key:0,class:"fixed inset-0 bg-black/30 flex items-center justify-center"},Sl={class:"bg-white p-6 rounded-xl w-80"},Vl={class:"flex justify-end gap-2 mt-4"},Dl=["disabled"],Tl={class:"flex items-center mt-3 gap-3"},Al=ra({__name:"Product",setup(Ll){const{canEditSheet:vt,canDeleteSheet:pt,canCreateVariable:ce,canCreateSheet:ft,canCreateCard:bt,canEditCard:ve,canAssignCard:mt}=ia(),J=d(!1),pe=d(null),fe=d(!1),be=d(null),Ve=d(!1),p=d("kanban"),De=d(null),me=d(null),Z=d(!1),Ue=Ta(),{workspaceId:h,moduleId:L}=sa(),P=da(),ge=d(!1),X=d(),M=d(null),U=d(!1),ye=d(!1),z=d(""),Te=d(null);function gt(t){z.value="",ye.value=!0,Te.value=t}function yt(){Te.value&&Te.value(z.value),ye.value=!1}function _t(){ye.value=!1}const Ae=d(null),xt=t=>{Ae.value=t},kt=V(()=>{var t;return(t=E.value)==null?void 0:t.find(e=>e._id===x.value)}),R=d(!1),Re=["#FFFFFF","#F2F2F2","#D9D9D9","#BFBFBF","#A6A6A6","#808080","#404040","#000000","#FFE066","#FF9AA2","#8EE4AF","#00EAD3","#90DBF4","#4D96FF","#6C63FF","#C77DFF","#F7A1C4","#FFC300","#FF5733","#2ECC71","#00B894","#17A2B8","#0984E3","#3F51B5","#9C27B0","#E84393","#FF8C00","#E74C3C","#1E8449","#006D6F","#004C6D","#0057A8","#1A237E","#4A148C","#7D3C98"],O=d(!1);H(R,t=>{t&&(O.value=!1)}),H(O,t=>{t&&(R.value=!1)});const Oe=async()=>{if(be.value)try{Ve.value=!0,await it({url:`workspace/card/${be.value}`,method:"DELETE"}),wt(be.value),fe.value=!1,pe.value=null,st.success("Ticket deleted successfully"),await ee(),await ke()}catch(t){st.error(La(t))}finally{Ve.value=!1}},ht=async()=>{await Oe()},wt=t=>{var e,a;(a=(e=m.value)==null?void 0:e.sheets)==null||a.forEach(l=>{var o;(o=l.sheet_lists)==null||o.forEach(v=>{v.cards=v.cards.filter(f=>f._id!==t)})})},Ct=Y(()=>G(()=>import("./CreateTaskModal-AgQfl3vR.js"),__vite__mapDeps([0,1,2,3]))),St=Y(()=>G(()=>import("./CreateSheetModal-l4F5q2Af.js"),__vite__mapDeps([4,2,3,5,6,7,8]))),Vt=Y(()=>G(()=>import("./CreateVariableModal-FY-1Kcfo.js"),__vite__mapDeps([9,2,3]))),Le=Y(()=>G(()=>import("./ConfirmDeleteModal-BzyRxjBa.js"),__vite__mapDeps([10,11,2,3]))),Dt=Y(()=>G(()=>import("./SidePanel-RU5NVvJw.js"),__vite__mapDeps([12,2,3,13]))),Tt=Y(()=>G(()=>import("./KanbanBoard-DsviSv4J.js"),__vite__mapDeps([14,15,16,2,3,17,11,18]))),{data:_e,refetch:ee,isPending:We}=ca({workspace_id:h,workspace_module_id:L}),Ee=V(()=>{var t;return _e.value?(t=_e.value[0])==null?void 0:t._id:""}),w=d(Ee.value),{data:E,isPending:At}=ua(h.value,L.value,w),{mutate:Fe,isPending:Ne}=va({onSuccess:()=>{P.invalidateQueries({queryKey:["sheet-list"]}),W.value="",j.value=!1,ae.value=!1,j.value=!1}}),je=V(()=>{var t;return((t=kt.value)==null?void 0:t.title)==="Process"&&Ae.value?{variable_slug:"card-type",type_value:Ae.value.title}:{}}),Ke=t=>{const e={workspace_id:h.value,module_id:L.value,variable_id:x.value,value:t,...je.value};Fe(e)};H(Ee,()=>{w.value=Ee.value});const Ie=V(()=>{var t;return E!=null&&E.value?(t=E==null?void 0:E.value[0])==null?void 0:t._id:""}),x=d(Ie.value);H(Ie,()=>{x.value=Ie.value});const xe=pa(),{data:m,isPending:qe,refetch:ke}=fa(L,w,V(()=>[...xe.selectedLaneIds]),x,je),N=t=>{t._id||(t._id=t.id),X.value=t};window.selectCardHandler=N;const te=d(!1),Lt=()=>{$.value={},te.value=!te.value},Et=ba(),Ft=ma();function Nt(t){t.type==="column"?Et.mutate({payload:{workspace_id:h.value,workspace_module_id:L.value,variable_id:x.value,moved_value:t.meta.id,new_index:t.meta.newIndex}},{onSuccess:()=>{ee(),ke()}}):Ft.mutate({payload:{workspace_id:h.value,card_id:t.meta.moved._id,group_value:t.meta.fromColumnId,group_variable_id:x.value,new_index:t.meta.newIndex,sheet_id:w.value}},{onSuccess:()=>{ee(),ke()}})}const It=t=>{},qt=V(()=>(_e.value||[]).map(t=>({_id:t._id,title:t==null?void 0:t.variables["sheet-title"],description:t==null?void 0:t.variables["sheet-description"],icon:t.icon,status:t==null?void 0:t.generation_status})));H(_e,t=>{var e;(t==null?void 0:t.length)>0&&(w.value=(e=t[0])==null?void 0:e._id)});const ae=d(!1),W=d("");function Pe(){ae.value=!ae.value}function he(){const t=W.value.trim();t&&Ke(t)}const Pt=t=>{Fe({workspace_id:Ue.params.id,module_id:Ue.params.module_id,new_value:t.title,value:t.oldTitle,variable_id:x.value})},j=d(!1),B=d(),Mt=()=>{Fe({value:B.value.title,workspace_id:h.value,module_id:L.value,newValue:B.value.title,variable_id:x.value,is_trash:!0})},zt=t=>{j.value=!0,B.value=t},Bt=t=>{ge.value=!0,B.value=t},$=d();function $t(t){J.value=!0,$.value=t}const{mutate:He,isPending:Ut}=ga({onSuccess:()=>{ee(),J.value=!1}});function Rt(){var t;He({sheet_id:(t=$.value)==null?void 0:t._id,workspace_module_id:L.value,is_trash:!0})}function Ot(t){te.value=!0,$.value=t}const le=d(""),Wt=d("");H(le,Pa.debounce(t=>{Wt.value=t},200));const jt=V(()=>{const t=m.value.flatMap(e=>e.cards.map(a=>({...a,columnId:e.title})));return new ut(t,{keys:["card-title","card-description"],threshold:.3})}),oe=V(()=>{var t;if(p.value==="kanban"){if(!le.value)return m.value;const e=jt.value.search(le.value).map(a=>a.item);return m.value.map(a=>({...a,cards:e.filter(l=>l.columnId===a.title)}))}else{const e=(t=le.value)==null?void 0:t.trim();if(!e){let l=[];return(m.value??[]).forEach(o=>{l=[...l,...o==null?void 0:o.cards]}),l}return new ut(Qt.value,{keys:["card-title","card-description"],threshold:.3}).search(e).map(l=>l.item)}}),{data:Me}=ya(h),Qe=V(()=>((Me==null?void 0:Me.value)??[]).map(t=>{var e;return{_id:t._id,title:((e=t==null?void 0:t.variables)==null?void 0:e["lane-title"])??String(t._id)}})),Kt=V(()=>{var t;return[{key:"card-title",label:"Title",render:({row:e,value:a})=>k("div",{class:"flex items-center gap-1 w-full"},[k("a",{onClick:()=>X.value=e,class:"text-[12px] underline text-blue-500 shrink-0 overflow-ellipsis cursor-pointer"},e["card-code"]),k("div",{class:"flex-1 min-w-0"},[k("input",{onFocusout:l=>{var o;Ge(e==null?void 0:e._id,"card-title",(o=l==null?void 0:l.target)==null?void 0:o.value)},class:"text-[12px] w-full overflow-ellipsis capitalize p-1 w-full p-1 focus:border border-accent/60 rounded-sm focus:outline-none focus:ring-1 focus:ring-accent bg-transparent focus:bg-bg-body text-[12px] h-8",defaultValue:a,disabled:!ve.value})])])},{key:"end-date",label:"Due Date",render:({row:e,value:a})=>{const l=d(a);return k(_a,{class:" capitalize flex items-center gap-2 text-[12px]",placeholder:"Set start date",tableInputClass:!0,modelValue:l.value,disabled:!ve.value,"onUpdate:modelValue":o=>Jt(e==null?void 0:e._id,o),emptyText:"Date"})}},{key:"lane",label:"Lane",render:({row:e})=>{var a;return k(ct,{options:Qe.value??[],placeholder:"Select lane",modelValue:((a=e.lane)==null?void 0:a._id)||null,disabled:!ve.value,"onUpdate:modelValue":l=>Zt(e==null?void 0:e._id,l),displayField:"title",emptyText:"Lane"})}},{key:"created_by",label:"Owner",render:({value:e})=>k("div",{class:"capitalize flex items-center gap-2  px-3"},[k("div",{class:" rounded-full  "},[e!=null&&e.u_profile_image?k("img",{class:"w-6 h-6 rounded-full",src:e==null?void 0:e.u_profile_image}):k("div",{class:"w-5 h-5 rounded-full flex justify-center items-center text-[11px] ",style:`background:${e!=null&&e.u_full_name?xa({name:e.u_full_name,email:e.u_email}):""}`},ka(e==null?void 0:e.u_full_name))]),k("span",{class:"text-[12px]"},e?e==null?void 0:e.u_full_name:"")])},{key:"seat",label:"Assignee",render:({row:e,value:a})=>k(Ma,{class:"capitalize flex items-center gap-2 ",onAssign:l=>Ht(e==null?void 0:e._id,l),assigneeId:a,seat:a,name:!0,disabled:!mt.value,emptyText:"Assignee"})},...((t=E.value)==null?void 0:t.filter(e=>{var a;return((a=e==null?void 0:e.type)==null?void 0:a.title)==="Select"}).map(e=>({key:e==null?void 0:e.slug,label:e==null?void 0:e.slug,render:({row:a,value:l})=>{var v;let o=l;if(Array.isArray(a==null?void 0:a.variables)){const f=a.variables.find(A=>A.slug===e.slug);f&&(o=f.value)}else o=((v=a==null?void 0:a.variables)==null?void 0:v[e.slug])??(a==null?void 0:a[e.slug])??l;return k("div",{class:"capitalize flex items-center gap-2"},[k(ct,{options:Yt(e.data??[]),modelValue:o,disabled:!ve.value,emptyText:e.slug,"onUpdate:modelValue":f=>{Ge(a==null?void 0:a._id,e.slug,f)},columnName:e.slug})])},visible:e==null?void 0:e.is_visible})))??[]]}),Ht=(t,e)=>{ze(t,a=>{a.seat=e}),ne.mutate({card_id:t,seat_id:e==null?void 0:e._id})},Qt=V(()=>{let t=[];return(m.value??[]).forEach(e=>{t=[...t,...e==null?void 0:e.cards]}),t}),Yt=t=>t.map(e=>({_id:e.value??e,title:e.value??e})),ne=ha({onSuccess:()=>{P.invalidateQueries({queryKey:["get-sheets"]}),P.invalidateQueries({queryKey:["sheet-list"]}),P.invalidateQueries({queryKey:["roles"]})}}),ze=(t,e)=>{if(!m.value)return;const a=m.value.findIndex(l=>l.cards.some(o=>o._id===t));if(a!==-1){const l=m.value[a].cards.findIndex(o=>o._id===t);if(l!==-1){const o={...m.value[a].cards[l]};e(o),m.value[a].cards[l]=o,rt(m)}}},{mutate:Ye}=wa({onSuccess:()=>{P.invalidateQueries({queryKey:["sheet-list"]})}});function Ge(t,e,a){ze(t,l=>{if(e==="card-title"&&(l[e]=a),Array.isArray(l.variables)){const o=l.variables.find(v=>v.slug===e);o?o.value=a:l.variables.push({slug:e,value:a,type:"Select"})}else l.variables&&typeof l.variables=="object"?l.variables[e]=a:l[e]=a}),ne.mutate({card_id:t,variables:{[e]:a.trim()}})}function Gt(t){if(t["card-title"]){const e={sheet_list_id:"To Do",workspace_id:h.value,sheet_id:w.value,variables:{"card-title":t["card-title"].trim()},createdAt:new Date().toISOString()};Ye(e)}}const Jt=(t,e)=>{const a=m.value.findIndex(l=>l.cards.some(o=>o._id===t));if(a!==-1){const l=m.value[a].cards.findIndex(o=>o._id===t);l!==-1&&(m.value[a].cards[l]["end-date"]=e)}ne.mutate({card_id:t,variables:{"start-date":e}})};function Zt(t,e){ze(t,a=>{const l=Qe.value.find(o=>o._id===e);l&&(a.lane=l)}),rt(m),ne.mutate({card_id:t,workspace_lane_id:e})}const{mutate:Xt}=Ca(),ea=(t,e)=>{Xt({payload:{sheet_id:w.value,workspace_id:h.value,variable_slug:t,is_visible:e}})},F=V(()=>{var t,e;return(e=(t=M.value)==null?void 0:t.nodeObj)!=null&&e.style?M.value.nodeObj.style:Be(D)});function T(t,e,a){return t!==void 0?t:e!==void 0?e:a}function re(t,e){var f;if(!((f=M.value)!=null&&f.nodeObj))return;const a=M.value.nodeObj;a.style||(a.style={});const l=e.target,o=l.type==="number"?Number(l.value):l.value;switch(t){case"bg_color":a.style.background=o;break;case"color":a.style.color=o;break;case"font_size":a.style.fontSize=`${o}px`;break;case"font_weight":a.style.fontWeight=o;break;case"font_style":a.style.fontStyle=o;break;case"font_family":a.style.fontFamily=o;break;case"border_color":a.style.borderColor=o;break;case"border_width":a.style.borderWidth=`${o}px`;break;case"border_radius":a.style.borderRadius=`${o}px`;break;case"padding":a.style.padding=`${o}px`;break}const v=document.getElementById(a.id);v&&Xe(a,v)}const D={bg_color:"#ffffff",color:"#000000",font_size:14,font_weight:"normal",font_style:"normal",font_family:"Inter",border_color:"#cccccc",border_width:0,border_radius:0,padding:0},K=d(!1);async function Je(){var e;const t=(e=M.value)==null?void 0:e.nodeObj;if(!(!t||K.value)){K.value=!0;try{const a=Aa(t);a._originalStyle||(a._originalStyle={});const l=a.style||{},o=a._originalStyle,v={bg_color:T(l.background,o.bg_color,D.bg_color),color:T(l.color,o.color,D.color),font_size:T(l.fontSize?parseInt(l.fontSize):void 0,o.font_size,D.font_size),font_weight:T(l.fontWeight,o.font_weight,D.font_weight),font_style:T(l.fontStyle,o.font_style,D.font_style),font_family:T(l.fontFamily,o.font_family,D.font_family),border_color:T(l.borderColor,o.border_color,D.border_color),border_width:T(l.borderWidth?parseInt(l.borderWidth):void 0,o.border_width,D.border_width),border_radius:T(l.borderRadius?parseInt(l.borderRadius):void 0,o.border_radius,D.border_radius),padding:T(l.padding?parseInt(l.padding):void 0,o.padding,D.padding),hyperLink:z.value||a.hyperLink||""};a._originalStyle={...v};const f=a.unique_name==="sheet"?{sheet_id:a.id,workspace_id:h.value,workspace_module_id:L.value,style:v}:{card_id:a.id,seat_id:a.seat_id,style:v};a.unique_name==="sheet"?await He(f):await ne.mutateAsync(f)}finally{K.value=!1}}}const ta=d([]);function aa(t){const e={id:"root",topic:localStorage.getItem("currentName")??"",isRoot:!0,children:[],style:{},_originalStyle:{},unique_name:"root"};if(!Array.isArray(t))return e;const a={};return t.forEach(l=>{var A,s;const o=((A=l.variables)==null?void 0:A["sheet-title"])||"Untitled",v=((s=l.style)==null?void 0:s.hyperLink)||"";a[o]||(a[o]={id:l._id,topic:o,variables:l==null?void 0:l.variables,children:[],style:l==null?void 0:l.style,_originalStyle:(l==null?void 0:l.style)||{},unique_name:"sheet",hyperLink:v||""},e.children.push(a[o]));const f={id:l==null?void 0:l._id,topic:l.title,children:[],style:Be(l==null?void 0:l.style),_originalStyle:l.style||{},unique_name:"List",hyperLink:v||""};(l.cards||[]).forEach((i,S)=>{var g;const r=((g=i.style)==null?void 0:g.hyperLink)||"",b={id:i._id||`card-${S}`,seat_id:i.seat_id,topic:i["card-title"],style:Be(i.style),_originalStyle:i.style||{},children:[],unique_name:"card",hyperLink:r||""};f.children.push(b),ta.value=b}),a[o].children.push(f)}),e}const{mutateAsync:la}=Sa({onSuccess:()=>{P.invalidateQueries({queryKey:["sheets"]}),P.invalidateQueries({queryKey:["sheet-list"]}),close()}}),oa=async t=>{try{await it({url:"workspace/cards/group-card-order",method:"PATCH",data:t}),ee(),ke(),console.log("Card reordered successfully")}catch(e){console.error("Failed to reorder card:",e)}};Va(()=>{p.value!=="mindmap"||!De.value||!m.value||Ea(()=>{var f,A;const t=aa(m.value);me.value&&((A=(f=me.value).destroy)==null||A.call(f),me.value=null);const e=new Set,a=new Set,l=new Set,o=new Ra({el:De.value,theme:void 0,draggable:!0,contextMenu:!0,toolBar:!0,keypress:!0,locale:"en",overflowHidden:!1,contextMenuOption:{Update:!0,extend:[{name:"Update Node",onclick:()=>{var i;U.value&&(U.value=!1);const s=(i=M.value)==null?void 0:i.nodeObj;s&&N(s)}},{name:"Add Hyperlink",onclick:()=>{gt(async()=>{await Je()})}}]}});me.value=o,o.init({nodeData:t}),setTimeout(()=>{o.toCenter()},100),o.bus.addListener("selectNode",s=>{s&&(M.value={nodeObj:s})}),o.bus.addListener("renderNode",s=>{!(s!=null&&s.nodeObj)||!(s!=null&&s.element)||Xe(s.nodeObj,s.element)});const v=s=>{let i=s;for(;i;){if(i.unique_name==="sheet")return i;i=i.parent}return null};o.bus.addListener("operation",async s=>{if(s){if(s.name==="moveNode"||s.name==="moveNodeBefore"||s.name==="moveNodeAfter"){const i=s.obj,S=s.target;if(!i||i.unique_name!=="card"||!S)return;const r=i._originalParent||i.parent;if(!r||r.unique_name!=="List")return;const b=S.unique_name==="List"?S:S.parent;if(!b||b.unique_name!=="List")return;const g=v(b);if(!g)return;const ie=b.children.findIndex(we=>we.id===i.id);if(ie===-1)return;i._originalParent=b,await oa({workspace_id:h.value,card_id:i.id,group_value:b.topic,group_variable_id:x.value,new_index:ie,sheet_id:g.id});return}if(s.name==="removeNode"){const i=s.obj;if(!i||!i.id||i.unique_name!=="card")return;be.value=i.id,await Oe();return}if(s.name==="addChild"||s.name==="insertSibling"){const i=s.obj;if(!i||!i.id)return;e.add(i.id);return}if(s.name==="beginEdit"){const i=s.obj;console.log("editing node",i);return}if(s.name==="finishEdit"){const i=s.obj;if(!i||!i.id)return;const S=e.has(i.id),r=a.has(i.id);if(!S&&!r||r)return;if(S){e.delete(i.id),a.add(i.id);const b=i.parent;if(!b||!("unique_name"in b)){a.delete(i.id);return}if(b.unique_name==="root"&&!l.has(i.id)){l.add(i.id);try{await la({variables:{"sheet-title":i.topic??"New Sheet","sheet-description":"This is custom description"},is_ai_generated:!1,workspace_id:h.value,workspace_module_id:L.value})}catch(g){console.error("Error creating workspace sheet:",g),a.delete(i.id),l.delete(i.id)}return}if(b.unique_name==="List"){try{const g=na({topic:i.topic??"New Card",id:i.id},b);g.variables&&(g.variables["card-description"]="This is a default description"),await Ye(g)}catch(g){console.error("Error creating card:",g),a.delete(i.id)}return}if(b.unique_name==="sheet"){try{console.log("Creating new list under sheet...")}catch(g){console.error("Error creating list:",g),a.delete(i.id)}return}}}}})})});function Ze(){const t=document.querySelector(".mind-elixir-toolbar.rb");if(!t){requestAnimationFrame(Ze);return}if(t.querySelector(".open-sidebar-btn"))return;const e=document.createElement("button");e.className="open-sidebar-btn me-toolbar-btn ms-2",e.title="Open Formatting Sidebar",e.innerHTML='<i class="fa-solid fa-sidebar"></i> ',e.addEventListener("click",()=>{U.value=!U.value}),t.appendChild(e)}Ze();function Xe(t,e){if(!t||!e||!t.style)return;const a=e.querySelector(".topic"),l=e.querySelector(".node")??e,o=t.style;o.background&&(l.style.background=o.background),o.color&&a&&(a.style.color=o.color),a&&(o.fontSize&&(a.style.fontSize=o.fontSize),o.fontFamily&&(a.style.fontFamily=o.fontFamily),o.fontWeight&&(a.style.fontWeight=o.fontWeight),o.fontStyle&&(a.style.fontStyle=o.fontStyle)),o.borderColor&&(l.style.borderColor=o.borderColor),o.borderWidth&&(l.style.borderWidth=o.borderWidth),o.borderRadius&&(l.style.borderRadius=o.borderRadius),o.padding&&(l.style.padding=o.padding)}function Be(t={}){return{background:t.bg_color,color:t.color,fontSize:t.font_size!=null?`${t.font_size}px`:void 0,fontWeight:t.font_weight,fontStyle:t.font_style,fontFamily:t.font_family,borderColor:t.border_color,borderWidth:t.border_width!=null?`${t.border_width}px`:void 0,borderRadius:t.border_radius!=null?`${t.border_radius}px`:void 0,padding:t.padding!=null?`${t.padding}px`:void 0,hyperLink:t.hyperLink||void 0}}function na(t,e){const a=new Date,l=a.toISOString().split("T")[0],o=new Date(a.getTime()+3*24*60*60*1e3).toISOString().split("T")[0];return{sheet_list_id:(e==null?void 0:e.topic)||"In Progress",workspace_id:h.value,sheet_id:w.value,workspace_lane_id:(t==null?void 0:t.workspace_lane_id)||null,variables:{"card-status":(e==null?void 0:e.topic)||"In Progress","card-type":null,priority:null,process:null,"card-title":t.topic||"New Card","card-description":"","start-date":l,"end-date":o},createdAt:new Date().toISOString()}}return(t,e)=>{var a,l,o,v,f,A,s,i,S;return c(),_(se,null,[n("div",Oa,[n("div",Wa,[n("div",ja,[C(dt,{onEditOption:Ot,modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=r=>w.value=r),canEdit:u(vt),canDelete:u(pt),onDeleteOption:$t,options:qt.value,variant:"secondary",customClasses:"fixed w-auto"},{more:Q(()=>[u(ft)?(c(),_("div",{key:0,onClick:e[0]||(e[0]=r=>Lt()),class:"capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},e[38]||(e[38]=[n("i",{class:"fa-solid fa-plus"},null,-1),Se(" Add new ")]))):y("",!0)]),_:1},8,["modelValue","canEdit","canDelete","options"]),n("div",Ka,[(p.value=="kanban",c(),I(dt,{key:0,actions:!1,modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=r=>x.value=r),options:u(E),variant:"secondary",customClasses:"fixed w-auto",onNestedSelect:xt},{more:Q(()=>[u(ce)?(c(),_("div",{key:0,onClick:e[2]||(e[2]=()=>{Z.value=!0}),class:"sticky bottom-0 bg-bg-dropdown shadow-md shadow-border capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},e[39]||(e[39]=[n("i",{class:"fa-solid fa-plus"},null,-1),Se(" Add new ")]))):y("",!0)]),_:1},8,["modelValue","options"])),C(Na,{onOnChange:e[4]||(e[4]=r=>{le.value=r}),placeholder:"Search in Orchit AI space"}),n("div",Ha,[n("button",{class:q(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",p.value==="kanban"?"text-accent bg-accent-text":" hover:bg-border/50 backdrop-blur-2xl  transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"List view",onClick:e[5]||(e[5]=r=>p.value="kanban")},e[40]||(e[40]=[n("i",{class:"fa-solid fa-chart-kanban"},null,-1)]),2),n("button",{onClick:e[6]||(e[6]=r=>p.value="table"),class:q(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",p.value==="table"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gallery view"},e[41]||(e[41]=[n("i",{class:"fa-solid fa-align-left"},null,-1)]),2),n("button",{onClick:e[7]||(e[7]=r=>p.value="mindmap"),class:q(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",p.value==="mindmap"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"MindMap view"},e[42]||(e[42]=[n("i",{class:"fa-solid fa-chart-diagram"},null,-1)]),2),n("button",{onClick:e[8]||(e[8]=r=>p.value="calendar"),class:q(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",p.value==="calendar"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Calendar view"},e[43]||(e[43]=[n("i",{class:"fa-regular fa-calendar"},null,-1)]),2),n("button",{onClick:e[9]||(e[9]=r=>p.value="gantt"),class:q(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",p.value==="gantt"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gantt Chart view"},e[44]||(e[44]=[n("i",{class:"fa-solid fa-chart-gantt"},null,-1)]),2),n("button",{onClick:e[10]||(e[10]=r=>p.value="timeline"),class:q(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",p.value==="timeline"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Timeline view"},e[45]||(e[45]=[n("i",{class:"fa-solid fa-timeline"},null,-1)]),2)])])])]),p.value=="kanban"?(c(),_(se,{key:0},[$e(C(Ia,null,null,512),[[tt,u(qe)||u(We)]]),$e(n("div",Qa,[C(u(Tt),{onOnPlus:Bt,board:oe.value,"onDelete:column":e[11]||(e[11]=r=>zt(r)),"onUpdate:column":e[12]||(e[12]=r=>Pt(r)),onReorder:Nt,onAddColumn:Ke,"onSelect:ticket":N,onOnBoardUpdate:It,variable_id:x.value,sheet_id:w.value},{"column-footer":Q(r=>{var b,g,ie,we,et;return[(g=(b=u(xe))==null?void 0:b.transitions)!=null&&g.all_allowed&&!((et=(we=(ie=u(xe))==null?void 0:ie.transitions)==null?void 0:we.all_allowed)!=null&&et.includes(r.column.title))&&u(xe).transitions.currentColumn!=r.column.title?(c(),_("div",Ya," Disbale ( you can't drop here ) ")):y("",!0)]}),ticket:Q(({ticket:r})=>[C(qa,{selectedVar:x.value,onSelect:()=>{N(r)},ticket:r},null,8,["selectedVar","onSelect","ticket"])]),_:1},8,["board","variable_id","sheet_id"]),n("div",{class:"min-w-[270px] sm:min-w-[328px]",onClick:e[14]||(e[14]=de(()=>{},["stop"]))},[ae.value?(c(),_("div",Ga,[C(lt,{autofocus:!0,modelValue:W.value,"onUpdate:modelValue":e[13]||(e[13]=r=>W.value=r),placeholder:"Add New list",onKeyup:at(he,["enter"])},null,8,["modelValue"]),e[46]||(e[46]=n("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),n("div",Ja,[C(ot,{onClick:he,varaint:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:Q(()=>[Se(ue(u(Ne)?"Adding...":"Add list"),1)]),_:1}),n("i",{class:"fa-solid fa-close",onClick:Pe})])])):(c(),_("button",{key:1,disabled:!u(ce),class:q(["text-sm text-text-primary py-2.5 font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",u(ce)?"cursor-pointer":"cursor-not-allowed"]),onClick:de(Pe,["stop"])}," + Add List ",10,Za))])],512),[[tt,!u(qe)&&!u(We)]])],64)):y("",!0),p.value=="table"?(c(),I(za,{key:1,onToggleVisibility:ea,onAddVar:e[15]||(e[15]=()=>{Z.value=!0}),isPending:u(qe)||u(At),columns:Kt.value,rows:oe.value,canCreate:u(bt),canCreateVariable:u(ce),onCreate:Gt},null,8,["isPending","columns","rows","canCreate","canCreateVariable"])):y("",!0),p.value==="mindmap"?(c(),_(se,{key:2},[n("div",Xa,[n("div",{ref_key:"mindMapRef",ref:De,class:"flex-1 h-full overflow-hidden rounded-md relative"},null,512),U.value?(c(),_("div",el,[n("div",tl,[e[48]||(e[48]=n("h3",{class:"text-sm font-semibold text-secondary"},"Format Node",-1)),n("button",{onClick:e[16]||(e[16]=r=>U.value=!1),class:"text-gray-400 hover:text-gray-700"},e[47]||(e[47]=[n("i",{class:"fa-solid fa-times"},null,-1)]))]),n("div",al,[n("div",null,[e[51]||(e[51]=n("h4",{class:"text-xs font-semibold text-secondary uppercase mb-3"}," Colors ",-1)),n("div",ll,[e[49]||(e[49]=n("label",{class:"block text-xs text-secondary mb-1"},"Background",-1)),n("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[17]||(e[17]=r=>R.value=!R.value)},[n("div",{class:"w-full h-7 rounded border",style:Ce({background:F.value.background})},null,4),n("span",ol,ue(F.value.background),1)]),R.value?(c(),_("div",nl,[n("div",rl,[(c(),_(se,null,nt(Re,r=>n("button",{key:r,class:"w-5 h-5 rounded border",style:Ce({background:r}),onClick:b=>{re("bg_color",{target:{value:r}}),R.value=!1}},null,12,il)),64))]),n("div",sl,[n("input",{type:"color",value:F.value.background,class:"w-8 h-8 cursor-pointer",onInput:e[18]||(e[18]=r=>re("bg_color",r))},null,40,dl),n("input",{type:"text",class:"flex-1 text-xs border rounded px-2 py-1",value:F.value.background,readonly:""},null,8,ul)])])):y("",!0)]),n("div",cl,[e[50]||(e[50]=n("label",{class:"block text-xs text-secondary mb-1"},"Text",-1)),n("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[19]||(e[19]=r=>O.value=!O.value)},[n("div",{class:"w-full h-7 rounded border",style:Ce({background:F.value.color})},null,4),n("span",vl,ue(F.value.color),1)]),O.value?(c(),_("div",pl,[n("div",fl,[(c(),_(se,null,nt(Re,r=>n("button",{key:r,class:"w-5 h-5 rounded border",style:Ce({background:r}),onClick:b=>{re("color",{target:{value:r}}),O.value=!1}},null,12,bl)),64))]),n("div",ml,[n("input",{type:"color",value:F.value.color,class:"w-8 h-8 cursor-pointer",onInput:e[20]||(e[20]=r=>re("color",r))},null,40,gl),n("input",{type:"text",class:"flex-1 text-xs border rounded px-2 py-1",value:F.value.color,readonly:""},null,8,yl)])])):y("",!0)])]),n("div",null,[n("div",_l,[n("div",null,[e[53]||(e[53]=n("label",{class:"block text-xs text-secondary mb-1"},"Weight",-1)),n("select",{class:"w-full h-8 border rounded px-2 text-sm",value:F.value.fontWeight,onChange:e[21]||(e[21]=r=>re("font_weight",r))},e[52]||(e[52]=[n("option",{value:"lighter"},"Light",-1),n("option",{value:"normal"},"Normal",-1),n("option",{value:"bold"},"Bold",-1),n("option",{value:"bolder"},"Extra Bold",-1)]),40,xl)])])])]),n("div",kl,[n("button",{class:"w-full cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm font-medium hover:shadow-md disabled:opacity-60",disabled:K.value,onClick:Je},[K.value?(c(),_("span",wl)):y("",!0),n("span",null,ue(K.value?"Updating...":"Update"),1)],8,hl)])])):y("",!0)]),ye.value?(c(),_("div",Cl,[n("div",Sl,[e[54]||(e[54]=n("h3",{class:"text-lg font-semibold mb-4"},"Insert Web Link",-1)),$e(n("input",{"onUpdate:modelValue":e[22]||(e[22]=r=>z.value=r),type:"text",placeholder:"Enter or paste a URL",class:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[Da,z.value]]),n("div",Vl,[n("button",{onClick:_t,class:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300"}," Cancel "),n("button",{disabled:!z.value,onClick:yt,class:q(["px-4 py-2 rounded-md text-white",z.value?"bg-blue-500 hover:bg-blue-600":"bg-blue-300 cursor-not-allowed"])}," Insert ",10,Dl)])])])):y("",!0),ae.value?(c(),_("div",{key:1,class:"absolute top-40 left-70 bg-bg-body rounded-lg p-4 shadow-lg z-100 min-w-[328px] border",onClick:e[24]||(e[24]=de(()=>{},["stop"]))},[C(lt,{autofocus:!0,modelValue:W.value,"onUpdate:modelValue":e[23]||(e[23]=r=>W.value=r),placeholder:"Add New list",onKeyup:at(he,["enter"])},null,8,["modelValue"]),e[55]||(e[55]=n("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),n("div",Tl,[C(ot,{onClick:he,varaint:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:Q(()=>[Se(ue(u(Ne)?"Adding...":"Add list"),1)]),_:1}),n("i",{class:"fa-solid fa-close cursor-pointer",onClick:Pe})])])):y("",!0)],64)):y("",!0),p.value==="calendar"?(c(),I(Ba,{key:3,data:oe.value,"onSelect:ticket":N},null,8,["data"])):y("",!0),p.value==="gantt"?(c(),I($a,{key:4,data:oe.value,"onSelect:ticket":N},null,8,["data"])):y("",!0),p.value==="timeline"?(c(),I(Ua,{key:5,data:oe.value,"onSelect:ticket":N},null,8,["data"])):y("",!0)]),C(u(Le),{onClick:e[25]||(e[25]=de(()=>{},["stop"])),modelValue:j.value,"onUpdate:modelValue":e[26]||(e[26]=r=>j.value=r),title:"Delete List",itemLabel:"list",itemName:(a=B.value)==null?void 0:a.title,requireMatchText:(l=B.value)==null?void 0:l.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:u(Ne),onConfirm:Mt,onCancel:e[27]||(e[27]=()=>{j.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),ge.value?(c(),I(u(Ct),{selectedVariable:x.value,listId:(o=B.value)==null?void 0:o.title,sheet_id:w.value,key:"createTaskModalKey",modelValue:ge.value,"onUpdate:modelValue":e[28]||(e[28]=r=>ge.value=r),onSubmit:e[29]||(e[29]=()=>{})},null,8,["selectedVariable","listId","sheet_id","modelValue"])):y("",!0),(v=X.value)!=null&&v._id?(c(),I(u(Dt),{key:1,details:X.value,onClose:e[30]||(e[30]=()=>{N({variables:{}})}),showPanel:!!((f=X.value)!=null&&f._id)},null,8,["details","showPanel"])):y("",!0),C(u(St),{size:"md",sheet:$.value,modelValue:te.value,"onUpdate:modelValue":e[31]||(e[31]=r=>te.value=r)},null,8,["sheet","modelValue"]),Z.value?(c(),I(u(Vt),{key:2,modelValue:Z.value,"onUpdate:modelValue":e[32]||(e[32]=r=>Z.value=r),sheetID:w.value},null,8,["modelValue","sheetID"])):y("",!0),C(u(Le),{onClick:e[33]||(e[33]=de(()=>{},["stop"])),modelValue:J.value,"onUpdate:modelValue":e[34]||(e[34]=r=>J.value=r),title:"Delete Sheet",itemLabel:"Sheet",itemName:(A=$.value)==null?void 0:A.title,requireMatchText:(s=$.value)==null?void 0:s.title,confirmText:"Delete Sheet",cancelText:"Cancel",size:"md",loading:u(Ut),onConfirm:Rt,onCancel:e[35]||(e[35]=()=>{J.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),C(u(Le),{modelValue:fe.value,"onUpdate:modelValue":e[36]||(e[36]=r=>fe.value=r),title:"Delete Ticket",itemLabel:"Ticket",itemName:(i=pe.value)==null?void 0:i.title,requireMatchText:(S=pe.value)==null?void 0:S.title,confirmText:"Delete Ticket",cancelText:"Cancel",size:"md",loading:Ve.value,onConfirm:ht,onCancel:e[37]||(e[37]=()=>{fe.value=!1,pe.value=null})},null,8,["modelValue","itemName","requireMatchText","loading"]),e[56]||(e[56]=n("div",null,null,-1))],64)}}}),Rl=Fa(Al,[["__scopeId","data-v-990f7b0b"]]);export{Rl as default};
