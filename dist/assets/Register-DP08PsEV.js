import{d as A,r as i,a as E,u as W,c as g,b as S,q,e as L,w as v,o as k,f as o,h as M,i as c,j as O,k as U,_ as b,g as m,t as V,v as P,B as N,l as j,m as G,n as T,p as D}from"./index-cGCZKwx5.js";import{_ as J,a as Z}from"./AuthLayout.vue_vue_type_script_setup_true_lang-9hOZvzBN.js";import{r as H,s as K}from"./auth-C0R2wEd2.js";import"./favicon-BAFXWHLW.js";import"./dark-logo-Mcb_sJlF.js";const Q={class:"max-w-[500px] md:mx-auto w-full"},X={key:0,class:"text-red-500 text-sm text-center mt-2"},Y={class:"text-sm font-medium text-text-secondary text-center mt-8"},le=A({__name:"Register",setup(ee){const f=D(),d=i(""),n=i(""),p=i(""),l=i(""),r={fName:i(!1),email:i(!1),password:i(!1)},B=E(),y=W(),x=g(()=>r.fName.value?d.value.trim()?d.value.trim().length<2?"Full name must be at least 2 characters":"":"Full name is required":""),w=g(()=>r.email.value?n.value.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.value)?"":"Invalid email format":"Email is required":""),_=g(()=>r.password.value?p.value?/^(?=.*[a-z])(?=.*[A-Z])(?=.*[\W_]).{8,}$/.test(p.value)?"":"Password must be at least 8 characters and include uppercase, lowercase, and a special character":"Password is required":""),$=g(()=>!x.value&&!w.value&&!_.value),{mutate:C,isPending:h}=S({mutationFn:H,onSuccess:()=>{f.push(`/otp-verification/${n.value}`)},onError:a=>{var e,t;l.value=((t=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong"}}),{mutateAsync:F}=S({mutationFn:K});async function I(){var a,e;try{const t=await G(),s=await T.get("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${t.access_token}`}}),u=await F({u_email:s.data.email,u_social_id:s.data.sub,u_social_type:"google",u_full_name:s.data.name});R(u)}catch(t){(t==null?void 0:t.message)!=="Popup closed"&&(l.value=((e=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:e.message)||"Google Login failed. Please try again.")}}async function R(a){var t,s;localStorage.setItem("token",(t=a==null?void 0:a.data)==null?void 0:t.token),await B.bootstrap();const e=localStorage.getItem("post_auth_intent");if(e)try{const u=JSON.parse(e);localStorage.removeItem("post_auth_intent"),u.aiResponse&&y.setWorkspace(u.aiResponse),f.push(u.path||"/dashboard");return}catch(u){console.error("Failed to parse post_auth_intent",u),localStorage.removeItem("post_auth_intent")}if((s=a==null?void 0:a.data)!=null&&s.is_new_user){f.push("/create-profile");return}y.pricing?f.push("/dashboard?stripePayment=true"):f.push("/dashboard")}function z(){if(l.value="",r.fName.value=!0,r.email.value=!0,r.password.value=!0,!$.value){l.value="Please fill all fields correctly.";return}C({u_full_name:d.value,u_email:n.value,u_password:p.value})}return q([d,n,p],()=>{l.value&&(l.value="")}),(a,e)=>{const t=j("router-link");return k(),L(J,null,{form:v(()=>[o("div",Q,[e[12]||(e[12]=o("div",{class:"mb-12 space-y-2 text-center"},[o("h2",{class:"text-[32px] font-medium text-text-primary"},"Welcome to Orchit AI"),o("p",{class:"text-base font-medium text-text-secondary"},"Create your free account")],-1)),o("form",{onSubmit:M(z,["prevent"]),class:"space-y-4 w-full"},[c(b,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),label:"Full Name",placeholder:"Full Name",size:"lg",error:!!x.value,message:x.value,onBlur:e[1]||(e[1]=s=>r.fName.value=!0)},null,8,["modelValue","error","message"]),c(b,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=s=>n.value=s),label:"Email",placeholder:"john@example.com",size:"lg",error:!!w.value,message:w.value,onBlur:e[3]||(e[3]=s=>r.email.value=!0)},null,8,["modelValue","error","message"]),c(b,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=s=>p.value=s),label:"Password",placeholder:"Password",size:"lg",type:"password",error:!!_.value,message:_.value,onBlur:e[5]||(e[5]=s=>r.password.value=!0)},null,8,["modelValue","error","message"]),c(N,{disabled:P(h),size:"lg",block:!0,type:"submit"},{default:v(()=>[m(V(P(h)?"Creating Account...":"Sign up"),1)]),_:1},8,["disabled"]),e[10]||(e[10]=o("div",{class:"flex items-center"},[o("div",{class:"flex-grow border-t border-border"}),o("span",{class:"mx-3 text-[12px] text-primary"},"OR"),o("div",{class:"flex-grow border-t border-border"})],-1)),c(N,{size:"lg",block:!0,appearance:"outlined",variant:"ghost",type:"button",onClick:I},{icon:v(()=>e[6]||(e[6]=[o("img",{src:Z,class:"w-5 h-5 mr-4"},null,-1)])),default:v(()=>[e[7]||(e[7]=m(" Continue with google "))]),_:1,__:[7]}),l.value?(k(),O("p",X,V(l.value),1)):U("",!0),e[11]||(e[11]=o("p",{class:"text-sm font-medium text-text-secondary text-center mt-6"},[m(" By signing up, I agree to the "),o("span",{class:"text-text-primary font-bold"},"Privacy Policy"),m(" and "),o("span",{class:"text-text-primary font-bold"},"Terms of Service"),m(". ")],-1)),o("p",Y,[e[9]||(e[9]=m(" Already have an account? ")),c(t,{to:"/login",class:"text-text-primary font-bold underline"},{default:v(()=>e[8]||(e[8]=[m("Sign in")])),_:1,__:[8]})])],32)])]),_:1})}}});export{le as default};
