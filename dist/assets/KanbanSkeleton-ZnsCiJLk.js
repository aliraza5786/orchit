import{d as X,r as W,c as r,l as Q,h as n,b as t,g as re,x as c,i as k,a as U,ao as J,t as S,T as te,w as oe,H as le,F as A,v as z,o as d,_ as Y,D as y,N as T,m as i,E as b,A as de,U as ne}from"./index-rFytiIBb.js";import{o as ie}from"./index-CnJM0KZb.js";const ue=["src"],ce={key:0,class:"font-bold"},me={class:"text-nowrap"},pe=["onClick"],ve=["src"],fe={class:"flex flex-col gap-1 max-w-40"},he={class:"overflow-hidden font-semibold overflow-ellipsis"},ye={key:0,class:"min-w-40 line-clamp-2 text-wrap text-text-secondary text-xs"},xe=X({__name:"Dropdown",props:{prefix:{},options:{default:()=>[]},modelValue:{default:""},variant:{default:"primary"},icon:{},size:{default:"md"}},emits:["update:modelValue"],setup(e,{emit:a}){const o=e,u=a,p=W(!1),s=r({get:()=>o.modelValue,set:l=>u("update:modelValue",l)}),m=r(()=>o.options.find(l=>l._id===s.value)??null),g=W(null);function h(){p.value=!p.value}function x(l){s.value=l._id,p.value=!1}ie(g,()=>p.value=!1);const v=r(()=>o.size==="sm"),w=r(()=>v.value?"px-2 py-1 text-xs":"px-3 py-1.5 text-sm"),$=r(()=>v.value?"text-xs":"text-sm"),Z=r(()=>v.value?"text-xs":"text-sm"),ee=r(()=>v.value?"px-3 py-1":"px-4 py-2"),I=r(()=>v.value?"w-3.5 h-3.5":"w-4 h-4"),_=r(()=>v.value?"w-3.5 h-3.5":"w-4 h-4"),P=r(()=>v.value?"text-base ":"text-lg "),ae=r(()=>v.value?"w-3.5 h-3.5":"w-4 h-4"),se=r(()=>"dark:border-light-black border-border-gray");function V(l){l!=null&&l.iconName}return Q(()=>o.icon,l=>V(l),{immediate:!0}),Q(()=>o.options,l=>l.forEach(C=>V(C.icon)),{immediate:!0,deep:!0}),(l,C)=>{var B,E,L,N,D,F,q,O,K,j,R;return d(),n("div",{ref_key:"dropdownRef",ref:g,class:"relative inline-block text-left"},[t("button",{onClick:h,type:"button",class:c(["text-nowrap inline-flex justify-between items-center gap-1 border rounded-md font-medium cursor-pointer transition bg-bg-surface",[w.value,l.variant==="secondary"?"!bg-bg-body border-0  ":"border-border"]])},[(B=m.value)!=null&&B.prefix?(d(),n("span",{key:0,class:c(I.value)},[typeof((E=m.value)==null?void 0:E.prefix)=="string"?(d(),n("img",{key:0,src:(L=m.value)==null?void 0:L.prefix,class:c(_.value)},null,10,ue)):(d(),U(J((N=m.value)==null?void 0:N.prefix),{key:1,class:c(_.value)},null,8,["class"]))],2)):k("",!0),t("i",{class:c(`${(F=(D=m.value)==null?void 0:D.icon)==null?void 0:F.prefix} ${(O=(q=m.value)==null?void 0:q.icon)!=null&&O.iconName?(j=(K=m.value)==null?void 0:K.icon)==null?void 0:j.iconName:"file"} ${P.value}`)},null,2),t("span",{class:c($.value)},[l.prefix?(d(),n("span",ce,S(l.prefix)+":",1)):k("",!0),t("span",me,S((R=m.value)==null?void 0:R.title),1)],2),(d(),n("svg",{class:c([ae.value,"text-text-secondary "]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},C[0]||(C[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))],2),re(te,{name:"fade-scale","enter-active-class":"transition duration-200 ease-out","leave-active-class":"transition duration-150 ease-in","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:oe(()=>[p.value?(d(),n("div",{key:0,class:c(["absolute max-h-[500px] overflow-y-auto z-12 mt-1 w-full min-w-fit rounded-md border border-border shadow-lg bg-bg-dropdown",se.value])},[t("ul",{class:c(["py-1 z-[2]",Z.value])},[(d(!0),n(A,null,z(l.options,f=>{var G,H,M;return d(),n("li",{key:f._id,onClick:Ce=>x(f),class:c(["cursor-pointer flex gap-2 overflow-hidden items-center text-nowrap hover:bg-bg-dropdown-menu-hover",ee.value])},[f.prefix?(d(),n("span",{key:0,class:c(I.value)},[typeof f.prefix=="string"?(d(),n("img",{key:0,src:f.prefix,class:c(_.value)},null,10,ve)):(d(),U(J(f.prefix),{key:1,class:c(["text-text-primary ",_.value])},null,8,["class"]))],2)):k("",!0),t("i",{class:c(` ${(G=f.icon)==null?void 0:G.prefix} ${(H=f.icon)!=null&&H.iconName?(M=f.icon)==null?void 0:M.iconName:"file"} ${P.value}`)},null,2),t("div",fe,[t("span",he,S(f.title),1),f.description?(d(),n("p",ye,S(f.description),1)):k("",!0)])],10,pe)}),128)),le(l.$slots,"more",{},void 0,!0)],2)],2)):k("",!0)]),_:3})],512)}}}),$e=Y(xe,[["__scopeId","data-v-180859ba"]]),be={sheets:(e,a)=>["sheets",e,a],sheetList:(e,a,o,u)=>["sheet-list",e,a,o,u]},Ae=(e={})=>y({key:["product-sheet"],url:"/sheets/add",method:"POST"},e),ze=(e={})=>y({key:["move-card"],url:"/workspace/cards/update",method:"PATCH"},e),Ie=(e={})=>y({key:["add-list"],url:"/workspace/catalog/variable/value",method:"POST"},e),Pe=(e={})=>y({key:["add-ticket"],url:"/workspace/cards/add",method:"POST"},e),Ve=(e,a={})=>y({key:["delete-ticket"],url:`workspace/card/${e}`,method:"DELETE"},a),Be=(e,a={})=>{const o=r(()=>i(e.workspace_module_id)),u=r(()=>i(e.workspace_id));return T({queryKey:be.sheets(o.value,u.value),enabled:r(()=>!!o.value),queryFn:({signal:p})=>b({url:"/sheets",method:"GET",params:{workspace_module_id:o.value,workspace_id:u.value},signal:p}).then(s=>s),...a})};function Ee(e,a,o,u,p={}){const s=r(()=>{const h=i(o);return h==null?void 0:Array.isArray(h)?Array.from(new Set(h.map(w=>String(w).trim()).filter(Boolean))).join(",")||void 0:String(h).trim()||void 0}),m=r(()=>["sheet-list",{moduleId:i(e),sheetId:i(a),laneIds:i(s),viewBy:i(u)}]),g=r(()=>!!(i(e)&&i(a)&&i(u)));return T({retry:0,queryKey:m,enabled:g,placeholderData:h=>h,queryFn:async()=>{const h={module_id:i(e),sheet_id:i(a),variable_id:i(u),...i(s)?{lane_ids:i(s)}:{}};return b({url:"/workspace/cards/grouped",method:"GET",params:h})},...p})}const Le=(e,a,o={})=>T({queryKey:["all-module-variables"],queryFn:({signal:u})=>b({url:`/workspace/catalog/${e}/card-variables/${a}`,method:"GET",signal:u}),...o}),Ne=(e,a={})=>T({queryKey:["all-module-lanes"],queryFn:({signal:o})=>b({url:`/workspace/lane-by-workspace/${e}`,method:"GET",signal:o}),...a}),De=(e={})=>y({key:["addVariables"]},{mutationFn:a=>b({url:"workspace/catalog/variable/add",method:"POST",data:a.payload}),...e}),Fe=(e={})=>y({key:["reorder-list"]},{mutationFn:a=>b({url:"workspace/cards/group-order",method:"PATCH",data:a.payload}),...e}),qe=(e={})=>y({key:["reorder-card"]},{mutationFn:a=>b({url:"workspace/cards/group-card-order",method:"PATCH",data:a.payload}),...e}),we={class:"p-4 overflow-x-auto flex-auto flex gap-6","aria-busy":"true","aria-live":"polite"},ke={class:"flex-1 w-full overflow-y-auto space-y-3 px-2 pb-2",role:"presentation"},ge={key:0,class:"min-w-[328px]",role:"presentation"},_e=X({__name:"KanbanSkeleton",props:{columns:{default:3},cardsPerColumn:{default:3},showAddList:{type:Boolean,default:!0}},setup(e){const a=e,o=r(()=>Array.from({length:a.columns},(p,s)=>s)),u=r(()=>Array.from({length:a.cardsPerColumn},(p,s)=>s));return(p,s)=>(d(),n("div",we,[(d(!0),n(A,null,z(o.value,(m,g,h,x)=>{const v=[a.cardsPerColumn];if(x&&x.key===m&&de(x,v))return x;const w=(d(),n("div",{key:m,class:"kanban-col max-w-[328px] min-w-[328px] min-h-[555px] h-full bg-bg-body rounded-lg p-2 flex flex-col",role:"presentation"},[s[4]||(s[4]=t("div",{class:"flex justify-between items-center py-3 px-4 sticky top-0 bg-bg-body rounded-xl mb-2 z-10",role:"presentation"},[t("div",{class:"flex items-center gap-2"},[t("div",{class:"h-4 w-24 rounded shimmer","aria-hidden":"true"}),t("div",{class:"h-4 w-4 rounded-full shimmer","aria-hidden":"true"})]),t("div",{class:"flex items-center gap-2"},[t("div",{class:"h-4 w-4 rounded shimmer","aria-hidden":"true"}),t("div",{class:"h-4 w-4 rounded shimmer","aria-hidden":"true"})])],-1)),t("div",ke,[(d(!0),n(A,null,z(u.value,$=>(d(),n("div",{key:$,class:"bg-bg-card rounded-xl border border-border p-3 space-y-3 shadow-sm",role:"presentation"},s[2]||(s[2]=[ne('<div class="flex gap-2" data-v-5a4807f3><div class="h-5 w-14 rounded-full shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="h-5 w-10 rounded-full shimmer" aria-hidden="true" data-v-5a4807f3></div></div><div data-v-5a4807f3><div class="h-4 w-3/4 rounded shimmer mb-2" aria-hidden="true" data-v-5a4807f3></div><div class="h-3 w-full rounded shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="h-3 w-5/6 rounded shimmer mt-1" aria-hidden="true" data-v-5a4807f3></div></div><div class="flex justify-between items-center" data-v-5a4807f3><div class="h-4 w-20 rounded shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="flex -space-x-2" data-v-5a4807f3><div class="w-6 h-6 rounded-full border-2 border-border shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="w-6 h-6 rounded-full border-2 border-border shimmer" aria-hidden="true" data-v-5a4807f3></div></div></div>',3)])))),128)),s[3]||(s[3]=t("div",{class:"h-9 rounded shimmer mt-3","aria-hidden":"true"},null,-1))])]));return w.memo=v,w},s,0),128)),a.showAddList?(d(),n("div",ge,s[5]||(s[5]=[t("div",{class:"bg-bg-body rounded-lg p-4"},[t("div",{class:"h-9 rounded shimmer","aria-hidden":"true"})],-1)]))):k("",!0)]))}}),Oe=Y(_e,[["__scopeId","data-v-5a4807f3"]]);export{$e as D,Oe as K,Fe as R,Ve as a,Le as b,Ie as c,Be as d,Ee as e,qe as f,Pe as g,Ne as h,Ae as i,De as j,ze as u};
