const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KanbanBoard-B-pr1OTn.js","assets/index-D4qWByIA.js","assets/index-vEdgDW5R.css","assets/DropMenu.vue_vue_type_script_setup_true_lang-BvDzvxcB.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-CuqfRti3.js","assets/workspace-DrJ4ddAf.js","assets/KanbanBoard-DlFwUlEB.css","assets/KanbanCard-B5bS2LWf.js","assets/usePeople-lu9105Qy.js"])))=>i.map(i=>d[i]);
import{d as ve,M as ye,r as p,m as X,c as ge,a as fe,aa as be,i as n,y as _e,e as l,h as v,j as _,ac as ke,n as g,b0 as Ce,f as E,t as f,P as we,aD as he,A as ie,V as De,a9 as re,g as P,F as ee,x as oe,b as xe,G as Ve,af as Ae,o as i,H as Se,W as Pe,q as Le,b1 as Te,k as $e,C as ue,w as Z,B as ce,a5 as me,_ as Ue,a6 as pe}from"./index-D4qWByIA.js";import{D as Ne,K as Ie}from"./KanbanSkeleton-zC4-X-St.js";import{b as Oe,c as Ee,d as Ke,e as qe,f as Be,g as je,R as Re,h as ze}from"./usePeople-lu9105Qy.js";import{_ as Me}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-CuqfRti3.js";import{_ as Qe}from"./BaseEmailChip.vue_vue_type_script_setup_true_lang-Bx0L2iBQ.js";import{_ as We}from"./ProgressBar.vue_vue_type_script_setup_true_lang-fp5Ir_9C.js";const Je={class:"py-4 flex justify-between items-center border-b border-border px-5 sticky top-0 bg-bg-card z-1"},Fe={class:"py-4 px-5"},He={class:"bg-bg-surface/50 p-2 rounded-lg flex gap-2 items-center"},Ye=["src"],Ge={key:0,class:"fa-solid fa-user text-white"},Ze={class:"text-base font-medium text-text-primary cursor-pointer"},Xe={class:"text-sm font-medium text-text-secondary cursor-pointer"},et={class:"flex flex-col mt-2"},tt={class:"text-sm text-text-secondary mt-2"},at={key:0},st={class:"mb-2 capitalize"},lt=["onKeydown"],ot={key:1,class:"mt-3"},it={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},dt={class:"text-sm text-text-primary"},nt={key:2,class:"mt-3"},rt={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},ut={class:"text-sm text-text-primary"},ct=ve({__name:"DetailPanel",props:{showPanel:{type:Boolean,default:!0},details:{type:Object,default:()=>({})}},emits:["close","update:details","comment:post","priority:change"],setup(u,{emit:de}){const te=ye({}),k=p("details"),$=[{label:"Details",value:"details"},{label:"Tasks",value:"tasks"},{label:"History",value:"history"}],{data:C}=Oe(),{mutate:b}=Ee({onSuccess:()=>{y.invalidateQueries({queryKey:["people-lists"]})}}),a=u,r=p(!1),x=p(a.details["card-title"]??""),ae=p(a.details.workspace_lane_id??"");X(()=>a.details["card-title"],c=>{x.value=c,ae.value=a.details.workspace_lane_id});const U=p(a.details["card-description"]);X(()=>a.details,()=>{U.value=a.details["card-description"]});const L=p(null);function se(){r.value=!0,Ae(()=>{var c,s;(c=L.value)==null||c.focus(),(s=L.value)==null||s.select()})}function w(){x.value.trim()||(x.value=a.details["card-title"]??""),B.mutate({card_id:a.details._id,variables:{"card-title":x.value.trim()}}),r.value=!1}function K(){x.value=a.details["card-title"]??"",r.value=!1}const q=p({startDate:a.details["start-date"],endDate:a.details["end-date"]}),h=ge(()=>a.details["start-date"]);X(h,c=>{q.value={...q.value,startDate:c}});const y=fe(),B=be({onSuccess:()=>{y.invalidateQueries({queryKey:["get-sheets"]}),y.invalidateQueries({queryKey:["sheet-list"]}),y.invalidateQueries({queryKey:["roles"]})}}),le=(c,s)=>{console.log(s,"slug",c),b({id:a.details._id,payload:{variable_values:[{module_variable_id:s,value:c}]}})};function j(c){var D,V,A;const s=(D=a==null?void 0:a.details)==null?void 0:D.variable_values.filter(T=>T.module_variable_id==c);return console.log((V=s[0])==null?void 0:V.value,">>>"),(A=s[0])==null?void 0:A.value}return(c,s)=>{var D,V,A,T,R,z,M,N,Q,I,W,J,F,H;return i(),n("div",{class:_e(`max-w-[358px] bg-bg-card  rounded-lg overflow-y-auto overflow-x-hidden relative ${u.showPanel?"!translate-x-0 w-full h-full min-w-[350px] overflow-y-auto":"!translate-x-100 w-0 h-0"} transition-all`)},[l("div",Je,[s[4]||(s[4]=l("h5",{class:"text-[16px] font-medium"},"Profile",-1)),l("i",{class:"cursor-pointer text-text-primary fa-solid fa-close",onClick:s[0]||(s[0]=()=>{c.$emit("close")})})]),l("div",Fe,[l("div",He,[(D=u.details)!=null&&D.avatar?(i(),n("img",{key:0,src:(V=u.details)==null?void 0:V.avatar,class:"w-10 h-10 rounded-full",alt:"avartar"},null,8,Ye)):(i(),n("div",{key:1,class:"min-w-10 max-h-10 aspect-square bg-bg-surface flex justify-center items-center rounded-full",style:ke({backgroundColor:(A=u.details)!=null&&A.name?g(Ce)({email:(T=u.details)==null?void 0:T.email}):""})},[E(f(g(we)((R=u.details)==null?void 0:R.name))+" ",1),(z=u.details)!=null&&z.name?_("",!0):(i(),n("i",Ge))],4)),l("div",null,[l("h1",Ze,f(u.details.name??u.details.title),1),l("p",Xe,f(u.details.email),1)])]),v(he,{modelValue:k.value,"onUpdate:modelValue":s[1]||(s[1]=o=>k.value=o),class:"my-2",options:$},null,8,["modelValue"]),l("div",et,[s[5]||(s[5]=l("h1",{class:"text-base font-medium text-text-primary cursor-pointer"}," Task Progress ",-1)),v(We,{class:"mt-2",progress:(M=a==null?void 0:a.details)==null?void 0:M.assigned_cards_count,fillColor:"bg-accent ",indeterminate:!0},null,8,["progress"]),l("span",tt,"Completed 10 tasks out of "+f((N=a==null?void 0:a.details)==null?void 0:N.assigned_cards_count),1)]),k.value=="details"?(i(),n("section",at,[l("div",st,[r.value?ie((i(),n("input",{key:0,ref_key:"titleInput",ref:L,"onUpdate:modelValue":s[2]||(s[2]=o=>x.value=o),onBlur:w,onKeydown:[re(P(w,["prevent"]),["enter"]),re(P(K,["prevent"]),["esc"])],class:"border border-border rounded px-2 py-1 w-full text-xl font-medium",type:"text"},null,40,lt)),[[De,x.value]]):(i(),n("h1",{key:1,class:"text-xl font-medium text-text-primary cursor-pointer",onClick:se},f(x.value),1))]),l("div",null,[(i(!0),n(ee,null,oe(g(C),(o,e)=>{var t;return i(),n("div",{key:e,class:"grid grid-cols-2 capitalize items-center gap-2 text-sm mt-4"},[E(f(o.title)+" ",1),(i(),xe(Ve,{size:"sm","model-value":te[o.slug],key:e,placeholder:` ${o.title}`,onClick:s[3]||(s[3]=P(()=>{},["stop"])),defaultValue:j(o==null?void 0:o._id),options:o==null?void 0:o.data.map(m=>({_id:m,title:m})),cardId:(t=u.details)==null?void 0:t._id,"onUpdate:modelValue":m=>le(m,o._id)},null,8,["model-value","placeholder","defaultValue","options","cardId","onUpdate:modelValue"]))])}),128))])])):_("",!0),k.value=="tasks"?(i(),n("section",ot,[s[7]||(s[7]=l("span",{class:"text-base text-text-primary"},"Worked On",-1)),((I=(Q=u.details)==null?void 0:Q.assigned_cards)==null?void 0:I.length)>0?(i(),n("ul",it,[(i(!0),n(ee,null,oe((W=u.details)==null?void 0:W.assigned_cards,(o,e)=>(i(),n("li",{class:"p-2",key:e},[l("h1",dt,f(o==null?void 0:o.title),1),s[6]||(s[6]=l("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):_("",!0)])):_("",!0),k.value=="history"?(i(),n("section",nt,[s[9]||(s[9]=l("span",{class:"text-base text-text-primary"},"history",-1)),((F=(J=u.details)==null?void 0:J.assignment_history)==null?void 0:F.length)>0?(i(),n("ul",rt,[(i(!0),n(ee,null,oe((H=u.details)==null?void 0:H.assignment_history,(o,e)=>(i(),n("li",{class:"p-2",key:e},[l("h1",ut,f(o==null?void 0:o.title),1),s[8]||(s[8]=l("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):_("",!0)])):_("",!0)])],2)}}}),mt=Se(ct,[["__scopeId","data-v-9b1e0603"]]),pt={class:"flex-auto flex-grow h-full bg-bg-card rounded-lg border border-border overflow-x-auto flex-col flex"},vt={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},ft={class:"flex gap-3 items-center"},xt={class:"flex p-4 overflow-x-auto gap-3 custom_scroll_bar"},yt=["onClick"],gt={key:1,class:"p-4 space-y-2 bg-bg-surface m-4 rounded-md"},bt={class:"text-sm text-text-primary"},_t={class:"flex items-center mt-3 gap-3"},At=ve({__name:"People",setup(u){const de=me(()=>pe(()=>import("./KanbanBoard-B-pr1OTn.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),te=me(()=>pe(()=>import("./KanbanCard-B5bS2LWf.js"),__vite__mapDeps([7,1,2,3,4,8]))),k=[{title:"Role",_id:"role"},{title:"Team",_id:"team"},{title:"Status",_id:"status"}],$=p("role"),C=p(!1),b=p(),{workspaceId:a}=Pe(),r=p([]),{mutate:x,isPending:ae}=Ke({onSuccess:e=>{r.value=[...r.value||[],e],y.value="",h.value=!1}}),{data:U,isPending:L}=qe(a.value,$);X(U,e=>{r.value=e?JSON.parse(JSON.stringify(e)):[]}),Le(()=>{r.value=U.value?JSON.parse(JSON.stringify(U.value)):[]});const se=p("kanban"),w=p(),K=e=>{w.value=e},q=e=>{},h=p(!1),y=p("");function B(){h.value=!h.value}function le(){console.log(">>> clicking on adding pepople ");const e=y.value.trim();j(e)}const j=e=>{console.log(">>> clicking on adding pepople ");const t={workspace_id:a.value,title:e,max_num_people:1};x({payload:t})},c=fe(),s=Te({onSuccess:()=>{c.invalidateQueries({queryKey:["people-lists"]})}}),D=e=>{const t={workspace_id:a.value,title:e==null?void 0:e.title,max_num_people:1};s.mutate({id:e._id,payload:t})},{mutate:V,isPending:A}=Be({onSuccess:e=>{C.value=!1,r.value=r.value.filter(t=>{var m;return t._id!==((m=e.deletedRole)==null?void 0:m._id)})}}),T=()=>{var e;V({id:(e=b.value)==null?void 0:e.columnId})},R=e=>{C.value=!0,b.value=e},{mutate:z,isPending:M}=je({onSuccess:e=>{y.value="",h.value=!1,console.log(b.value,">>>. id local column");const t=r.value.findIndex(G=>G._id===b.value._id);if(t===-1)return;console.log(t,"index>>>");const m=r.value[t],S=[...m.cards??[],e==null?void 0:e.assigned_seat],Y={...m,cards:S};r.value=[...r.value.slice(0,t),Y,...r.value.slice(t+1)],c.invalidateQueries({queryKey:["people-lists"]}),c.invalidateQueries({queryKey:["workspaceRoles"]})}}),N=e=>{b.value=e;const t={name:e!=null&&e.email?Q(e==null?void 0:e.email[0]):"",email:e!=null&&e.email?e==null?void 0:e.email[0]:"",role_id:e==null?void 0:e._id,workspace_id:a==null?void 0:a.value,additional_seats:1};z({id:e._id,payload:t})};function Q(e){const m=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return m.length?m.map(S=>S.charAt(0).toUpperCase()+S.slice(1).toLowerCase()).join(" "):e}const I=e=>{window.dispatchEvent(new CustomEvent("close-all-showADDNEW")),e.showADDNEW=!e.showADDNEW},W=e=>{N(e)},J=e=>{w.value=e},F=Re(),H=ze();function o(e){console.log(e,">>"),e.type=="column"?F.mutate({id:a.value,payload:{role_id:e.meta._id,new_sort_order:e.meta.newIndex}}):H.mutate({id:e.meta.toColumnId,payload:{team_member_id:e.meta.moved._id,new_sort_order:e.meta.newIndex}})}return(e,t)=>{var S,Y,G,ne;const m=$e("Searchbar");return i(),n(ee,null,[l("div",pt,[l("div",vt,[v(Ne,{actions:!1,prefix:"View By",modelValue:$.value,"onUpdate:modelValue":t[0]||(t[0]=d=>$.value=d),options:k,variant:"secondary"},null,8,["modelValue"]),l("div",ft,[v(m,{placeholder:"Search in Orchit AI space"})])]),ie(v(Ie,null,null,512),[[ue,g(L)]]),ie(l("div",xt,[((S=r.value)==null?void 0:S.length)>0?(i(),xe(g(de),{key:0,plusIcon:!1,onOnPlus:t[2]||(t[2]=d=>N(d)),"onDelete:column":t[3]||(t[3]=d=>R(d)),"onUpdate:column":t[4]||(t[4]=d=>D(d)),onReorder:o,onAddColumn:j,"onSelect:ticket":K,board:r.value,onOnBoardUpdate:q,variable_id:"",sheet_id:"selected_sheet_id"},{ticket:Z(({ticket:d})=>[v(g(te),{onClick:O=>J(d),ticket:d},null,8,["onClick","ticket"])]),"column-footer":Z(({column:d})=>[d.showADDNEW?d.showADDNEW?(i(),n("div",gt,[l("p",bt,f(d.title)+" "+f(d.cards.length+1),1),v(Qe,{maxEmails:1,placeholder:"team member email",modelValue:d.email,"onUpdate:modelValue":O=>d.email=O},null,8,["modelValue","onUpdate:modelValue"]),t[13]||(t[13]=l("p",{class:"text-sm text-text-secondary"},"You can assign user later",-1)),v(ce,{size:"md",onClick:O=>W(d)},{default:Z(()=>[E(f(g(M)?"Adding...":"Add Seat"),1)]),_:2},1032,["onClick"]),l("i",{class:"fa-solid fa-close cursor-pointer ml-2",onClick:t[1]||(t[1]=O=>I(""))})])):_("",!0):(i(),n("div",{key:0,onClick:O=>I(d),class:"flex py-3 px-3 justify-center text-sm text-text-primary items-center gap-3 border border-text-primary cursor-pointer border-dashed mb-4 mx-4 rounded-md"},t[12]||(t[12]=[l("i",{class:"fa-solid fa-plus"},null,-1),E(" Add Seat ")]),8,yt))]),_:1},8,["board"])):_("",!0),l("div",{class:"min-w-[328px]",onClick:t[7]||(t[7]=P(()=>{},["stop"]))},[h.value?(i(),n("form",{key:0,onSubmit:t[6]||(t[6]=P(()=>{},["prevent"])),class:"bg-bg-body rounded-lg p-4"},[v(Ue,{autofocus:!0,modelValue:y.value,"onUpdate:modelValue":t[5]||(t[5]=d=>y.value=d),placeholder:"Add New list"},null,8,["modelValue"]),t[14]||(t[14]=l("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),l("div",_t,[v(ce,{onClick:le,type:"submit",variant:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:Z(()=>[E(f(g(ae)?"Adding...":"Add Team"),1)]),_:1}),l("i",{class:"fa-solid fa-close cursor-pointer",onClick:B})])],32)):(i(),n("button",{key:1,class:"text-sm text-text-primary py-2.5 cursor-pointer font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",onClick:P(B,["stop"])}," + Add Team "))])],512),[[ue,se.value=="kanban"&&!g(L)]])]),v(Me,{onClick:t[8]||(t[8]=P(()=>{},["stop"])),modelValue:C.value,"onUpdate:modelValue":t[9]||(t[9]=d=>C.value=d),title:"Delete List",itemLabel:"list",itemName:(Y=b.value)==null?void 0:Y.title,requireMatchText:(G=b.value)==null?void 0:G.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:g(A),onConfirm:T,onCancel:t[10]||(t[10]=()=>{C.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),v(mt,{details:w.value,onClose:t[11]||(t[11]=()=>{K({variables:{}})}),showPanel:!!((ne=w.value)!=null&&ne.title)},null,8,["details","showPanel"])],64)}}});export{At as default};
