import{d as G,c as W,r as k,q as ee,b as te,w as C,e as t,i as d,j as D,A as se,V as ae,a9 as ie,g as S,F as J,x as le,y as oe,ac as N,n as u,b1 as R,t as c,P as X,f as V,h as y,B as Z,S as ne,o as r,O as re,bj as de,a as ue,k as ce}from"./index-DhgU3ice.js";import{_ as me}from"./DropMenu.vue_vue_type_script_setup_true_lang-YV2LJPqC.js";import{h as pe,i as fe,j as ge,k as ve}from"./usePeople-Cm45VL6m.js";import{_ as be}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-CMPGAA_V.js";const ye={class:"px-6 pb-2"},ke={class:"relative mb-4"},we=["onKeydown"],xe={key:0,class:"mt-3"},he={class:"divide-y divide-border rounded-xl border border-border bg-bg-card"},_e=["onClick"],Ce={class:"flex items-center gap-3 min-w-0"},Se=["src"],Ve={class:"min-w-0"},Ae={class:"truncate font-medium leading-tight capitalize"},$e={class:"truncate text-xs text-text-secondary leading-tight"},je={key:1,class:"mt-3 flex items-center gap-2"},Te={class:"inline-flex items-center gap-2 rounded-full px-3 py-2 bg-bg-muted text-text-secondary"},qe={class:"flex items-center justify-between gap-3 p-6 mt-3 pb-2 border-t border-border bg-bg-body"},Me={class:"flex gap-2 justify-between w-full"},De=G({__name:"AssignmentModal",props:{modelValue:{type:Boolean,default:!1},members:{default:()=>[]},directory:{default:()=>[]},placeholder:{default:"Search people by name or email"},isSubmitting:{}},emits:["update:modelValue","submit","copy-link"],setup(A,{emit:m}){const p=A,x=m,f=W({get:()=>p.modelValue,set:i=>x("update:modelValue",i)}),o=k(""),n=k(""),g=k(""),v=W(()=>{const i=o.value.trim().toLowerCase();return p.directory.filter(l=>{var e;return((e=l.name)==null?void 0:e.toLowerCase().includes(i))||l.email.toLowerCase().includes(i)})}),$=i=>{n.value=i.email,o.value=""},h=()=>{n.value=""},j=()=>{o.value&&(n.value=o.value.trim(),o.value="")},T=i=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i),q=()=>{if(!n.value||!T(n.value)){g.value="Please select a valid email.";return}x("submit",{invite:{email:n.value}})},M=()=>{h(),o.value="",f.value=!1};return ee(()=>{f.value&&(o.value="")}),(i,l)=>(r(),te(ne,{modelValue:f.value,"onUpdate:modelValue":l[1]||(l[1]=e=>f.value=e),size:"md"},{default:C(()=>[l[3]||(l[3]=t("div",{class:"sticky top-0 z-10 flex items-start gap-2 px-6 pb-4 mb-4 border-b border-border bg-bg-body"},[t("h2",{class:"text-xl font-semibold"},"Add team member")],-1)),t("div",ye,[t("div",ke,[se(t("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>o.value=e),type:"text",placeholder:"Search or add email",class:"w-full h-11 rounded-xl border border-border bg-bg-input px-3 text-sm outline-none focus:ring-2 focus:ring-primary/40",onKeydown:ie(S(j,["prevent"]),["enter"])},null,40,we),[[ae,o.value]])]),v.value.length?(r(),d("div",xe,[t("ul",he,[(r(!0),d(J,null,le(v.value,e=>(r(),d("li",{key:e.id||e.email,class:oe(["flex items-center justify-between gap-3 px-3 py-3 cursor-pointer hover:bg-bg-muted",{"bg-bg-muted":n.value===e.email}]),onClick:B=>$(e)},[t("div",Ce,[e!=null&&e.profile_image?(r(),d("img",{key:0,class:"h-9 w-9 rounded-full aspect-square",src:e==null?void 0:e.profile_image,alt:"avatar"},null,8,Se)):(r(),d("div",{key:1,class:"h-9 w-9 bg-white capitalize rounded-full flex items-center justify-center text-xs font-semibold",style:N({backgroundColor:u(R)({email:e.email})})},c(u(X)(e.name||e.email)),5)),t("div",Ve,[t("div",Ae,c(e.name||e.email),1),t("div",$e,c(e.email),1)])])],10,_e))),128))])])):D("",!0),n.value?(r(),d("div",je,[t("span",Te,[V(c(n.value)+" ",1),t("button",{onClick:h,class:"ml-2 text-sm text-red-500"},"✕")])])):D("",!0)]),t("div",qe,[t("div",Me,[y(Z,{variant:"secondary",onClick:M},{default:C(()=>l[2]||(l[2]=[V("Cancel")])),_:1,__:[2]}),y(Z,{variant:"primary",disabled:!!(!n.value||i.isSubmitting),onClick:q},{default:C(()=>[V(c(i.isSubmitting?"Assigning…":"Assign"),1)]),_:1},8,["disabled"])])])]),_:1,__:[3]},8,["modelValue"]))}}),Ne={class:"flex justify-between gap-2 items-start w-full"},Be={class:"flex items-center gap-2 w-[90%]"},Ie=["src"],Ue={key:0,class:"fa-solid fa-user text-white"},ze={class:"max-w-[70%]"},Ke={class:"text-sm font-medium mb-1 text-card-foreground leading-tight w-full"},Pe={class:"text-text-secondary text-xs overflow-hidden overflow-ellipsis"},Ee={class:"group-hover:flex justify-center items-center hidden w-6 h-6 bg-bg-surface/40 rounded-md"},Oe=G({__name:"KanbanCard",props:{ticket:{}},setup(A){const m=k(!1),p=A,{workspaceId:x}=re(),{data:f}=de(),{data:o}=pe(x.value,f),n=k([]),g=k(!1),v=ue();function $(){return[{label:"Assign User",danger:!0,action:()=>{m.value=!0},icon:{prefix:"fa-regular",iconName:"fa-user-plus"}},...p.ticket.name?[{label:"UnAssign User",danger:!0,action:()=>{Y()},icon:{prefix:"fa-regular",iconName:"fa-user-minus"}}]:[],{label:"Delete Seat",danger:!0,action:()=>{g.value=!0},icon:{prefix:"fa-regular",iconName:"fa-trash"}}]}const h=()=>{},{mutate:j,isPending:T}=fe({onSuccess:()=>{v.invalidateQueries({queryKey:["people-lists"]})}}),q=()=>{j({id:p.ticket._id})},{mutate:M,isPending:i}=ge({onSuccess:()=>{m.value=!1,v.invalidateQueries({queryKey:["people-lists"]})}});function l(s){const _=(s.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return _.length?_.map(w=>w.charAt(0).toUpperCase()+w.slice(1).toLowerCase()).join(" "):s}const{mutate:e}=ve({onSuccess:()=>{m.value=!1,v.invalidateQueries({queryKey:["people-lists"]})}});function B(s){M({id:p.ticket._id,payload:{name:l(s.email),email:s.email}})}function Y(){e({id:p.ticket._id})}return(s,a)=>{var w,I,U,z,K,P,E,L,F,Q,H,O;const _=ce("AssigmentDropdown");return r(),d(J,null,[t("div",{onClick:a[2]||(a[2]=b=>s.$emit("click")),class:"group bg-bg-card rounded-lg p-4 shadow-sm cursor-grab hover:shadow-md transition-all duration-200 active:cursor-grabbing",style:N({borderColor:(I=(w=s.ticket)==null?void 0:w.lane)==null?void 0:I.variables["lane-color"]})},[t("div",Ne,[t("div",Be,[(U=s.ticket)!=null&&U.avatar?(r(),d("img",{key:0,src:(z=s.ticket)==null?void 0:z.avatar,class:"min-w-10 w-10 h-10 rounded-full object-cover",alt:"avartar"},null,8,Ie)):(r(),d("div",{key:1,class:"w-10 min-w-10 overflow-hidden overflow-ellipsis aspect-square bg-bg-surface flex justify-center items-center rounded-full",style:N({backgroundColor:(K=s.ticket)!=null&&K.name?u(R)({email:(P=s.ticket)==null?void 0:P.email}):""})},[V(c(u(X)((E=s.ticket)==null?void 0:E.name))+" ",1),(L=s.ticket)!=null&&L.name?D("",!0):(r(),d("i",Ue))],4)),t("div",ze,[t("h3",Ke,c(((F=s.ticket)==null?void 0:F.name)??s.ticket.title??"Team Member "),1),t("p",Pe,c((Q=s.ticket)==null?void 0:Q.email),1)])]),t("div",Ee,[y(me,{onClick:a[0]||(a[0]=S(()=>{},["stop"])),items:$()},{trigger:C(()=>a[8]||(a[8]=[t("i",{class:"cursor-pointer fa-solid fa-ellipsis"},null,-1)])),_:1},8,["items"])])]),t("div",{onClick:a[1]||(a[1]=S(()=>{},["stop"]))},[y(_,{users:n.value,onAssign:h,assigneeId:s.ticket.assigned_to},null,8,["users","assigneeId"])])],4),y(be,{onClick:a[3]||(a[3]=S(()=>{},["stop"])),modelValue:g.value,"onUpdate:modelValue":a[4]||(a[4]=b=>g.value=b),title:"Delete Team seat",itemLabel:"Seat",itemName:s.ticket.title,requireMatchText:s.ticket.title,confirmText:"Delete Seat",cancelText:"Cancel",size:"md",loading:u(T),onConfirm:q,onCancel:a[5]||(a[5]=()=>{g.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),y(De,{isSubmitting:u(i),modelValue:m.value,"onUpdate:modelValue":a[6]||(a[6]=b=>m.value=b),members:(H=u(o))==null?void 0:H.people,directory:(O=u(o))==null?void 0:O.people,onSubmit:a[7]||(a[7]=({invite:b})=>B(b))},null,8,["isSubmitting","modelValue","members","directory"])],64)}}});export{Oe as default};
