const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KanbanBoard-pbBDeQuN.js","assets/index-C0EDYk9O.js","assets/index-KjqEc-Z4.css","assets/DropMenu.vue_vue_type_script_setup_true_lang-BL-uUAfD.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Dz-2Hxax.js","assets/workspace-BUeTPCZz.js","assets/KanbanBoard-CdMCEOAX.css","assets/KanbanCard-MRQthb2n.js","assets/usePeople-C1ojoUYB.js"])))=>i.map(i=>d[i]);
import{d as me,M as fe,r as m,m as Y,c as xe,a as pe,aa as ye,i as n,y as ge,e as s,h as p,j as C,ac as be,n as g,b3 as _e,f as K,t as v,P as ke,aD as Ce,A as le,V as we,a9 as ne,g as P,F as G,x as se,b as ve,G as he,af as De,o,H as Ve,W as Ae,q as Se,b4 as Pe,k as Te,C as de,w as H,B as re,a5 as ue,_ as $e,a6 as ce}from"./index-C0EDYk9O.js";import{D as Le,K as Ue}from"./KanbanSkeleton-BFVJ0qh_.js";import{b as Ne,c as Ee,d as Ie,e as Ke,f as Oe,g as qe}from"./usePeople-C1ojoUYB.js";import{_ as Be}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Dz-2Hxax.js";import{_ as je}from"./BaseEmailChip.vue_vue_type_script_setup_true_lang-B_TFejiW.js";import{_ as ze}from"./ProgressBar.vue_vue_type_script_setup_true_lang-DNGtFb2i.js";const Me={class:"py-4 flex justify-between items-center border-b border-border px-5 sticky top-0 bg-bg-card z-1"},Qe={class:"py-4 px-5"},We={class:"bg-bg-surface/50 p-2 rounded-lg flex gap-2 items-center"},Re=["src"],Je={key:0,class:"fa-solid fa-user text-white"},Fe={class:"text-base font-medium text-text-primary cursor-pointer"},He={class:"text-sm font-medium text-text-secondary cursor-pointer"},Ye={class:"flex flex-col mt-2"},Ge={class:"text-sm text-text-secondary mt-2"},Ze={key:0},Xe={class:"mb-2 capitalize"},et=["onKeydown"],tt={key:1,class:"mt-3"},at={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},st={class:"text-sm text-text-primary"},lt={key:2,class:"mt-3"},ot={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},it={class:"text-sm text-text-primary"},nt=me({__name:"DetailPanel",props:{showPanel:{type:Boolean,default:!0},details:{type:Object,default:()=>({})}},emits:["close","update:details","comment:post","priority:change"],setup(r,{emit:oe}){const Z=fe({}),w=m("details"),L=[{label:"Details",value:"details"},{label:"Tasks",value:"tasks"},{label:"History",value:"history"}],{data:h}=Ne(),{mutate:b}=Ee({onSuccess:()=>{x.invalidateQueries({queryKey:["people-lists"]})}}),l=r,d=m(!1),f=m(l.details["card-title"]??""),X=m(l.details.workspace_lane_id??"");Y(()=>l.details["card-title"],c=>{f.value=c,X.value=l.details.workspace_lane_id});const U=m(l.details["card-description"]);Y(()=>l.details,()=>{U.value=l.details["card-description"]});const T=m(null);function ee(){d.value=!0,De(()=>{var c,a;(c=T.value)==null||c.focus(),(a=T.value)==null||a.select()})}function D(){f.value.trim()||(f.value=l.details["card-title"]??""),V.mutate({card_id:l.details._id,variables:{"card-title":f.value.trim()}}),d.value=!1}function O(){f.value=l.details["card-title"]??"",d.value=!1}const q=m({startDate:l.details["start-date"],endDate:l.details["end-date"]}),te=xe(()=>l.details["start-date"]);Y(te,c=>{q.value={...q.value,startDate:c}});const x=pe(),V=ye({onSuccess:()=>{x.invalidateQueries({queryKey:["get-sheets"]}),x.invalidateQueries({queryKey:["sheet-list"]}),x.invalidateQueries({queryKey:["roles"]})}}),B=(c,a)=>{console.log(a,"slug",c),b({id:l.details._id,payload:{variable_values:[{module_variable_id:a,value:c}]}})};function ae(c){var k,A,S;const a=(k=l==null?void 0:l.details)==null?void 0:k.variable_values.filter($=>$.module_variable_id==c);return console.log((A=a[0])==null?void 0:A.value,">>>"),(S=a[0])==null?void 0:S.value}return(c,a)=>{var k,A,S,$,j,z,M,Q,N,W,E,R,J,t;return o(),n("div",{class:ge(`max-w-[358px] bg-bg-card  rounded-lg overflow-y-auto overflow-x-hidden relative ${r.showPanel?"!translate-x-0 w-full h-full min-w-[350px] overflow-y-auto":"!translate-x-100 w-0 h-0"} transition-all`)},[s("div",Me,[a[4]||(a[4]=s("h5",{class:"text-[16px] font-medium"},"Profile",-1)),s("i",{class:"cursor-pointer text-text-primary fa-solid fa-close",onClick:a[0]||(a[0]=()=>{c.$emit("close")})})]),s("div",Qe,[s("div",We,[(k=r.details)!=null&&k.avatar?(o(),n("img",{key:0,src:(A=r.details)==null?void 0:A.avatar,class:"w-10 h-10 rounded-full",alt:"avartar"},null,8,Re)):(o(),n("div",{key:1,class:"min-w-10 max-h-10 aspect-square bg-bg-surface flex justify-center items-center rounded-full",style:be({backgroundColor:(S=r.details)!=null&&S.name?g(_e)({email:($=r.details)==null?void 0:$.email}):""})},[K(v(g(ke)((j=r.details)==null?void 0:j.name))+" ",1),(z=r.details)!=null&&z.name?C("",!0):(o(),n("i",Je))],4)),s("div",null,[s("h1",Fe,v(r.details.name??r.details.title),1),s("p",He,v(r.details.email),1)])]),p(Ce,{modelValue:w.value,"onUpdate:modelValue":a[1]||(a[1]=e=>w.value=e),class:"my-2",options:L},null,8,["modelValue"]),s("div",Ye,[a[5]||(a[5]=s("h1",{class:"text-base font-medium text-text-primary cursor-pointer"}," Task Progress ",-1)),p(ze,{class:"mt-2",progress:(M=l==null?void 0:l.details)==null?void 0:M.assigned_cards_count,fillColor:"bg-accent ",indeterminate:!0},null,8,["progress"]),s("span",Ge,"Completed 10 tasks out of "+v((Q=l==null?void 0:l.details)==null?void 0:Q.assigned_cards_count),1)]),w.value=="details"?(o(),n("section",Ze,[s("div",Xe,[d.value?le((o(),n("input",{key:0,ref_key:"titleInput",ref:T,"onUpdate:modelValue":a[2]||(a[2]=e=>f.value=e),onBlur:D,onKeydown:[ne(P(D,["prevent"]),["enter"]),ne(P(O,["prevent"]),["esc"])],class:"border border-border rounded px-2 py-1 w-full text-xl font-medium",type:"text"},null,40,et)),[[we,f.value]]):(o(),n("h1",{key:1,class:"text-xl font-medium text-text-primary cursor-pointer",onClick:ee},v(f.value),1))]),s("div",null,[(o(!0),n(G,null,se(g(h),(e,u)=>{var y;return o(),n("div",{key:u,class:"grid grid-cols-2 capitalize items-center gap-2 text-sm mt-4"},[K(v(e.title)+" ",1),(o(),ve(he,{size:"sm","model-value":Z[e.slug],key:u,placeholder:` ${e.title}`,onClick:a[3]||(a[3]=P(()=>{},["stop"])),defaultValue:ae(e==null?void 0:e._id),options:e==null?void 0:e.data.map(_=>({_id:_,title:_})),cardId:(y=r.details)==null?void 0:y._id,"onUpdate:modelValue":_=>B(_,e._id)},null,8,["model-value","placeholder","defaultValue","options","cardId","onUpdate:modelValue"]))])}),128))])])):C("",!0),w.value=="tasks"?(o(),n("section",tt,[a[7]||(a[7]=s("span",{class:"text-base text-text-primary"},"Worked On",-1)),((W=(N=r.details)==null?void 0:N.assigned_cards)==null?void 0:W.length)>0?(o(),n("ul",at,[(o(!0),n(G,null,se((E=r.details)==null?void 0:E.assigned_cards,(e,u)=>(o(),n("li",{class:"p-2",key:u},[s("h1",st,v(e==null?void 0:e.title),1),a[6]||(a[6]=s("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):C("",!0)])):C("",!0),w.value=="history"?(o(),n("section",lt,[a[9]||(a[9]=s("span",{class:"text-base text-text-primary"},"history",-1)),((J=(R=r.details)==null?void 0:R.assignment_history)==null?void 0:J.length)>0?(o(),n("ul",ot,[(o(!0),n(G,null,se((t=r.details)==null?void 0:t.assignment_history,(e,u)=>(o(),n("li",{class:"p-2",key:u},[s("h1",it,v(e==null?void 0:e.title),1),a[8]||(a[8]=s("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):C("",!0)])):C("",!0)])],2)}}}),dt=Ve(nt,[["__scopeId","data-v-9b1e0603"]]),rt={class:"flex-auto flex-grow h-full bg-bg-card rounded-lg border border-border overflow-x-auto flex-col flex"},ut={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},ct={class:"flex gap-3 items-center"},mt={class:"flex p-4 overflow-x-auto gap-3 custom_scroll_bar"},pt=["onClick"],vt={key:1,class:"p-4 space-y-2 bg-bg-surface m-4 rounded-md"},ft={class:"text-sm text-text-primary"},xt={class:"flex items-center mt-3 gap-3"},wt=me({__name:"People",setup(r){const oe=ue(()=>ce(()=>import("./KanbanBoard-pbBDeQuN.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Z=ue(()=>ce(()=>import("./KanbanCard-MRQthb2n.js"),__vite__mapDeps([7,1,2,3,4,8]))),w=[{title:"Role",_id:"role"},{title:"Team",_id:"team"},{title:"Status",_id:"status"}],L=m("role"),h=m(!1),b=m(),{workspaceId:l}=Ae(),d=m([]),{mutate:f,isPending:X}=Ie({onSuccess:t=>{d.value=[...d.value||[],t],V.value="",x.value=!1}}),{data:U,isPending:T}=Ke(l.value,L);Y(U,t=>{d.value=t?JSON.parse(JSON.stringify(t)):[]}),Se(()=>{d.value=U.value?JSON.parse(JSON.stringify(U.value)):[]});const ee=m("kanban"),D=m(),O=t=>{D.value=t};function q(t){t.type==="column"||k.mutate({id:t.meta.moved._id,payload:{roleId:t.meta.toColumnId}})}const te=t=>{},x=m(!1),V=m("");function B(){x.value=!x.value}function ae(){console.log(">>> clicking on adding pepople ");const t=V.value.trim();c(t)}const c=t=>{console.log(">>> clicking on adding pepople ");const e={workspace_id:l.value,title:t,max_num_people:1};f({payload:e})},a=pe(),k=Pe({onSuccess:()=>{a.invalidateQueries({queryKey:["people-lists"]})}}),A=t=>{const e={workspace_id:l.value,title:t==null?void 0:t.title,max_num_people:1};k.mutate({id:t._id,payload:e})},{mutate:S,isPending:$}=Oe({onSuccess:t=>{h.value=!1,d.value=d.value.filter(e=>{var u;return e._id!==((u=t.deletedRole)==null?void 0:u._id)})}}),j=()=>{var t;S({id:(t=b.value)==null?void 0:t.columnId})},z=t=>{h.value=!0,b.value=t},{mutate:M,isPending:Q}=qe({onSuccess:t=>{V.value="",x.value=!1,console.log(b.value,">>>. id local column");const e=d.value.findIndex(F=>F._id===b.value._id);if(e===-1)return;console.log(e,"index>>>");const u=d.value[e],y=[...u.cards??[],t==null?void 0:t.assigned_seat],_={...u,cards:y};d.value=[...d.value.slice(0,e),_,...d.value.slice(e+1)],a.invalidateQueries({queryKey:["people-lists"]}),a.invalidateQueries({queryKey:["workspaceRoles"]})}}),N=t=>{b.value=t;const e={name:t!=null&&t.email?W(t==null?void 0:t.email[0]):"",email:t!=null&&t.email?t==null?void 0:t.email[0]:"",role_id:t==null?void 0:t._id,workspace_id:l==null?void 0:l.value,additional_seats:1};M({id:t._id,payload:e})};function W(t){const u=(t.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return u.length?u.map(y=>y.charAt(0).toUpperCase()+y.slice(1).toLowerCase()).join(" "):t}const E=t=>{window.dispatchEvent(new CustomEvent("close-all-showADDNEW")),t.showADDNEW=!t.showADDNEW},R=t=>{N(t)},J=t=>{D.value=t};return(t,e)=>{var y,_,F,ie;const u=Te("Searchbar");return o(),n(G,null,[s("div",rt,[s("div",ut,[p(Le,{actions:!1,prefix:"View By",modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=i=>L.value=i),options:w,variant:"secondary"},null,8,["modelValue"]),s("div",ct,[p(u,{placeholder:"Search in Orchit AI space"})])]),le(p(Ue,null,null,512),[[de,g(T)]]),le(s("div",mt,[((y=d.value)==null?void 0:y.length)>0?(o(),ve(g(oe),{key:0,plusIcon:!1,onOnPlus:e[2]||(e[2]=i=>N(i)),"onDelete:column":e[3]||(e[3]=i=>z(i)),"onUpdate:column":e[4]||(e[4]=i=>A(i)),onReorder:q,onAddColumn:c,"onSelect:ticket":O,board:d.value,onOnBoardUpdate:te,variable_id:"",sheet_id:"selected_sheet_id"},{ticket:H(({ticket:i})=>[p(g(Z),{onClick:I=>J(i),ticket:i},null,8,["onClick","ticket"])]),"column-footer":H(({column:i})=>[i.showADDNEW?i.showADDNEW?(o(),n("div",vt,[s("p",ft,v(i.title)+" "+v(i.cards.length+1),1),p(je,{maxEmails:1,placeholder:"team member email",modelValue:i.email,"onUpdate:modelValue":I=>i.email=I},null,8,["modelValue","onUpdate:modelValue"]),e[13]||(e[13]=s("p",{class:"text-sm text-text-secondary"},"You can assign user later",-1)),p(re,{size:"md",onClick:I=>R(i)},{default:H(()=>[K(v(g(Q)?"Adding...":"Add Seat"),1)]),_:2},1032,["onClick"]),s("i",{class:"fa-solid fa-close cursor-pointer ml-2",onClick:e[1]||(e[1]=I=>E(""))})])):C("",!0):(o(),n("div",{key:0,onClick:I=>E(i),class:"flex py-3 px-3 justify-center text-sm text-text-primary items-center gap-3 border border-text-primary cursor-pointer border-dashed mb-4 mx-4 rounded-md"},e[12]||(e[12]=[s("i",{class:"fa-solid fa-plus"},null,-1),K(" Add Seat ")]),8,pt))]),_:1},8,["board"])):C("",!0),s("div",{class:"min-w-[328px]",onClick:e[7]||(e[7]=P(()=>{},["stop"]))},[x.value?(o(),n("form",{key:0,onSubmit:e[6]||(e[6]=P(()=>{},["prevent"])),class:"bg-bg-body rounded-lg p-4"},[p($e,{autofocus:!0,modelValue:V.value,"onUpdate:modelValue":e[5]||(e[5]=i=>V.value=i),placeholder:"Add New list"},null,8,["modelValue"]),e[14]||(e[14]=s("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),s("div",xt,[p(re,{onClick:ae,type:"submit",variant:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:H(()=>[K(v(g(X)?"Adding...":"Add Team"),1)]),_:1}),s("i",{class:"fa-solid fa-close cursor-pointer",onClick:B})])],32)):(o(),n("button",{key:1,class:"text-sm text-text-primary py-2.5 cursor-pointer font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",onClick:P(B,["stop"])}," + Add Team "))])],512),[[de,ee.value=="kanban"&&!g(T)]])]),p(Be,{onClick:e[8]||(e[8]=P(()=>{},["stop"])),modelValue:h.value,"onUpdate:modelValue":e[9]||(e[9]=i=>h.value=i),title:"Delete List",itemLabel:"list",itemName:(_=b.value)==null?void 0:_.title,requireMatchText:(F=b.value)==null?void 0:F.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:g($),onConfirm:j,onCancel:e[10]||(e[10]=()=>{h.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),p(dt,{details:D.value,onClose:e[11]||(e[11]=()=>{O({variables:{}})}),showPanel:!!((ie=D.value)!=null&&ie.title)},null,8,["details","showPanel"])],64)}}});export{wt as default};
