import{r as x,m as z,v as M,d as $,c as h,i as l,e,j as _,t as d,y as P,h as O,F as S,x as C,f as G,o as r,p as q,q as H,b as Y,n as K,w as Q,aA as X,S as A,a1 as y,_ as Z}from"./index-By-MWQyp.js";import{t as D}from"./useQueryParams-Cj5obHVe.js";import{_ as ee}from"./ProgressBar.vue_vue_type_script_setup_true_lang-C8E5q2Wf.js";function te(w,{start:n=0,maxWhileLoading:g=90,step:a=.8,intervalMs:m=120}={}){const s=x(n);let v=null;const i=()=>{v==null&&(v=window.setInterval(()=>{w()&&(s.value=Math.min(s.value+a,g))},m))},b=()=>{v!=null&&(clearInterval(v),v=null)};return z(w,k=>{k?(s.value=n,i()):(s.value=100,setTimeout(()=>{s.value=n,b()},300))},{immediate:!0}),M(b),s}const se={class:"rounded-lg min-w-sm border border-border overflow-hidden flex flex-col justify-between bg-bg-card w-full"},ae={class:"px-3 pt-3"},oe={class:"flex justify-between items-start pb-2"},re={class:"text-lg font-semibold text-text-primary text-left"},le={class:"text-xs text-text-secondary text-left"},ne={key:1,class:"text-xs"},ie={key:0,class:"mb-2 pb-3"},de={class:"flex justify-between text-sm text-text-secondary mb-1"},ue={class:"flex justify-between items-center bg-bg-body p-3"},ce={class:"flex -space-x-2"},me=["src"],ge={key:0,class:"w-6 h-6 rounded-full border-2 border-border bg-bg-card text-[11px] font-semibold flex items-center justify-center text-text-secondary shadow"},ve={class:"flex items-center gap-1 text-sm text-text-secondary"},pe=$({__name:"ProjectCard",props:{title:{},subtitle:{},status:{},progress:{default:0},avatars:{},maxVisible:{default:2},date:{},loading:{type:Boolean,default:!1},color:{default:"#9CA3AF"},totalCard:{}},setup(w){const n=w,g=te(()=>!!n.loading),a=h(()=>n.loading?g.value:n.progress),m=h(()=>n.avatars.slice(0,n.maxVisible)),s=h(()=>n.avatars.length>n.maxVisible?n.avatars.length-n.maxVisible:0),v=i=>{switch(i){case"completed":return"bg-green-400/40 border-green-400 text-green-400";case"failed":return"bg-red-400/40 border-red-400 text-red-400";case"in_progress":return"bg-blue-400/20 border-blue-400 text-blue-400";case"pending":return"bg-amber-400/20 border-amber-400 text-amber-400";default:return"progress-default"}};return(i,b)=>(r(),l("div",se,[e("div",ae,[e("div",oe,[e("div",null,[e("h3",re,d(i.title),1),e("p",le,d(i.subtitle),1)]),i.status!="completed"?(r(),l("span",{key:0,class:P(["text-xs border rounded-full px-2 py-0.5",v(i.status)])},d(i.status),3)):_("",!0),i.status=="completed"?(r(),l("span",ne," Total Cards: "+d(i.totalCard),1)):_("",!0)]),i.status!="completed"?(r(),l("div",ie,[e("div",de,[e("span",null,d(i.status=="in_progress"?"Generating lane with AI...":"Progress"),1),e("span",null,d(Math.round(a.value))+"%",1)]),O(ee,{class:"mt-2",progress:a.value,fillColor:"bg-accent ",indeterminate:!!i.loading},null,8,["progress","indeterminate"])])):_("",!0)]),e("div",ue,[e("div",ce,[(r(!0),l(S,null,C(m.value,(k,f)=>(r(),l("img",{key:f,src:k,class:"w-6 h-6 rounded-full border-2 border-border object-cover shadow"},null,8,me))),128)),s.value>0?(r(),l("div",ge," +"+d(s.value),1)):_("",!0)]),e("div",ve,[b[0]||(b[0]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 7V3M16 7V3M4 11h16M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),G(" "+d(i.date),1)])])]))}}),be={class:"flex flex-col gap-4 h-full overflow-x-auto w-full flex-auto"},fe={class:"p-5 rounded-lg bg-bg-card space-y-6"},xe={class:"flex items-center justify-between"},he={class:"flex flex-col w-full"},ye={class:"flex gap-2.5 overflow-x-auto w-full py-8"},_e=["onClick"],we={class:"flex flex-grow gap-4"},ke={class:"bg-bg-card w-full flex-auto p-5 rounded-lg"},Se={class:"space-y-4"},Ce={class:"flex items-center gap-2 w-32 flex-shrink-0"},Ee={key:1,class:"w-8 h-8 rounded-full bg-bg-body flex items-center justify-center"},Ie={class:"text-sm text-text-primary truncate"},je={class:"flex-1"},Be={class:"h-6 bg-bg-body rounded overflow-hidden relative"},Ae={key:0,class:"absolute inset-0 flex items-center justify-start px-2 text-xs text-text-primary font-medium"},$e={class:"bg-bg-card w-full flex-auto p-5 rounded-lg overflow-hidden flex flex-col"},Oe={class:"space-y-4 overflow-y-auto flex-1"},Ve={class:"flex-1 min-w-0"},De={class:"text-sm text-text-primary"},Le={class:"font-medium text-accent/90"},Me={class:"text-text-secondary"},Pe={href:"#",class:"text-accent/90 hover:underline"},Re={class:"text-xs text-text-secondary mt-1"},L=5,Te=$({__name:"Peak",setup(w){const n=x(!1),g=x(null),a=x(null),m=x(0),s=x({}),v="https://backend.streamed.space/api/v1/workspace",i=h(()=>{var u,o;return((o=(u=g.value)==null?void 0:u.progress_details)==null?void 0:o.lanes_progress)??[]}),b=h(()=>!g.value||["queued","running"].includes(g.value.status)),k=["https://randomuser.me/api/portraits/women/1.jpg","https://randomuser.me/api/portraits/men/2.jpg","https://randomuser.me/api/portraits/men/3.jpg"],f=q(),R=h(()=>{var u;return D((u=f==null?void 0:f.params)==null?void 0:u.id)}),E=h(()=>{var u;return D((u=f==null?void 0:f.params)==null?void 0:u.jobId)}),I=()=>{if(a.value&&a.value.readyState===EventSource.OPEN||m.value>=L)return;a.value&&a.value.close();const u=localStorage.getItem("token")||"",o=localStorage.getItem("jobId")||(E==null?void 0:E.value)||R.value,t=localStorage.getItem("jobId")?"false":"true",B=`${v}/step2/tasks/${o}/stream?token=${u}&is_manual=${t}`;try{a.value=new EventSource(B,{withCredentials:!1}),a.value.onopen=()=>{n.value=!0,m.value=0,s.value={...s.value,connectionStatus:"Connected",lastConnected:new Date().toISOString(),url:B}},a.value.onmessage=c=>{try{const p=JSON.parse(c.data);g.value=p,s.value={...s.value,lastMessage:p,lastMessageTime:new Date().toISOString()},["completed","failed","canceled"].includes(p.status)&&setTimeout(j,1200)}catch(p){s.value={...s.value,parseError:p==null?void 0:p.message,rawMessage:c.data}}},a.value.addEventListener("progress",c=>{try{g.value=JSON.parse(c.data)}catch{}}),a.value.addEventListener("error",c=>{try{s.value={...s.value,serverError:JSON.parse(c.data)}}catch{}}),a.value.onerror=()=>{var c;if(n.value=!1,s.value={...s.value,connectionError:!0,errorTime:new Date().toISOString(),readyState:(c=a.value)==null?void 0:c.readyState},m.value<L){m.value++;const p=Math.min(3e4,1e3*2**m.value);setTimeout(I,p)}}}catch(c){s.value={...s.value,creationError:c==null?void 0:c.message,errorTime:new Date().toISOString()}}},j=()=>{a.value&&(a.value.close(),a.value=null),n.value=!1,s.value={...s.value,disconnectedAt:new Date().toISOString()}},T=()=>{j(),m.value=0,setTimeout(I,600)};H(()=>{I(),document.addEventListener("visibilitychange",V)}),M(()=>{j(),document.removeEventListener("visibilitychange",V)});const V=()=>{!document.hidden&&!n.value&&(!a.value||a.value.readyState===EventSource.CLOSED)&&T()},N=u=>{console.log("Lane clicked:",u)},F=x([{id:1,name:"Unassigned",initials:"",avatar:!1,color:"#6B7280",workload:13},{id:2,name:"Amal Lashari",initials:"AL",avatar:!0,color:"#3B82F6",workload:35},{id:3,name:"Anam Rehman",initials:"AR",avatar:!0,color:"#3B82F6",workload:8},{id:4,name:"Sufian",initials:"S",avatar:!0,color:"#6B7280",workload:8},{id:5,name:"Arooj Sajjad",initials:"AS",avatar:!0,color:"#EF4444",workload:5}]),U=x([{id:1,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-33073: IPU: Agenda Multilingual Issue (global issue)",status:"DEPLOYED-PROD",time:"about 4 hours ago"},{id:2,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-31468: Show/Hide Team Members on Booth",status:"REOPENED",time:"about 4 hours ago"},{id:3,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-32359: Favicon not displaying after uploading from Event Settings",status:"",time:"about 4 hours ago"}]),W=u=>({"DEPLOYED-PROD":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",REOPENED:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200","IN-PROGRESS":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"})[u]||"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",J=$({name:"SkeletonCard",setup(){return()=>y("div",{class:"w-[380px] min-w-[280px] h-[180px] rounded-xl border border-border bg-bg-body/60 animate-pulse p-4"},[y("div",{class:"h-5 w-2/3 rounded bg-bg-card/50 mb-2"}),y("div",{class:"h-3 w-1/2 rounded bg-bg-card/50 mb-4"}),y("div",{class:"h-2 w-full rounded bg-bg-card/50 mb-1"}),y("div",{class:"h-2 w-11/12 rounded bg-bg-card/50 mb-1"}),y("div",{class:"h-2 w-10/12 rounded bg-bg-card/50"})])}});return(u,o)=>(r(),l("div",be,[e("div",fe,[e("div",xe,[e("div",he,[o[0]||(o[0]=e("h3",{class:"text-2xl text-text-primary font-semibold"},"Project Overview",-1)),o[1]||(o[1]=e("p",{class:"text-sm text-text-secondary mt-2"},"Last update on Sep 12, 2024 - 09.45 AM",-1)),e("div",ye,[b.value?(r(),l(S,{key:0},C(3,t=>O(K(J),{key:t})),64)):(r(),Y(X,{key:1,name:"list",tag:"div",class:"flex gap-2.5"},{default:Q(()=>[(r(!0),l(S,null,C(i.value,t=>(r(),l("button",{key:t.lane_title,class:"group focus:outline-none border-border border focus-visible:ring-2 focus-visible:ring-primary/50 rounded-xl",type:"button",role:"button","aria-label":"Open lane details",onClick:B=>N(t)},[O(pe,{loading:b.value||(t==null?void 0:t.status)==="in_progress",title:t.lane_title,subtitle:"Mobile Application",progress:(t==null?void 0:t.progress)??0,totalCard:t==null?void 0:t.total_cards,status:(t==null?void 0:t.status)??"",avatars:k,date:"May 28",class:"transition-transform duration-200 ease-out group-hover:shadow-lg border border-transparent hover:border-border-subtle rounded-xl cursor-pointer"},null,8,["loading","title","progress","totalCard","status"])],8,_e))),128))]),_:1}))])])])]),e("div",we,[e("div",ke,[o[4]||(o[4]=e("div",{class:"mb-4"},[e("h3",{class:"text-lg font-semibold text-text-primary"},"Team workload"),e("p",{class:"text-sm text-text-secondary mt-1"}," Monitor the capacity of your team. ")],-1)),e("div",Se,[o[3]||(o[3]=e("div",{class:"flex items-center justify-between text-sm font-medium text-text-secondary mb-2"},[e("span",null,"Assignee"),e("span",null,"Work distribution")],-1)),(r(!0),l(S,null,C(F.value,t=>(r(),l("div",{key:t.id,class:"flex items-center gap-3"},[e("div",Ce,[t.avatar?(r(),l("div",{key:0,class:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-medium",style:A({backgroundColor:t.color})},d(t.initials),5)):(r(),l("div",Ee,o[2]||(o[2]=[e("i",{class:"pi pi-user text-text-secondary"},null,-1)]))),e("span",Ie,d(t.name),1)]),e("div",je,[e("div",Be,[e("div",{class:"h-full bg-border-subtle transition-all duration-300",style:A({width:t.workload+"%"})},null,4),t.workload>10?(r(),l("span",Ae,d(t.workload)+"% ",1)):_("",!0)])])]))),128))])]),e("div",$e,[o[6]||(o[6]=e("div",{class:"mb-4"},[e("h3",{class:"text-lg font-semibold text-text-primary"},"Recent activity"),e("p",{class:"text-sm text-text-secondary mt-1"},"Stay up to date with what's happening across the project.")],-1)),e("div",Oe,[o[5]||(o[5]=e("div",{class:"text-xs font-semibold text-text-secondary mb-3"},"Today",-1)),(r(!0),l(S,null,C(U.value,t=>(r(),l("div",{key:t.id,class:"flex gap-3 pb-4 border-b border-border last:border-0"},[e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-medium flex-shrink-0",style:A({backgroundColor:t.userColor})},d(t.userInitials),5),e("div",Ve,[e("div",De,[e("span",Le,d(t.user),1),e("span",Me,d(t.action),1),e("a",Pe,d(t.item),1),t.status?(r(),l("span",{key:0,class:P(["ml-2 px-2 py-0.5 rounded text-xs font-medium",W(t.status)])},d(t.status),3)):_("",!0)]),e("div",Re,d(t.time),1)])]))),128))])])])]))}}),We=Z(Te,[["__scopeId","data-v-7a0655e1"]]);export{We as default};
