import{r as v,m as $,v as M,d as O,c as h,i,e,t as u,y as T,h as P,f as L,j as C,o as l,_ as N,p as Y,q,b as K,F as k,x as S,n as Q,w as X,aA as Z,S as A,a1 as _}from"./index-QAH94Xm8.js";import{t as R}from"./useQueryParams-DdOU-zEC.js";import{_ as ee}from"./ProgressBar.vue_vue_type_script_setup_true_lang-D1V7bgZD.js";function te(w,{start:r=0,maxWhileLoading:b=90,step:a=.8,intervalMs:g=120}={}){const s=v(r);let p=null;const n=()=>{p==null&&(p=window.setInterval(()=>{w()&&(s.value=Math.min(s.value+a,b))},g))},m=()=>{p!=null&&(clearInterval(p),p=null)};return $(w,E=>{E?(s.value=r,n()):(s.value=100,setTimeout(()=>{s.value=r,m()},300))},{immediate:!0}),M(m),s}const se={class:"relative p-3 rounded-lg min-w-sm border border-border overflow-hidden flex flex-col justify-between bg-bg-card w-full"},ae={class:"flex justify-between items-start pb-2"},oe={class:"text-lg font-semibold text-text-primary text-left"},re={class:"text-xs text-text-secondary text-left"},le={class:"flex items-center gap-2"},ne={key:1,class:"text-xs"},ie={class:""},de={class:"flex justify-between text-sm text-text-secondary mb-1"},ue={key:0,class:"fa-regular text-left fa-arrows-spin animate-spin duration-250"},ce=O({__name:"ProjectCard",props:{title:{},subtitle:{},status:{},progress:{default:0},avatars:{},maxVisible:{default:2},date:{},loading:{type:Boolean,default:!1},color:{default:"#9CA3AF"},totalCard:{}},setup(w){const r=w,b=te(()=>!!r.loading),a=h(()=>r.loading?b.value:r.progress);h(()=>r.avatars.slice(0,r.maxVisible)),h(()=>r.avatars.length>r.maxVisible?r.avatars.length-r.maxVisible:0);const g=h(()=>Math.round(a.value)>=100),s=v(0);$(g,(n,m)=>{n&&!m&&s.value++});function p(n){switch(n){case"completed":return"bg-green-400/40 border-green-400 text-green-400";case"failed":return"bg-red-400/40 border-red-400 text-red-400";case"in_progress":return"bg-blue-400/20 border-blue-400 text-blue-400";case"pending":return"bg-amber-400/20 border-amber-400 text-amber-400";default:return"progress-default"}}return(n,m)=>(l(),i("div",se,[e("div",ae,[e("div",null,[e("h3",oe,u(n.title),1),e("p",re,u(n.subtitle),1)]),e("div",le,[n.status!="completed"?(l(),i("span",{key:0,class:T(["text-xs border rounded-full px-2 py-0.5",p(n.status)])},u(n.status),3)):(l(),i("span",ne,"Total Cards: "+u(n.totalCard),1))])]),e("div",ie,[e("div",de,[e("div",null,[e("span",null,u(n.status=="in_progress"?"Generating lane with AI...":"Progress"),1),m[0]||(m[0]=L()),n.status=="in_progress"?(l(),i("i",ue)):C("",!0)]),e("span",null,[L(u(Math.round(a.value))+"% ",1),g.value?(l(),i("span",{key:s.value,class:"confetti-icon select-none","aria-label":"Completed"}," ðŸŽ‰ ")):C("",!0)])]),P(ee,{class:"mt-2",progress:a.value,fillColor:"bg-accent",indeterminate:!!n.loading},null,8,["progress","indeterminate"])])]))}}),me=N(ce,[["__scopeId","data-v-c749d02a"]]),ge={class:"flex flex-col gap-4 h-full overflow-x-auto w-full flex-auto"},ve={class:"p-5 rounded-lg bg-bg-card space-y-6"},pe={class:"flex items-center justify-between"},fe={class:"flex flex-col w-full"},xe={class:"flex gap-2.5 overflow-x-auto w-full py-8"},be=["onClick"],he={class:"flex flex-grow gap-4"},ye={class:"bg-bg-card w-full flex-auto p-5 rounded-lg"},_e={class:"space-y-4"},we={class:"flex items-center gap-2 w-32 flex-shrink-0"},ke={key:1,class:"w-8 h-8 rounded-full bg-bg-body flex items-center justify-center"},Se={class:"text-sm text-text-primary truncate"},Ce={class:"flex-1"},Ee={class:"h-6 bg-bg-body rounded overflow-hidden relative"},Ie={key:0,class:"absolute inset-0 flex items-center justify-start px-2 text-xs text-text-primary font-medium"},Be={class:"bg-bg-card w-full flex-auto p-5 rounded-lg overflow-hidden flex flex-col"},je={class:"space-y-4 overflow-y-auto flex-1"},Ae={class:"flex-1 min-w-0"},Oe={class:"text-sm text-text-primary"},Pe={class:"font-medium text-accent/90"},De={class:"text-text-secondary"},Le={href:"#",class:"text-accent/90 hover:underline"},Re={class:"text-xs text-text-secondary mt-1"},V=5,Ve=O({__name:"Peak",setup(w){const r=v(!1),b=v(null),a=v(null),g=v(0),s=v({}),p="https://backend.streamed.space/api/v1/workspace",n=h(()=>{var d,o;return((o=(d=b.value)==null?void 0:d.progress_details)==null?void 0:o.lanes_progress)??[]}),m=v(!1),E=["https://randomuser.me/api/portraits/women/1.jpg","https://randomuser.me/api/portraits/men/2.jpg","https://randomuser.me/api/portraits/men/3.jpg"],y=Y(),F=h(()=>{var d;return R((d=y==null?void 0:y.params)==null?void 0:d.id)}),f=h(()=>{var d;return R((d=y==null?void 0:y.params)==null?void 0:d.job_id)}),I=()=>{if(a.value&&a.value.readyState===EventSource.OPEN||g.value>=V)return;a.value&&a.value.close();const d=localStorage.getItem("token")||"",o=localStorage.getItem("jobId")?localStorage.getItem("jobId"):f!=null&&f.value?f==null?void 0:f.value:F.value,t=localStorage.getItem("jobId")||f!=null&&f.value?"false":"true",j=`${p}/step2/tasks/${o}/stream?token=${d}&is_manual=${t}`;try{a.value=new EventSource(j,{withCredentials:!1}),a.value.onopen=()=>{m.value=!0,r.value=!0,g.value=0,s.value={...s.value,connectionStatus:"Connected",lastConnected:new Date().toISOString(),url:j},m.value=!1},a.value.onmessage=c=>{try{const x=JSON.parse(c.data);b.value=x,s.value={...s.value,lastMessage:x,lastMessageTime:new Date().toISOString()},["completed","failed","canceled"].includes(x.status)&&setTimeout(B,1200)}catch(x){s.value={...s.value,parseError:x==null?void 0:x.message,rawMessage:c.data}}},a.value.addEventListener("progress",c=>{try{b.value=JSON.parse(c.data)}catch{}}),a.value.addEventListener("error",c=>{try{s.value={...s.value,serverError:JSON.parse(c.data)}}catch{}}),a.value.onerror=()=>{var c;if(r.value=!1,s.value={...s.value,connectionError:!0,errorTime:new Date().toISOString(),readyState:(c=a.value)==null?void 0:c.readyState},g.value<V){g.value++;const x=Math.min(3e4,1e3*2**g.value);setTimeout(I,x)}}}catch(c){s.value={...s.value,creationError:c==null?void 0:c.message,errorTime:new Date().toISOString()}}},B=()=>{a.value&&(a.value.close(),a.value=null),r.value=!1,s.value={...s.value,disconnectedAt:new Date().toISOString()}},U=()=>{B(),g.value=0,setTimeout(I,600)};q(()=>{I(),document.addEventListener("visibilitychange",D)}),M(()=>{B(),document.removeEventListener("visibilitychange",D)});const D=()=>{!document.hidden&&!r.value&&(!a.value||a.value.readyState===EventSource.CLOSED)&&U()},W=d=>{console.log("Lane clicked:",d)},J=v([{id:1,name:"Unassigned",initials:"",avatar:!1,color:"#6B7280",workload:13},{id:2,name:"Amal Lashari",initials:"AL",avatar:!0,color:"#3B82F6",workload:35},{id:3,name:"Anam Rehman",initials:"AR",avatar:!0,color:"#3B82F6",workload:8},{id:4,name:"Sufian",initials:"S",avatar:!0,color:"#6B7280",workload:8},{id:5,name:"Arooj Sajjad",initials:"AS",avatar:!0,color:"#EF4444",workload:5}]),G=v([{id:1,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-33073: IPU: Agenda Multilingual Issue (global issue)",status:"DEPLOYED-PROD",time:"about 4 hours ago"},{id:2,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-31468: Show/Hide Team Members on Booth",status:"REOPENED",time:"about 4 hours ago"},{id:3,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-32359: Favicon not displaying after uploading from Event Settings",status:"",time:"about 4 hours ago"}]),z=d=>({"DEPLOYED-PROD":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",REOPENED:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200","IN-PROGRESS":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"})[d]||"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",H=O({name:"SkeletonCard",setup(){return()=>_("div",{class:"w-[380px] min-w-[280px] h-[180px] rounded-xl border border-border bg-bg-body/60 animate-pulse p-4"},[_("div",{class:"h-5 w-2/3 rounded bg-bg-card/50 mb-2"}),_("div",{class:"h-3 w-1/2 rounded bg-bg-card/50 mb-4"}),_("div",{class:"h-2 w-full rounded bg-bg-card/50 mb-1"}),_("div",{class:"h-2 w-11/12 rounded bg-bg-card/50 mb-1"}),_("div",{class:"h-2 w-10/12 rounded bg-bg-card/50"})])}});return(d,o)=>(l(),i("div",ge,[e("div",ve,[e("div",pe,[e("div",fe,[o[0]||(o[0]=e("h3",{class:"text-2xl text-text-primary font-semibold"},"Project Overview",-1)),o[1]||(o[1]=e("p",{class:"text-sm text-text-secondary mt-2"},"Last update on Sep 12, 2024 - 09.45 AM",-1)),e("div",xe,[m.value?(l(),i(k,{key:0},S(3,t=>P(Q(H),{key:t})),64)):(l(),K(Z,{key:1,name:"list",tag:"div",class:"flex gap-2.5"},{default:X(()=>[(l(!0),i(k,null,S(n.value,t=>(l(),i("button",{key:t.lane_title,class:"group focus:outline-none border-border border focus-visible:ring-2 focus-visible:ring-primary/50 rounded-xl",type:"button",role:"button","aria-label":"Open lane details",onClick:j=>W(t)},[P(me,{loading:m.value||(t==null?void 0:t.status)==="in_progress",title:t.lane_title,subtitle:"Mobile Application",progress:(t==null?void 0:t.progress)??0,totalCard:t==null?void 0:t.total_cards,status:(t==null?void 0:t.status)??"",avatars:E,date:"May 28",class:"transition-transform duration-200 ease-out group-hover:shadow-lg border border-transparent hover:border-border-subtle rounded-xl cursor-pointer"},null,8,["loading","title","progress","totalCard","status"])],8,be))),128))]),_:1}))])])])]),e("div",he,[e("div",ye,[o[4]||(o[4]=e("div",{class:"mb-4"},[e("h3",{class:"text-lg font-semibold text-text-primary"},"Team workload"),e("p",{class:"text-sm text-text-secondary mt-1"}," Monitor the capacity of your team. ")],-1)),e("div",_e,[o[3]||(o[3]=e("div",{class:"flex items-center justify-between text-sm font-medium text-text-secondary mb-2"},[e("span",null,"Assignee"),e("span",null,"Work distribution")],-1)),(l(!0),i(k,null,S(J.value,t=>(l(),i("div",{key:t.id,class:"flex items-center gap-3"},[e("div",we,[t.avatar?(l(),i("div",{key:0,class:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-medium",style:A({backgroundColor:t.color})},u(t.initials),5)):(l(),i("div",ke,o[2]||(o[2]=[e("i",{class:"pi pi-user text-text-secondary"},null,-1)]))),e("span",Se,u(t.name),1)]),e("div",Ce,[e("div",Ee,[e("div",{class:"h-full bg-border-subtle transition-all duration-300",style:A({width:t.workload+"%"})},null,4),t.workload>10?(l(),i("span",Ie,u(t.workload)+"% ",1)):C("",!0)])])]))),128))])]),e("div",Be,[o[6]||(o[6]=e("div",{class:"mb-4"},[e("h3",{class:"text-lg font-semibold text-text-primary"},"Recent activity"),e("p",{class:"text-sm text-text-secondary mt-1"},"Stay up to date with what's happening across the project.")],-1)),e("div",je,[o[5]||(o[5]=e("div",{class:"text-xs font-semibold text-text-secondary mb-3"},"Today",-1)),(l(!0),i(k,null,S(G.value,t=>(l(),i("div",{key:t.id,class:"flex gap-3 pb-4 border-b border-border last:border-0"},[e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-medium flex-shrink-0",style:A({backgroundColor:t.userColor})},u(t.userInitials),5),e("div",Ae,[e("div",Oe,[e("span",Pe,u(t.user),1),e("span",De,u(t.action),1),e("a",Le,u(t.item),1),t.status?(l(),i("span",{key:0,class:T(["ml-2 px-2 py-0.5 rounded text-xs font-medium",z(t.status)])},u(t.status),3)):C("",!0)]),e("div",Re,u(t.time),1)])]))),128))])])])]))}}),Ne=N(Ve,[["__scopeId","data-v-7a377dc3"]]);export{Ne as default};
