const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CreateTaskModal-CLHvsSOn.js","assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-DYWAXxAd.js","assets/index-DkDAC3Va.js","assets/index-BMLa60ps.css","assets/ConfirmDeleteModal-DHWWnNdh.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Cj7hP43k.js","assets/SidePanel-BImeSGVA.js","assets/sidePanelStore-Dvr9tGsY.js","assets/SidePanel-CXc43vY9.css","assets/KanbanBoard-BW33x5UN.js","assets/vuedraggable.umd-ygNpMSOO.js","assets/_commonjsHelpers-_d1bhYXs.js","assets/DropMenu.vue_vue_type_script_setup_true_lang-sIHymcp_.js","assets/index-CD16Swx0.js","assets/KanbanBoard-BPQQrwQ8.css","assets/TableSearchCell-zk4oD_C_.js","assets/TableAssigneeCell-J8X9xX0O.js","assets/CalendarView-DwSj_f2u.js","assets/CalendarView-BkzIJC_N.css","assets/GanttChartView-FhdCeGfJ.js","assets/TimelineView-BC9bVCtm.js","assets/TimelineView-k1H_fj-O.css","assets/BaseTextField-DYlezkNB.js"])))=>i.map(i=>d[i]);
import{r as m,x as P,O as Tt,c as C,V as ct,d as pt,a as il,W as Ll,X as fs,m as v,g as e,l as Se,F as Y,i as b,G as Ce,E as Ne,o as d,t as S,U as Ml,N as dl,k as te,n as E,f as he,w as me,Y as ul,h as j,_ as Il,B as Ge,P as ss,M as Dl,Z as ol,y as ut,T as El,S as Al,Q as ms,$ as gs,a0 as bs,a1 as xs,a2 as ys,a3 as hs,J as rl,a4 as Ss,a5 as Cs,a6 as $s,u as Ts,a7 as Ds,a8 as Vs,a9 as Ls,aa as Ms,ab as Is,ac as we,ad as Es,ae as Ae,af as As,ag as Bs,ah as ye,ai as nl,A as Ns,aj as as,ak as zs,H as Be,al as ns,am as os,an as Ps,ao as Os,C as rs,z as Us,ap as is,aq as js}from"./index-DkDAC3Va.js";import{u as _s,a as Vl,b as qs,c as Hs,d as Rs,e as ds,f as Fs,g as Ws,h as Qs,i as Ks,j as Zs,k as Js,l as Gs}from"./CreateTaskModal.vue_vue_type_script_setup_true_lang-DYWAXxAd.js";import{_ as Xs}from"./BaseTextAreaField.vue_vue_type_script_setup_true_lang-7Cdtjmw-.js";import{_ as Ys}from"./SearchBar.vue_vue_type_script_setup_true_lang-C9ByG9b5.js";import{u as ks}from"./sidePanelStore-Dvr9tGsY.js";import{_ as ea}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Cj7hP43k.js";import{_ as ta}from"./TableView.vue_vue_type_script_setup_true_lang-CydDl_Mf.js";import{k as Rt}from"./MindElixir-Ch35iPok.js";import la from"./KanbanSkeleton-Cvw40GCw.js";import sa from"./KanbanTicket-Qq2Y9_RC.js";import{F as us}from"./fuse-Ch1WBRTM.js";import{l as aa}from"./lodash-CQYOKM_D.js";import{o as sl}from"./index-CD16Swx0.js";import"./DropMenu.vue_vue_type_script_setup_true_lang-sIHymcp_.js";import"./_commonjsHelpers-_d1bhYXs.js";const na="data:image/svg+xml,%3csvg%20width='60'%20height='46'%20viewBox='0%200%2060%2046'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M59.7443%2034.8967L50.5682%2025.7206C50.4457%2025.5984%2050.2897%2025.5152%2050.1199%2025.4816C49.9501%2025.4479%2049.7742%2025.4653%2049.6143%2025.5315C49.4544%2025.5976%2049.3176%2025.7097%2049.2213%2025.8535C49.125%2025.9973%2049.0734%2026.1664%2049.073%2026.3394V30.517H25.9775V40.5114H49.0755V44.689C49.0759%2044.8621%2049.1275%2045.0312%2049.2238%2045.175C49.3201%2045.3187%2049.4569%2045.4308%2049.6168%2045.497C49.7767%2045.5632%2049.9527%2045.5805%2050.1224%2045.5468C50.2922%2045.5132%2050.4482%2045.43%2050.5708%2045.3078L59.7468%2036.1318C59.9095%2035.9672%2060.0005%2035.7451%2060.0001%2035.5137C59.9996%2035.2823%2059.9076%2035.0605%2059.7443%2034.8967Z'%20fill='%23C6DBA9'/%3e%3cpath%20d='M32.3149%2030.5293C30.664%2031.5967%2028.7394%2032.1633%2026.7734%2032.1609V40.5237H34.7295C39.2829%2038.5638%2042.9649%2035.0102%2045.0851%2030.5293H32.3149Z'%20fill='url(%23paint0_linear_250_16424)'/%3e%3cpath%20d='M46.2209%2020.2832C46.2317%2015.0884%2044.2448%2010.0884%2040.6714%206.3179C37.0981%202.54738%2032.2119%200.295026%2027.024%200.0269855C21.8362%20-0.241055%2016.7439%201.49574%2012.801%204.87791C8.85809%208.26009%206.36647%2013.0287%205.84178%2018.1969L2.46233%2017.8913C2.31055%2017.8782%202.15829%2017.9103%202.02467%2017.9835C1.89106%2018.0566%201.78205%2018.1677%201.71134%2018.3026C1.64063%2018.4376%201.61138%2018.5904%201.62726%2018.7419C1.64313%2018.8934%201.70343%2019.0368%201.80058%2019.1542L9.51927%2028.406C9.79205%2028.7344%2010.277%2028.7773%2010.378%2028.5045L19.6298%2020.7833C20.3876%2020.3413%2020.1173%2019.4825%2019.4328%2019.4194L15.8008%2019.091C16.0297%2017.1283%2016.8213%2015.2735%2018.0802%2013.7503C19.3391%2012.2271%2021.0115%2011.1004%2022.8961%2010.5059C24.7806%209.9114%2026.7969%209.8745%2028.7019%2010.3996C30.6069%2010.9248%2032.3195%2011.9896%2033.6332%2013.4657C34.947%2014.9419%2035.8059%2016.7664%2036.1065%2018.7195C36.4071%2020.6726%2036.1365%2022.6709%2035.3274%2024.4738C34.5183%2026.2766%2033.2051%2027.8071%2031.5462%2028.8807C29.8872%2029.9544%2027.9531%2030.5254%2025.977%2030.5251H25.9283V40.5094C31.2249%2040.4031%2036.7093%2038.2263%2040.4202%2034.4455C44.1311%2030.6648%2046.2134%2025.5808%2046.2209%2020.2832Z'%20fill='%23D7A39E'/%3e%3cpath%20d='M25.9773%2030.5293H0V40.5237H25.9773V30.5293Z'%20fill='url(%23paint1_linear_250_16424)'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_250_16424'%20x1='6.53714'%20y1='35.5252'%20x2='47.0198'%20y2='35.5252'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%236C798F'/%3e%3cstop%20offset='1'%20stop-color='%236C798F'%20stop-opacity='0.1'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_250_16424'%20x1='0'%20y1='36'%20x2='26'%20y2='36'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23E8D4D3'%20stop-opacity='0'/%3e%3cstop%20offset='1'%20stop-color='%23E2A39F'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",ws="jira-like:";function cs(O="id"){return`${O}_${Math.random().toString(36).slice(2,9)}`}function ps(O,N){try{localStorage.setItem(ws+O,JSON.stringify(N))}catch{}}function vs(O,N){try{const Z=localStorage.getItem(ws+O);return Z?JSON.parse(Z):N}catch{return N}}function oa(O){switch(O){case"Highest":return"rounded-md bg-red-50 px-2 py-0.5 text-xs text-red-700";case"High":return"rounded-md bg-orange-50 px-2 py-0.5 text-xs text-orange-700";case"Medium":return"rounded-md bg-amber-50 px-2 py-0.5 text-xs text-amber-700";case"Low":return"rounded-md bg-gray-100 px-2 py-0.5 text-xs text-gray-600"}}function ra(){const O=m(vs("backlog",[])),N=m(vs("sprints",[]));if(N.value.length===0)N.value.push({id:cs("sprint"),name:"Sprint 1",goal:"",start:"",end:"",started:!1,tickets:[]});else if(N.value.length>1){for(let f=1;f<N.value.length;f++)O.value.push(...N.value[f].tickets);N.value=[N.value[0]]}const Z=m(N.value[0].id);P([O,N],()=>{ps("backlog",O.value),ps("sprints",N.value)},{deep:!0});const $=m([]),U=Tt({}),H=C(()=>O.value.length>0&&$.value.length===O.value.length),u=f=>{var o;const g=N.value.find(s=>s.id===f);return!!g&&g.tickets.length>0&&(((o=U[f])==null?void 0:o.length)||0)===g.tickets.length};function z(f,g,o){const s=g.target.checked;if(f==="backlog")$.value=s?O.value.map(p=>p.id):[];else if(o){const p=N.value.find(k=>k.id===o);U[o]=s&&p?p.tickets.map(k=>k.id):[]}}function R(f,g,o,s){const p=o.target.checked,k=f==="backlog"?$.value:U[s]||(U[s]=[]);if(p&&!k.includes(g)&&k.push(g),!p){const ee=k.indexOf(g);ee>=0&&k.splice(ee,1)}}function L(){return N.value.find(f=>f.id===Z.value)||N.value[0]}function A(){const g=[...O.value,...N.value.flatMap(s=>s.tickets)].map(s=>Number(String(s.key).replace(/[^0-9]/g,""))).filter(s=>!Number.isNaN(s));return`PRJ-${g.length?Math.max(...g)+1:1}`}const{mutate:ne}=_s({onSuccess:()=>{ct.success("Cards moved to sprint successfully")},onError:f=>{ct.error("Failed to move cards: "+(f.message||"Unknown error"))}});function oe(){var s,p;const f=L();if(!f||!$.value.length)return;const g=[],o=[];for(const k of O.value)($.value.includes(k.id)?o:g).push(k);O.value=g,f.tickets.push(...o),$.value=[],o.length>0&&ne({id:f.id,payload:{card_ids:o.map(k=>k.id),priority:((p=(s=o[0])==null?void 0:s.priority)==null?void 0:p.toLowerCase())||"medium",story_points:o.reduce((k,ee)=>k+(ee.storyPoints||0),0)}})}function q(f){const g=N.value.find(k=>k.id===f);if(!g)return;const o=U[f]||[],s=[],p=[];for(const k of g.tickets)(o.includes(k.id)?p:s).push(k);g.tickets=s,O.value.push(...p),U[f]=[]}function M(f,g){if(f==="backlog")O.value=O.value.filter(o=>!$.value.includes(o.id)),$.value=[];else if(g){const o=U[g]||[],s=N.value.find(p=>p.id===g);if(!s)return;s.tickets=s.tickets.filter(p=>!o.includes(p.id)),U[g]=[]}}function J(f,g){const o={id:cs("T"),key:A(),createdAt:new Date().toISOString(),...g};if(f==="backlog")O.value.push(o);else{const s=L();s==null||s.tickets.push(o)}}function Q(f){const g=L();g&&(g.name=f.name??g.name,g.goal=f.goal??g.goal,g.start=f.start??g.start,g.end=f.end??g.end)}function I(){const f=L();f&&(f.started=!f.started)}function F(f){return f.tickets.reduce((g,o)=>g+(o.storyPoints||0),0)}return{backlog:O,sprints:N,activeSprintId:Z,selectedBacklogIds:$,selectedSprintIds:U,allBacklogChecked:H,allSprintChecked:u,toggleAll:z,toggleOne:R,getActiveSprint:L,createTicket:J,saveSprintMeta:Q,toggleStartSprint:I,sprintPoints:F,moveSelectedToSprint:oe,moveSelectedToBacklog:q,deleteSelected:M,priorityClass:oa}}const ia={class:"h-full min-h-0 mt-2"},da={key:0,class:"empty-state flex flex-col justify-center items-center h-full"},ua=["disabled"],ca={key:1,class:"overflow-y-auto h-[calc(100%-50px)] tickets-scroll mt-2"},pa={class:"flex flex-col flex-1 gap-[4px] min-w-0 me-1"},va={key:0,class:"flex items-center justify-center py-10"},fa=["onDragstart","onClick"],ma=["checked","onChange"],ga={class:"flex items-center text-[14px] font-sans font-medium capitalize text-text-secondary flex-1 min-w-0"},ba={class:"truncate"},xa={class:"flex-shrink-0"},ya={key:0,class:"flex justify-center text-gray-500 items-center text-[11px] aspect-square w-[24px] h-[24px] bg-bg-body rounded-full border-border-input border-2"},ha={key:1,class:"w-6 h-6 rounded-full"},_a=["src"],ka={key:2,class:"text-[11px] aspect-square w-[24px] h-[24px] flex justify-center items-center bg-accent/30 text-accent border-accent border rounded-full"},wa=pt({__name:"BacklogTable",props:{searchQuery:{type:String,default:""},sprintType:{type:String,default:""},checkedAll:{type:Boolean,default:!1},moduleId:{type:String,default:""}},emits:["ticket-dragged-to-sprint","open-ticket","ticket-moved-to-backlog","open-create-ticket"],setup(O,{emit:N}){const{isDark:Z}=il(),{canCreateCard:$}=Ll(),U=N,H=O,{workspaceId:u}=fs(),z=m(H.moduleId??null),{data:R,isPending:L}=Vl(u,H.sprintType,z,!1),A=m([]),ne=m(!1),oe=m([]),q=m([]);P(R,o=>{o!=null&&o.cards&&(A.value=o.cards.map(s=>{var y,B,_e,K,re,$e;const p=((y=s.card)==null?void 0:y.variables)??{},k=((B=s.card)==null?void 0:B._id)??s.card_id,ee=String(p["card-status"]??"").trim(),le=String(p.priority??"").trim();return{id:k,_id:(_e=s.card)==null?void 0:_e._id,key:p["card-code"]||(k==null?void 0:k.slice(-6))||"PRJ-?",summary:p["card-title"]||"(untitled)",type:"Story",status:ee,assignee:((K=s.card)==null?void 0:K.assigned_to)??"Unassigned",storyPoints:Number(s.story_points??0)||0,priority:J(le),createdAt:((re=s.card)==null?void 0:re.created_at)??new Date().toISOString(),description:p["card-description"]||"",image:($e=s.card)==null?void 0:$e.assigned_to}}))},{immediate:!0}),P(A,o=>{const s=new Set(o.map(p=>p.id));q.value=q.value.filter(p=>s.has(p))});const M=C(()=>{if(!H.searchQuery)return A.value;const o=H.searchQuery.toLowerCase();return A.value.filter(s=>{var k;const p=typeof s.assignee=="string"?s.assignee:((k=s.assignee)==null?void 0:k.u_full_name)||"";return s.key.toLowerCase().includes(o)||s.summary.toLowerCase().includes(o)||p.toLowerCase().includes(o)})});function J(o){const s=String(o??"").toLowerCase();return["highest","blocker","critical"].includes(s)?"Highest":["high","major"].includes(s)?"High":["medium","normal"].includes(s)?"Medium":"Low"}function Q(o,s,p){var y;const k=q.value.includes(s.id)?[...q.value]:[s.id],ee=k.map(B=>A.value.find(_e=>_e.id===B)).filter(Boolean);oe.value=k;const le=JSON.stringify({id:s.id,ids:k,from:p,tickets:ee});(y=o.dataTransfer)==null||y.setData("text/plain",le),o.dataTransfer&&(o.dataTransfer.effectAllowed="move")}function I(o){var s;ne.value=!1,((s=o.dataTransfer)==null?void 0:s.dropEffect)!=="none"&&oe.value.length&&(A.value=A.value.filter(p=>!oe.value.includes(p.id)),q.value=q.value.filter(p=>!oe.value.includes(p))),oe.value=[]}function F(o){var s;o.preventDefault(),ne.value=!1;try{const p=(s=o.dataTransfer)==null?void 0:s.getData("text/plain");if(!p)return;const k=JSON.parse(p);if(k.from!=="sprint")return;const le=(k.tickets&&k.tickets.length?k.tickets:k.ticket?[k.ticket]:[]).filter(Boolean).filter(B=>!A.value.some(_e=>_e.id===B.id));le.length&&A.value.push(...le);const y=k.ids&&k.ids.length?k.ids:k.id?[k.id]:[];y.length&&U("ticket-moved-to-backlog",y,k.sprintId),console.log(k.sprintId,"sprintId ....")}catch(p){console.error("Drop error:",p)}}function f(o,s){s?q.value.includes(o)||q.value.push(o):q.value=q.value.filter(p=>p!==o)}function g(o,s){const p=s.target.checked;f(o,p)}return P(()=>H.checkedAll,o=>{o?(q.value=A.value.map(s=>s.id),console.log(q.value)):q.value=[]}),(o,s)=>(d(),v("section",ia,[e("div",{class:Y(["rounded-lg flex flex-col h-full",ne.value?"ring-2 ring-blue-400":""]),onDragover:s[3]||(s[3]=Se(()=>{},["prevent"])),onDragenter:s[4]||(s[4]=p=>ne.value=!0),onDragleave:s[5]||(s[5]=p=>ne.value=!1),onDrop:s[6]||(s[6]=p=>F(p))},[!b(L)&&M.value.length===0?(d(),v("div",da,[s[7]||(s[7]=e("img",{src:na,class:"mb-4",alt:"backlog-plan"},null,-1)),s[8]||(s[8]=e("h6",{class:"text-sm text-text-primary font-semibold mb-1"}," Get started in the backlog ",-1)),s[9]||(s[9]=e("p",{class:"text-sm text-text-primary/90 mb-4"}," Plan and start a sprint to see issues here. ",-1)),e("button",{disabled:!b($),onClick:s[0]||(s[0]=p=>o.$emit("open-create-ticket")),class:Y(["relative inline-flex items-center justify-center font-medium py-1.5 px-3 text-sm rounded-md focus:outline-none transition h-[34px] bg-accent text-white hover:bg-accent-hover border-border-input border",b($)?"cursor-pointer":"cursor-not-allowed"])}," Create Ticket ",10,ua)])):(d(),v("div",ca,[e("div",pa,[b(L)?(d(),v("div",va,s[10]||(s[10]=[e("div",{role:"status","aria-label":"Loading",class:"h-10 w-10 rounded-full border-4 border-accent border-t-transparent animate-spin"},null,-1)]))):(d(!0),v(Ce,{key:1},Ne(M.value,p=>{var k,ee;return d(),v("div",{key:p.id,draggable:"true",class:Y(["flex items-center gap-3 p-[8px] cursor-pointer transition-colors rounded-[8px]",q.value.includes(p.id)?"border-2 border-[#5a2d7f]":"border border-border-input",b(Z)?"bg-bg-body hover:bg-bg-surface":"bg-bg-charcoal hover:bg-bg-body"]),onDragstart:le=>Q(le,p,"backlog"),onDragend:s[2]||(s[2]=le=>I(le)),onClick:le=>o.$emit("open-ticket",p)},[e("input",{type:"checkbox",class:"custom-checkbox bg-bg-body border border-border-input flex-shrink-0",checked:q.value.includes(p.id),onClick:s[1]||(s[1]=Se(()=>{},["stop"])),onChange:le=>g(p.id,le)},null,40,ma),e("div",ga,[e("span",ba,S(p.summary),1)]),e("div",xa,[(p==null?void 0:p.assignee)==="Unassigned"?(d(),v("span",ya," UA ")):(k=p==null?void 0:p.assignee)!=null&&k.u_profile_image?(d(),v("div",ha,[e("img",{src:p.assignee.u_profile_image,alt:"",class:"rounded-full"},null,8,_a)])):(d(),v("span",ka,S(b(Ml)((ee=p==null?void 0:p.assignee)==null?void 0:ee.u_full_name)),1))])],42,fa)}),128))])]))],34)]))}}),Sa=dl(wa,[["__scopeId","data-v-d1e7ec11"]]),Ca="data:image/svg+xml,%3csvg%20width='60'%20height='60'%20viewBox='0%200%2060%2060'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M9.375%2030C11.6402%2030%2013.4766%2028.1637%2013.4766%2025.8984C13.4766%2023.6332%2011.6402%2021.7969%209.375%2021.7969C7.10977%2021.7969%205.27344%2023.6332%205.27344%2025.8984C5.27344%2028.1637%207.10977%2030%209.375%2030Z'%20fill='%23AE2A19'/%3e%3cpath%20d='M26.25%2024.375C28.5152%2024.375%2030.3516%2022.5387%2030.3516%2020.2734C30.3516%2018.0082%2028.5152%2016.1719%2026.25%2016.1719C23.9848%2016.1719%2022.1484%2018.0082%2022.1484%2020.2734C22.1484%2022.5387%2023.9848%2024.375%2026.25%2024.375Z'%20fill='%23BF63F3'/%3e%3cpath%20d='M15.3931%2035.8594H11.0159V33.0938C9.93587%2033.3387%208.81469%2033.3387%207.73465%2033.0938V35.8594H1.87528C1.55115%2035.8601%201.2345%2035.9568%200.965283%2036.1373C0.696064%2036.3178%200.486343%2036.574%200.362583%2036.8736C0.238824%2037.1731%200.206573%2037.5027%200.269899%2037.8205C0.333226%2038.1384%200.489292%2038.4304%200.718404%2038.6597L7.05872%2045L0.718404%2051.3403C0.489292%2051.5696%200.333226%2051.8616%200.269899%2052.1795C0.206573%2052.4973%200.238824%2052.8269%200.362583%2053.1264C0.486343%2053.426%200.696064%2053.6822%200.965283%2053.8627C1.2345%2054.0432%201.55115%2054.1399%201.87528%2054.1406H15.3931L21.7503%2045L15.3931%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M34.4562%2035.8594H27.8937V27.4688C26.8137%2027.7138%2025.6925%2027.7138%2024.6125%2027.4688V35.8594H19.3896L25.7487%2045L19.3896%2054.1406H34.4562L40.8143%2045L34.4562%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M43.8281%2019.6875H55.3125C55.7475%2019.6873%2056.1647%2019.5143%2056.4723%2019.2067C56.7799%2018.8991%2056.9529%2018.4819%2056.9531%2018.0469V9.375C56.9529%208.93996%2056.7799%208.5228%2056.4723%208.21518C56.1647%207.90755%2055.7475%207.73462%2055.3125%207.73438H43.8281V7.5C43.8281%207.06488%2043.6553%206.64758%2043.3476%206.3399C43.0399%206.03223%2042.6226%205.85938%2042.1875%205.85938C41.7524%205.85938%2041.3351%206.03223%2041.0274%206.3399C40.7197%206.64758%2040.5469%207.06488%2040.5469%207.5V32.5781H43.8281V19.6875Z'%20fill='%23FCA700'/%3e%3cpath%20d='M59.2843%2043.8403L51.7843%2036.3403C51.6322%2036.1878%2051.4514%2036.0668%2051.2524%2035.9842C51.0534%2035.9017%2050.8401%2035.8593%2050.6246%2035.8594H38.4521L44.8121%2045L38.4531%2054.1406H50.6246C50.8401%2054.1407%2051.0534%2054.0983%2051.2524%2054.0158C51.4514%2053.9332%2051.6322%2053.8122%2051.7843%2053.6597L59.2843%2046.1597C59.4368%2046.0075%2059.5577%2045.8267%2059.6402%2045.6277C59.7228%2045.4287%2059.7652%2045.2154%2059.7652%2045C59.7652%2044.7846%2059.7228%2044.5713%2059.6402%2044.3723C59.5577%2044.1733%2059.4368%2043.9925%2059.2843%2043.8403Z'%20fill='%2382B536'/%3e%3c/g%3e%3c/svg%3e",$a={class:"h-full min-h-0 px-2"},Ta={key:0,class:"overflow-y-auto h-[calc(100%-50px)] tickets-scroll"},Da={class:"flex flex-col flex-1 gap-[4px] min-w-0 me-1"},Va=["onDragstart","onClick"],La=["checked","onChange"],Ma={class:"flex items-center text-[14px] font-sans font-medium capitalize text-text-secondary flex-1 min-w-0"},Ia={class:"truncate"},Ea={class:"flex-shrink-0"},Aa={class:"flex-shrink-0"},Ba={key:0,class:"flex justify-center text-gray-500 items-center text-[11px] aspect-square w-[24px] h-[24px] bg-bg-body rounded-full border-border-input border-2"},Na={key:1,class:"w-6 h-6 rounded-full overflow-hidden"},za=["src"],Pa=["onMouseenter"],Oa={key:0,class:"hidden lg:block absolute top-full mt-1 right-1/2 translate-x-1/2 bg-bg-card text-text-primary text-xs px-2 py-1 rounded shadow whitespace-nowrap z-50"},Ua={key:1,class:"empty-state flex flex-col justify-center items-center border-dashed border-3 p-2 border-border h-[calc(100%-50px)] min-h-0"},ja={class:"text-sm text-text-primary font-semibold mb-1 text-center"},qa={class:"text-sm text-text-primary/90 mb-3 max-w-120 text-center"},Ha={class:"font-bold"},Ra=pt({__name:"SprintCard",props:{sprint:{},sprintId:{},searchQuery:{},checkedSprintAll:{type:Boolean},searchedData:{},label:{}},emits:["edit-sprint","toggle-start","open-ticket","move-selected-to-backlog","delete-selected-sprint","refresh","checked-change","selection-change"],setup(O,{emit:N}){const{isDark:Z}=il(),$=m(null),U=O,H=N,u=m([]),z=m([]);P(()=>U.sprint&&U.sprint.tickets,f=>{u.value=[...f||[]];const g=new Set(u.value.map(o=>o.id));z.value=z.value.filter(o=>g.has(o))},{immediate:!0,deep:!0}),P(z,f=>{H("checked-change",f.length>0),H("selection-change",f)},{deep:!0});const R=C(()=>{var g,o;if((g=U.searchedData)!=null&&g.length)return u.value.filter(s=>U.searchedData.some(p=>p.card_id===s.id));const f=((o=U.searchQuery)==null?void 0:o.toLowerCase())||"";return f?u.value.filter(s=>{var k;const p=((k=s.assignee)==null?void 0:k.u_full_name)??"";return s.key.toLowerCase().includes(f)||s.summary.toLowerCase().includes(f)||p.toLowerCase().includes(f)}):u.value}),L=m(!1),A=m([]),{mutate:ne}=_s({onSuccess:()=>{ct.success("Card moved to sprint successfully"),H("refresh")},onError:f=>{ct.error("Failed to move card: "+(f.message||"Unknown error"))}});function oe(f,g,o,s){var le;const p=z.value.includes(g.id)?[...z.value]:[g.id],k=p.map(y=>u.value.find(B=>B.id===y)).filter(Boolean);A.value=p;const ee=JSON.stringify({id:g.id,ids:p,from:o,sprintId:s,ticket:g,tickets:k});(le=f.dataTransfer)==null||le.setData("text/plain",ee),f.dataTransfer&&(f.dataTransfer.effectAllowed="move")}function q(f){var g;L.value=!1,((g=f.dataTransfer)==null?void 0:g.dropEffect)!=="none"&&A.value.length&&(u.value=u.value.filter(o=>!A.value.includes(o.id)),z.value=z.value.filter(o=>!A.value.includes(o))),A.value=[]}function M(){L.value=!0}function J(){L.value=!1}function Q(f){var g;f.preventDefault(),L.value=!1;try{const o=(g=f.dataTransfer)==null?void 0:g.getData("text/plain");if(!o)return;const s=JSON.parse(o);if(s.from!=="backlog")return;const k=(s.tickets&&s.tickets.length?s.tickets:s.ticket?[s.ticket]:[]).filter(Boolean).filter(ee=>!u.value.some(le=>le.id===ee.id));if(!k.length)return;u.value.push(...k),k.forEach(ee=>{ne({id:U.sprintId,payload:{card_ids:[ee.id],priority:(ee.priority||"Medium").toLowerCase(),story_points:ee.storyPoints||0}})})}catch(o){console.error("Drop error:",o)}}function I(f,g){g?z.value.includes(f)||z.value.push(f):z.value=z.value.filter(o=>o!==f)}function F(f,g){const o=g.target.checked;I(f,o)}return P(()=>U.checkedSprintAll,f=>{f?(z.value=R.value.map(g=>g.id),console.log(R.value)):z.value=[]}),(f,g)=>(d(),v("div",$a,[e("div",{class:Y([L.value?"ring-2 ring-blue-400 rounded-lg":"","h-full box-border mt-3"]),onDragover:g[3]||(g[3]=Se(()=>{},["prevent"])),onDragenter:M,onDragleave:J,onDrop:Q},[R.value.length>0&&f.sprint?(d(),v("div",Ta,[e("div",Da,[(d(!0),v(Ce,null,Ne(R.value,o=>(d(),v("div",{key:o.id,draggable:"true",class:Y(["flex items-center  gap-3 p-[8px] cursor-pointer transition-colors rounded-[8px]",z.value.includes(o.id)?"border-2 border-[#5a2d7f]":"border border-border-input",b(Z)?"bg-bg-body hover:bg-bg-surface":"bg-bg-charcoal hover:bg-bg-body"]),onDragstart:s=>oe(s,o,"sprint",f.sprint.id),onDragend:g[2]||(g[2]=s=>q(s)),onClick:s=>f.$emit("open-ticket",o)},[e("input",{type:"checkbox",class:Y(["custom-checkbox border border-border-input flex-shrink-0",b(Z)?"bg-bg-charcoal":"bg-bg-body "]),checked:z.value.includes(o.id),onClick:g[0]||(g[0]=Se(()=>{},["stop"])),onChange:s=>F(o.id,s)},null,42,La),e("div",Ma,[e("span",Ia,S(o.summary),1)]),e("div",Ea,[e("div",Aa,[(o==null?void 0:o.assignee)==="Unassigned"?(d(),v("span",Ba," UA ")):o.image?(d(),v("div",Na,[e("img",{src:o.image,alt:"",class:"w-full h-full object-cover"},null,8,za)])):(d(),v("span",{key:2,class:"relative text-[11px] aspect-square w-[24px] h-[24px] flex justify-center items-center bg-accent/30 text-accent border-accent border rounded-full cursor-default",onMouseenter:s=>{var p;return $.value=((p=o.assignee)==null?void 0:p.name)||o.assignee||""},onMouseleave:g[1]||(g[1]=s=>$.value=null)},[te(S(b(Ml)(o.assignee??""))+" ",1),$.value?(d(),v("div",Oa,S($.value),1)):E("",!0)],40,Pa))])])],42,Va))),128))])])):(d(),v("div",Ua,[g[7]||(g[7]=e("img",{src:Ca,class:"mb-4",alt:"backlog-plan"},null,-1)),e("h6",ja," Plan your "+S(f.label),1),e("p",qa,[g[4]||(g[4]=te(" Drag work items from the ")),g[5]||(g[5]=e("span",{class:"font-bold"},"Backlog",-1)),te(" section or create new ones to plan the work for this "+S(f.label)+". Select ",1),e("span",Ha,"Start "+S(f.label),1),g[6]||(g[6]=te(" when you're ready. "))])]))],34)]))}}),Fa=dl(Ra,[["__scopeId","data-v-383bcd0c"]]),Wa={class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-input pb-4"},Qa={class:"text-xl font-semibold"},Ka={class:"px-6 gap-4 bg-bg-input pt-5 pb-8"},Za={class:"mt-3"},Ja={class:"flex justify-end gap-2 p-6 sticky bottom-0 bg-bg-input border-t border-border"},Ga=pt({__name:"SprintModal",props:{modelValue:{type:Boolean,default:!1},lable:{},sprint:{},creatingSprint:{type:Boolean},sprints:{}},emits:["update:modelValue","save","close"],setup(O,{emit:N}){const Z=N,$=O,U=C(()=>$.lable?$.lable.charAt(0).toUpperCase()+$.lable.slice(1):""),H=C({get:()=>$.modelValue,set:Q=>Z("update:modelValue",Q)}),u=Tt({name:"",sprintType:"",description:""}),z=Tt({name:!1,sprintType:!1,description:!1}),R=C(()=>z.name&&!String(u.name||"").trim()?"Name is required":""),L=C(()=>!!String(u.name||"").trim()&&!R.value);function A(){H.value=!1,Z("close")}function ne(){z.name=!0,L.value&&Z("save",{name:String(u.name||"").trim(),value:String($.lable||"").trim(),description:String(u.description||"").trim()})}function oe(){z.name=!1,z.sprintType=!1,z.description=!1}P(()=>$.sprint,Q=>{if(!Q){u.name="",u.sprintType=null;return}u.name="",u.description="",u.sprintType=Q.sprintType??null,oe()},{immediate:!0});const q=[{title:"Milestone",_id:"milestone",dot:"#2e9bda"},{title:"Sprint",_id:"sprint",dot:"#7d68c8"},{title:"Huddle",_id:"huddle",dot:"#eea832"}],M=C(()=>q.map(Q=>({...Q})));P(()=>$.lable,Q=>{if(!Q)return;u.description="",u.sprintType="",oe();const I=M.value.find(F=>F.title===Q);u.sprintType=(I==null?void 0:I._id)??"",J()},{immediate:!0});function J(){const Q=$.sprints||[],I=$.lable,F=I.charAt(0).toUpperCase()+I.slice(1);u.name=`${F} ${Q.length+1}`}return P(()=>$.sprints,()=>{(!u.name||u.name.trim()==="")&&J()},{immediate:!0,deep:!0}),(Q,I)=>(d(),he(ul,{modelValue:H.value,"onUpdate:modelValue":I[3]||(I[3]=F=>H.value=F),modalClass:"!py-0",size:"md"},{default:me(()=>[e("div",Wa,[e("h2",Qa,"Add New "+S(U.value),1)]),e("div",Ka,[j(Il,{class:"rounded-1",modelValue:u.name,"onUpdate:modelValue":I[0]||(I[0]=F=>u.name=F),label:"Name",placeholder:Q.lable,error:!!R.value,message:R.value,onBlur:I[1]||(I[1]=F=>z.name=!0)},null,8,["modelValue","placeholder","error","message"]),e("div",Za,[j(Xs,{modelValue:u.description,"onUpdate:modelValue":I[2]||(I[2]=F=>u.description=F),label:"Description",placeholder:`${U.value} description...`,type:"textarea",rows:4},null,8,["modelValue","placeholder"])]),I[4]||(I[4]=e("div",null,null,-1))]),e("div",Ja,[j(Ge,{variant:"secondary",onClick:A},{default:me(()=>I[5]||(I[5]=[te("Cancel")])),_:1,__:[5]}),j(Ge,{variant:"primary",disabled:!L.value,onClick:ne},{default:me(()=>[te(S(Q.creatingSprint?"Saving...":"Save"),1)]),_:1},8,["disabled"])])]),_:1},8,["modelValue"]))}}),Xa="/assets/filter-JX25xO5j.svg",Ya={class:"p-5"},en={class:"flex items-start gap-3"},tn={class:"flex-1 min-w-0"},ln={class:"mt-1 text-sm text-muted"},sn={key:0,class:"mt-4"},an={class:"mt-6 flex justify-end gap-2"},nn=["disabled"],on=["disabled"],rn={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},dn="This action cannot be undone. This Ticket will be permanently deleted.",un=pt({__name:"confirmDeleteTicket",props:{modelValue:{type:Boolean},title:{default:"Delete item"},itemLabel:{},itemName:{},message:{},confirmText:{default:"Delete"},cancelText:{default:"Cancel"},requireMatchText:{},loading:{type:Boolean,default:!1},size:{default:"md"},modalClass:{default:""}},emits:["update:modelValue","confirm","cancel"],setup(O,{emit:N}){const Z=O,$=N,U=C({get:()=>Z.modelValue,set:L=>$("update:modelValue",L)}),H=m(""),u=C(()=>`!py-0 bg-card text-body ${Z.modalClass}`.trim());function z(){H.value="",$("cancel"),U.value=!1}function R(){Z.loading||($("confirm"),H.value="")}return(L,A)=>(d(),he(ul,{modelValue:U.value,"onUpdate:modelValue":A[0]||(A[0]=ne=>U.value=ne),size:L.size,modalClass:u.value},{default:me(()=>[e("div",Ya,[e("div",en,[A[2]||(A[2]=e("div",{class:"h-10 w-10 rounded-full bg-red-100 text-red-600 grid place-items-center dark:bg-red-500/15"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M9 3h6a1 1 0 0 1 1 1v1h4a1 1 0 1 1 0 2h-1.077l-1.27 12.03A3 3 0 0 1 14.67 22H9.33a3 3 0 0 1-2.982-2.97L5.077 7H4a1 1 0 1 1 0-2h4V4a1 1 0 0 1 1-1Zm2 0v1h2V3h-2ZM7.08 7l1.2 11.37A1 1 0 0 0 9.33 20h5.34a1 1 0 0 0 1.05-.88L16.92 7H7.08ZM10 9a1 1 0 0 1 1 1v7a1 1 0 1 1-2 0v-7a1 1 0 0 1 1-1Zm4 0a1 1 0 0 1 1 1v7a1 1 0 1 1-2 0v-7a1 1 0 0 1 1-1Z"})])],-1)),e("div",tn,[A[1]||(A[1]=e("h3",{class:"text-base font-semibold text-text-primary"}," Do you want to Delete This Ticket? ",-1)),e("p",ln,[ss(L.$slots,"message",{},()=>[te(S(dn))])]),L.$slots.extra?(d(),v("div",sn,[ss(L.$slots,"extra")])):E("",!0)])]),e("div",an,[e("button",{type:"button",class:"px-3 py-2 cursor-pointer text-sm rounded-md border border-ui bg-card text-body hover:bg-surface-2 disabled:opacity-50",disabled:L.loading,onClick:Se(z,["stop"])},S(L.cancelText),9,nn),e("button",{type:"button",class:"px-3 py-2 text-sm rounded-md text-white bg-red-600 hover:bg-red-700 disabled:opacity-50 flex items-center gap-2",disabled:L.loading,onClick:R},[L.loading?(d(),v("svg",rn,A[3]||(A[3]=[e("circle",{cx:"12",cy:"12",r:"10","stroke-width":"4",class:"opacity-25"},null,-1),e("path",{d:"M4 12a8 8 0 0 1 8-8","stroke-width":"4",class:"opacity-75"},null,-1)]))):E("",!0),te(" "+S(L.confirmText),1)],8,on)])])]),_:3},8,["modelValue","size","modalClass"]))}}),cn={class:"sticky top-0 z-10 flex justify-between items-center py-6 px-6 border-b border-border bg-bg-input"},pn={class:"text-xl font-semibold"},vn={class:"px-6 grid grid-cols-2 gap-4 bg-bg-input pt-5"},fn={class:"flex flex-col col-span-2"},mn={class:"flex flex-col col-span-2"},gn={class:"flex gap-1 flex-col col-span-2 sm:col-span-1"},bn={key:0,class:"text-xs text-red-500"},xn={class:"flex gap-1 flex-col col-span-2 sm:col-span-1"},yn={key:0,class:"text-xs text-red-500"},hn={class:"flex flex-col col-span-2"},_n={class:"flex flex-col col-span-2"},kn={class:"bg-bg-body wfull px-4 py-3 rounded-lg text-xs text-text-secondary"},wn={class:"flex justify-end gap-2 p-6 sticky bottom-0 bg-bg-input"},Sn=pt({__name:"StartSprintModal",props:{modelValue:{type:Boolean,default:!1},sprint:{},creatingSprint:{type:Boolean},sprintType:{}},emits:["update:modelValue","save","close"],setup(O,{emit:N}){const Z=N,$=O,U=[{_id:1,title:"1 Week"},{_id:2,title:"2 Weeks"},{_id:3,title:"3 Weeks"},{_id:4,title:"4 Weeks"},{_id:5,title:"Custom"}],H=C({get:()=>$.modelValue,set:o=>Z("update:modelValue",o)}),u=Tt({goal:"",start:new Date().toISOString().slice(0,10),end:"",sprint_name:"",duration:null}),z=C(()=>$.sprintType?$.sprintType.charAt(0).toUpperCase()+$.sprintType.slice(1):""),R=Tt({start:!1,end:!1}),L=C(()=>!u.start&&R.start?"Start date is required":""),A=C(()=>{if(!u.end&&R.end)return"End date is required";if(u.start&&u.end){const o=I(u.start),s=I(u.end);if(Number.isFinite(o)&&Number.isFinite(s)&&s<o)return"End date cannot be before start date"}return""}),ne=C(()=>!L.value&&!A.value);function oe(o){u.start=o||"",R.start=!0}function q(o){u.end=o||"",R.end=!0}function M(){H.value=!1,u.duration=null,Z("close")}function J(){R.start=!0,R.end=!0,ne.value&&(Z("save",{title:u.sprint_name||"new sprint",duration:String(g.value)||null,start:u.start||"",end:u.end||"",goal:u.goal??""}),u.duration=null)}function Q(){R.start=!1,R.end=!1}function I(o){return o?new Date(`${o}T00:00:00`).getTime():NaN}const F=C(()=>u.duration===5);P(()=>u.duration,o=>{if(!o)return;const s=typeof o=="object"?o._id:o;if(s!==5&&u.start){const p=f(u.start,s*7);u.end=p}}),P(()=>u.start,o=>{o&&(u.duration&&u.duration!==5&&(u.end=f(u.start,u.duration*7)),u.end&&I(u.end)<I(u.start)&&(u.end=u.start))});function f(o,s){const p=new Date(o);return p.setDate(p.getDate()+s),p.toISOString().slice(0,10)}const g=C(()=>!u.start||!u.end?0:u.duration!==5?u.duration*7:(I(u.end)-I(u.start))/864e5);return P(()=>$.sprint,o=>{if(!o){u.start=new Date().toISOString().slice(0,10),u.end="",u.sprint_name="",u.goal="",Q();return}u.goal=o.goal??"",u.start=o.start??new Date().toISOString().slice(0,10),u.end=o.end??"",u.sprint_name=o.title??"",Q()},{immediate:!0}),(o,s)=>(d(),he(ul,{modelValue:H.value,"onUpdate:modelValue":s[3]||(s[3]=p=>H.value=p),modalClass:"!py-0",size:"md"},{default:me(()=>[e("div",cn,[e("h2",pn,"Start "+S(o.sprintType),1),e("span",{onClick:M,class:"text-sm text-text-secondary cursor-pointer"},s[4]||(s[4]=[e("i",{class:"fa-solid fa-xmark text-text-primary text-[19px]"},null,-1)]))]),e("div",vn,[e("div",fn,[j(Il,{modelValue:u.sprint_name,"onUpdate:modelValue":s[0]||(s[0]=p=>u.sprint_name=p),label:`${z.value} Name`,placeholder:`Enter ${o.sprintType} name`,size:"md",class:"rounded-1"},null,8,["modelValue","label","placeholder"])]),e("div",mn,[j(Dl,{modelValue:u.duration,"onUpdate:modelValue":s[1]||(s[1]=p=>u.duration=p),options:U,label:"Duration",placeholder:"Select duration"},null,8,["modelValue"])]),e("div",gn,[s[6]||(s[6]=e("label",{class:"text-sm font-medium"},"Start date",-1)),e("div",{class:Y(["border relative flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",L.value?"border-red-500":""])},[j(ol,{placeholder:"Set start date",class:"w-full z-1","model-value":u.start,"emit-as":"ymd","onUpdate:modelValue":oe},null,8,["model-value"]),s[5]||(s[5]=e("i",{class:"fa-regular fa-calendar absolute right-2 top-3 z-0"},null,-1))],2),L.value?(d(),v("p",bn,S(L.value),1)):E("",!0)]),e("div",xn,[s[7]||(s[7]=e("label",{class:"text-sm font-medium"},"End date",-1)),e("div",{class:Y(["border relative flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",A.value?"border-red-500":""])},[j(ol,{placeholder:"Set end date",class:"w-full","model-value":u.end,"emit-as":"ymd",disabled:!F.value,"onUpdate:modelValue":q,"min-date":u.start},null,8,["model-value","disabled","min-date"]),e("i",{class:Y(["fa-regular fa-calendar absolute right-2 top-3 z-0",{"text-text-secondary/30 pointer-events-none":!F.value,"text-text-primary":F.value}])},null,2)],2),A.value?(d(),v("p",yn,S(A.value),1)):E("",!0)]),e("div",hn,[s[8]||(s[8]=e("label",{class:"text-sm font-medium pb-1"},"Goal (optional)",-1)),ut(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=p=>u.goal=p),class:"w-full text-sm rounded-md border border-border px-3 py-2 bg-bg-input",rows:"2",placeholder:"Ship onboarding flow"},null,512),[[El,u.goal]])]),e("div",_n,[e("p",kn," Duration: "+S(u.start?g.value+" days":""),1)])]),e("div",wn,[j(Ge,{variant:"secondary",onClick:M},{default:me(()=>s[9]||(s[9]=[te("Cancel")])),_:1,__:[9]}),j(Ge,{variant:"primary",disabled:!ne.value,onClick:J},{default:me(()=>[te(S(o.creatingSprint?"Starting...":"Start"),1)]),_:1},8,["disabled"])])]),_:1},8,["modelValue"]))}}),Cn={class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-body pb-4 mb-4"},$n={class:"w-full flex items-start justify-between"},Tn={class:"text-sm text-text-secondary mt-1"},Dn={class:"flex items-center gap-2 mt-4 w-full"},Vn={class:"flex items-center gap-2 flex-1"},Ln={class:"px-6 min-h-[400px]"},Mn={key:0},In={key:0,class:"flex items-center justify-center py-12"},En={key:1,class:"text-center py-12 text-text-secondary"},An={key:2,class:"grid grid-cols-2 gap-3"},Bn=["onClick"],Nn={class:"flex items-center gap-3"},zn={class:"w-10 h-10 rounded-lg bg-bg-input flex items-center justify-center group-hover:bg-primary/10 transition-colors"},Pn={class:"font-medium"},On={key:1},Un={key:0,class:"flex items-center justify-center py-12"},jn={key:1,class:"text-center py-12 text-text-secondary"},qn={key:2,class:"grid grid-cols-2 gap-3"},Hn=["onClick"],Rn={class:"flex items-center gap-3"},Fn={class:"w-10 h-10 rounded-lg bg-bg-input flex items-center justify-center group-hover:bg-primary/10 transition-colors"},Wn={class:"font-medium"},Qn={key:2},Kn={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Zn={key:0,class:"flex flex-col"},Jn={class:"flex gap-1 flex-col"},Gn={key:0,class:"text-xs text-red-500"},Xn={class:"flex gap-1 flex-col"},Yn={key:0,class:"text-xs text-red-500"},eo={class:"flex flex-col gap-1"},to={class:"mt-2"},lo={class:"mt-4"},so={class:"flex justify-between gap-2 p-6 mt-8 sticky bottom-0 bg-bg-body border-t border-border"},ao={key:1},no={class:"flex gap-2"},oo=pt({__name:"CreateBacklogTicketWithModuleSelection",props:{modelValue:{type:Boolean,default:!1},listId:{},selectedVariable:{}},emits:["update:modelValue","created"],setup(O,{emit:N}){const Z=N,$=O,U=Al(),{workspaceId:H}=ms(),u=m(1),z=m(null),R=m(null),L=m(""),{data:A,isLoading:ne}=gs(H.value),oe=C(()=>{var w;return((w=A.value)==null?void 0:w.modules)||[]}),q=ks(),{data:M,isFetching:J,refetch:Q}=bs({workspace_module_id:L,workspace_id:H},{enabled:C(()=>!!L)});P(()=>z.value,()=>{Q()});const I=C(()=>M.value||[]),{data:F}=xs(H.value);P(z,w=>{L.value=w??""});const{data:f}=ys(H,L,m("")),{mutate:g,isPending:o}=hs({onSuccess:()=>{Te(),U.invalidateQueries({queryKey:["backlog-list"]}),s.value=!1}}),s=C({get:()=>$.modelValue,set:w=>Z("update:modelValue",w)}),p=C(()=>{switch(u.value){case 1:return"Select a module to create the ticket in";case 2:return"Select a sheet within the module";case 3:return"Provide the ticket details below and click Add Ticket";default:return""}}),k=C(()=>{var w,h;return(h=((w=f==null?void 0:f.value)==null?void 0:w.variables)??[])==null?void 0:h.filter(x=>{var de;return((de=x==null?void 0:x.type)==null?void 0:de.title)==="Select"&&(x==null?void 0:x.slug)!=="process"})}),ee=C(()=>{const w=((F==null?void 0:F.value)??[]).map(h=>{var x;return{_id:h._id,title:((x=h==null?void 0:h.variables)==null?void 0:x["lane-title"])??String(h._id)}});return w.find(h=>h.title==="Main")||w.unshift({_id:"main",title:"Main"}),w}),le=w=>w.slug,y=Tt({title:"",description:"",startDate:null,endDate:null,lane_id:null,assignee:null,variables:{}});P(k,w=>{for(const h of w){const x=le(h);x in y.variables||(y.variables[x]=null)}},{immediate:!0}),P([ee,s],([w,h])=>{if(h&&!y.lane_id){const x=w.find(de=>de.title==="Main");x&&(y.lane_id=x._id)}},{immediate:!0});const B=Tt({title:!1,description:!1,startDate:!1,endDate:!1,lane:!1}),_e=C(()=>!!y.title.trim()&&!!y.lane_id&&!!y.startDate&&!!y.endDate&&!ft.value&&!Re.value&&!Fe.value&&!xe.value);function K(w){y.startDate=w,B.startDate=!0}function re(w){y.endDate=w,B.endDate=!0}function $e(w){y.lane_id=w,B.lane=!0}function Oe(w){y.assignee=w}function Dt(w){z.value=w._id,u.value=2}function Ie(w){R.value=w._id,u.value=3}function Bt(){u.value>1&&u.value--}function Xe(){s.value=!1,Te()}function Te(){u.value=1,z.value=null,R.value=null,y.title="",y.description="",y.startDate=null,y.endDate=null,y.lane_id=null,y.assignee=null,y.variables={},B.title=!1,B.description=!1,B.startDate=!1,B.endDate=!1,B.lane=!1,localStorage.removeItem("sprintType"),localStorage.removeItem("activeMilestoneId")}const vt=C(()=>{var w,h;return(h=(w=f==null?void 0:f.value)==null?void 0:w.variables)==null?void 0:h.find(x=>(x==null?void 0:x._id)==$.selectedVariable)}),ft=C(()=>B.title&&!y.title.trim()?"Title is required":""),Re=C(()=>B.startDate?y.startDate?"":"Start date is required":""),Fe=C(()=>B.endDate?y.endDate?y.startDate&&y.endDate&&y.endDate<y.startDate?"End date cannot be before start date":"":"End date is required":""),xe=C(()=>B.lane?y.lane_id?"":"Lane is required":""),Ye=new Date().toISOString().split("T")[0];function Vt(){var h,x;if(B.title=!0,B.lane=!0,B.description=!0,B.startDate=!0,B.endDate=!0,!_e.value||o.value)return;const w={sheet_list_id:$.listId,workspace_id:H.value,sheet_id:R.value,...y.lane_id&&y.lane_id!=="main"?{workspace_lane_id:y.lane_id}:{},variables:{...y.variables,[`${(h=vt.value)==null?void 0:h.slug}`]:$.listId,"card-title":y.title.trim(),"card-description":y.description.trim(),"start-date":y.startDate,"end-date":y.endDate},seat_id:((x=y.assignee)==null?void 0:x._id)??null,sprint_id:q.selectedMilestoneId||localStorage.getItem("activeMilestoneId")||null,createdAt:new Date().toISOString()};g(w)}return P(()=>y.title,w=>{w!=null&&w.trim()&&B.title&&(B.title=!1)}),P(()=>y.lane_id,w=>{w&&B.lane&&(B.lane=!1)}),P(()=>y.startDate,w=>{w&&B.startDate&&(B.startDate=!1)}),P(()=>y.endDate,w=>{w&&B.endDate&&(B.endDate=!1)}),P(()=>y.description,w=>{w!=null&&w.trim()&&B.description&&(B.description=!1)}),(w,h)=>(d(),he(ul,{modelValue:s.value,"onUpdate:modelValue":h[5]||(h[5]=x=>s.value=x),modalClass:"!py-0",size:"lg"},{default:me(()=>[e("div",Cn,[e("div",$n,[e("div",null,[h[6]||(h[6]=e("h2",{class:"text-xl font-semibold"},"Create Backlog Ticket",-1)),e("p",Tn,S(p.value),1)]),e("button",{class:"ml-4 p-2 rounded-md hover:bg-border transition-colors cursor-pointer",onClick:Xe,"aria-label":"Close"},h[7]||(h[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 8.586l4.95-4.95a1 1 0 111.414 1.414L11.414 10l4.95 4.95a1 1 0 01-1.414 1.414L10 11.414l-4.95 4.95a1 1 0 01-1.414-1.414L8.586 10 3.636 5.05a1 1 0 011.414-1.414L10 8.586z","clip-rule":"evenodd"})],-1)]))]),e("div",Dn,[(d(),v(Ce,null,Ne(3,x=>e("div",{key:x,class:"flex items-center flex-1"},[e("div",Vn,[e("div",{class:Y(["h-1 flex-1 rounded-full transition-colors",u.value>=x?"bg-primary":"bg-border"])},null,2)])])),64))])]),e("div",Ln,[u.value===1?(d(),v("div",Mn,[h[9]||(h[9]=e("h3",{class:"text-lg font-medium mb-4"},"Select Module",-1)),b(ne)?(d(),v("div",In,h[8]||(h[8]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):!oe.value||oe.value.length===0?(d(),v("div",En," No modules available ")):(d(),v("div",An,[(d(!0),v(Ce,null,Ne(oe.value,x=>{var de,fe,mt,se,De;return d(),v("button",{key:x._id,onClick:Ft=>Dt(x),class:Y(["p-4 border rounded-lg hover:border-primary transition-all text-left group",z.value===x._id?"border-primary bg-primary/5":"border-border"])},[e("div",Nn,[e("div",zn,[e("i",{class:Y([`${(fe=(de=x==null?void 0:x.variables)==null?void 0:de["module-icon"])==null?void 0:fe.prefix} ${(se=(mt=x==null?void 0:x.variables)==null?void 0:mt["module-icon"])==null?void 0:se.iconName}`,"text-lg"])},null,2)]),e("div",null,[e("p",Pn,S(((De=x.variables)==null?void 0:De["module-title"])||"Untitled"),1)])])],10,Bn)}),128))]))])):u.value===2?(d(),v("div",On,[h[11]||(h[11]=e("h3",{class:"text-lg font-medium mb-4"},"Select Sheet",-1)),b(J)?(d(),v("div",Un,h[10]||(h[10]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):!I.value||I.value.length===0?(d(),v("div",jn," No sheets available for this module ")):(d(),v("div",qn,[(d(!0),v(Ce,null,Ne(I.value,x=>{var de,fe;return d(),v("button",{key:x._id,onClick:mt=>Ie(x),class:Y(["p-4 border rounded-lg hover:border-primary transition-all text-left group",R.value===x._id?"border-primary bg-primary/5":"border-border"])},[e("div",Rn,[e("div",Fn,[e("i",{class:Y(`fa ${(de=x==null?void 0:x.variables["sheet-icon"])==null?void 0:de.prefix} ${(fe=x==null?void 0:x.variables["sheet-icon"])==null?void 0:fe.iconName} text-lg`)},null,2)]),e("div",null,[e("p",Wn,S((x==null?void 0:x.variables["sheet-title"])||"Untitled Sheet"),1)])])],10,Hn)}),128))]))])):u.value===3?(d(),v("div",Qn,[h[15]||(h[15]=e("h3",{class:"text-lg font-medium mb-4"},"Ticket Details",-1)),e("div",Kn,[j(Il,{modelValue:y.title,"onUpdate:modelValue":h[0]||(h[0]=x=>y.title=x),label:"Ticket Title",placeholder:"e.g., Implement real-time notifications",error:!!ft.value,message:ft.value,onBlur:h[1]||(h[1]=x=>B.title=!0)},null,8,["modelValue","error","message"]),ee.value.length>0?(d(),v("div",Zn,[j(Dl,{size:"md",label:"Tab",options:ee.value,placeholder:"Select tab",allowCustom:!1,"model-value":y.lane_id,"onUpdate:modelValue":$e,error:!!xe.value,message:xe.value},null,8,["options","model-value","error","message"])])):E("",!0),(d(!0),v(Ce,null,Ne(k.value,x=>ut((d(),he(Dl,{size:"md",key:le(x),modelValue:y.variables[x.slug],"onUpdate:modelValue":de=>y.variables[x.slug]=de,options:x.data.filter(de=>de!=="process").map(de=>({_id:de,title:de})),label:x.title,placeholder:"Select value",allowCustom:!0},null,8,["modelValue","onUpdate:modelValue","options","label"])),[[rl,(x==null?void 0:x._id)!=w.selectedVariable]])),128)),e("div",Jn,[h[12]||(h[12]=e("label",{class:"text-sm"},"Start date",-1)),e("div",{class:Y(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",Re.value?"border-red-500":""])},[j(ol,{placeholder:"Set start date",class:"w-full","model-value":y.startDate,"emit-as":"ymd","onUpdate:modelValue":K,"min-date":b(Ye)},null,8,["model-value","min-date"])],2),Re.value?(d(),v("p",Gn,S(Re.value),1)):E("",!0)]),e("div",Xn,[h[13]||(h[13]=e("label",{class:"text-sm"},"End date",-1)),e("div",{class:Y(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",Fe.value?"border-red-500":""])},[j(ol,{placeholder:"Set end date",class:"w-full","model-value":y.endDate,"emit-as":"ymd","onUpdate:modelValue":re,"min-date":y.startDate||b(Ye)},null,8,["model-value","min-date"])],2),Fe.value?(d(),v("p",Yn,S(Fe.value),1)):E("",!0)]),e("div",eo,[h[14]||(h[14]=e("label",{class:"text-sm"},"Assignee",-1)),e("div",to,[j(Ss,{name:!0,workspaceId:b(H),onAssign:Oe,onUnassign:h[2]||(h[2]=x=>Oe(null)),assigneeId:y.assignee,seat:null,disabled:!1,skipPermissionCheck:!0,class:"w-full"},null,8,["workspaceId","assigneeId"])])])]),e("div",lo,[j(Cs,{label:"Description",placeholder:"What needs to be done, acceptance criteria, links…",modelValue:y.description,"onUpdate:modelValue":h[3]||(h[3]=x=>y.description=x),onBlur:h[4]||(h[4]=x=>B.description=!0)},null,8,["modelValue"])])])):E("",!0)]),e("div",so,[u.value>1?(d(),he(Ge,{key:0,variant:"secondary",onClick:Bt},{default:me(()=>h[16]||(h[16]=[te("Back")])),_:1,__:[16]})):(d(),v("div",ao)),e("div",no,[j(Ge,{variant:"secondary",onClick:Xe},{default:me(()=>h[17]||(h[17]=[te("Cancel")])),_:1,__:[17]}),u.value===3?(d(),he(Ge,{key:0,variant:"primary",disabled:!_e.value||b(o),onClick:Vt},{default:me(()=>[te(S(b(o)?"Adding…":"Add Ticket"),1)]),_:1},8,["disabled"])):E("",!0)])])]),_:1},8,["modelValue"]))}}),ro={class:"flex flex-col h-full"},io={class:"sticky top-0 z-20 bg-bg-card overflow-x-auto shrink-0"},uo={class:"header lg:px-4 px-2 py-2 flex justify-between items-center gap-1 overflow-auto border-b border-border"},co={class:"flex lg:gap-4 gap-2 py-1"},po={class:"hidden sm:flex"},vo={class:"flex sm:hidden"},fo={class:"lg:px-4 px-2 py-1 h-8 mt-1 rounded-2xl bg-gradient-to-tr from-accent to-accent-hover text-white font-medium cursor-pointer"},mo={class:"flex gap-3 items-center"},go={class:"flex items-center gap-3 bg-bg-surface/50 h-[32px] px-2 rounded-md"},bo={class:"flex gap-3 items-center"},xo={class:"flex items-center gap-3 bg-bg-surface/50 h-[32px] px-2 rounded-md"},yo={class:"flex flex-1 overflow-hidden bg-bg-card"},ho={class:"flex-1 min-w-0 flex flex-col"},_o={class:"flex-1 overflow-x-auto overflow-y-hidden scrollbar-visible"},ko={class:"flex gap-3 p-4 min-w-max h-full"},wo={key:0,class:"mx-auto text-text-secondary/80 m-2 w-[90%] h-full justify-center flex items-center border border-dashed border-border"},So={class:"max-h-[calc(100vh-220px)] overflow-y-auto pr-1"},Co={key:1,class:"flex-1 overflow-auto pb-12"},$o={class:"relative w-full h-full flex overflow-hidden"},To={key:0,class:"format-sidebar h-full py-4 px-4 w-[320px] border-l bg-bg-card overflow-x-hidden overflow-y-auto flex flex-col"},Do={class:"flex items-center justify-between pb-3 mb-4 border-b"},Vo={class:"format-content space-y-6"},Lo={class:"format-group mb-3"},Mo={class:"flex items-center gap-2"},Io=["value"],Eo={class:"format-group mb-3"},Ao={class:"flex items-center gap-2"},Bo=["value"],No={class:"grid grid-cols-1 gap-3"},zo=["value"],Po={class:"mt-6 pt-4"},Oo=["disabled"],Uo={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},jo={key:0,class:"fixed inset-0 bg-black/30 flex items-center justify-center"},qo={class:"bg-white p-6 rounded-xl w-80"},Ho={class:"flex justify-end gap-2 mt-4"},Ro=["disabled"],Fo={class:"flex items-center mt-3 gap-3"},Wo=pt({__name:"ActiveSprint",props:{sptint_id:{},searchQuery:{},activeSprint:{}},setup(O){const N=O,Z=Ae(()=>Be(()=>import("./CreateTaskModal-CLHvsSOn.js"),__vite__mapDeps([0,1,2,3]))),$=Ae(()=>Be(()=>import("./ConfirmDeleteModal-DHWWnNdh.js"),__vite__mapDeps([4,5,2,3]))),U=Ae(()=>Be(()=>import("./SidePanel-BImeSGVA.js"),__vite__mapDeps([6,2,3,7,8]))),H=Ae(()=>Be(()=>import("./KanbanBoard-BW33x5UN.js"),__vite__mapDeps([9,10,11,2,3,12,13,14]))),u=Ae(()=>Be(()=>import("./index-DkDAC3Va.js").then(l=>l.ds),__vite__mapDeps([2,3]))),z=Ae(()=>Be(()=>import("./TableSearchCell-zk4oD_C_.js"),__vite__mapDeps([15,2,3]))),R=Ae(()=>Be(()=>import("./TableAssigneeCell-J8X9xX0O.js"),__vite__mapDeps([16,2,3]))),L=Ae(()=>Be(()=>import("./CalendarView-DwSj_f2u.js"),__vite__mapDeps([17,2,3,18]))),A=Ae(()=>Be(()=>import("./GanttChartView-FhdCeGfJ.js"),__vite__mapDeps([19,2,3]))),ne=Ae(()=>Be(()=>import("./TimelineView-BC9bVCtm.js"),__vite__mapDeps([20,2,3,21]))),oe=Ae(()=>Be(()=>import("./index-DkDAC3Va.js").then(l=>l.dq),__vite__mapDeps([2,3]))),q=Ae(()=>Be(()=>import("./BaseTextField-DYlezkNB.js"),__vite__mapDeps([22,2,3]))),M=m(!1),J=m(""),Q=m(null),I=m(null),F=m(null),f=m(""),{isDark:g}=il(),o=m(null),s=m(!1);function p(l){J.value="",M.value=!0,Q.value=l}function k(){Q.value&&Q.value(J.value),M.value=!1}function ee(){M.value=!1}const{mutate:le}=hs({onSuccess:()=>{xe.invalidateQueries({queryKey:["sheet-list"]})}});function y(){const l=ue.value.trim();l&&w(l)}function B(){G.value=!G.value}const _e=Ns(),K=m("kanban"),{workspaceId:re,moduleId:$e}=ms(),Oe=m(""),Dt=m(!1),Ie=m(!1),{canCreateVariable:Bt,canCreateCard:Xe,canEditCard:Te,canAssignCard:vt}=Ll(),{data:ft}=gs(re.value),Re=m(ft.value.modules||[]),Fe=C(()=>(Re.value||[]).map(l=>{var t,a;return{_id:l._id,title:((t=l.variables)==null?void 0:t["module-title"])??"Untitled module",description:((a=l.variables)==null?void 0:a["module-description"])??"",icon:l.icon??null,status:l.status??null}})),xe=Al(),{mutate:Ye,isPending:Vt}=$s({onSuccess:()=>{xe.invalidateQueries({queryKey:["sheet-list"]}),ue.value="",ze.value=!1,G.value=!1,ze.value=!1}}),w=l=>{Ye({workspace_id:re.value,module_id:$e.value,variable_id:se.value,value:l})};P(Fe,l=>{if(l.length&&!Oe.value){const t=l.find(a=>a.title==="Tasks")||l[0];Oe.value=t._id}},{immediate:!0});const{data:h,refetch:x}=bs({workspace_id:re.value,workspace_module_id:$e.value});P(Oe,l=>{l&&x()});const de=C(()=>{var l;return h.value?(l=h.value[0])==null?void 0:l._id:""}),fe=m(de),mt=C(()=>{var l;return Pt.value?(l=Pt.value[0])==null?void 0:l._id:""}),se=m(mt),De=Ts(),Ft=C(()=>N.sptint_id),{data:pe,isPending:Nt,refetch:Wt}=qs(Ft),gt=m(!1),bt=m(),ve=l=>{bt.value=l},Qt=Ds(),cl=Vs();function pl(l){l.type=="column"?Qt.mutate({payload:{workspace_id:re.value,workspace_module_id:$e.value,variable_id:se.value,moved_value:l.meta.id,new_index:l.meta.newIndex}}):cl.mutate({payload:{workspace_id:re.value,card_id:l.meta.moved._id,group_value:l.meta.fromColumnId,group_variable_id:se.value,new_index:l.meta.newIndex,sheet_id:fe.value}})}const vl=l=>{},{mutate:fl}=Ls({onSuccess:()=>{x(),bl.value=!1}}),zt=C(()=>!h.value||!h.value.length?[]:h.value.map(l=>{var t,a;return{_id:l._id,title:((t=l.variables)==null?void 0:t["sheet-title"])||"Untitled Sheet",description:((a=l.variables)==null?void 0:a["sheet-description"])||"",icon:l.icon||null,status:l.generation_status||null}}));P(zt,l=>{l.length>0&&!fe.value&&(fe.value=l[0]._id)},{immediate:!0}),P(zt,l=>{l.length>0?f.value=l[0].title:f.value="Backlog"},{immediate:!0}),P(h,l=>{var t;(l==null?void 0:l.length)>0&&(fe.value=(t=l[0])==null?void 0:t._id)});const G=m(!1),ue=m(""),Lt=l=>{Ye({workspace_id:_e.params.id,module_id:_e.params.module_id,new_value:l.title,value:l.oldTitle,variable_id:se.value})},ze=m(!1),Ue=m(),ml=()=>{Ye({value:Ue.value.title,workspace_id:re.value,module_id:$e.value,newValue:Ue.value.title,variable_id:se.value,is_trash:!0})},Kt=l=>{ze.value=!0,Ue.value=l},xt=l=>{gt.value=!0,localStorage.setItem("selectedStatusTitle",l==null?void 0:l.title),localStorage.setItem("selectedModuleId",Oe.value),Ue.value=l},yt=C(()=>N.searchQuery),gl=m("");P(yt,aa.debounce(l=>{gl.value=l},200));const We=C(()=>{var t;const l=(t=pe.value)==null?void 0:t.flatMap(a=>a.cards.map(i=>({...i,columnId:a.title})));return new us(l,{keys:["card-title","card-description"],threshold:.3})}),et=C(()=>{var l,t;if(K.value==="kanban"){if(!yt.value)return pe.value;const a=We.value.search(yt.value).map(i=>i.item);return pe.value.map(i=>({...i,cards:a.filter(c=>c.columnId===i.title)}))}else{const a=(l=yt.value)==null?void 0:l.trim();if(!a){let c=[];return(t=pe.value??[])==null||t.forEach(W=>{c=[...c,...W==null?void 0:W.cards]}),c}return new us(ht.value,{keys:["card-title","card-description"],threshold:.3}).search(a).map(c=>c.item)}}),ht=C(()=>{let l=[];return(pe.value??[]).forEach(t=>{l=[...l,...t==null?void 0:t.cards]}),l}),bl=m(!1),{data:Pt,isPending:xl}=ys(re,Oe,fe),{mutate:yl}=Ms(),je=(l,t)=>{yl({payload:{sheet_id:fe.value,workspace_id:re.value,variable_slug:l,is_visible:t}})},{data:Mt}=xs(re),Zt=C(()=>((Mt==null?void 0:Mt.value)??[]).map(l=>{var t;return{_id:l._id,title:((t=l==null?void 0:l.variables)==null?void 0:t["lane-title"])??String(l._id)}})),hl=l=>l.map(t=>({_id:t.value??t,title:t.value??t})),_t=Is({onSuccess:()=>{xe.invalidateQueries({queryKey:["get-sheets"]}),xe.invalidateQueries({queryKey:["sheet-list"]}),xe.invalidateQueries({queryKey:["roles"]})}}),It=(l,t)=>{if(!pe.value)return;const a=pe.value.findIndex(i=>i.cards.some(c=>c._id===l));if(a!==-1){const i=pe.value[a].cards.findIndex(c=>c._id===l);if(i!==-1){const c={...pe.value[a].cards[i]};t(c),pe.value[a].cards[i]=c,as(pe)}}};function _l(l,t){It(l,a=>{const i=Zt.value.find(c=>c._id===t);i&&(a.lane=i)}),as(pe),_t.mutate({card_id:l,workspace_lane_id:t})}const kl=(l,t)=>{It(l,a=>{a.seat=t}),_t.mutate({card_id:l,seat_id:t==null?void 0:t._id})},kt=C(()=>{var l,t;return[{key:"card-title",label:"Title",render:({row:a,value:i})=>we("div",{class:"flex items-center gap-1 w-full"},[we("a",{onClick:()=>bt.value=a,class:"text-[12px] underline text-blue-500 shrink-0 overflow-ellipsis cursor-pointer"},a["card-code"]),we("div",{class:"flex-1 min-w-0"},[we("input",{onFocusout:c=>{var W;Ot(a==null?void 0:a._id,"card-title",(W=c==null?void 0:c.target)==null?void 0:W.value)},class:"text-[12px] w-full overflow-ellipsis capitalize p-1 w-full p-1 focus:border border-accent/60 rounded-sm focus:outline-none focus:ring-1 focus:ring-accent bg-transparent focus:bg-bg-body text-[12px] h-8",defaultValue:i,disabled:!Te.value})])])},{key:"end-date",label:"Due Date",render:({row:a,value:i})=>{const c=m(i);return we(u,{class:" capitalize flex items-center gap-2 text-[12px]",placeholder:"Set start date",tableInputClass:!0,modelValue:c.value,disabled:!Te.value,"onUpdate:modelValue":W=>tt(a==null?void 0:a._id,W),emptyText:"Date"})}},{key:"lane",label:"Lane",render:({row:a})=>{var i;return we(z,{options:Zt.value??[],placeholder:"Select lane",modelValue:((i=a.lane)==null?void 0:i._id)||null,disabled:!Te.value,"onUpdate:modelValue":c=>_l(a==null?void 0:a._id,c),displayField:"title",emptyText:"Lane"})}},{key:"created_by",label:"Owner",render:({value:a})=>we("div",{class:"capitalize flex items-center gap-2  px-3"},[we("div",{class:" rounded-full  "},[a!=null&&a.u_profile_image?we("img",{class:"w-6 h-6 rounded-full",src:a==null?void 0:a.u_profile_image}):we("div",{class:"w-5 h-5 rounded-full flex justify-center items-center text-[11px] ",style:`background:${a!=null&&a.u_full_name?Es({name:a.u_full_name,email:a.u_email}):""}`},Ml(a==null?void 0:a.u_full_name))]),we("span",{class:"text-[12px]"},a?a==null?void 0:a.u_full_name:"")])},{key:"seat",label:"Assignee",render:({row:a,value:i})=>we(R,{class:"capitalize flex items-center gap-2 ",onAssign:c=>kl(a==null?void 0:a._id,c),assigneeId:i,seat:i,name:!0,disabled:!vt.value,emptyText:"Assignee"})},...((t=(l=Pt.value)==null?void 0:l.variables)==null?void 0:t.filter(a=>{var i;return((i=a==null?void 0:a.type)==null?void 0:i.title)==="Select"}).map(a=>({key:a==null?void 0:a.slug,label:a==null?void 0:a.slug,render:({row:i,value:c})=>{var ie;let W=c;if(Array.isArray(i==null?void 0:i.variables)){const V=i.variables.find(D=>D.slug===a.slug);V&&(W=V.value)}else W=((ie=i==null?void 0:i.variables)==null?void 0:ie[a.slug])??(i==null?void 0:i[a.slug])??c;return we("div",{class:"capitalize flex items-center gap-2"},[we(z,{options:hl(a.data??[]),modelValue:W,disabled:!Te.value,emptyText:a.slug,"onUpdate:modelValue":V=>{Ot(i==null?void 0:i._id,a.slug,V)},columnName:a.slug})])},visible:a==null?void 0:a.is_visible})))??[]]});function Ot(l,t,a){It(l,i=>{if(t==="card-title"&&(i[t]=a),Array.isArray(i.variables)){const c=i.variables.find(W=>W.slug===t);c?c.value=a:i.variables.push({slug:t,value:a,type:"Select"})}else i.variables&&typeof i.variables=="object"?i.variables[t]=a:i[t]=a}),_t.mutate({card_id:l,variables:{[t]:a.trim()}})}function Jt(l){if(l["card-title"]){const t={sheet_list_id:"To Do",workspace_id:re.value,sheet_id:fe.value,variables:{"card-title":l["card-title"].trim()},createdAt:new Date().toISOString()};le(t)}}const tt=(l,t)=>{const a=pe.value.findIndex(i=>i.cards.some(c=>c._id===l));if(a!==-1){const i=pe.value[a].cards.findIndex(c=>c._id===l);i!==-1&&(pe.value[a].cards[i]["end-date"]=t)}_t.mutate({card_id:l,variables:{"start-date":t}})},Qe=m(null),Et=m(!1),Gt=m(!1);P(Et,l=>{l&&(Gt.value=!1)}),P(Gt,l=>{l&&(Et.value=!1)});const Ke=C(()=>{var l,t;return(t=(l=Qe.value)==null?void 0:l.nodeObj)!=null&&t.style?Qe.value.nodeObj.style:qe(be)});function Ve(l,t,a){return l!==void 0?l:t!==void 0?t:a}function Ut(l,t){var ie;if(!((ie=Qe.value)!=null&&ie.nodeObj))return;const a=Qe.value.nodeObj;a.style||(a.style={});const i=t.target,c=i.type==="number"?Number(i.value):i.value;switch(l){case"bg_color":a.style.background=c;break;case"color":a.style.color=c;break;case"font_size":a.style.fontSize=`${c}px`;break;case"font_weight":a.style.fontWeight=c;break;case"font_style":a.style.fontStyle=c;break;case"font_family":a.style.fontFamily=c;break;case"border_color":a.style.borderColor=c;break;case"border_width":a.style.borderWidth=`${c}px`;break;case"border_radius":a.style.borderRadius=`${c}px`;break;case"padding":a.style.padding=`${c}px`;break}const W=document.getElementById(a.id);W&&jt(a,W)}const be={bg_color:"#ffffff",color:"#000000",font_size:14,font_weight:"normal",font_style:"normal",font_family:"Inter",border_color:"#cccccc",border_width:0,border_radius:0,padding:0},Ze=m(!1);async function Xt(){var t;const l=(t=Qe.value)==null?void 0:t.nodeObj;if(!(!l||Ze.value)){Ze.value=!0;try{const a=zs(l);a._originalStyle||(a._originalStyle={});const i=a.style||{},c=a._originalStyle,W={bg_color:Ve(i.background,c.bg_color,be.bg_color),color:Ve(i.color,c.color,be.color),font_size:Ve(i.fontSize?parseInt(i.fontSize):void 0,c.font_size,be.font_size),font_weight:Ve(i.fontWeight,c.font_weight,be.font_weight),font_style:Ve(i.fontStyle,c.font_style,be.font_style),font_family:Ve(i.fontFamily,c.font_family,be.font_family),border_color:Ve(i.borderColor,c.border_color,be.border_color),border_width:Ve(i.borderWidth?parseInt(i.borderWidth):void 0,c.border_width,be.border_width),border_radius:Ve(i.borderRadius?parseInt(i.borderRadius):void 0,c.border_radius,be.border_radius),padding:Ve(i.padding?parseInt(i.padding):void 0,c.padding,be.padding),hyperLink:J.value||a.hyperLink||""};a._originalStyle={...W};const ie=a.unique_name==="sheet"?{sheet_id:a.id,workspace_id:re.value,workspace_module_id:$e.value,style:W}:{card_id:a.id,seat_id:a.seat_id,style:W};a.unique_name==="sheet"?await fl(ie):await _t.mutateAsync(ie)}finally{Ze.value=!1}}}const Yt=m([]);function wl(l){const t={id:"root",topic:localStorage.getItem("currentName")??"",isRoot:!0,children:[],style:{},_originalStyle:{},unique_name:"root"};if(!Array.isArray(l))return t;const a={};return l.forEach(i=>{var V;const c=f.value,W=((V=i.style)==null?void 0:V.hyperLink)||"";a[c]||(a[c]={id:i._id,topic:c,variables:i==null?void 0:i.variables,children:[],style:i==null?void 0:i.style,_originalStyle:(i==null?void 0:i.style)||{},unique_name:"sheet",hyperLink:W||""},t.children.push(a[c]));const ie={id:i==null?void 0:i._id,topic:i.title,children:[],style:qe(i==null?void 0:i.style),_originalStyle:i.style||{},unique_name:"List",hyperLink:W||""};(i.cards||[]).forEach((D,T)=>{var ce;const ge=((ce=D.style)==null?void 0:ce.hyperLink)||"",Le={id:D._id||`card-${T}`,seat_id:D.seat_id,topic:D["card-title"],style:qe(D.style),_originalStyle:D.style||{},children:[],unique_name:"card",hyperLink:ge||""};ie.children.push(Le),Yt.value=Le}),a[c].children.push(ie)}),t}const{mutateAsync:Sl}=As({onSuccess:()=>{xe.invalidateQueries({queryKey:["sheets"]}),xe.invalidateQueries({queryKey:["sheet-list"]}),close()}}),Cl=l=>{var t,a;(a=(t=pe.value)==null?void 0:t.sheets)==null||a.forEach(i=>{var c;(c=i.sheet_lists)==null||c.forEach(W=>{W.cards=W.cards.filter(ie=>ie._id!==l)})})},el=m(!1),tl=m(null),wt=async()=>{if(o.value)try{s.value=!0,await os({url:`workspace/card/${o.value}`,method:"DELETE"}),Cl(o.value),el.value=!1,tl.value=null,ct.success("Ticket deleted successfully"),await x(),await Wt()}catch(l){ct.error(Ps(l))}finally{s.value=!1}},St=async l=>{try{await os({url:"workspace/cards/group-card-order",method:"PATCH",data:l}),x(),Wt()}catch(t){console.error("Failed to reorder card:",t)}};function At(){var a;const l=(a=I.value)==null?void 0:a.querySelector(".mind-elixir-toolbar.rb");if(!l||l.querySelector(".open-sidebar-btn"))return;const t=document.createElement("button");t.className="open-sidebar-btn me-toolbar-btn ms-2",t.title="Open Formatting Sidebar",t.innerHTML='<i class="fa-solid fa-sidebar"></i>',t.addEventListener("click",()=>{Ie.value=!Ie.value}),l.appendChild(t)}let Ct=null;function ll(){var t,a;Ct&&(Ct.disconnect(),Ct=null);const l=(a=(t=I.value)==null?void 0:t.querySelector(".mind-elixir-toolbar.rb"))==null?void 0:a.parentElement;l&&(Ct=new MutationObserver(()=>{At()}),Ct.observe(l,{childList:!0,subtree:!0}),At())}Bs(()=>{K.value!=="mindmap"||!I.value||!pe.value||ns(()=>{var ie,V;const l=wl(pe.value);F.value&&((V=(ie=F.value).destroy)==null||V.call(ie),F.value=null);const t=new Set,a=new Set,i=new Set,c=new Rt({el:I.value,theme:g.value?Rt.DARK_THEME:Rt.THEME,draggable:!0,contextMenu:!0,toolBar:!0,keypress:!0,locale:"en",overflowHidden:!1,contextMenuOption:{Update:!0,extend:[{name:"Update Node",onclick:()=>{var T;Ie.value&&(Ie.value=!1);const D=(T=Qe.value)==null?void 0:T.nodeObj;D&&ve(D)}},{name:"Add Hyperlink",onclick:()=>{p(async()=>{await Xt()})}}]}});F.value=c,c.init({nodeData:l}),setTimeout(()=>{c.toCenter()},100),ns(()=>{ll()}),c.bus.addListener("selectNode",D=>{D&&(Qe.value={nodeObj:D})}),c.bus.addListener("renderNode",D=>{!(D!=null&&D.nodeObj)||!(D!=null&&D.element)||jt(D.nodeObj,D.element)});const W=D=>{let T=D;for(;T;){if(T.unique_name==="sheet")return T;T=T.parent}return null};c.bus.addListener("operation",async D=>{if(D){if(D.name==="moveNode"||D.name==="moveNodeBefore"||D.name==="moveNodeAfter"){const T=D.obj,ge=D.target;if(!T||T.unique_name!=="card"||!ge)return;const Le=T._originalParent||T.parent;if(!Le||Le.unique_name!=="List")return;const ce=ge.unique_name==="List"?ge:ge.parent;if(!ce||ce.unique_name!=="List")return;const r=W(ce);if(!r)return;const n=ce.children.findIndex(X=>X.id===T.id);if(n===-1)return;T._originalParent=ce,await St({workspace_id:re.value,card_id:T.id,group_value:ce.topic,group_variable_id:se.value,new_index:n,sheet_id:r.id});return}if(D.name==="removeNode"){const T=D.obj;if(!T||!T.id||T.unique_name!=="card")return;o.value=T.id,await wt();return}if(D.name==="addChild"||D.name==="insertSibling"){const T=D.obj;if(!T||!T.id)return;t.add(T.id);return}if(D.name==="finishEdit"){const T=D.obj;if(!T||!T.id)return;const ge=t.has(T.id),Le=a.has(T.id);if(!ge&&!Le||Le)return;if(ge){t.delete(T.id),a.add(T.id);const ce=T.parent;if(!ce||!("unique_name"in ce)){a.delete(T.id);return}if(ce.unique_name==="root"&&!i.has(T.id)){i.add(T.id);try{await Sl({variables:{"sheet-title":T.topic??"New Sheet","sheet-description":"This is custom description"},is_ai_generated:!1,workspace_id:re.value,workspace_module_id:$e.value})}catch{a.delete(T.id),i.delete(T.id)}return}if(ce.unique_name==="List"){try{const r=$l({topic:T.topic??"New Card",id:T.id},ce);r.variables&&(r.variables["card-description"]="This is a default description"),await le(r)}catch{a.delete(T.id)}return}if(ce.unique_name==="sheet"){try{console.log("Creating new list under sheet...")}catch{a.delete(T.id)}return}}}}})})}),P(g,()=>{F.value&&F.value.changeTheme(g.value?Rt.DARK_THEME:Rt.THEME)},{immediate:!0});function jt(l,t){if(!l||!t||!l.style)return;const a=t.querySelector(".topic"),i=t.querySelector(".node")??t,c=l.style;c.background&&(i.style.background=c.background),c.color&&a&&(a.style.color=c.color),a&&(c.fontSize&&(a.style.fontSize=c.fontSize),c.fontFamily&&(a.style.fontFamily=c.fontFamily),c.fontWeight&&(a.style.fontWeight=c.fontWeight),c.fontStyle&&(a.style.fontStyle=c.fontStyle)),c.borderColor&&(i.style.borderColor=c.borderColor),c.borderWidth&&(i.style.borderWidth=c.borderWidth),c.borderRadius&&(i.style.borderRadius=c.borderRadius),c.padding&&(i.style.padding=c.padding)}function qe(l={}){return{background:l.bg_color,color:l.color,fontSize:l.font_size!=null?`${l.font_size}px`:void 0,fontWeight:l.font_weight,fontStyle:l.font_style,fontFamily:l.font_family,borderColor:l.border_color,borderWidth:l.border_width!=null?`${l.border_width}px`:void 0,borderRadius:l.border_radius!=null?`${l.border_radius}px`:void 0,padding:l.padding!=null?`${l.padding}px`:void 0,hyperLink:l.hyperLink||void 0}}function $l(l,t){const a=new Date,i=a.toISOString().split("T")[0],c=new Date(a.getTime()+3*24*60*60*1e3).toISOString().split("T")[0];return{sheet_list_id:(t==null?void 0:t.topic)||"In Progress",workspace_id:re.value,sheet_id:fe.value,workspace_lane_id:(l==null?void 0:l.workspace_lane_id)||null,variables:{"card-status":(t==null?void 0:t.topic)||"In Progress","card-type":null,priority:null,process:null,"card-title":l.topic||"New Card","card-description":"","start-date":i,"end-date":c},createdAt:new Date().toISOString()}}return(l,t)=>{var a,i,c,W,ie;return d(),v("div",ro,[e("div",io,[e("div",uo,[e("div",co,[e("div",po,[e("button",{class:"cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white items-center justify-center gap-1 px-2 rounded-md text-xs font-medium",onClick:t[0]||(t[0]=V=>l.$emit("go-back"))},t[24]||(t[24]=[e("i",{class:"fa-solid fa-chevron-left"},null,-1),te(" Go Back ")]))]),e("div",vo,[e("button",{class:"cursor-pointer bg-gradient-to-tr from-accent to-accent-hover px-2 text-white items-center justify-center py-1 rounded-md font-medium",onClick:t[1]||(t[1]=V=>l.$emit("go-back"))},t[25]||(t[25]=[e("i",{class:"fa-solid fa-chevron-left"},null,-1)]))]),e("div",fo,S(l.activeSprint),1)]),e("div",mo,[e("div",go,[e("div",bo,[e("div",xo,[e("button",{class:Y(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",K.value==="kanban"?"text-accent bg-accent-text":" hover:bg-border/50 backdrop-blur-2xl  transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"List view",onClick:t[2]||(t[2]=V=>K.value="kanban")},t[26]||(t[26]=[e("i",{class:"fa-solid fa-chart-kanban"},null,-1)]),2),e("button",{onClick:t[3]||(t[3]=V=>K.value="table"),class:Y(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",K.value==="table"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gallery view"},t[27]||(t[27]=[e("i",{class:"fa-solid fa-align-left"},null,-1)]),2),e("button",{onClick:t[4]||(t[4]=V=>K.value="mindmap"),class:Y(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",K.value==="mindmap"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"MindMap view"},t[28]||(t[28]=[e("i",{class:"fa-solid fa-chart-diagram"},null,-1)]),2),e("button",{onClick:t[5]||(t[5]=V=>K.value="calendar"),class:Y(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",K.value==="calendar"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Calendar view"},t[29]||(t[29]=[e("i",{class:"fa-regular fa-calendar"},null,-1)]),2),e("button",{onClick:t[6]||(t[6]=V=>K.value="gantt"),class:Y(["aspect-square cursor-pointer rounded-sm p-0",K.value==="gantt"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gantt Chart view"},t[30]||(t[30]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 6h2v12H4V6Zm4 4h10v2H8v-2Zm0 4h10v2H8v-2Zm0-8h10v2H8V6Z"})],-1)]),2),e("button",{onClick:t[7]||(t[7]=V=>K.value="timeline"),class:Y(["aspect-square cursor-pointer rounded-sm p-0",K.value==="timeline"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Timeline view"},t[31]||(t[31]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 12a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm16 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm-8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm0-16a2 2 0 1 1 0-4 2 2 0 0 1 0 4Z",opacity:"0"}),e("path",{d:"M4 12h4m8 0h4M9 12h6M9 12v-6M15 12v6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),2)])])])])])]),e("div",yo,[e("div",ho,[K.value==="kanban"?(d(),v(Ce,{key:0},[ut(j(la,null,null,512),[[rl,b(Nt)]]),ut(e("div",_o,[e("div",ko,[j(b(H),{class:"flex h-full",board:et.value,variable_id:se.value,sheet_id:fe.value,onOnPlus:xt,"onDelete:column":t[8]||(t[8]=V=>Kt(V)),"onUpdate:column":t[9]||(t[9]=V=>Lt(V)),onReorder:pl,onAddColumn:w,"onSelect:ticket":ve,onOnBoardUpdate:vl},{"column-footer":me(V=>{var D,T,ge,Le,ce;return[(T=(D=b(De))==null?void 0:D.transitions)!=null&&T.all_allowed&&!((ce=(Le=(ge=b(De))==null?void 0:ge.transitions)==null?void 0:Le.all_allowed)!=null&&ce.includes(V.column.title))&&b(De).transitions.currentColumn!=V.column.title?(d(),v("div",wo," Disable ( you can't drop here ) ")):E("",!0)]}),ticket:me(({ticket:V})=>[e("div",So,[j(sa,{selectedVar:se.value,ticket:V,onSelect:()=>ve(V)},null,8,["selectedVar","ticket","onSelect"])])]),_:1},8,["board","variable_id","sheet_id"])])],512),[[rl,!b(Nt)]])],64)):E("",!0),K.value==="table"?(d(),v("div",Co,[j(ta,{onToggleVisibility:je,onAddVar:t[10]||(t[10]=()=>{Dt.value=!0}),isPending:b(Nt)||b(xl),columns:kt.value,rows:et.value,canCreate:b(Xe),canCreateVariable:b(Bt),onCreate:Jt},null,8,["isPending","columns","rows","canCreate","canCreateVariable"])])):E("",!0),K.value==="mindmap"?(d(),v(Ce,{key:2},[e("div",$o,[e("div",{ref_key:"mindMapRef",ref:I,class:"flex-1 h-full overflow-hidden rounded-md relative",style:{height:"600px",width:"100%"}},null,512),Ie.value&&b(vt)&&b(Te)&&b(Xe)?(d(),v("div",To,[e("div",Do,[t[33]||(t[33]=e("h3",{class:"text-sm font-semibold text-secondary"},"Format Node",-1)),e("button",{onClick:t[11]||(t[11]=V=>Ie.value=!1),class:"text-gray-400 hover:text-gray-700"},t[32]||(t[32]=[e("i",{class:"fa-solid fa-times"},null,-1)]))]),e("div",Vo,[e("div",null,[t[36]||(t[36]=e("h4",{class:"text-xs font-semibold text-secondary uppercase mb-3"}," Colors ",-1)),e("div",Lo,[t[34]||(t[34]=e("label",{class:"block text-xs text-secondary mb-1"},"Background",-1)),e("div",Mo,[e("div",{class:"h-10 w-10 rounded-md border cursor-pointer relative",style:ye({backgroundColor:Ke.value.background})},[e("input",{type:"color",value:Ke.value.background,class:"absolute inset-0 opacity-0 cursor-pointer",onInput:t[12]||(t[12]=V=>Ut("bg_color",V)),style:{"pointer-events":"all"}},null,40,Io)],4),j(b(q),{modelValue:Ke.value.background,placeholder:"#3b82f6",class:"flex-1",readonly:""},null,8,["modelValue"])])]),e("div",Eo,[t[35]||(t[35]=e("label",{class:"block text-xs text-secondary mb-1"},"Text",-1)),e("div",Ao,[e("div",{class:"h-10 w-10 rounded-md border cursor-pointer relative",style:ye({backgroundColor:Ke.value.color})},[e("input",{type:"color",value:Ke.value.color,class:"absolute inset-0 opacity-0 cursor-pointer",onInput:t[13]||(t[13]=V=>Ut("color",V)),style:{"pointer-events":"all"}},null,40,Bo)],4),j(b(q),{modelValue:Ke.value.color,placeholder:"#3b82f6",class:"flex-1",readonly:""},null,8,["modelValue"])])])]),e("div",null,[e("div",No,[e("div",null,[t[38]||(t[38]=e("label",{class:"block text-xs text-secondary mb-1"},"Weight",-1)),e("select",{class:"w-full h-8 border rounded px-2 text-sm",value:Ke.value.fontWeight,onChange:t[14]||(t[14]=V=>Ut("font_weight",V))},t[37]||(t[37]=[e("option",{value:"lighter"},"Light",-1),e("option",{value:"normal"},"Normal",-1),e("option",{value:"bold"},"Bold",-1),e("option",{value:"bolder"},"Extra Bold",-1)]),40,zo)])])])]),e("div",Po,[e("button",{class:"w-full cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm font-medium hover:shadow-md disabled:opacity-60",disabled:Ze.value,onClick:Xt},[Ze.value?(d(),v("span",Uo)):E("",!0),e("span",null,S(Ze.value?"Updating...":"Update"),1)],8,Oo)])])):E("",!0)]),M.value&&b(vt)&&b(Te)&&b(Xe)?(d(),v("div",jo,[e("div",qo,[t[39]||(t[39]=e("h3",{class:"text-lg font-semibold mb-4"},"Insert Web Link",-1)),ut(e("input",{"onUpdate:modelValue":t[15]||(t[15]=V=>J.value=V),type:"text",placeholder:"Enter or paste a URL",class:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[El,J.value]]),e("div",Ho,[e("button",{onClick:ee,class:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300"}," Cancel "),e("button",{disabled:!J.value,onClick:k,class:Y(["px-4 py-2 rounded-md text-white",J.value?"bg-blue-500 hover:bg-blue-600":"bg-blue-300 cursor-not-allowed"])}," Insert ",10,Ro)])])])):E("",!0),G.value?(d(),v("div",{key:1,class:"absolute top-40 left-70 bg-bg-body rounded-lg p-4 shadow-lg z-100 min-w-[328px] border",onClick:t[17]||(t[17]=Se(()=>{},["stop"]))},[j(b(q),{autofocus:!0,modelValue:ue.value,"onUpdate:modelValue":t[16]||(t[16]=V=>ue.value=V),placeholder:"Add New list",onKeyup:nl(y,["enter"])},null,8,["modelValue"]),t[40]||(t[40]=e("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),e("div",Fo,[j(b(oe),{onClick:y,varaint:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:me(()=>[te(S(b(Vt)?"Adding...":"Add list"),1)]),_:1}),e("i",{class:"fa-solid fa-close cursor-pointer",onClick:B})])])):E("",!0)],64)):E("",!0),K.value==="calendar"?(d(),he(b(L),{key:3,data:et.value,"onSelect:ticket":ve,class:"min-h-[600px]"},null,8,["data"])):E("",!0),K.value==="gantt"?(d(),he(b(A),{key:4,data:et.value,"onSelect:ticket":ve},null,8,["data"])):E("",!0),K.value==="timeline"?(d(),he(b(ne),{key:5,data:et.value,"onSelect:ticket":ve},null,8,["data"])):E("",!0),j(b($),{onClick:t[18]||(t[18]=Se(()=>{},["stop"])),modelValue:ze.value,"onUpdate:modelValue":t[19]||(t[19]=V=>ze.value=V),title:"Delete List",itemLabel:"list",itemName:(a=Ue.value)==null?void 0:a.title,requireMatchText:(i=Ue.value)==null?void 0:i.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:b(Vt),onConfirm:ml,onCancel:t[20]||(t[20]=()=>{ze.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),gt.value?(d(),he(b(Z),{selectedVariable:se.value,listId:(c=Ue.value)==null?void 0:c.title,sheet_id:fe.value,key:"createTaskModalKey",modelValue:gt.value,"onUpdate:modelValue":t[21]||(t[21]=V=>gt.value=V),onSubmit:t[22]||(t[22]=()=>{})},null,8,["selectedVariable","listId","sheet_id","modelValue"])):E("",!0)]),(W=bt.value)!=null&&W._id?(d(),he(b(U),{key:0,class:"w-[400px] flex-shrink-0",details:bt.value,onClose:t[23]||(t[23]=()=>ve({variables:{}})),showPanel:!!((ie=bt.value)!=null&&ie._id)},null,8,["details","showPanel"])):E("",!0)])])}}}),Qo=dl(Wo,[["__scopeId","data-v-e895cddb"]]),Ko={class:"flex-auto min-h-0 rounded-[6px] overflow-x-auto flex-col flex backdrop-blur flex-grow h-full"},Zo={key:1,class:"flex flex-col flex-1 min-h-0"},Jo={class:"h-screen w-full flex flex-col -mt-3.5"},Go={class:"overflow-x-auto w-full flex-1"},Xo={class:"min-w-[1200px] h-full flex flex-col"},Yo={key:0,class:"px-0.5 py-4 w-full min-w-0 flex flex-col min-h-0 overflow-x-auto h-full"},er={class:"flex items-center justify-between mt-2"},tr={class:"text-sm font-semibold flex gap-2 items-center"},lr={class:"flex items-center gap-2 relative",ref:"filterDropdownRef"},sr={class:"mt-3"},ar={key:0,class:"flex items-center gap-2 overflow-x-auto no-scrollbar py-1"},nr={key:0,class:"ml-2 text-xs font-normal"},or=["onClick"],rr={key:0,class:"ml-2 text-xs font-normal"},ir={key:1,class:"relative flex items-center gap-3"},dr={class:"relative flex-shrink-0"},ur={class:"flex items-center gap-2 truncate"},cr=["src"],pr={class:"truncate"},vr={class:"ml-2 text-xs font-normal"},fr={key:0,class:"absolute left-0 top-full mt-1 w-44 bg-bg-card border border-gray-200 rounded-lg shadow-lg z-[9999]"},mr={class:"flex flex-col"},gr=["onClick"],br={class:"flex gap-2 overflow-x-auto no-scrollbar flex-1"},xr=["onClick"],yr={key:0,class:"w-full h-full flex justify-center items-center"},hr={key:1,class:"flex-1 min-h-0 overflow-y-auto"},_r={class:"relative z-10 group"},kr={class:"rounded-md relative pt-2 flex flex-col flex-1 bg-bg-card min-h-0 border border-border"},wr={class:"flex justify-between gap-4 px-3 pb-2 border-b border-border-input"},Sr={class:"flex items-center gap-2 min-w-0 py-1"},Cr=["onClick"],$r={class:"flex items-center lg:gap-2 max-w-full"},Tr={class:"flex items-center lg:gap-2 max-w-full"},Dr={class:"truncate max-w-[160px]"},Vr={key:1,class:"absolute left-0 mt-2 w-60 bg-bg-card border-accent-hover rounded-xl shadow-lg z-50 max-h-64 overflow-y-auto overflow-x-hidden"},Lr={class:"relative flex-1"},Mr=["onClick"],Ir=["onBlur","onKeyup"],Er={class:"relative ml-2 flex gap-2"},Ar=["onClick"],Br=["onClick"],Nr={class:"flex justify-end items-center"},zr={class:"flex gap-2"},Pr={class:"gap-2 hidden lg:flex"},Or={key:0,class:"flex gap-2"},Ur={key:0,class:"relative inline-block"},jr={key:0,class:"absolute right-0 mt-2 w-28 bg-bg-dropdown border border-border rounded-md shadow-lg z-50"},qr={key:1},Hr={key:0,class:"gap-2"},Rr={class:"hidden lg:fxex bg-[#E6E1F5] text-accent px-3 py-1 rounded-2xl justify-center items-center"},Fr={key:0,class:"flex lg:hidden ms-2"},Wr=["title"],Qr=["disabled"],Kr={class:"absolute z-50 top-10 mb-2 -translate-x-2/3 bg-card border border-accent text-accent text-xs px-2 py-1 rounded whitespace-nowrap"},Zr={key:0,class:"fixed inset-0 z-50 flex items-center justify-center w-full"},Jr={class:"relative bg-bg-card rounded-lg p-4 mx-3 w-full max-w-md lg:max-w-2xl xl:max-w-3xl"},Gr={class:"flex flex-col gap-2 mt-4"},Xr={class:"text-sm text-muted mb-2"},Yr={class:"flex gap-2 w-full"},ei={key:0,class:"mt-1 w-full bg-bg-card rounded-md max-h-64 overflow-y-auto"},ti=["onClick"],li={class:"flex items-center justify-between"},si={class:"font-medium"},ai={class:"text-muted text-xs ml-2"},ni={class:"flex gap-2 text-xs"},oi={class:"text-muted border border-border-input rounded-md px-3 py-1"},ri={key:1,class:"absolute top-full left-0 mt-1 w-full bg-bg-card border border-border-input rounded-md shadow-md p-4 z-50 text-center text-muted"},ii={key:0,class:"w-full h-full min-h-[250px] flex justify-center items-center"},di={key:1,class:"flex-1 min-h-0 overflow-y-auto"},ui={key:1,class:"bg-bg-card w-full p-6 flex flex-col justify-center h-full items-center text-center gap-4"},ci={class:"text-sm text-text-primary font-semibold mb-1 text-center"},pi={class:"text-sm text-text-primary/90 mb-3 max-w-120 text-center"},vi={key:2,class:"w-full h-full min-h-[250px] flex flex-col items-center justify-center text-center gap-4 p-6"},fi={class:"text-sm text-text-primary font-semibold mb-1 text-center"},mi={class:"text-sm text-text-primary/90 mb-3 max-w-120 text-center"},al=400,gi=pt({__name:"Plan",setup(O){const{isDark:N}=il(),Z=m(!1),$=m(!1),U=m(""),H=m(!1),u=m(!1),{canCreateCard:z}=Ll(),R=m(!1),L=m(null),A=m([]),ne=m(null),oe=m(!1),q=m(!1),M=C(()=>s.value.value),J=m(""),Q=m(!1),I=ks(),F=m(!1),f=m([]),g=[{label:"Milestone",value:"milestone",dot:"#7D68C8"},{label:"Sprint",value:"sprint",dot:"#7D68C8"},{label:"Huddle",value:"huddle",dot:"#7D68C8"}],o=C(()=>M.value?M.value.charAt(0).toUpperCase()+M.value.slice(1):""),s=m(g[0]),p=m(null),k=m(!1);sl(p,()=>{k.value=!1});const ee=()=>{Z.value=!1},le=()=>{R.value=!0,localStorage.setItem("activeSprintId",G.value||"")},y=m(!1),B=()=>{y.value=!y.value},_e=r=>{Z.value=!0,kt.value=r.card,ie()},{workspaceId:K}=fs(),re=m(!1),{moveSelectedToSprint:$e,moveSelectedToBacklog:Oe,deleteSelected:Dt,saveSprintMeta:Ie,toggleStartSprint:Bt}=ra();function Xe(){!L.value||!A.value.length||(A.value.forEach(r=>{vt({sprintId:L.value,cardId:r})}),Te())}function Te(){De.value=!1,L.value=null,A.value=[]}const{mutate:vt,isPending:ft}=Hs({onSuccess:()=>{Dt("sprint",L.value),$.value=!1,yt(),Te()}}),Re=m("");function Fe(r,n){!G.value||!r.length||(console.log("Deleting selected sprint tickets:",r,n),L.value=G.value,A.value=r,Re.value=n,$.value=!0)}function xe(r){J.value=r,I.setActiveMilestoneId(r),localStorage.setItem("activeMilestoneId",r),localStorage.setItem("sprintType","milestone"),V.value=r||"all",D.value=!1}function Ye(r){J.value=r,V.value=r,I.setActiveMilestoneId(r),localStorage.setItem("activeMilestoneId",r),localStorage.setItem("sprintType","huddle"),D.value=!1}function Vt(r){J.value=r,I.setActiveMilestoneId(r),typeof window<"u"&&localStorage.setItem("activeMilestoneId",r),localStorage.setItem("sprintType","sprint"),D.value=!1}const{data:w,refetch:h}=Vl(K,M,J);P(J,()=>{h()});const{data:x}=Os(K),de=C(()=>{var r;return((r=x.value)==null?void 0:r.modules.filter(n=>{var X;return((X=n==null?void 0:n.variables)==null?void 0:X["module-title"])!=="Pin"}))||[]});P(()=>M.value,(r,n)=>{r!==n&&h()});const{mutate:fe,isPending:mt}=Rs({onSuccess:()=>{Et.invalidateQueries({queryKey:["sprint-list"]}),De.value=!1}}),se=m(null),De=m(!1),Ft=()=>{var r;fe((r=se.value)==null?void 0:r._id)},{mutate:pe,isPending:Nt}=ds({onSuccess:r=>{Ie({name:r.title}),Wt({id:G.value,payload:{title:r.title,start_date:r.start_date,end_date:r.end_date,goal:r.goal,duration:Number(r.duration_days)}}),ze.value=!1}}),{mutate:Wt,isPending:gt}=Fs({onSuccess:()=>{Lt()}}),bt=async r=>{Q.value=!0;try{await pe({id:G.value,payload:{title:r.title,duration:r.duration,start_date:r.start,end_date:r.end,goal:r.goal}})}finally{Q.value=!1}},{data:ve,refetch:Qt,isLoading:cl}=Ws(K.value,M),pl=C(()=>{var r;return((r=ve.value)==null?void 0:r.sprints)??[]});P(()=>M.value,(r,n)=>{r!==n&&Qt()});const{refetch:vl,isPending:fl}=Vl(K,M,m("")),zt=C(()=>{var r,n;return(n=(r=ve==null?void 0:ve.value)==null?void 0:r.sprints[0])==null?void 0:n._id}),G=m(zt.value);P(()=>zt.value,r=>{G.value=r}),P(()=>G.value,r=>{var n;se.value=((n=ve.value)==null?void 0:n.sprints.find(X=>X._id===r))||null});const{data:ue,refetch:Lt}=Qs(G,{enabled:C(()=>!!G.value)}),ze=m(!1),Ue=()=>{localStorage.setItem("asFirstTime",JSON.stringify(!0)),ze.value=!0},ml=()=>JSON.parse(localStorage.getItem("asFirstTime")||"false"),Kt=()=>{var r;((r=ue.value)==null?void 0:r.status)==="active"&&ml()&&(R.value=!0,localStorage.setItem("asFirstTime",JSON.stringify(!1)))};rs(()=>{Kt()}),P(()=>{var r;return(r=ue.value)==null?void 0:r.status},()=>{Kt()});const{data:xt,refetch:yt,isFetching:gl}=Ks(G);P(()=>G.value,()=>{G.value&&Lt()});const We=m(""),et=m(null),ht=C(()=>{const r=xt.value;if(!We.value||!(r!=null&&r.backlog_items))return[];const n=We.value.toLowerCase().trim();return r.backlog_items.filter(X=>{var lt,st,at,nt,ot,rt,it,dt,qt,Ht;const Me=((at=(st=(lt=X.card)==null?void 0:lt.variables)==null?void 0:st["card-title"])==null?void 0:at.toLowerCase())||"",Pe=((rt=(ot=(nt=X.card)==null?void 0:nt.variables)==null?void 0:ot["card-code"])==null?void 0:rt.toLowerCase())||"",$t=((qt=(dt=(it=X.card)==null?void 0:it.variables)==null?void 0:dt["card-status"])==null?void 0:qt.toLowerCase())||"",ae=((Ht=X.priority)==null?void 0:Ht.toLowerCase())||"",He=String(X._id||"").toLowerCase(),Je=String(X.card_id||"").toLowerCase();return Me.includes(n)||Pe.includes(n)||$t.includes(n)||ae.includes(n)||He.includes(n)||Je.includes(n)})});function bl(r){We.value=r}function Pt(){ht.value.length===1&&Mt(ht.value[0])}const xl={high:"bg-red-500/20 text-red-500",medium:"bg-yellow-500/20 text-yellow-500",low:"bg-green-500/20 text-green-500"};function yl(r){const n=r==null?void 0:r.toLowerCase();return xl[n]??"bg-gray-500/20 text-gray-500"}const je=C(()=>{var X,Me,Pe,$t;const r=(X=xt.value)==null?void 0:X.backlog_items;if(!r)return null;const n=(r||[]).map(ae=>{var lt,st,at,nt,ot,rt,it,dt;const He=((lt=ae==null?void 0:ae.card)==null?void 0:lt.variables)||{},Je=((st=ae==null?void 0:ae.card)==null?void 0:st._id)||ae.card_id;return{id:Je,_id:(at=ae==null?void 0:ae.card)==null?void 0:at._id,key:He["card-code"]||(Je==null?void 0:Je.slice(-6))||"PRJ-?",summary:He["card-title"]||"(untitled)",type:"Story",status:Zt(String(He["card-status"]||"").trim()),assignee:((ot=(nt=ae==null?void 0:ae.card)==null?void 0:nt.assigned_to)==null?void 0:ot.u_full_name)||"Unassigned",image:((it=(rt=ae==null?void 0:ae.card)==null?void 0:rt.assigned_to)==null?void 0:it.u_avatar)||"",storyPoints:Number(ae.story_points||0),priority:hl(String(He.priority||"").trim()),createdAt:((dt=ae==null?void 0:ae.card)==null?void 0:dt.created_at)||new Date().toISOString(),description:He["card-description"]||""}});return{id:(Me=xt.value)==null?void 0:Me._id,name:((Pe=xt.value)==null?void 0:Pe.title)||"Sprint 1",title:($t=xt.value)==null?void 0:$t.title,goal:"",start:"",end:"",started:!1,tickets:n}});function Mt(r){console.log("selected sprint id",r),G.value=r._id,i.value=!1}function Zt(r){const n=r.toLowerCase();return n.includes("progress")?"In Progress":n.includes("done")||n.includes("complete")?"Done":"Todo"}function hl(r){const n=r.toLowerCase();return n==="highest"||n==="blocker"||n==="critical"?"Highest":n==="high"||n==="major"?"High":n==="medium"||n==="normal"?"Medium":"Low"}const{mutate:_t}=Zs({onSuccess:()=>{ct.success("Card removed from sprint successfully"),It()},onError:r=>{ct.error("Failed to remove card from sprint",r)}});function It(){yt(),Qt(),vl(),Lt()}function _l(r,n){const X=Array.isArray(r)?r:[r],Me=n||G.value;!Me||!X.length||X.forEach(Pe=>{_t({sprintId:Me,cardId:Pe})})}const kl=m(!1),kt=m(null);function Ot(){re.value=!0,kt.value=null}function Jt(r){kt.value=r,Z.value=!0,kl.value=!0}const tt=m(!1);function Qe(){tt.value=!0}const Et=Al(),{mutate:Gt,isPending:Ke}=Js({onSuccess:r=>{Ie({name:r.title}),Et.invalidateQueries({queryKey:["sprint-list"]}),tt.value=!1}}),{mutate:Ve,isPending:Ut}=ds({onSuccess:r=>{Ie({name:r.title}),Et.invalidateQueries({queryKey:["sprint-list"]}),tt.value=!1}}),be=m("");function Ze(r){const n=be.value.trim();if(!n||n===r.title){l();return}Ve({id:r._id,payload:{workspace_id:K.value,title:n}}),qe.value=null}function Xt(r){var n;se.value?Ve({id:(n=se.value)==null?void 0:n._id,payload:{workspace_id:K.value,title:r.name,sprintType:r.value,description:r.description}}):Gt({payload:{workspace_id:K.value,title:r.name,sprintType:r.value,description:r.description}})}const Yt=m([]);function wl(r){se.value=null,tt.value=!0,Yt.value=r}function Sl(r){se.value=r,De.value=!0}const{mutate:Cl,isPending:el}=Gs(G,{onSuccess:()=>{Lt()}}),tl=()=>{Cl({})},wt=m(null),St=m(0);let At=!1;rs(()=>{if(!wt.value)return;const r=wt.value.offsetWidth;St.value=r/3});function Ct(){At=!0,document.addEventListener("mousemove",ll),document.addEventListener("mouseup",jt)}function ll(r){if(!At||!wt.value)return;const n=wt.value.getBoundingClientRect(),X=r.clientX-n.left;X<al?St.value=al:X>n.width-al?St.value=n.width-al:St.value=X}function jt(){At=!1,document.removeEventListener("mousemove",ll),document.removeEventListener("mouseup",jt)}const qe=m(null);function $l(r){qe.value=r._id,r.tempTitle=r.title,be.value=r.title}function l(){var n;const r=(n=ve.value)==null?void 0:n.sprints.find(X=>X._id===qe.value);r&&(r.tempTitle=r.title),qe.value=null}sl(ne,()=>{q.value=!1});const t=r=>{console.log("selected type",r),s.value=r,oe.value=!1};sl(p,()=>{oe.value=!1});const a=m(null),i=m(!1);sl(a,()=>{i.value=!1});const c=m(!1),W=()=>{c.value=!0},ie=()=>{c.value=!1,We.value=""},V=m("all"),D=m(!1),T=C(()=>{var n,X,Me;if(V.value==="all")return"All Milestones";const r=(X=(n=x.value)==null?void 0:n.modules)==null?void 0:X.find(Pe=>Pe._id===V.value);return((Me=r==null?void 0:r.variables)==null?void 0:Me["module-title"])??"All Milestones"}),ge=m(!1),Le=()=>{ge.value=!ge.value};function ce(){f.value.length&&(Fe(f.value,`${f.value.length} ticket(s)`),ge.value=!1)}return(r,n)=>{var X,Me,Pe,$t,ae,He,Je,lt,st,at,nt,ot,rt,it,dt,qt,Ht,Bl,Nl,zl,Pl,Ol,Ul,jl,ql,Hl,Rl,Fl,Wl,Ql,Kl,Zl,Jl,Gl,Xl,Yl;return d(),v("div",Ko,[R.value||Q.value?(d(),he(Qo,{key:0,sptint_id:G.value,searchQuery:U.value,"active-sprint":M.value,onGoBack:n[0]||(n[0]=_=>R.value=!1)},null,8,["sptint_id","searchQuery","active-sprint"])):(d(),v("div",Zo,[e("div",Jo,[e("div",Go,[e("div",Xo,[b(gt)?E("",!0):(d(),v("div",Yo,[e("div",{ref_key:"containerRef",ref:wt,class:"flex gap-1 min-h-0 overflow-x-auto group h-full"},[e("section",{class:"px-4 rounded-md relative flex flex-col min-h-0 bg-bg-card h-full border border-border",style:ye({width:St.value+"px"})},[e("div",er,[e("h2",tr,[ut(e("input",{type:"checkbox",class:"custom-checkbox bg-bg-body border border-border-input flex-shrink-0","onUpdate:modelValue":n[1]||(n[1]=_=>H.value=_)},null,512),[[Us,H.value]]),te(" Tickets ("+S((Me=(X=b(w))==null?void 0:X.cards)==null?void 0:Me.length)+" "+S((($t=(Pe=b(w))==null?void 0:Pe.cards)==null?void 0:$t.length)>1?"Tasks":"Task")+") ",1)]),e("div",lr,[b(z)?(d(),v("button",{key:0,class:"w-8 h-8 rounded cursor-pointer text-sm hover:bg-bg-body flex items-center justify-center",onClick:Ot},n[24]||(n[24]=[e("i",{class:"text-text-primary fa-regular fa-plus"},null,-1)]))):E("",!0)],512)]),e("div",sr,[M.value==="milestone"?(d(),v("div",ar,[e("button",{onClick:n[2]||(n[2]=_=>xe("")),class:Y(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium transition-colors whitespace-nowrap",J.value===""?"bg-accent text-white border-none":"bg-transparent text-accent border border-accent"])},[n[25]||(n[25]=te(" All Modules ")),J.value===""?(d(),v("span",nr," ("+S((He=(ae=b(w))==null?void 0:ae.cards)==null?void 0:He.length)+") ",1)):E("",!0)],2),(d(!0),v(Ce,null,Ne(de.value,_=>{var ke,Ee;return d(),v("button",{key:_._id,onClick:Tl=>xe(_._id),class:Y(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",J.value===_._id?"bg-accent text-white border-none":"bg-transparent text-accent border border-accent"])},[te(S(_.variables["module-title"])+" ",1),J.value===_._id?(d(),v("span",rr," ("+S((Ee=(ke=b(w))==null?void 0:ke.cards)==null?void 0:Ee.length)+") ",1)):E("",!0)],10,or)}),128))])):M.value==="huddle"||M.value==="sprint"?(d(),v("div",ir,[e("div",dr,[e("button",{class:"h-8 min-w-[160px] flex items-center justify-between px-2 rounded-md border text-sm border-border hover:bg-bg-body",onClick:n[3]||(n[3]=_=>D.value=!D.value)},[e("span",ur,[e("img",{src:b(Xa),alt:"filter",class:"w-4 h-4"},null,8,cr),e("span",pr,[te(S(T.value||"All Milestones")+" ",1),e("span",vr," ("+S((lt=(Je=b(w))==null?void 0:Je.cards)==null?void 0:lt.length)+") ",1)])]),n[26]||(n[26]=e("i",{class:"fas fa-chevron-down text-xs ml-2"},null,-1))]),D.value?(d(),v("div",fr,[e("ul",mr,[e("li",{class:"px-3 py-2 cursor-pointer hover:bg-bg-body hover:text-primary",onClick:n[4]||(n[4]=_=>xe(""))}," All Milestones "),(d(!0),v(Ce,null,Ne(de.value,_=>(d(),v("li",{key:_._id,class:"px-3 py-2 cursor-pointer hover:bg-bg-body hover:text-primary",onClick:ke=>Ye(_._id)},S(_.variables["module-title"]),9,gr))),128))])])):E("",!0)]),e("div",br,[(d(!0),v(Ce,null,Ne(pl.value,_=>(d(),v("button",{key:_._id,onClick:ke=>Vt(_._id),class:Y(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium whitespace-nowrap transition-colors",J.value===_._id?"bg-accent text-white border-none":"bg-transparent text-accent border border-accent"])},S(_.title),11,xr))),128))])])):E("",!0)]),b(fl)?(d(),v("div",yr,n[27]||(n[27]=[e("div",{role:"status","aria-label":"Loading",class:"h-10 w-10 rounded-full border-4 border-accent border-t-transparent animate-spin"},null,-1)]))):(d(),v("div",hr,[j(Sa,{checkedAll:H.value,"sprint-type":M.value,searchQuery:U.value,"module-id":J.value,onMoveSelectedToSprint:b($e),onDeleteSelectedBacklog:n[5]||(n[5]=_=>b(Dt)("backlog")),onOpenTicket:Jt,onTicketMovedToBacklog:_l,onOpenCreateTicket:Ot},null,8,["checkedAll","sprint-type","searchQuery","module-id","onMoveSelectedToSprint"])]))],4),e("div",_r,[(d(),v("svg",{onMousedown:Ct,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 cursor-col-resize opacity-0 group-hover:opacity-100 transition",role:"img","aria-label":"Resize"},n[28]||(n[28]=[e("path",{fill:"currentColor",d:"M10 3h4v2h-4V3zm0 4h4v2h-4V7zm0 4h4v2h-4v-2zm0 4h4v2h-4v-2zm0 4h4v2h-4v-2z"},null,-1),e("path",{fill:"currentColor",d:"M4 2h2v20H4V2zm14 0h2v20h-2V2z",opacity:"0.4"},null,-1)]),32))]),e("section",kr,[e("div",wr,[e("div",Sr,[e("div",{ref_key:"elipseWrapperSprint",ref:ne,class:"relative inline-block"},[e("button",{onClick:n[6]||(n[6]=Se(_=>q.value=!q.value,["stop"])),class:"flex items-center gap-2 lg:px-3 px-2 py-1.5 text-sm font-medium bg-transparent rounded-lg",style:ye({border:"1px solid "+s.value.dot})},[e("span",{class:"w-2 h-2 rounded-full hidden lg:flex",style:ye({backgroundColor:s.value.dot})},null,4),te(" "+S(s.value.label)+" ",1),n[29]||(n[29]=e("i",{class:"fas fa-chevron-down text-xs"},null,-1))],4),j(is,{name:"fade"},{default:me(()=>[q.value?(d(),v("ul",{key:0,onClick:n[7]||(n[7]=Se(()=>{},["stop"])),class:"absolute left-0 mt-2 w-44 bg-bg-dropdown border border-border rounded-xl shadow-lg z-50"},[(d(),v(Ce,null,Ne(g,_=>e("li",{key:_.value,onClick:ke=>(t(_),q.value=!q.value),class:"flex items-center gap-3 px-4 py-2 text-sm cursor-pointer hover:bg-bg-body hover:text-primary"},[e("span",{class:"w-2 h-2 rounded-full",style:ye({backgroundColor:_.dot})},null,4),te(" "+S(_.label),1)],8,Cr)),64))])):E("",!0)]),_:1})],512),e("div",$r,[e("div",Tr,[e("div",{ref_key:"sprintDropdownWrapperRef",ref:a,class:"relative min-w-0"},[(st=b(ve))!=null&&st.sprints.length?(d(),v("button",{key:0,onClick:n[8]||(n[8]=_=>i.value=!i.value),class:Y(["flex items-center gap-3 lg:px-6 px-1 py-1.5 rounded-lg text-sm font-medium transition-all",G.value?"text-white":"bg-gray-100 hover:bg-card hover:text-primary"]),style:ye(G.value?{backgroundColor:s.value.dot}:{})},[e("span",Dr,S((ot=(nt=(at=b(ve))==null?void 0:at.sprints)==null?void 0:nt.find(_=>_._id===G.value))==null?void 0:ot.title),1),n[30]||(n[30]=e("i",{class:"fas fa-chevron-down text-xs"},null,-1))],6)):E("",!0),i.value?(d(),v("div",Vr,[(d(!0),v(Ce,null,Ne((rt=b(ve))==null?void 0:rt.sprints,_=>{var ke;return d(),v("div",{key:_._id,class:"relative px-4 py-2 flex items-center justify-between text-sm cursor-pointer transition-color"},[e("div",Lr,[qe.value!==_._id?(d(),v("button",{key:0,class:"text-left truncate w-full",onClick:Ee=>Mt(_)},S(_.title),9,Mr)):ut((d(),v("input",{key:1,ref_for:!0,ref:"editingInputRef","onUpdate:modelValue":n[9]||(n[9]=Ee=>be.value=Ee),class:"w-full px-1 py-1 text-sm rounded outline-none bg-bg-card border border-[#7d68c8]",placeholder:"Enter new name",onClick:n[10]||(n[10]=Se(()=>{},["stop"])),onBlur:Ee=>Ze(_),onKeyup:[nl(Ee=>Ze(_),["enter"]),nl(l,["esc"])]},null,40,Ir)),[[El,be.value]])]),e("div",Er,[e("button",{class:"ml-2 text-xs text-gray-400 hover:text-accent",onClick:Se(Ee=>$l(_),["stop"])},n[31]||(n[31]=[e("i",{class:"fas fa-pen"},null,-1)]),8,Ar),(ke=b(ve))!=null&&ke.sprints.length&&qe.value!==_._id?(d(),v("button",{key:0,onClick:Se(Ee=>Sl(_),["stop"]),class:"w-4 h-4 rounded-full flex items-center justify-center text-red-500"},n[32]||(n[32]=[e("i",{class:"fas fa-times text-xs"},null,-1)]),8,Br)):E("",!0)])])}),128))])):E("",!0)],512)])]),e("button",{onClick:n[11]||(n[11]=_=>{var ke;return wl((ke=b(ve))==null?void 0:ke.sprints)}),class:Y(["w-8 h-8 lg:flex sm:hidden items-center justify-center rounded-full border text-white transition-colors shrink-0"]),style:ye({backgroundColor:s.value.dot})},n[33]||(n[33]=[e("i",{class:"fa-solid fa-plus"},null,-1)]),4)]),e("div",Nr,[e("div",zr,[(dt=(it=b(ue))==null?void 0:it.cards)!=null&&dt.length?(d(),v("button",{key:0,class:"flex items-center justify-center w-8 h-8 me-2 rounded-full bg-accent",onClick:W,style:ye(G.value?{backgroundColor:s.value.dot}:{})},n[34]||(n[34]=[e("i",{class:"fa-solid fa-magnifying-glass text-white"},null,-1)]),4)):E("",!0),((qt=b(ue))==null?void 0:qt.status)==="active"&&b(ue).cards.length?(d(),v("button",{key:1,class:"flex lg:hidden cursor-pointer text-white items-center justify-center rounded-full ms-2 w-7 h-7 text-sm font-medium mt-0.5",onClick:le,style:ye(G.value?{backgroundColor:s.value.dot}:{})},n[35]||(n[35]=[e("i",{class:"fa-regular fa-eye text-sm"},null,-1)]),4)):E("",!0)]),e("div",Pr,[((Ht=b(ue))==null?void 0:Ht.status)==="active"?(d(),v("div",Or,[j(Ge,{size:"sm",onClick:tl,variant:(b(N),"primary"),class:"border-border-input border",style:ye(G.value?{backgroundColor:s.value.dot}:{})},{default:me(()=>[te(S(b(el)?"Ending...":"End"),1)]),_:1},8,["variant","style"]),e("button",{class:"cursor-pointer text-white flex items-center justify-end gap-1 px-2 py-1 rounded-md text-sm font-medium",onClick:le,style:ye(G.value?{backgroundColor:s.value.dot}:{})},n[36]||(n[36]=[e("i",{class:"fa-regular fa-eye text-sm"},null,-1),te(" Preview ")]),4),((Bl=b(ue))==null?void 0:Bl.status)==="active"&&F.value?(d(),v("div",Ur,[e("i",{class:"fa-solid fa-ellipsis-vertical text-lg mt-2 cursor-pointer",onClick:Se(Le,["stop"])}),ge.value?(d(),v("div",jr,[e("div",{class:"px-3 py-2 text-sm text-red-500 cursor-pointer hover:bg-bg-dropdown-menu-hover",onClick:ce},n[37]||(n[37]=[e("div",{class:"flex justify-between"},[e("span",null,"Delete"),e("i",{class:"fa-light fa-trash mt-0.5"})],-1)]))])):E("",!0)])):E("",!0)])):(d(),v("div",qr,[((Nl=b(ue))==null?void 0:Nl.status)!=="completed"?(d(),he(Ge,{key:0,size:"sm",variant:(b(N),"primary"),class:"border-border-input border",onClick:Ue,disabled:!je.value||je.value.tickets.length===0||((zl=b(ue))==null?void 0:zl.status)==="completed",style:ye({backgroundColor:s.value.dot})},{default:me(()=>[te(" Start "+S(s.value.label),1)]),_:1},8,["variant","disabled","style"])):E("",!0)]))]),je.value&&je.value.tickets.length?(d(),v("div",Hr,[e("span",Rr,S((Pl=b(ue))==null?void 0:Pl.status),1),((Ol=b(ue))==null?void 0:Ol.status)==="active"?(d(),v("div",Fr,[e("button",{onClick:tl,class:"w-7 h-7 flex items-center justify-center rounded-full bg-accent",title:b(el)?"Ending...":"End Sprint",style:ye(G.value?{backgroundColor:s.value.dot}:{})},n[38]||(n[38]=[e("i",{class:"fa-solid fa-flag-checkered text-white"},null,-1)]),12,Wr)])):(d(),v("button",{key:1,onClick:Ue,disabled:!je.value||je.value.tickets.length===0||((Ul=b(ue))==null?void 0:Ul.status)==="completed",class:"w-7 h-7 flex items-center justify-center rounded-full text-white bg-accent disabled:opacity-50 disabled:cursor-not-allowed lg:hidden",title:"Start Sprint",style:ye(G.value?{backgroundColor:s.value.dot}:{})},n[39]||(n[39]=[e("i",{class:"fa-solid fa-play text-sm"},null,-1)]),12,Qr))])):E("",!0),((jl=b(ue))==null?void 0:jl.status)==="active"?(d(),v("div",{key:1,class:"relative inline-flex",onMouseenter:n[12]||(n[12]=_=>y.value=!0),onMouseleave:n[13]||(n[13]=_=>y.value=!1),onClick:B},[n[40]||(n[40]=e("span",{class:"flex lg:hidden bg-emerald-500 text-white w-7 h-7 rounded-full justify-center items-center cursor-pointer"},[e("i",{class:"fa-solid fa-check"})],-1)),ut(e("div",Kr," Sprint is active ",512),[[rl,y.value]])],32)):E("",!0)]),j(is,{name:"fade"},{default:me(()=>[c.value?(d(),v("div",Zr,[e("div",{class:"absolute inset-0 bg-black/10 backdrop-blur-sm",onClick:ie}),e("div",Jr,[e("div",{class:"flex justify-end"},[e("button",{onClick:ie,class:"px-2 py-1 rounded bg-bg-input border border-border-input text-accent"},n[41]||(n[41]=[e("i",{class:"fa-solid fa-xmark"},null,-1)]))]),e("div",Gr,[e("p",Xr," Search for "+S(M.value)+" by name, status, or priority. Start typing to filter results. ",1),e("div",Yr,[j(Ys,{placeholder:`Search in ${M.value}`,onOnChange:bl,onKeyup:nl(Pt,["enter"]),class:"flex-1"},null,8,["placeholder"])]),ht.value.length&&We.value?(d(),v("div",ei,[e("ul",null,[(d(!0),v(Ce,null,Ne(ht.value,_=>{var ke,Ee,Tl,es,ts,ls;return d(),v("li",{key:_._id,onClick:bi=>_e(_),class:"px-4 py-2 cursor-pointer hover:bg-bg-hover text-text-primary border-b border-border-input"},[e("div",li,[e("div",null,[e("span",si,S((Ee=(ke=_.card)==null?void 0:ke.variables)==null?void 0:Ee["card-title"]),1),e("span",ai," ("+S((es=(Tl=_.card)==null?void 0:Tl.variables)==null?void 0:es["card-code"])+") ",1)]),e("div",ni,[e("span",{class:Y(["px-3 py-1 rounded text-md",yl(_.priority)])},S(_.priority),3),e("span",oi,S((ls=(ts=_.card)==null?void 0:ts.variables)==null?void 0:ls["card-status"]),1)])])],8,ti)}),128))])])):We.value&&!ht.value.length?(d(),v("div",ri," No "+S(M.value)+' found matching "'+S(We.value)+'" ',1)):E("",!0)])])])):E("",!0)]),_:1})]),b(cl)||b(gl)?(d(),v("div",ii,n[42]||(n[42]=[e("div",{role:"status","aria-label":"Loading",class:"h-10 w-10 rounded-full border-4 border-accent border-t-transparent animate-spin"},null,-1)]))):(d(),v("div",di,[je.value&&["planning","active"].includes((Hl=(ql=b(ue))==null?void 0:ql.status)==null?void 0:Hl.toLowerCase())?(d(),he(Fa,{key:0,searchQuery:U.value,sprintId:G.value,searchedData:et.value?[et.value]:[],label:M.value,checkedSprintAll:u.value,sprint:je.value,onOpenTicket:Jt,onEditSprint:Qe,onToggleStart:b(Bt),onMoveSelectedToBacklog:b(Oe),onDeleteSelectedSprint:Fe,onRefresh:It,onCheckedChange:n[14]||(n[14]=_=>F.value=_),onSelectionChange:n[15]||(n[15]=_=>f.value=_)},null,8,["searchQuery","sprintId","searchedData","label","checkedSprintAll","sprint","onToggleStart","onMoveSelectedToBacklog"])):E("",!0),((Fl=(Rl=b(ue))==null?void 0:Rl.status)==null?void 0:Fl.toString().trim().toLowerCase())==="completed"?(d(),v("div",ui,[n[45]||(n[45]=e("div",{class:"w-16 h-16 flex justify-center items-center text-white rounded-full text-3xl"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 117.72 117.72","aria-hidden":"true"},[e("path",{fill:"#42ba96",d:`M58.86,0c9.13,0,17.77,2.08,25.49,5.79c-3.16,2.5-6.09,4.9-8.82,7.21c-5.2-1.89-10.81-2.92-16.66-2.92\r
                  c-13.47,0-25.67,5.46-34.49,14.29c-8.83,8.83-14.29,21.02-14.29,34.49c0,13.47,5.46,25.66,14.29,34.49\r
                  c8.83,8.83,21.02,14.29,34.49,14.29s25.67-5.46,34.49-14.29c8.83-8.83,14.29-21.02,14.29-34.49\r
                  c0-3.2-0.31-6.34-0.9-9.37c2.53-3.3,5.12-6.59,7.77-9.85c2.08,6.02,3.21,12.49,3.21,19.22\r
                  c0,16.25-6.59,30.97-17.24,41.62c-10.65,10.65-25.37,17.24-41.62,17.24c-16.25,0-30.97-6.59-41.62-17.24\r
                  C6.59,89.83,0,75.11,0,58.86c0-16.25,6.59-30.97,17.24-41.62S42.61,0,58.86,0z\r
                  M31.44,49.19L45.8,49l1.07,0.28c2.9,1.67,5.63,3.58,8.18,5.74c1.84,1.56,3.6,3.26,5.27,5.1\r
                  c5.15-8.29,10.64-15.9,16.44-22.9c6.35-7.67,13.09-14.63,20.17-20.98l1.4-0.54H114l-3.16,3.51\r
                  C101.13,30,92.32,41.15,84.36,52.65C76.4,64.16,69.28,76.04,62.95,88.27l-1.97,3.8l-1.81-3.87\r
                  c-3.34-7.17-7.34-13.75-12.11-19.63c-4.77-5.88-10.32-11.1-16.79-15.54L31.44,49.19z`})])],-1)),e("h6",ci,S(o.value)+" Completed ",1),e("p",pi,[te(" This "+S(M.value)+" has been successfully completed. To continue planning work, create a new "+S(M.value)+" by clicking the ",1),n[43]||(n[43]=e("strong",null,"plus (+)",-1)),n[44]||(n[44]=te(" button and start organizing upcoming tasks. "))])])):E("",!0),((Wl=b(ue))==null?void 0:Wl.length)<1||((Ql=b(ve))==null?void 0:Ql.sprints.length)<1?(d(),v("div",vi,[n[48]||(n[48]=e("div",{class:"w-16 h-16 flex items-center justify-center rounded-full bg-muted/10 text-accent"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-20 h-20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("h6",fi," No "+S(M.value)+"s available ",1),e("p",mi,[te(" You don’t have any "+S(M.value)+"s yet. Create a new "+S(M.value)+" to start planning and organizing your work. Click the ",1),n[46]||(n[46]=e("strong",null,"plus (+)",-1)),n[47]||(n[47]=te(" button to get started. "))])])):E("",!0)]))])],512)]))])])])])),j(ea,{onClick:n[16]||(n[16]=Se(()=>{},["stop"])),modelValue:De.value,"onUpdate:modelValue":n[17]||(n[17]=_=>De.value=_),title:`Delete ${M.value}`,itemLabel:M.value,itemName:(Kl=se.value)==null?void 0:Kl.title,requireMatchText:(Zl=se.value)==null?void 0:Zl.title,confirmText:`Delete ${M.value}`,cancelText:"Cancel",size:"md",loading:b(mt),onConfirm:Ft,onCancel:n[18]||(n[18]=()=>{se.value=null,De.value=!1})},null,8,["modelValue","title","itemLabel","itemName","requireMatchText","confirmText","loading"]),j(un,{modelValue:$.value,"onUpdate:modelValue":n[19]||(n[19]=_=>$.value=_),title:`Delete ${Re.value}`,itemLabel:M.value,itemName:(Jl=se.value)==null?void 0:Jl.title,requireMatchText:(Gl=se.value)==null?void 0:Gl.title,confirmText:"Delete Ticket",cancelText:"Cancel",size:"md",loading:b(ft),onConfirm:Xe,onCancel:Te},null,8,["modelValue","title","itemLabel","itemName","requireMatchText","loading"]),j(Ga,{modelValue:tt.value,"onUpdate:modelValue":n[20]||(n[20]=_=>tt.value=_),onSave:Xt,sprint:se.value,lable:M.value,creatingSprint:se.value?b(Ut):b(Ke),sprints:Yt.value},null,8,["modelValue","sprint","lable","creatingSprint","sprints"]),j(Sn,{sprint:se.value,modelValue:ze.value,"onUpdate:modelValue":n[21]||(n[21]=_=>ze.value=_),onSave:bt,creatingSprint:b(gt)||b(Nt),sprintType:M.value},null,8,["sprint","modelValue","creatingSprint","sprintType"]),j(js,{modelValue:Z.value,"onUpdate:modelValue":n[22]||(n[22]=_=>Z.value=_),cardId:((Xl=kt.value)==null?void 0:Xl.id)||((Yl=kt.value)==null?void 0:Yl._id),onClose:ee},null,8,["modelValue","cardId"]),j(oo,{modelValue:re.value,"onUpdate:modelValue":n[23]||(n[23]=_=>re.value=_)},null,8,["modelValue"])])}}}),Ei=dl(gi,[["__scopeId","data-v-61e27a28"]]);export{Ei as default};
