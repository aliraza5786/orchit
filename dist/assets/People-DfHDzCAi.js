const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KanbanBoard-DQUsbCRa.js","assets/lodash-B3d4OLnQ.js","assets/index-f4VPBcGQ.js","assets/index-CO1eJH23.css","assets/DropMenu.vue_vue_type_script_setup_true_lang-Cv5LPV9f.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-B89PVan0.js","assets/KanbanBoard-CCl7J72V.css","assets/KanbanCard-D3JxmQhx.js","assets/usePeople-CX0eS2kD.js"])))=>i.map(i=>d[i]);
import{d as he,T as De,R as Ae,r as p,n as C,c as L,b as Ve,ac as Se,b4 as Pe,j as u,z as le,f as o,i as x,k as D,a8 as Ee,p as c,b3 as $e,g as M,t as y,N as Ie,aH as Te,C as ve,M as Ue,ab as ye,h as V,F as oe,y as pe,e as fe,H as _e,ah as Le,o as n,S as be,I as Re,K as Ne,v as Oe,b5 as Ke,D as ge,w as se,B as ke,a5 as we,_ as Be,a6 as Ce}from"./index-f4VPBcGQ.js";import{D as qe,K as je}from"./Dropdown-DxZIYKZu.js";import{b as ze,c as Qe,d as Me,e as We,f as Fe,g as He,h as Je,i as Ye,R as Ze,j as Ge}from"./usePeople-CX0eS2kD.js";import{_ as Xe}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-B89PVan0.js";import{_ as et}from"./BaseEmailChip.vue_vue_type_script_setup_true_lang-coOAXs9C.js";import{_ as tt}from"./ProgressBar.vue_vue_type_script_setup_true_lang-BFGOWIet.js";import{F as at}from"./fuse-Ch1WBRTM.js";import{l as st}from"./lodash-B3d4OLnQ.js";import{_ as lt}from"./SearchBar.vue_vue_type_script_setup_true_lang-D86Nlx0t.js";const ot={class:"pt-[17px] pb-[18px] flex justify-between items-center border-b border-border px-5 sticky top-0 bg-bg-card z-1"},it={class:"py-4 px-5"},dt={class:"bg-bg-surface/50 p-2 rounded-lg flex gap-2 items-center"},nt=["src"],rt={key:0,class:"fa-solid fa-user text-white"},ut={class:"text-base font-medium text-text-primary cursor-pointer"},ct={class:"text-sm font-medium text-text-secondary cursor-pointer"},mt={class:"flex flex-col mt-2"},pt={class:"text-sm text-text-secondary mt-2"},vt={key:0},ft={class:"mb-2 capitalize"},xt=["onKeydown"],yt={class:"mt-5 pt-3 border-t border-border-input relstive"},_t={key:1,class:"mt-3"},bt={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},gt={class:"text-sm text-text-primary"},kt={key:2,class:"mt-3"},wt={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},Ct={class:"text-sm text-text-primary"},ht=he({__name:"DetailPanel",props:{showPanel:{type:Boolean,default:!0},details:{type:Object,default:()=>({})}},emits:["close","update:details","comment:post","priority:change"],setup(v,{emit:xe}){var G;const{canEditUser:R}=De(),N=Ae({}),_=p("details"),ie=[{label:"Details",value:"details"},{label:"Tasks",value:"tasks"},{label:"History",value:"history"}],{data:B}=ze(),{mutate:A}=Qe({onSuccess:()=>{b.invalidateQueries({queryKey:["people-lists"]})}}),a=v,f=p(!1),r=p(a.details["card-title"]??""),de=p(a.details.workspace_lane_id??"");C(()=>a.details["card-title"],l=>{r.value=l,de.value=a.details.workspace_lane_id});const ne=p(a.details["card-description"]);C(()=>a.details,()=>{ne.value=a.details["card-description"]}),C(()=>a.details,()=>{var l;(l=a.details)!=null&&l.variable_values&&a.details.variable_values.forEach(s=>{N[s.module_variable_id]=s.value})},{immediate:!0,deep:!0});const S=p(null);function W(){f.value=!0,Le(()=>{var l,s;(l=S.value)==null||l.focus(),(s=S.value)==null||s.select()})}function F(){r.value.trim()||(r.value=a.details["card-title"]??""),P.mutate({card_id:a.details._id,variables:{"card-title":r.value.trim()}}),f.value=!1}function O(){r.value=a.details["card-title"]??"",f.value=!1}const q=p({startDate:a.details["start-date"],endDate:a.details["end-date"]}),re=L(()=>a.details["start-date"]);C(re,l=>{q.value={...q.value,startDate:l}});const b=Ve(),P=Se({onSuccess:()=>{b.invalidateQueries({queryKey:["get-sheets"]}),b.invalidateQueries({queryKey:["sheet-list"]}),b.invalidateQueries({queryKey:["roles"]})}}),H=(l,s)=>{console.log(s,"slug",l),N[s]=l,A({id:a.details._id,payload:{variable_values:[{module_variable_id:s,value:l}]}})};function ue(l){var s,$,h,I;if((s=a==null?void 0:a.details)!=null&&s.variable_values){const T=($=a==null?void 0:a.details)==null?void 0:$.variable_values.filter(K=>K.module_variable_id==l);return console.log((h=T[0])==null?void 0:h.value,">>>"),(I=T[0])==null?void 0:I.value}}const j=L(()=>{var l;return(l=a.details)==null?void 0:l.workspace_id}),{data:z}=Pe(j,{enabled:L(()=>!!j.value)}),J=L(()=>{var l;return((l=z.value)==null?void 0:l.company_id)??null}),{data:Y}=Me(J,{enabled:L(()=>!!J.value)}),E=p(((G=a.details)==null?void 0:G.workspace_access_role_id)??""),{mutate:Z}=We({onSuccess:()=>{console.log("Role assigned successfully!"),b.invalidateQueries({queryKey:["people-lists"]})},onError:l=>console.error(l)});C(E,l=>{var s;Z({id:(s=a.details)==null?void 0:s._id,workspace_access_role_id:l})}),C(()=>{var l;return(l=a.details)==null?void 0:l.workspace_access_role_id},l=>{E.value=l??""}),C(()=>{var l;return(l=a.details)==null?void 0:l._id},()=>{var l;E.value=((l=a.details)==null?void 0:l.workspace_access_role_id)??""},{immediate:!0});function ce(){R||be.error("You have no permission to edit user details")}function me(l){var s;if(!R){be.error("You have no permission to edit user details");return}E.value=l,Z({id:(s=a.details)==null?void 0:s._id,workspace_access_role_id:l})}return(l,s)=>{var $,h,I,T,K,X,ee,U,te,ae,Q,e,t,m,k;return n(),u("div",{class:le(`max-w-[358px] bg-bg-card  rounded-lg overflow-y-auto overflow-x-hidden relative ${v.showPanel?"!translate-x-0 w-full h-full min-w-[350px] overflow-y-auto":"!translate-x-100 w-0 h-0"} transition-all`)},[o("div",ot,[s[4]||(s[4]=o("h5",{class:"text-[16px] font-medium"},"Profile",-1)),o("i",{class:"cursor-pointer text-text-primary fa-solid fa-close",onClick:s[0]||(s[0]=()=>{l.$emit("close")})})]),o("div",it,[o("div",dt,[($=v.details)!=null&&$.avatar?(n(),u("img",{key:0,src:(h=v.details)==null?void 0:h.avatar,class:"w-10 h-10 rounded-full",alt:"avartar"},null,8,nt)):(n(),u("div",{key:1,class:"min-w-10 max-h-10 aspect-square bg-bg-surface flex justify-center items-center rounded-full",style:Ee({backgroundColor:(I=v.details)!=null&&I.name?c($e)({email:(T=v.details)==null?void 0:T.email}):""})},[M(y(c(Ie)((K=v.details)==null?void 0:K.name))+" ",1),(X=v.details)!=null&&X.name?D("",!0):(n(),u("i",rt))],4)),o("div",null,[o("h1",ut,y(v.details.name??v.details.title),1),o("p",ct,y(v.details.email),1)])]),x(Te,{modelValue:_.value,"onUpdate:modelValue":s[1]||(s[1]=i=>_.value=i),class:"my-2",options:ie},null,8,["modelValue"]),o("div",mt,[s[5]||(s[5]=o("h1",{class:"text-base font-medium text-text-primary cursor-pointer"}," Task Progress ",-1)),x(tt,{class:"mt-2",progress:(ee=a==null?void 0:a.details)==null?void 0:ee.assigned_cards_count,fillColor:"bg-accent ",indeterminate:!0},null,8,["progress"]),o("span",pt,"Completed 10 tasks out of "+y((U=a==null?void 0:a.details)==null?void 0:U.assigned_cards_count),1)]),_.value=="details"?(n(),u("section",vt,[o("div",ft,[f.value?ve((n(),u("input",{key:0,ref_key:"titleInput",ref:S,"onUpdate:modelValue":s[2]||(s[2]=i=>r.value=i),onBlur:F,onKeydown:[ye(V(F,["prevent"]),["enter"]),ye(V(O,["prevent"]),["esc"])],class:"border border-border rounded px-2 py-1 w-full text-xl font-medium",type:"text"},null,40,xt)),[[Ue,r.value]]):(n(),u("h1",{key:1,class:"text-xl font-medium text-text-primary cursor-pointer",onClick:W},y(r.value),1))]),o("div",null,[(n(!0),u(oe,null,pe(c(B),(i,g)=>{var d;return n(),u("div",{key:g,class:"grid grid-cols-2 capitalize items-center gap-2 text-sm mt-4"},[M(y(i.title)+" ",1),(n(),fe(_e,{size:"sm","model-value":N[i._id],key:g,placeholder:` ${i.title}`,onClick:s[3]||(s[3]=V(()=>{},["stop"])),defaultValue:ue(i==null?void 0:i._id),options:i==null?void 0:i.data.map(w=>({_id:w,title:w})),cardId:(d=v.details)==null?void 0:d._id,canEditCard:!c(R),"onUpdate:modelValue":w=>H(w,i._id)},null,8,["model-value","placeholder","defaultValue","options","cardId","canEditCard","onUpdate:modelValue"]))])}),128))]),o("div",yt,[s[6]||(s[6]=o("span",{class:"text-sm inline-block mb-1"},"Select Role",-1)),(n(),fe(_e,{size:"sm","model-value":E.value,options:(c(Y)||[]).map(i=>({_id:i._id,title:i.title})),placeholder:"Select Role",onClick:V(ce,["stop"]),"onUpdate:modelValue":me,canEditCard:!c(R),key:(te=c(Y))==null?void 0:te.length},null,8,["model-value","options","canEditCard"]))])])):D("",!0),_.value=="tasks"?(n(),u("section",_t,[s[8]||(s[8]=o("span",{class:"text-base text-text-primary"},"Worked On",-1)),((Q=(ae=v.details)==null?void 0:ae.assigned_cards)==null?void 0:Q.length)>0?(n(),u("ul",bt,[(n(!0),u(oe,null,pe((e=v.details)==null?void 0:e.assigned_cards,(i,g)=>(n(),u("li",{class:"p-2",key:g},[o("h1",gt,y(i==null?void 0:i.title),1),s[7]||(s[7]=o("p",{class:"text-xs text-text-secondary"}," Design Project . Olivia Updated on April 9, 2025 ",-1))]))),128))])):D("",!0)])):D("",!0),_.value=="history"?(n(),u("section",kt,[s[10]||(s[10]=o("span",{class:"text-base text-text-primary"},"history",-1)),((m=(t=v.details)==null?void 0:t.assignment_history)==null?void 0:m.length)>0?(n(),u("ul",wt,[(n(!0),u(oe,null,pe((k=v.details)==null?void 0:k.assignment_history,(i,g)=>(n(),u("li",{class:"p-2",key:g},[o("h1",Ct,y(i==null?void 0:i.title),1),s[9]||(s[9]=o("p",{class:"text-xs text-text-secondary"}," Design Project . Olivia Updated on April 9, 2025 ",-1))]))),128))])):D("",!0)])):D("",!0)])],2)}}}),Dt=Re(ht,[["__scopeId","data-v-5046e406"]]),Vt={class:"flex-auto flex-grow h-full bg-bg-card rounded-[6px] border border-border overflow-x-auto flex-col flex"},At={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},St={class:"flex gap-3 items-center"},Pt={class:"flex p-4 overflow-x-auto gap-3 custom_scroll_bar"},Et=["onClick","disabled"],$t={key:1,class:"p-4 space-y-2 bg-bg-surface m-4 rounded-md"},It={class:"text-sm text-text-primary"},Tt={class:"flex items-center mt-3 gap-3"},Ut=["disabled"],Qt=he({__name:"People",setup(v){const xe=we(()=>Ce(()=>import("./KanbanBoard-DQUsbCRa.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),R=we(()=>Ce(()=>import("./KanbanCard-D3JxmQhx.js"),__vite__mapDeps([7,2,3,4,5,8]))),{canCreateVariable:N,canInviteUser:_}=De(),ie=[{title:"Role",_id:"role"},{title:"Team",_id:"team"},{title:"Status",_id:"status"}],B=p("role"),A=p(!1),a=p(),{workspaceId:f}=Ne(),r=p([]),{mutate:de,isPending:ne}=Fe({onSuccess:e=>{r.value=[...r.value||[],e],P.value="",b.value=!1}}),{data:S,isPending:W}=He(f.value,B);C(S,e=>{r.value=e?JSON.parse(JSON.stringify(e)):[]}),Oe(()=>{r.value=S.value?JSON.parse(JSON.stringify(S.value)):[]});const F=p("kanban"),O=p(),q=e=>{O.value=e},re=e=>{},b=p(!1),P=p("");function H(){b.value=!b.value}function ue(){console.log(">>> clicking on adding pepople ");const e=P.value.trim();j(e)}const j=e=>{console.log(">>> clicking on adding pepople ");const t={workspace_id:f.value,title:e,max_num_people:1};de({payload:t})},z=Ve(),J=Ke({onSuccess:()=>{z.invalidateQueries({queryKey:["people-lists"]})}}),Y=e=>{const t={workspace_id:f.value,title:e==null?void 0:e.title,max_num_people:1};J.mutate({id:e._id,payload:t})},{mutate:E,isPending:Z}=Je({onSuccess:e=>{A.value=!1,r.value=r.value.filter(t=>{var m;return t._id!==((m=e.deletedRole)==null?void 0:m._id)})}}),ce=()=>{var e;E({id:(e=a.value)==null?void 0:e.columnId})},me=e=>{A.value=!0,a.value=e},{mutate:G,isPending:l}=Ye({onSuccess:e=>{P.value="",b.value=!1,console.log(a.value,">>>. id local column");const t=r.value.findIndex(g=>g._id===a.value._id);if(t===-1)return;console.log(t,"index>>>");const m=r.value[t],k=[...m.cards??[],e==null?void 0:e.assigned_seat],i={...m,cards:k};r.value=[...r.value.slice(0,t),i,...r.value.slice(t+1)],z.invalidateQueries({queryKey:["people-lists"]}),z.invalidateQueries({queryKey:["workspaceRoles"]})}}),s=e=>{a.value=e;const t={name:e!=null&&e.email?$(e==null?void 0:e.email[0]):"",email:e!=null&&e.email?e==null?void 0:e.email[0]:"",role_id:e==null?void 0:e._id,workspace_id:f==null?void 0:f.value,additional_seats:1};G({id:e._id,payload:t})};function $(e){const m=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return m.length?m.map(k=>k.charAt(0).toUpperCase()+k.slice(1).toLowerCase()).join(" "):e}const h=e=>{_.value&&(window.dispatchEvent(new CustomEvent("close-all-showADDNEW")),e.showADDNEW=!e.showADDNEW)},I=e=>{s(e)},T=e=>{O.value=e},K=Ze(),X=Ge();function ee(e){console.log(e,">>"),e.type=="column"?K.mutate({id:f.value,payload:{role_id:e.meta._id,new_sort_order:e.meta.newIndex}}):X.mutate({id:e.meta.toColumnId,payload:{team_member_id:e.meta.moved._id,new_sort_order:e.meta.newIndex}})}const U=p(""),te=p("");C(U,st.debounce(e=>{te.value=e},200));const ae=L(()=>{const e=r.value.flatMap(t=>t.cards.map(m=>({...m,columnId:t.title})));return new at(e,{keys:["title","name"],threshold:.3})}),Q=L(()=>{if(!U.value)return r.value;const e=ae.value.search(U.value).map(t=>t.item);return r.value.map(t=>({...t,cards:e.filter(m=>m.columnId===t.title)}))});return(e,t)=>{var m,k,i,g;return n(),u(oe,null,[o("div",Vt,[o("div",At,[x(qe,{actions:!1,prefix:"View By",modelValue:B.value,"onUpdate:modelValue":t[0]||(t[0]=d=>B.value=d),options:ie,variant:"secondary"},null,8,["modelValue"]),o("div",St,[x(lt,{class:"max-w-[250px]",onOnChange:t[1]||(t[1]=d=>{U.value=d}),placeholder:"Search in Orchit AI space"})])]),ve(x(je,null,null,512),[[ge,c(W)]]),ve(o("div",Pt,[((m=Q.value)==null?void 0:m.length)>0?(n(),fe(c(xe),{key:0,plusIcon:!1,onOnPlus:t[3]||(t[3]=d=>s(d)),"onDelete:column":t[4]||(t[4]=d=>me(d)),"onUpdate:column":t[5]||(t[5]=d=>Y(d)),onReorder:ee,onAddColumn:j,"onSelect:ticket":q,board:Q.value,onOnBoardUpdate:re,variable_id:"",sheet_id:"selected_sheet_id"},{ticket:se(({ticket:d})=>[x(c(R),{onClick:w=>T(d),ticket:d},null,8,["onClick","ticket"])]),"column-footer":se(({column:d})=>[d.showADDNEW?d.showADDNEW?(n(),u("div",$t,[o("p",It,y(d.title)+" "+y(d.cards.length+1),1),x(et,{maxEmails:1,placeholder:"team member email",modelValue:d.email,"onUpdate:modelValue":w=>d.email=w},null,8,["modelValue","onUpdate:modelValue"]),t[14]||(t[14]=o("p",{class:"text-sm text-text-secondary"},"You can assign user later",-1)),x(ke,{size:"md",onClick:w=>I(d)},{default:se(()=>[M(y(c(l)?"Adding...":"Add Seat"),1)]),_:2},1032,["onClick"]),o("i",{class:"fa-solid fa-close cursor-pointer ml-2",onClick:t[2]||(t[2]=w=>h(""))})])):D("",!0):(n(),u("div",{key:0,onClick:w=>h(d),disabled:!c(_),class:le([c(_)?"cursor-pointer":"cursor-not-allowed","flex py-3 px-3 justify-center text-sm text-text-primary items-center gap-3 border border-text-primary border-dashed mb-4 mx-4 rounded-md"])},t[13]||(t[13]=[o("i",{class:"fa-solid fa-plus"},null,-1),M(" Add Seat ")]),10,Et))]),_:1},8,["board"])):D("",!0),o("div",{class:"min-w-[328px]",onClick:t[8]||(t[8]=V(()=>{},["stop"]))},[b.value?(n(),u("form",{key:0,onSubmit:t[7]||(t[7]=V(()=>{},["prevent"])),class:"bg-bg-body rounded-lg p-4"},[x(Be,{autofocus:!0,modelValue:P.value,"onUpdate:modelValue":t[6]||(t[6]=d=>P.value=d),placeholder:"Add New list"},null,8,["modelValue"]),t[15]||(t[15]=o("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),o("div",Tt,[x(ke,{disabled:!c(_),class:le([c(_)?"cursor-pointer":"cursor-not-allowed","px-3 py-1 bg-accent text-white rounded"]),onClick:ue,type:"submit",variant:"primary"},{default:se(()=>[M(y(c(ne)?"Adding...":"Add Team"),1)]),_:1},8,["disabled","class"]),o("i",{class:"fa-solid fa-close cursor-pointer",onClick:H})])],32)):(n(),u("button",{key:1,class:le(["text-sm text-text-primary py-2.5 font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",c(N)?"cursor-pointer":"cursor-not-allowed"]),onClick:V(H,["stop"]),disabled:!c(N)}," + Add Team ",10,Ut))])],512),[[ge,F.value=="kanban"&&!c(W)]])]),x(Xe,{onClick:t[9]||(t[9]=V(()=>{},["stop"])),modelValue:A.value,"onUpdate:modelValue":t[10]||(t[10]=d=>A.value=d),title:"Delete List",itemLabel:"list",itemName:(k=a.value)==null?void 0:k.title,requireMatchText:(i=a.value)==null?void 0:i.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:c(Z),onConfirm:ce,onCancel:t[11]||(t[11]=()=>{A.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),x(Dt,{details:O.value,onClose:t[12]||(t[12]=()=>{q({})}),showPanel:!!((g=O.value)!=null&&g.title)},null,8,["details","showPanel"])],64)}}});export{Qt as default};
