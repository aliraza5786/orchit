import{r as g,m as U,v as W,d as D,c as h,i,e as t,t as u,y as J,h as I,f as V,j as P,o as n,_ as G,p as X,q as Z,b as ee,F as C,x as E,n as te,w as se,aA as ae,S as j,a1 as w}from"./index-lr5JxJGD.js";import{t as T}from"./useQueryParams-BLs6_Xx1.js";import{_ as oe}from"./ProgressBar.vue_vue_type_script_setup_true_lang-BGOQu7sM.js";function re(k,{start:d=0,maxWhileLoading:v=90,step:r=.8,intervalMs:m=120}={}){const o=g(d);let p=null;const l=()=>{p==null&&(p=window.setInterval(()=>{k()&&(o.value=Math.min(o.value+r,v))},m))},f=()=>{p!=null&&(clearInterval(p),p=null)};return U(k,A=>{A?(o.value=d,l()):(o.value=100,setTimeout(()=>{o.value=d,f()},300))},{immediate:!0}),W(f),o}const le={class:"relative p-3 rounded-lg min-w-sm border border-border overflow-hidden flex flex-col justify-between bg-bg-card w-full"},ne={class:"flex justify-between items-start pb-2"},ie={class:"text-lg font-semibold text-text-primary text-left"},de={class:"text-xs text-text-secondary text-left"},ue={class:"flex items-center gap-2"},ce={key:1,class:"text-xs"},me={class:""},ge={class:"flex justify-between text-sm text-text-secondary mb-1"},ve={key:0,class:"fa-regular text-left fa-arrows-spin animate-spin duration-250"},pe=D({__name:"ProjectCard",props:{title:{},subtitle:{},status:{},progress:{default:0},avatars:{},maxVisible:{default:2},date:{},loading:{type:Boolean,default:!1},color:{default:"#9CA3AF"},totalCard:{default:0}},setup(k){const d=k,v=re(()=>!!d.loading),r=h(()=>d.loading?v.value:d.progress);h(()=>d.avatars.slice(0,d.maxVisible)),h(()=>d.avatars.length>d.maxVisible?d.avatars.length-d.maxVisible:0);const m=h(()=>Math.round(r.value)>=100),o=g(0);U(m,(l,f)=>{l&&!f&&o.value++});function p(l){switch(l){case"completed":return"bg-green-400/40 border-green-400 text-green-400";case"failed":return"bg-red-400/40 border-red-400 text-red-400";case"in_progress":return"bg-blue-400/20 border-blue-400 text-blue-400";case"pending":return"bg-amber-400/20 border-amber-400 text-amber-400";default:return"progress-default"}}return(l,f)=>(n(),i("div",le,[t("div",ne,[t("div",null,[t("h3",ie,u(l.title),1),t("p",de,u(l.subtitle),1)]),t("div",ue,[!l.totalCard&&l.status?(n(),i("span",{key:0,class:J(["text-xs border rounded-full px-2 py-0.5",p(l.status)])},u(l.status),3)):(n(),i("span",ce,"Total Cards: "+u(l.totalCard),1))])]),t("div",me,[t("div",ge,[t("div",null,[t("span",null,u(l.status=="in_progress"?"Generating lane with AI...":"Progress"),1),f[0]||(f[0]=V()),l.status=="in_progress"?(n(),i("i",ve)):P("",!0)]),t("span",null,[V(u(Math.round(r.value))+"% ",1),m.value?(n(),i("span",{key:o.value,class:"confetti-icon select-none","aria-label":"Completed"}," ðŸŽ‰ ")):P("",!0)])]),I(oe,{class:"mt-2",progress:r.value,fillColor:"bg-accent",indeterminate:!!l.loading},null,8,["progress","indeterminate"])])]))}}),N=G(pe,[["__scopeId","data-v-92bf594a"]]),fe={class:"flex flex-col gap-4 h-full overflow-x-auto w-full flex-auto"},be={class:"p-5 rounded-lg bg-bg-card space-y-6"},xe={class:"flex items-center justify-between"},he={class:"flex flex-col w-full"},_e={class:"flex gap-2.5 overflow-x-auto w-full py-8"},ye=["onClick"],we=["onClick"],ke={class:"flex flex-grow gap-4"},Se={class:"bg-bg-card w-full flex-auto p-5 rounded-lg"},Ce={class:"space-y-4"},Ee={class:"flex items-center gap-2 w-32 flex-shrink-0"},Ie={key:1,class:"w-8 h-8 rounded-full bg-bg-body flex items-center justify-center"},Pe={class:"text-sm text-text-primary truncate"},Ae={class:"flex-1"},Be={class:"h-6 bg-bg-body rounded overflow-hidden relative"},Oe={key:0,class:"absolute inset-0 flex items-center justify-start px-2 text-xs text-text-primary font-medium"},je={class:"bg-bg-card w-full flex-auto p-5 rounded-lg overflow-hidden flex flex-col"},De={class:"space-y-4 overflow-y-auto flex-1"},Le={class:"flex-1 min-w-0"},$e={class:"text-sm text-text-primary"},Me={class:"font-medium text-accent/90"},Re={class:"text-text-secondary"},Ve={href:"#",class:"text-accent/90 hover:underline"},Te={class:"text-xs text-text-secondary mt-1"},F=5,Ne=D({__name:"Peak",setup(k){const d=g(!1),v=g(null),r=g(null),m=g(0),o=g({}),p="https://backend.streamed.space/api/v1/workspace",l=h(()=>{var s;return((s=v.value)==null?void 0:s.percent)==100}),f=h(()=>{var s,a;return((a=(s=v.value)==null?void 0:s.result)==null?void 0:a.lanes_summary)??[]}),A=h(()=>{var s,a;return((a=(s=v.value)==null?void 0:s.progress_details)==null?void 0:a.lanes_progress)??[]}),S=g(!1),L=["https://randomuser.me/api/portraits/women/1.jpg","https://randomuser.me/api/portraits/men/2.jpg","https://randomuser.me/api/portraits/men/3.jpg"],_=X(),z=h(()=>{var s;return T((s=_==null?void 0:_.params)==null?void 0:s.id)}),b=h(()=>{var s;return T((s=_==null?void 0:_.params)==null?void 0:s.job_id)}),B=()=>{if(r.value&&r.value.readyState===EventSource.OPEN||m.value>=F)return;r.value&&r.value.close();const s=localStorage.getItem("token")||"",a=b!=null&&b.value?b==null?void 0:b.value:localStorage.getItem("jobId")?localStorage.getItem("jobId"):z.value,e=localStorage.getItem("jobId")||b!=null&&b.value?"false":"true",y=`${p}/step2/tasks/${a}/stream?token=${s}&is_manual=${e}`;try{r.value=new EventSource(y,{withCredentials:!1}),r.value.onopen=()=>{S.value=!0,d.value=!0,m.value=0,o.value={...o.value,connectionStatus:"Connected",lastConnected:new Date().toISOString(),url:y},S.value=!1},r.value.onmessage=c=>{try{const x=JSON.parse(c.data);v.value=x,o.value={...o.value,lastMessage:x,lastMessageTime:new Date().toISOString()},["completed","failed","canceled"].includes(x.status)&&setTimeout(O,1200)}catch(x){o.value={...o.value,parseError:x==null?void 0:x.message,rawMessage:c.data}}},r.value.addEventListener("progress",c=>{try{v.value=JSON.parse(c.data)}catch{}}),r.value.addEventListener("error",c=>{try{o.value={...o.value,serverError:JSON.parse(c.data)}}catch{}}),r.value.onerror=()=>{var c;if(d.value=!1,o.value={...o.value,connectionError:!0,errorTime:new Date().toISOString(),readyState:(c=r.value)==null?void 0:c.readyState},m.value<F){m.value++;const x=Math.min(3e4,1e3*2**m.value);setTimeout(B,x)}}}catch(c){o.value={...o.value,creationError:c==null?void 0:c.message,errorTime:new Date().toISOString()}}},O=()=>{r.value&&(r.value.close(),r.value=null),d.value=!1,o.value={...o.value,disconnectedAt:new Date().toISOString()}},H=()=>{O(),m.value=0,setTimeout(B,600)};Z(()=>{B(),document.addEventListener("visibilitychange",$)}),W(()=>{O(),document.removeEventListener("visibilitychange",$)});const $=()=>{!document.hidden&&!d.value&&(!r.value||r.value.readyState===EventSource.CLOSED)&&H()},M=s=>{console.log("Lane clicked:",s)},Y=g([{id:1,name:"Unassigned",initials:"",avatar:!1,color:"#6B7280",workload:13},{id:2,name:"Amal Lashari",initials:"AL",avatar:!0,color:"#3B82F6",workload:35},{id:3,name:"Anam Rehman",initials:"AR",avatar:!0,color:"#3B82F6",workload:8},{id:4,name:"Sufian",initials:"S",avatar:!0,color:"#6B7280",workload:8},{id:5,name:"Arooj Sajjad",initials:"AS",avatar:!0,color:"#EF4444",workload:5}]),q=g([{id:1,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-33073: IPU: Agenda Multilingual Issue (global issue)",status:"DEPLOYED-PROD",time:"about 4 hours ago"},{id:2,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-31468: Show/Hide Team Members on Booth",status:"REOPENED",time:"about 4 hours ago"},{id:3,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-32359: Favicon not displaying after uploading from Event Settings",status:"",time:"about 4 hours ago"}]),K=s=>({"DEPLOYED-PROD":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",REOPENED:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200","IN-PROGRESS":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"})[s]||"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",Q=D({name:"SkeletonCard",setup(){return()=>w("div",{class:"w-[380px] min-w-[280px] h-[180px] rounded-xl border border-border bg-bg-body/60 animate-pulse p-4"},[w("div",{class:"h-5 w-2/3 rounded bg-bg-card/50 mb-2"}),w("div",{class:"h-3 w-1/2 rounded bg-bg-card/50 mb-4"}),w("div",{class:"h-2 w-full rounded bg-bg-card/50 mb-1"}),w("div",{class:"h-2 w-11/12 rounded bg-bg-card/50 mb-1"}),w("div",{class:"h-2 w-10/12 rounded bg-bg-card/50"})])}}),R=(s,a)=>{if(s==0)return 0;const e=a.Done??0,y=e/s*100;return console.log(e,">>",s),y};return(s,a)=>(n(),i("div",fe,[t("div",be,[t("div",xe,[t("div",he,[a[0]||(a[0]=t("h3",{class:"text-2xl text-text-primary font-semibold"},"Project Overview",-1)),a[1]||(a[1]=t("p",{class:"text-sm text-text-secondary mt-2"},"Last update on Sep 12, 2024 - 09.45 AM",-1)),t("div",_e,[S.value?(n(),i(C,{key:0},E(3,e=>I(te(Q),{key:e})),64)):(n(),ee(ae,{key:1,name:"list",tag:"div",class:"flex gap-2.5"},{default:se(()=>[l.value?(n(!0),i(C,{key:0},E(f.value,e=>(n(),i("button",{key:e==null?void 0:e.lane_title,class:"group focus:outline-none border-border border focus-visible:ring-2 focus-visible:ring-primary/50 rounded-xl",type:"button",role:"button","aria-label":"Open lane details",onClick:y=>M(e)},[I(N,{loading:S.value||(e==null?void 0:e.status)==="in_progress",title:e==null?void 0:e.lane_title,subtitle:"Mobile Application",progress:l.value?R(e==null?void 0:e.total_cards,e==null?void 0:e.status_distribution):e==null?void 0:e.progress,totalCard:e==null?void 0:e.total_cards,status:l.value?"":e==null?void 0:e.status,avatars:L,date:"May 28",class:"transition-transform duration-200 ease-out group-hover:shadow-lg border border-transparent hover:border-border-subtle rounded-xl cursor-pointer"},null,8,["loading","title","progress","totalCard","status"])],8,ye))),128)):(n(!0),i(C,{key:1},E(A.value,e=>(n(),i("button",{key:`2-${e==null?void 0:e.lane_title}`,class:"group focus:outline-none border-border border focus-visible:ring-2 focus-visible:ring-primary/50 rounded-xl",type:"button",role:"button","aria-label":"Open lane details",onClick:y=>M(e)},[I(N,{loading:S.value||(e==null?void 0:e.status)==="in_progress",title:e==null?void 0:e.lane_title,subtitle:"Mobile Application",progress:l.value?R(e==null?void 0:e.total_cards,e==null?void 0:e.status_distribution):e==null?void 0:e.progress,totalCard:e==null?void 0:e.total_cards,status:l.value?"":e==null?void 0:e.status,avatars:L,date:"May 28",class:"transition-transform duration-200 ease-out group-hover:shadow-lg border border-transparent hover:border-border-subtle rounded-xl cursor-pointer"},null,8,["loading","title","progress","totalCard","status"])],8,we))),128))]),_:1}))])])])]),t("div",ke,[t("div",Se,[a[4]||(a[4]=t("div",{class:"mb-4"},[t("h3",{class:"text-lg font-semibold text-text-primary"},"Team workload"),t("p",{class:"text-sm text-text-secondary mt-1"}," Monitor the capacity of your team. ")],-1)),t("div",Ce,[a[3]||(a[3]=t("div",{class:"flex items-center justify-between text-sm font-medium text-text-secondary mb-2"},[t("span",null,"Assignee"),t("span",null,"Work distribution")],-1)),(n(!0),i(C,null,E(Y.value,e=>(n(),i("div",{key:e.id,class:"flex items-center gap-3"},[t("div",Ee,[e.avatar?(n(),i("div",{key:0,class:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-medium",style:j({backgroundColor:e.color})},u(e.initials),5)):(n(),i("div",Ie,a[2]||(a[2]=[t("i",{class:"pi pi-user text-text-secondary"},null,-1)]))),t("span",Pe,u(e.name),1)]),t("div",Ae,[t("div",Be,[t("div",{class:"h-full bg-border-subtle transition-all duration-300",style:j({width:e.workload+"%"})},null,4),e.workload>10?(n(),i("span",Oe,u(e.workload)+"% ",1)):P("",!0)])])]))),128))])]),t("div",je,[a[6]||(a[6]=t("div",{class:"mb-4"},[t("h3",{class:"text-lg font-semibold text-text-primary"},"Recent activity"),t("p",{class:"text-sm text-text-secondary mt-1"},"Stay up to date with what's happening across the project.")],-1)),t("div",De,[a[5]||(a[5]=t("div",{class:"text-xs font-semibold text-text-secondary mb-3"},"Today",-1)),(n(!0),i(C,null,E(q.value,e=>(n(),i("div",{key:e.id,class:"flex gap-3 pb-4 border-b border-border last:border-0"},[t("div",{class:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-medium flex-shrink-0",style:j({backgroundColor:e.userColor})},u(e.userInitials),5),t("div",Le,[t("div",$e,[t("span",Me,u(e.user),1),t("span",Re,u(e.action),1),t("a",Ve,u(e.item),1),e.status?(n(),i("span",{key:0,class:J(["ml-2 px-2 py-0.5 rounded text-xs font-medium",K(e.status)])},u(e.status),3)):P("",!0)]),t("div",Te,u(e.time),1)])]))),128))])])])]))}}),Je=G(Ne,[["__scopeId","data-v-2476db5d"]]);export{Je as default};
