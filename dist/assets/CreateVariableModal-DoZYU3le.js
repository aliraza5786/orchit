import{d as L,K as Q,U as $,c as x,r as n,L as G,c0 as R,e as W,o as m,w as v,h as l,k as i,l as g,m as H,_ as y,B as V,i as _,C as J,a9 as X,F as Y,y as Z,t as B,p as T,W as ee}from"./index-CYISEzkl.js";const te={class:"px-6 py-4 flex flex-col gap-4"},le={class:"flex gap-2 items-start"},ae={class:"flex-1 flex flex-col gap-1"},oe={class:"flex items-center gap-2 select-none"},se={key:0,class:"mt-2 border border-border rounded-md p-2 bg-bg-input max-h-48 overflow-auto"},re={class:"font-medium"},ne=["onClick"],ie={class:"flex justify-end gap-2 px-6 py-4 border-t border-border sticky bottom-0 bg-bg-body"},pe=L({__name:"CreateVariableModal",props:{modelValue:{type:Boolean,default:!1},sheetID:{}},emits:["update:modelValue"],setup(I,{emit:M}){const{moduleId:U,workspaceId:E}=Q(),{canCreateVariable:q}=$(),N=M,h=I,u=x({get:()=>h.modelValue,set:t=>N("update:modelValue",t)}),s=n(""),o=n(""),p=n(""),r=n([]),c=n(!0),f=n(""),d=n("");function z(){f.value=s.value.trim()?s.value.length>30?"Maximum 30 characters allowed":"":"Dropdown title is required"}function F(){d.value=o.value.trim()?o.value.length>30?"Maximum 30 characters allowed":"":"Option title is required"}const w=x(()=>!d.value&&o.value.trim()!=="");function P(){w.value&&(r.value.push(o.value.trim()),o.value="",d.value="")}function S(t){r.value.splice(t,1)}const k=x(()=>{const t=s.value.trim();return t.length>0&&t.length<=30&&r.value.length>0}),j=G(),{mutate:b,isPending:C}=R({onSuccess:()=>{O(),j.invalidateQueries({queryKey:["all-module-variables"]}),u.value=!1},onError:t=>{console.error("Mutation failed:",(t==null?void 0:t.response)??t)}});function A(){if(!k.value||!q.value)return;const t={description:p.value,title:s.value.trim(),data:r.value,workspace_module_id:U.value,workspace_id:E.value,filterable:c.value,visible_on_card:!1,type_id:"",sheet_id:h.sheetID};if(console.log(">>> helo",t),typeof b!="function"){console.error("createVariable is not a function. Got:",b);return}b({payload:t})}function K(){O(),u.value=!1}function O(){s.value="",o.value="",p.value="",r.value=[],f.value="",d.value="",c.value=!0}return(t,e)=>(m(),W(ee,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value=a),size:"sm"},{default:v(()=>[e[8]||(e[8]=l("div",{class:"flex flex-col gap-1 px-6 pb-6 border-b border-border sticky top-0 bg-bg-body z-10"},[l("h2",{class:"text-lg font-semibold"},"Create Dropdown"),l("p",{class:"text-sm text-text-secondary"},"Provide a title and add options for your dropdown.")],-1)),l("div",te,[i(y,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value=a),label:"Dropdown Title",placeholder:"Enter dropdown title (max 30 chars)",error:f.value!="",maxlength:"30",onInput:z},null,8,["modelValue","error"]),i(y,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=a=>p.value=a),label:"Option Description",placeholder:"Optional description"},null,8,["modelValue"]),l("div",le,[l("div",ae,[i(y,{modelValue:o.value,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value=a),label:"Option Title",placeholder:"Option title (max 30 chars)",error:!!d.value,maxlength:"30",onInput:F},null,8,["modelValue","error"])]),i(V,{class:"mt-6",size:"md",variant:"primary",disabled:!w.value,onClick:P},{default:v(()=>e[5]||(e[5]=[_(" Add ")])),_:1,__:[5]},8,["disabled"])]),l("label",oe,[J(l("input",{id:"filterable-toggle",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=a=>c.value=a),class:"h-4 w-4 accent-primary"},null,512),[[X,c.value]]),e[6]||(e[6]=l("span",{class:"text-sm",for:"filterable-toggle"},"Show this dropdown in filters",-1))]),r.value.length?(m(),g("ul",se,[(m(!0),g(Y,null,Z(r.value,(a,D)=>(m(),g("li",{key:D,class:"flex justify-between items-center px-2 py-1 border-b border-border last:border-b-0"},[l("div",null,[l("span",re,B(a),1)]),l("button",{class:"text-red-500",onClick:de=>S(D)},"âœ•",8,ne)]))),128))])):H("",!0)]),l("div",ie,[i(V,{variant:"secondary",onClick:K},{default:v(()=>e[7]||(e[7]=[_("Cancel")])),_:1,__:[7]}),i(V,{variant:"primary",disabled:!k.value||T(C),onClick:A},{default:v(()=>[_(B(T(C)?"Creating...":" Create Dropdown"),1)]),_:1},8,["disabled"])])]),_:1,__:[8]},8,["modelValue"]))}});export{pe as default};
