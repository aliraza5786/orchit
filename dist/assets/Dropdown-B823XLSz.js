import{d as ye,r as u,c as r,aw as ge,x as be,m as a,g as o,f as B,F as n,n as i,b4 as Y,t as y,k as S,G as I,h as ke,ap as we,w as he,ay as _e,al as Ce,bt as $e,o as s,l as g,ah as ze,P as Se,E as Z,bu as Ne,bv as De,bw as Be,bx as Ie,N as Ve}from"./index-Bau3eFG3.js";import{o as Ee}from"./index-sNcY8Umf.js";const Re=["src"],Me={key:0,class:"font-bold"},Te={class:"text-nowrap"},Fe=["onClick","onMouseenter"],Pe={class:"flex items-center gap-2 min-w-0 flex-1"},je=["src"],Ae={class:"flex flex-col gap-1 max-w-40"},Ue={class:"overflow-hidden font-semibold overflow-ellipsis"},We={key:0,class:"min-w-40 line-clamp-2 text-wrap text-text-secondary text-xs"},Ge={key:1,class:"fa-regular text-left fa-arrows-spin animate-spin duration-250"},Le={key:0,class:"pl-2 flex items-center relative ml-auto"},Oe={class:"py-1 text-sm"},qe=["onClick"],He={key:1,class:"pl-2 flex items-center relative"},Je=["onClick","aria-expanded","aria-label"],Ke={class:"rounded-md border border-border bg-bg-dropdown shadow-lg w-28 py-1 flex flex-col text-sm"},Qe=["onClick"],Xe=["onClick"],Ye=ye({__name:"Dropdown",props:{prefix:{},options:{default:()=>[]},modelValue:{default:""},variant:{default:"primary"},icon:{},size:{default:"md"},actions:{type:Boolean,default:!0},canEdit:{type:Boolean,default:!0},canDelete:{type:Boolean,default:!0},customClasses:{default:""}},emits:["update:modelValue","edit-option","delete-option","nested-select"],setup(ee,{emit:te}){const m=ee,h=te,_=u(!1),V=u(null),b=u(null),f=u(null),E=u({position:"fixed",top:"-9999px",left:"-9999px"});let x=null;const N=r({get:()=>m.modelValue,set:e=>h("update:modelValue",e)}),d=r(()=>m.options.find(e=>e._id===N.value)??null);function le(){_.value?C():(_.value=!0,Ce(()=>{se()}))}function C(){_.value=!1,k.value=null,x&&(x(),x=null)}function se(){b.value&&f.value&&(x=$e(b.value,f.value,ae))}function ae(){!b.value||!f.value||Ne(b.value,f.value,{placement:"bottom-start",strategy:"fixed",middleware:[De(({placement:e})=>e.startsWith("top")?17:5),Be(),Ie({padding:5})]}).then(({x:e,y:t})=>{E.value={position:"fixed",left:`${e}px`,top:`${t}px`}})}function oe(e){var t;N.value=e._id,(t=e.nested)!=null&&t.length||(w.value=null),C()}const D=u(null),k=u(null),v=u(null);function ne(e){var t;(t=e.nested)!=null&&t.length?k.value=k.value===e._id?null:e._id:oe(e)}const w=u(null);function re(e,t){h("nested-select",e),N.value=t._id,w.value={parentId:t._id,option:e},k.value=null,C()}const $=u(null);function ie(e){$.value=null,v.value=v.value===e?null:e}function ue(e){h("edit-option",e),v.value=null,$.value=null}function de(e){h("delete-option",e),v.value=null,$.value=null}Ee(V,e=>{const t=e.target;f.value&&f.value.contains(t)||(C(),v.value=null,$.value=null)}),ge(()=>{x&&x()});const p=r(()=>m.size==="sm"),ce=r(()=>p.value?"px-2 py-1 text-xs":"px-3 py-1.5 text-sm"),pe=r(()=>p.value?"text-xs":"text-sm"),fe=r(()=>p.value?"text-xs":"text-sm"),ve=r(()=>p.value?"px-3 py-1":"px-4 py-2"),R=r(()=>p.value?"w-3.5 h-3.5":"w-4 h-4"),z=r(()=>p.value?"w-3.5 h-3.5":"w-4 h-4"),M=r(()=>p.value?"text-base":"text-lg"),me=r(()=>p.value?"w-3.5 h-3.5":"w-4 h-4"),xe=r(()=>"dark:border-light-black border-border-gray");return be(()=>m.options,()=>{},{deep:!0}),(e,t)=>{var T,F,P,j,A,U,W,G,L,O,q,H;return s(),a("div",{ref_key:"wrapperRef",ref:V,class:"relative inline-block text-left"},[o("button",{ref_key:"triggerRef",ref:b,onClick:le,type:"button",class:n(["text-nowrap inline-flex justify-between items-center gap-1 border rounded-[6px] font-medium cursor-pointer transition bg-bg-surface",[ce.value,e.variant==="secondary"?"!bg-bg-body border-0":"border-border"]])},[(T=d.value)!=null&&T.prefix?(s(),a("span",{key:0,class:n(R.value)},[typeof((F=d.value)==null?void 0:F.prefix)=="string"?(s(),a("img",{key:0,src:(P=d.value)==null?void 0:P.prefix,class:n(z.value)},null,10,Re)):(s(),B(Y((j=d.value)==null?void 0:j.prefix),{key:1,class:n(z.value)},null,8,["class"]))],2)):i("",!0),o("i",{class:n(`${(U=(A=d.value)==null?void 0:A.icon)==null?void 0:U.prefix} ${(G=(W=d.value)==null?void 0:W.icon)!=null&&G.iconName?(O=(L=d.value)==null?void 0:L.icon)==null?void 0:O.iconName:"file"} ${M.value}`)},null,2),o("span",{class:n(pe.value)},[e.prefix?(s(),a("span",Me,y(e.prefix)+":",1)):i("",!0),o("span",Te,[S(y((q=d.value)==null?void 0:q.title)+" ",1),w.value&&w.value.parentId===((H=d.value)==null?void 0:H._id)?(s(),a(I,{key:0},[S(" ("+y(w.value.option.title)+") ",1)],64)):i("",!0)])],2),(s(),a("svg",{class:n([me.value,"text-text-secondary mt-1"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[4]||(t[4]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))],2),(s(),B(_e,{to:"body"},[ke(we,{name:"fade-scale","enter-active-class":"transition duration-200 ease-out","leave-active-class":"transition duration-150 ease-in","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:he(()=>[_.value?(s(),a("div",{key:0,ref_key:"menuRef",ref:f,style:ze(E.value),class:n(["max-h-[500px] overflow-visible z-[9999] min-w-fit rounded-[6px] border border-border shadow-lg bg-bg-dropdown fixed",[xe.value,m.customClasses?m.customClasses:""]]),onClick:t[3]||(t[3]=g(()=>{},["stop"]))},[o("ul",{class:n(["py-1 z-[2]",fe.value])},[(s(!0),a(I,null,Z(e.options,l=>{var J,K,Q,X;return s(),a("li",{key:l._id,class:n(["group cursor-pointer flex items-stretch text-nowrap hover:bg-bg-dropdown-menu-hover",ve.value]),onClick:c=>ne(l),onMouseenter:c=>D.value=l._id,onMouseleave:t[2]||(t[2]=c=>D.value=null)},[o("div",Pe,[l.prefix?(s(),a("span",{key:0,class:n(R.value)},[typeof l.prefix=="string"?(s(),a("img",{key:0,src:l.prefix,class:n(z.value)},null,10,je)):(s(),B(Y(l.prefix),{key:1,class:n(["text-text-primary",z.value])},null,8,["class"]))],2)):i("",!0),o("i",{class:n(`${(J=l.icon)==null?void 0:J.prefix} ${(K=l.icon)!=null&&K.iconName?(Q=l.icon)==null?void 0:Q.iconName:"file"} ${M.value}`)},null,2),o("div",Ae,[o("span",Ue,y(l.title),1),l.description?(s(),a("p",We,y(l.description),1)):i("",!0)]),(l==null?void 0:l.status)=="running"?(s(),a("i",Ge)):i("",!0)]),(X=l.nested)!=null&&X.length?(s(),a("div",Le,[t[5]||(t[5]=o("span",{class:"text-text-secondary"},"...",-1)),D.value===l._id||k.value===l._id?(s(),a("div",{key:0,class:"absolute left-[-170px] sm:left-[30px] top-[-250px] sm:top-[-5px] ml-1 z-[30] min-w-48 bg-bg-dropdown border border-border rounded-md shadow-lg max-h-60 overflow-y-auto",onClick:t[0]||(t[0]=g(()=>{},["stop"]))},[o("ul",Oe,[(s(!0),a(I,null,Z(l.nested,c=>(s(),a("li",{key:c._id,class:"px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer",onClick:Ze=>re(c,l)},y(c.title),9,qe))),128))])])):i("",!0)])):e.actions&&e.canEdit&&e.canDelete?(s(),a("div",He,[o("button",{class:"opacity-0 cursor-pointer group-hover:opacity-100 focus:opacity-100 transition rounded-md px-1.5 py-1 text-text-secondary hover:bg-bg-dropdown-menu-hover",onClick:g(c=>ie(l._id),["stop"]),"aria-expanded":v.value===l._id?"true":"false","aria-label":`Actions for ${l.title}`}," â‹¯ ",8,Je),v.value===l._id?(s(),a("div",{key:0,class:"absolute left-[100%] right-0 top-full mt-1 z-[20]",onClick:t[1]||(t[1]=g(()=>{},["stop"]))},[o("div",Ke,[e.canEdit?(s(),a("button",{key:0,class:"px-3 py-1.5 text-left hover:bg-bg-dropdown-menu-hover cursor-pointer",onClick:g(c=>ue(l),["stop"])},t[6]||(t[6]=[o("i",{class:"fa-regular fa-edit"},null,-1),S(" Edit ")]),8,Qe)):i("",!0),e.canDelete?(s(),a("button",{key:1,class:"px-3 py-1.5 text-left text-red-600 cursor-pointer",onClick:g(c=>de(l),["stop"])},t[7]||(t[7]=[o("i",{class:"fa-regular fa-trash"},null,-1),S(" Delete ")]),8,Xe)):i("",!0)])])):i("",!0)])):i("",!0)],42,Fe)}),128)),Se(e.$slots,"more",{},void 0,!0)],2)],6)):i("",!0)]),_:3})]))],512)}}}),lt=Ve(Ye,[["__scopeId","data-v-62df26b4"]]);export{lt as default};
