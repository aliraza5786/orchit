import{d as T,j as l,F as g,z as v,o,f as e,t as d,e as A,r as x,N as Z,O as V,p as ee,i as _,w as y,q as r,B as K,k as L,E as w,G as Q,P as te,l as se,g as k,Q as oe,n as re}from"./index-B6QqO5al.js";import{o as le}from"./index-BM_FmKdx.js";import ne from"./KanbanSkeleton-5QaY9Op_.js";import de from"./Dropdown-DWWlM5_9.js";import{u as ae,a as ie,b as ue,c as ce}from"./useMore-SEbYZSvs.js";import be from"./KanbanTicket-BV5ePWLm.js";import"./DropMenu.vue_vue_type_script_setup_true_lang-DhNQF2XC.js";import"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-DEGnXEGy.js";const me={class:"flex sticky top-0 z-[1] bg-bg-body items-center justify-between w-full p-4 border-b border-border cursor-grab"},fe={class:"flex items-center gap-2 flex-auto max-w-[80%]"},pe={class:"font-semibold overflow-ellipsis line-clamp-1 text-nowrap text-foreground px-1 py-0.5 rounded hover:bg-bg-card focus:outline-none focus:ring-1 focus:ring-border cursor-text",title:"Click to rename"},xe={class:"text-xs bg-bg-card aspect-square flex justify-center items-center text-muted-foreground p-1 min-w-6 rounded-full"},_e={class:"p-4 space-y-2"},ge=T({__name:"KanbanView",props:{columns:{}},setup(E){return(b,h)=>(o(!0),l(g,null,v(b.columns,(i,u)=>(o(),l("div",{key:u,class:"flex bg-bg-body flex-col min-w-[300px] h-[600px] overflow-y-auto w-80 rounded-lg transition-all duration-200"},[e("div",me,[e("div",fe,[e("button",pe,d(i.title||"Untitled"),1),e("span",xe,d(i.cards?i.cards.length:0),1)])]),e("div",_e,[(o(!0),l(g,null,v(i==null?void 0:i.cards,(m,c)=>(o(),A(be,{footer:!0,key:`card-${c}`,onSelect:()=>{},ticket:m},null,8,["ticket"]))),128))])]))),128))}}),ve={class:"flex flex-col w-full h-full overflow-y-auto bg-bg-card rounded-6px border border-border overflow-hidden"},he={class:"sticky top-0 w-full z-10 bg-bg-card/80 backdrop-blur border-b border-border"},ye={class:"mx-auto px-6 py-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4"},we={class:"flex flex-col gap-2"},ke={key:0,class:"space-y-2"},Ce={key:1},je={class:"text-3xl font-semibold tracking-tight mt-2 capitalize"},Pe={class:"text-sm text-text-secondary max-w-4xl mt-2"},Me={key:0,class:"mt-3 flex flex-wrap gap-2"},$e={key:1,class:"mt-3 flex flex-wrap gap-2"},ze={class:"text-xs text-text-secondary mt-2"},Be={class:"flex items-center gap-2"},Se={key:0},Ne={class:"mx-auto w-full p-6 pb-16"},Ue={class:"flex flex-col lg:flex-row gap-4 justify-between"},qe={class:"flex-auto border overflow-x-auto border-border bg-bg-card rounded-lg min-h-[420px]"},De={class:"flex px-4 py-2 justify-between items-center border-b border-border"},Ie={key:1,class:"h-8 w-32 bg-bg-body rounded"},Ke={class:"rounded-lg space-y-3 w-full"},Le={class:"flex w-full overflow-x-auto gap-3 p-4 scrollbar-visible"},Qe={class:"mt-12 w-full"},Te={key:0,class:"space-y-2"},Ae={key:1},Ee={class:"flex justify-end mt-2"},Fe={key:2,class:"mt-6 text-sm"},He=["src"],Oe={key:1,class:"w-8 h-8 rounded-full bg-accent/40 flex justify-center items-center"},Re={class:"font-medium capitalize"},Ge={class:"text-text-secondary text-xs"},Je={class:"mt-1 font-light text-sm"},ot=T({__name:"ModuleDetail",setup(E){const b=x(!1),h=x(null),i=()=>{b.value=!b.value};le(h,()=>b.value=!1);const u=x([]),m=x(""),c=x(""),{moduleId:C,workspaceId:p}=Z(),F=V(),H=re(),{data:a,isPending:f}=ae(C),{data:O,isPending:j}=ie(C.value,m),{mutate:R,isPending:P}=ue({onSuccess:()=>{F.invalidateQueries({queryKey:["workspaces"]}),H.push(`/workspace/more/${p==null?void 0:p.value}`)}}),{mutate:G,isPending:J}=ce({onSuccess:n=>{c.value="",u.value=[...u.value,{...n}]}}),W=()=>{var n;c.value.trim()&&G({payload:{workspace_module_id:(n=a.value)==null?void 0:n._id,comment:c.value}})};ee(a,n=>{var t;n!=null&&n.comments&&(u.value=[...n.comments]),(t=n==null?void 0:n.sheets)!=null&&t.length&&(m.value=n.sheets[0]._id)},{immediate:!0});const X=()=>{var n;R({payload:{workspace_id:p.value,module_id:(n=a==null?void 0:a.value)==null?void 0:n._id}})};return(n,t)=>{var M,$,z,B,S,N,U;const Y=se("router-link");return o(),l("div",ve,[e("header",he,[e("div",ye,[e("div",we,[_(Y,{to:`/workspace/more/${r(p)}`},{default:y(()=>t[2]||(t[2]=[e("button",{class:"text-sm text-text-secondary cursor-pointer hover:underline flex gap-2 items-center"},[e("i",{class:"fa-solid fa-arrow-left"}),k(" Back to Apps ")],-1)])),_:1,__:[2]},8,["to"]),r(f)?(o(),l("div",ke,t[3]||(t[3]=[e("div",{class:"h-6 w-48 bg-bg-body rounded"},null,-1),e("div",{class:"h-4 w-96 bg-bg-body/80 rounded"},null,-1),e("div",{class:"h-3 w-32 bg-bg-body/80 rounded"},null,-1)]))):(o(),l("div",Ce,[e("h1",je,d((M=r(a))==null?void 0:M.title),1),e("p",Pe,d(($=r(a))==null?void 0:$.description),1),r(f)?(o(),l("div",Me,t[4]||(t[4]=[e("div",{class:"h-6 w-16 bg-bg-body rounded"},null,-1),e("div",{class:"h-6 w-12 bg-bg-body rounded"},null,-1),e("div",{class:"h-6 w-20 bg-bg-body rounded"},null,-1)]))):(o(),l("div",$e,[(o(!0),l(g,null,v((z=r(a))==null?void 0:z.tags,s=>(o(),l("span",{key:s,class:"border border-border bg-bg-surface cursor-pointer rounded-md px-2 py-1 text-xs text-text-secondary hover:bg-accent/50 hover:text-white"},d(s),1))),128))])),e("p",ze,d(((B=r(a))==null?void 0:B.no_of_views)??0)+" views · "+d(((S=r(a))==null?void 0:S.no_of_used)??0)+" using",1)]))]),e("div",Be,[_(K,{size:"sm",disabled:r(f)||r(P),onClick:X},{default:y(()=>[k(d(r(P)?"Processing...":"Use this Module"),1)]),_:1},8,["disabled"]),t[7]||(t[7]=e("button",{class:"border border-input rounded-lg w-9 h-9 text-text-secondary hover:text-accent flex items-center justify-center"},[e("span",{class:"text-lg"},"♡")],-1)),e("div",{class:"relative group",ref_key:"shareContainer",ref:h},[e("button",{onClick:i,class:"border border-input rounded-lg w-9 h-9 text-text-secondary hover:text-accent flex items-center justify-center cursor-pointer"},t[5]||(t[5]=[e("span",null,[e("i",{class:"fa-solid fa-share text-sm"})],-1)])),b.value?(o(),l("div",Se,t[6]||(t[6]=[e("div",{class:"mt-3 flex gap-2 absolute right-0 bottom-12 px-3 py-2 border border-accent rounded-[6px]"},[e("button",{class:"border border-input rounded-lg w-9 h-9 text-text-secondary hover:text-accent flex items-center justify-center"},"⇪"),e("button",{class:"border border-input rounded-lg w-9 h-9 text-text-secondary hover:text-accent flex items-center justify-center"},"⤫"),e("button",{class:"border border-input rounded-lg w-9 h-9 text-text-secondary hover:text-accent flex items-center justify-center"},"Ｆ")],-1)]))):L("",!0)],512)])])]),e("main",Ne,[e("div",Ue,[e("div",qe,[e("div",De,[r(f)?(o(),l("div",Ie)):(o(),A(de,{key:0,modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),options:(N=r(a))==null?void 0:N.sheets,variant:"secondary"},null,8,["modelValue","options"]))]),e("div",Ke,[w(_(ne,null,null,512),[[Q,r(j)]]),w(e("div",Le,[_(ge,{columns:(U=r(O))==null?void 0:U.groups},null,8,["columns"])],512),[[Q,!r(j)]])])])]),e("section",Qe,[t[9]||(t[9]=e("h2",{class:"font-semibold text-base mb-3"},"Comments",-1)),r(f)?(o(),l("div",Te,t[8]||(t[8]=[e("div",{class:"h-20 w-full bg-bg-body rounded"},null,-1),e("div",{class:"h-6 w-24 bg-bg-body rounded"},null,-1)]))):(o(),l("div",Ae,[w(e("textarea",{class:"w-full border border-border rounded-lg bg-bg-card text-sm text-text-secondary p-3 focus:outline-none",placeholder:"Add a comment...","onUpdate:modelValue":t[1]||(t[1]=s=>c.value=s)},null,512),[[te,c.value]]),e("div",Ee,[_(K,{onClick:W,size:"sm"},{default:y(()=>[k(d(r(J)?"Posting...":"Post"),1)]),_:1})])])),r(f)?L("",!0):(o(),l("div",Fe,[e("span",null,d(u.value.length)+" comments",1),(o(!0),l(g,null,v(u.value,s=>{var q,D,I;return o(),l("div",{key:s._id,class:"flex gap-3 mt-4 border-b border-border pb-2"},[(q=s.user_id)!=null&&q.u_profile_image?(o(),l("img",{key:0,class:"w-8 h-8 bg-bg-surface rounded-full",src:s.user_id.u_profile_image},null,8,He)):(o(),l("div",Oe,d(r(oe)(((D=s==null?void 0:s.user_id)==null?void 0:D.u_full_name)??"")),1)),e("div",null,[e("p",Re,d((I=s==null?void 0:s.user_id)==null?void 0:I.u_full_name),1),e("p",Ge,d(s==null?void 0:s.time),1),e("p",Je,d(s==null?void 0:s.comment),1)])])}),128))]))])])])}}});export{ot as default};
