import{r as b,l as z,q as M,d as B,c as k,h as n,b as e,t as i,x as P,g as A,i as O,F as _,v as w,e as G,o as l,p as q,a as H,m as Y,w as X,U as K,J as j,X as f,_ as Q}from"./index-DXbJhmZM.js";import{a as Z,b as D}from"./useQueryParams-CVLohy2L.js";import{_ as ee}from"./ProgressBar.vue_vue_type_script_setup_true_lang-BohwDv0S.js";function te(h,{start:r=0,maxWhileLoading:m=90,step:a=.8,intervalMs:c=120}={}){const s=b(r);let g=null;const d=()=>{g==null&&(g=window.setInterval(()=>{h()&&(s.value=Math.min(s.value+a,m))},c))},x=()=>{g!=null&&(clearInterval(g),g=null)};return z(h,y=>{y?(s.value=r,d()):(s.value=100,setTimeout(()=>{s.value=r,x()},300))},{immediate:!0}),M(x),s}const se={class:"rounded-lg min-w-sm border border-border overflow-hidden flex flex-col justify-between bg-bg-card w-full"},ae={class:"px-3 pt-3"},oe={class:"flex justify-between items-start"},re={class:"text-lg font-semibold text-text-primary text-left"},le={class:"text-xs text-text-secondary"},ne={class:"my-2 pb-3"},ie={class:"flex justify-between text-sm text-text-secondary mb-1"},de={class:"flex justify-between items-center bg-bg-body p-3"},ue={class:"flex -space-x-2"},ce=["src"],me={key:0,class:"w-6 h-6 rounded-full border-2 border-border bg-bg-card text-[11px] font-semibold flex items-center justify-center text-text-secondary shadow"},ge={class:"flex items-center gap-1 text-sm text-text-secondary"},ve=B({__name:"ProjectCard",props:{title:{},subtitle:{},status:{},progress:{default:0},avatars:{},maxVisible:{default:2},date:{},loading:{type:Boolean,default:!1},color:{default:"#9CA3AF"}},setup(h){const r=h,m=te(()=>!!r.loading),a=k(()=>r.loading?m.value:r.progress),c=k(()=>r.avatars.slice(0,r.maxVisible)),s=k(()=>r.avatars.length>r.maxVisible?r.avatars.length-r.maxVisible:0),g=d=>{switch(d){case"completed":return"bg-green-400/40 border-green-400 text-green-400";case"failed":return"bg-red-400/40 border-red-400 text-red-400";case"in_progress":return"bg-blue-400/20 border-blue-400 text-blue-400";case"pending":return"bg-amber-400/20 border-amber-400 text-amber-400";default:return"progress-default"}};return(d,x)=>(l(),n("div",se,[e("div",ae,[e("div",oe,[e("div",null,[e("h3",re,i(d.title),1),e("p",le,i(d.subtitle),1)]),e("span",{class:P(["text-xs border rounded-full px-2 py-0.5",g(d.status)])},i(d.status),3)]),e("div",ne,[e("div",ie,[e("span",null,i(d.status=="in_progress"?"Generating lane with AI...":"Progress"),1),e("span",null,i(Math.round(a.value))+"%",1)]),A(ee,{class:"mt-2",progress:a.value,fillColor:"bg-accent ",indeterminate:!!d.loading},null,8,["progress","indeterminate"])])]),e("div",de,[e("div",ue,[(l(!0),n(_,null,w(c.value,(y,S)=>(l(),n("img",{key:S,src:y,class:"w-6 h-6 rounded-full border-2 border-border object-cover shadow"},null,8,ce))),128)),s.value>0?(l(),n("div",me," +"+i(s.value),1)):O("",!0)]),e("div",ge,[x[0]||(x[0]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 7V3M16 7V3M4 11h16M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),G(" "+i(d.date),1)])])]))}}),pe={class:"flex flex-col gap-4 h-full overflow-x-auto w-full flex-auto"},be={class:"p-5 rounded-lg bg-bg-card space-y-6"},xe={class:"flex items-center justify-between"},fe={class:"flex flex-col w-full"},he={class:"flex gap-2.5 overflow-x-auto w-full py-8"},ye=["onClick"],_e={class:"flex flex-grow gap-4"},we={class:"bg-bg-card w-full flex-auto p-5 rounded-lg"},ke={class:"space-y-4"},Se={class:"flex items-center gap-2 w-32 flex-shrink-0"},Ce={key:1,class:"w-8 h-8 rounded-full bg-bg-body flex items-center justify-center"},Ee={class:"text-sm text-text-primary truncate"},Ie={class:"flex-1"},je={class:"h-6 bg-bg-body rounded overflow-hidden relative"},Be={key:0,class:"absolute inset-0 flex items-center justify-start px-2 text-xs text-text-primary font-medium"},Ae={class:"bg-bg-card w-full flex-auto p-5 rounded-lg overflow-hidden flex flex-col"},Oe={class:"space-y-4 overflow-y-auto flex-1"},Ve={class:"flex-1 min-w-0"},$e={class:"text-sm text-text-primary"},De={class:"font-medium text-accent/90"},Le={class:"text-text-secondary"},Me={href:"#",class:"text-accent/90 hover:underline"},Pe={class:"text-xs text-text-secondary mt-1"},L=5,Re=B({__name:"Peak",setup(h){var $;const r=b(!1),m=b(null),a=b(null),c=b(0),s=b({}),{workspaceId:g}=Z(),{jobId:d}=($=D())!=null&&$.jobId?D():{jobId:b(null)},x="https://backend.streamed.space/api/v1/workspace",y=k(()=>{var v,o;return((o=(v=m.value)==null?void 0:v.progress_details)==null?void 0:o.lanes_progress)??[]}),S=k(()=>!m.value||["queued","running"].includes(m.value.status)),R=["https://randomuser.me/api/portraits/women/1.jpg","https://randomuser.me/api/portraits/men/2.jpg","https://randomuser.me/api/portraits/men/3.jpg"],C=()=>{if(a.value&&a.value.readyState===EventSource.OPEN||c.value>=L)return;a.value&&a.value.close();const v=localStorage.getItem("token")||"",o=localStorage.getItem("jobId")||(d==null?void 0:d.value)||g.value,t=localStorage.getItem("jobId")?"false":"true",I=`${x}/step2/tasks/${o}/stream?token=${v}&is_manual=${t}`;try{a.value=new EventSource(I,{withCredentials:!1}),a.value.onopen=()=>{r.value=!0,c.value=0,s.value={...s.value,connectionStatus:"Connected",lastConnected:new Date().toISOString(),url:I}},a.value.onmessage=u=>{try{const p=JSON.parse(u.data);m.value=p,s.value={...s.value,lastMessage:p,lastMessageTime:new Date().toISOString()},["completed","failed","canceled"].includes(p.status)&&setTimeout(E,1200)}catch(p){s.value={...s.value,parseError:p==null?void 0:p.message,rawMessage:u.data}}},a.value.addEventListener("progress",u=>{try{m.value=JSON.parse(u.data)}catch{}}),a.value.addEventListener("error",u=>{try{s.value={...s.value,serverError:JSON.parse(u.data)}}catch{}}),a.value.onerror=()=>{var u;if(r.value=!1,s.value={...s.value,connectionError:!0,errorTime:new Date().toISOString(),readyState:(u=a.value)==null?void 0:u.readyState},c.value<L){c.value++;const p=Math.min(3e4,1e3*2**c.value);setTimeout(C,p)}}}catch(u){s.value={...s.value,creationError:u==null?void 0:u.message,errorTime:new Date().toISOString()}}},E=()=>{a.value&&(a.value.close(),a.value=null),r.value=!1,s.value={...s.value,disconnectedAt:new Date().toISOString()}},T=()=>{E(),c.value=0,setTimeout(C,600)};q(()=>{C(),document.addEventListener("visibilitychange",V)}),M(()=>{E(),document.removeEventListener("visibilitychange",V)});const V=()=>{!document.hidden&&!r.value&&(!a.value||a.value.readyState===EventSource.CLOSED)&&T()},N=v=>{console.log("Lane clicked:",v)},F=b([{id:1,name:"Unassigned",initials:"",avatar:!1,color:"#6B7280",workload:13},{id:2,name:"Amal Lashari",initials:"AL",avatar:!0,color:"#3B82F6",workload:35},{id:3,name:"Anam Rehman",initials:"AR",avatar:!0,color:"#3B82F6",workload:8},{id:4,name:"Sufian",initials:"S",avatar:!0,color:"#6B7280",workload:8},{id:5,name:"Arooj Sajjad",initials:"AS",avatar:!0,color:"#EF4444",workload:5}]),J=b([{id:1,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-33073: IPU: Agenda Multilingual Issue (global issue)",status:"DEPLOYED-PROD",time:"about 4 hours ago"},{id:2,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-31468: Show/Hide Team Members on Booth",status:"REOPENED",time:"about 4 hours ago"},{id:3,user:"Streamed Bot",userInitials:"VB",userColor:"#06B6D4",action:'updated field "RemoteWorkItemLink" on',item:"VFC-32359: Favicon not displaying after uploading from Event Settings",status:"",time:"about 4 hours ago"}]),U=v=>({"DEPLOYED-PROD":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",REOPENED:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200","IN-PROGRESS":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"})[v]||"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",W=B({name:"SkeletonCard",setup(){return()=>f("div",{class:"w-[380px] min-w-[280px] h-[180px] rounded-xl border border-border bg-bg-body/60 animate-pulse p-4"},[f("div",{class:"h-5 w-2/3 rounded bg-bg-card/50 mb-2"}),f("div",{class:"h-3 w-1/2 rounded bg-bg-card/50 mb-4"}),f("div",{class:"h-2 w-full rounded bg-bg-card/50 mb-1"}),f("div",{class:"h-2 w-11/12 rounded bg-bg-card/50 mb-1"}),f("div",{class:"h-2 w-10/12 rounded bg-bg-card/50"})])}});return(v,o)=>(l(),n("div",pe,[e("div",be,[e("div",xe,[e("div",fe,[o[0]||(o[0]=e("h3",{class:"text-2xl text-text-primary font-semibold"},"Project Overview",-1)),o[1]||(o[1]=e("p",{class:"text-sm text-text-secondary mt-2"},"Last update on Sep 12, 2024 - 09.45 AM",-1)),e("div",he,[S.value?(l(),n(_,{key:0},w(3,t=>A(Y(W),{key:t})),64)):(l(),H(K,{key:1,name:"list",tag:"div",class:"flex gap-2.5"},{default:X(()=>[(l(!0),n(_,null,w(y.value,t=>(l(),n("button",{key:t.lane_title,class:"group focus:outline-none border-border border focus-visible:ring-2 focus-visible:ring-primary/50 rounded-xl",type:"button",role:"button","aria-label":"Open lane details",onClick:I=>N(t)},[A(ve,{loading:S.value||(t==null?void 0:t.status)==="in_progress",title:t.lane_title,subtitle:"Mobile Application",progress:(t==null?void 0:t.progress)??0,status:(t==null?void 0:t.status)??"",avatars:R,date:"May 28",class:"transition-transform duration-200 ease-out group-hover:shadow-lg border border-transparent hover:border-border-subtle rounded-xl cursor-pointer"},null,8,["loading","title","progress","status"])],8,ye))),128))]),_:1}))])])])]),e("div",_e,[e("div",we,[o[4]||(o[4]=e("div",{class:"mb-4"},[e("h3",{class:"text-lg font-semibold text-text-primary"},"Team workload"),e("p",{class:"text-sm text-text-secondary mt-1"}," Monitor the capacity of your team. ")],-1)),e("div",ke,[o[3]||(o[3]=e("div",{class:"flex items-center justify-between text-sm font-medium text-text-secondary mb-2"},[e("span",null,"Assignee"),e("span",null,"Work distribution")],-1)),(l(!0),n(_,null,w(F.value,t=>(l(),n("div",{key:t.id,class:"flex items-center gap-3"},[e("div",Se,[t.avatar?(l(),n("div",{key:0,class:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-medium",style:j({backgroundColor:t.color})},i(t.initials),5)):(l(),n("div",Ce,o[2]||(o[2]=[e("i",{class:"pi pi-user text-text-secondary"},null,-1)]))),e("span",Ee,i(t.name),1)]),e("div",Ie,[e("div",je,[e("div",{class:"h-full bg-border-subtle transition-all duration-300",style:j({width:t.workload+"%"})},null,4),t.workload>10?(l(),n("span",Be,i(t.workload)+"% ",1)):O("",!0)])])]))),128))])]),e("div",Ae,[o[6]||(o[6]=e("div",{class:"mb-4"},[e("h3",{class:"text-lg font-semibold text-text-primary"},"Recent activity"),e("p",{class:"text-sm text-text-secondary mt-1"},"Stay up to date with what's happening across the project.")],-1)),e("div",Oe,[o[5]||(o[5]=e("div",{class:"text-xs font-semibold text-text-secondary mb-3"},"Today",-1)),(l(!0),n(_,null,w(J.value,t=>(l(),n("div",{key:t.id,class:"flex gap-3 pb-4 border-b border-border last:border-0"},[e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-medium flex-shrink-0",style:j({backgroundColor:t.userColor})},i(t.userInitials),5),e("div",Ve,[e("div",$e,[e("span",De,i(t.user),1),e("span",Le,i(t.action),1),e("a",Me,i(t.item),1),t.status?(l(),n("span",{key:0,class:P(["ml-2 px-2 py-0.5 rounded text-xs font-medium",U(t.status)])},i(t.status),3)):O("",!0)]),e("div",Pe,i(t.time),1)])]))),128))])])])]))}}),Je=Q(Re,[["__scopeId","data-v-afb3cf7d"]]);export{Je as default};
