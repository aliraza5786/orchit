import{d as R,N as J,r as x,q as M,c as b,j as n,o as r,k as d,f as p,C as g,g as D,G as E,t as v,aK as O,aJ as j,O as w,F as K,A as U,h as q,S as G}from"./index-BLf7qyjg.js";const P={key:0,class:"inline-block text-text-secondary -400 ml-1 cursor-help"},Z={class:"relative"},H={key:0,class:"mr-1 text-text-secondary -500"},Q={class:"flex flex-wrap gap-2 w-full items-center flex-1"},W={key:0,class:"font-medium"},X={key:1,class:"opacity-70 w-[90%] overflow-ellipsis overflow-hidden"},Y={key:2,class:"w-[90%] overflow-ellipsis overflow-hidden"},ee=["onClick","disabled"],te=["placeholder","disabled"],ae={key:1,class:"ml-1 text-text-secondary"},oe=R({__name:"BaseEmailChip",props:{modelValue:{default:()=>[]},label:{},tooltip:{},message:{},error:{type:Boolean,default:!1},placeholder:{default:"Add people by email… (Enter, comma, space)"},size:{default:"md"},theme:{default:"system"},disabled:{type:Boolean,default:!1},allowDuplicates:{type:Boolean,default:!1},showName:{type:Boolean,default:!1},validator:{},maxEmails:{default:void 0}},emits:["update:modelValue","invalid","add","remove","limit"],setup(C,{emit:$}){const{isDark:_}=J(),o=C,i=$,k=x(null),m=x(""),l=x([...o.modelValue]);M(()=>o.modelValue,e=>{JSON.stringify(e)!==JSON.stringify(l.value)&&(l.value=[...e])});const h=b(()=>o.theme==="dark"||o.theme==="system"&&_.value),f=b(()=>o.maxEmails&&o.maxEmails>0?o.maxEmails:1/0),y=b(()=>Math.max(0,f.value-l.value.length)),c=b(()=>y.value===0);function I(){var e;!o.disabled&&!c.value&&((e=k.value)==null||e.focus())}const S=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i;function z(e){return(o.validator??(t=>S.test(t)))(e)}function N(e){return e.split(/[\s,;]+/).map(t=>t.trim().toLowerCase()).filter(Boolean)}function V(e){if(y.value===0){i("limit",isFinite(f.value)?Number(f.value):1/0);return}const t=[],s=[],a=o.allowDuplicates?null:new Set(l.value);for(const u of e){if(y.value-t.length<=0)break;if(!z(u)){s.push(u);continue}a&&a.has(u)||(a&&a.add(u),l.value.push(u),t.push(u))}t.length&&i("add",t),s.length&&i("invalid",s),t.length&&s.length===0&&i("invalid",[]),(t.length||s.length)&&i("update:modelValue",[...l.value]),y.value===0&&i("limit",isFinite(f.value)?Number(f.value):1/0)}function B(){!m.value||c.value||(V(N(m.value)),m.value="")}function A(e){var s;if(c.value){e.preventDefault(),i("limit",Number(f.value));return}const t=((s=e.clipboardData)==null?void 0:s.getData("text"))||"";t&&(e.preventDefault(),V(N(t)))}function F(e){if(!o.disabled){if(e.key==="Enter"||e.key==="Tab"||e.key===","||e.key===" "){e.preventDefault(),B();return}if(e.key==="Backspace"&&!m.value&&l.value.length){const t=l.value.pop();i("remove",t),i("update:modelValue",[...l.value])}}}function T(e){if(o.disabled)return;const[t]=l.value.splice(e,1);i("remove",t),i("update:modelValue",[...l.value])}function L(e){const s=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return s.length?s.map(a=>a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()).join(" "):e}return(e,t)=>{const s=j("tooltip");return r(),n("div",{class:g(h.value?"text-white":"text-text-primary")},[e.label?(r(),n("label",{key:0,class:g(["text-base font-medium mb-1 flex items-center",h.value?"text-white":"text-text-primary"])},[D(v(e.label)+" ",1),e.tooltip?E((r(),n("span",P,t[1]||(t[1]=[p("img",{src:O,alt:"info"},null,-1)]))),[[s,e.tooltip]]):d("",!0)],2)):d("",!0),p("div",Z,[p("div",{class:g(["flex items-center gap-2 border rounded-[6px] px-3 py-2 w-full text-sm focus-within:ring-2",e.size==="md"?"min-h-10":"min-h-12",e.error?"border-red-500 focus-within:ring-red-500":"focus-within:ring-border",h.value?"bg-[#131318] border-border ":" border-border bg-bg-input",e.disabled?"opacity-60 cursor-not-allowed":""]),onClick:I},[e.$slots.prefix?(r(),n("span",H,[w(e.$slots,"prefix")])):d("",!0),p("div",Q,[(r(!0),n(K,null,U(l.value,(a,u)=>(r(),n("span",{key:a+u,class:"inline-flex items-center w-full gap-2 rounded-full px-2 py-1 text-xs bg-bg-body text-text-secondary"},[e.showName?(r(),n("span",W,v(L(a)),1)):d("",!0),e.showName?(r(),n("span",X,"<"+v(a)+">",1)):(r(),n("span",Y,v(a),1)),p("button",{type:"button",class:"ml-1 rounded hover:bg-bg-surface px-1",title:"Remove",onClick:q(le=>T(u),["stop"]),disabled:e.disabled},"✕",8,ee)]))),128)),E(p("input",{ref_key:"inputRef",ref:k,"onUpdate:modelValue":t[0]||(t[0]=a=>m.value=a),placeholder:c.value?"":l.value.length===0?e.placeholder:"",class:"flex-1 min-w-[160px] bg-transparent outline-none text-sm placeholder:text-text-secondary text-text-primary",disabled:e.disabled||c.value,onKeydown:F,onBlur:B,onPaste:A},null,40,te),[[G,m.value]])]),e.$slots.suffix?(r(),n("span",ae,[w(e.$slots,"suffix")])):d("",!0)],2)]),e.message?(r(),n("p",{key:1,class:g(["mt-2 text-xs flex items-center gap-1",e.error?"text-red-500":(h.value,"text-text-secondary ")])},[e.$slots.msgIcon?w(e.$slots,"msgIcon",{key:0}):d("",!0),D(" "+v(e.message),1)],2)):d("",!0)],2)}}});export{oe as _};
