const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CreateTaskModal-B8T8kQVS.js","assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-CB6Vdvof.js","assets/index-j3-bp8Lo.js","assets/index-DvCgEa0I.css","assets/ConfirmDeleteModal-D5yvjzcO.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Cll2TaEh.js","assets/SidePanel-ClYigjNH.js","assets/SidePanel-U7OOMI6M.css","assets/KanbanBoard-BEiFDO8A.js","assets/lodash-B3d4OLnQ.js","assets/DropMenu.vue_vue_type_script_setup_true_lang-CTHw2Gqm.js","assets/KanbanBoard-Dffh696C.css"])))=>i.map(i=>d[i]);
import{R as at,S as St,p as g,T as we,c as E,r as y,n as R,K as lt,U as vt,d as st,V as Zt,W as ml,j as m,f as t,h as Se,z as J,F as fe,y as _e,o as u,t as N,Q as Xt,J as Ut,O as Cl,e as ce,w as oe,X as Yt,i as F,_ as el,I as Ft,g as ie,B as Ne,k as I,Y as kt,D as tt,P as tl,N as ll,M as gl,Z as bl,$ as yl,a0 as xl,a1 as _l,a2 as hl,E as Qt,a3 as $l,a4 as Dl,a5 as Tl,u as Vl,a6 as El,a7 as Ll,a8 as Al,a9 as Ml,aa as Bl,ab as Il,ac as Fl,ad as Oe,ae as Gt,q as Ul,af as Ol,l as Wt,ag as At,A as Mt,ah as ge,ai as Nl,aj as rl,ak as Pl,al as ql,v as zl,am as jl,an as il,ao as Rl}from"./index-j3-bp8Lo.js";import{u as al}from"./useTheme-CRIxJ4Dy.js";import{_ as Hl}from"./BaseTextAreaField.vue_vue_type_script_setup_true_lang-hVYH8DLJ.js";import{_ as dl}from"./SearchBar.vue_vue_type_script_setup_true_lang-wLLlcjh2.js";import{o as Bt,_ as Wl}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-Cll2TaEh.js";import{D as Kt,K as kl}from"./Dropdown-jN9g-yI1.js";import{_ as Kl,a as ul,b as Ql,k as Gl}from"./TableAssigneeCell.vue_vue_type_script_setup_true_lang-BYLwqSbC.js";import{K as Jl}from"./KanbanTicket-DCDNacmz.js";import{F as Zl}from"./fuse-Ch1WBRTM.js";import{l as Xl}from"./lodash-B3d4OLnQ.js";import"./DropMenu.vue_vue_type_script_setup_true_lang-CTHw2Gqm.js";const Yl="data:image/svg+xml,%3csvg%20width='60'%20height='46'%20viewBox='0%200%2060%2046'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M59.7443%2034.8967L50.5682%2025.7206C50.4457%2025.5984%2050.2897%2025.5152%2050.1199%2025.4816C49.9501%2025.4479%2049.7742%2025.4653%2049.6143%2025.5315C49.4544%2025.5976%2049.3176%2025.7097%2049.2213%2025.8535C49.125%2025.9973%2049.0734%2026.1664%2049.073%2026.3394V30.517H25.9775V40.5114H49.0755V44.689C49.0759%2044.8621%2049.1275%2045.0312%2049.2238%2045.175C49.3201%2045.3187%2049.4569%2045.4308%2049.6168%2045.497C49.7767%2045.5632%2049.9527%2045.5805%2050.1224%2045.5468C50.2922%2045.5132%2050.4482%2045.43%2050.5708%2045.3078L59.7468%2036.1318C59.9095%2035.9672%2060.0005%2035.7451%2060.0001%2035.5137C59.9996%2035.2823%2059.9076%2035.0605%2059.7443%2034.8967Z'%20fill='%23C6DBA9'/%3e%3cpath%20d='M32.3149%2030.5293C30.664%2031.5967%2028.7394%2032.1633%2026.7734%2032.1609V40.5237H34.7295C39.2829%2038.5638%2042.9649%2035.0102%2045.0851%2030.5293H32.3149Z'%20fill='url(%23paint0_linear_250_16424)'/%3e%3cpath%20d='M46.2209%2020.2832C46.2317%2015.0884%2044.2448%2010.0884%2040.6714%206.3179C37.0981%202.54738%2032.2119%200.295026%2027.024%200.0269855C21.8362%20-0.241055%2016.7439%201.49574%2012.801%204.87791C8.85809%208.26009%206.36647%2013.0287%205.84178%2018.1969L2.46233%2017.8913C2.31055%2017.8782%202.15829%2017.9103%202.02467%2017.9835C1.89106%2018.0566%201.78205%2018.1677%201.71134%2018.3026C1.64063%2018.4376%201.61138%2018.5904%201.62726%2018.7419C1.64313%2018.8934%201.70343%2019.0368%201.80058%2019.1542L9.51927%2028.406C9.79205%2028.7344%2010.277%2028.7773%2010.378%2028.5045L19.6298%2020.7833C20.3876%2020.3413%2020.1173%2019.4825%2019.4328%2019.4194L15.8008%2019.091C16.0297%2017.1283%2016.8213%2015.2735%2018.0802%2013.7503C19.3391%2012.2271%2021.0115%2011.1004%2022.8961%2010.5059C24.7806%209.9114%2026.7969%209.8745%2028.7019%2010.3996C30.6069%2010.9248%2032.3195%2011.9896%2033.6332%2013.4657C34.947%2014.9419%2035.8059%2016.7664%2036.1065%2018.7195C36.4071%2020.6726%2036.1365%2022.6709%2035.3274%2024.4738C34.5183%2026.2766%2033.2051%2027.8071%2031.5462%2028.8807C29.8872%2029.9544%2027.9531%2030.5254%2025.977%2030.5251H25.9283V40.5094C31.2249%2040.4031%2036.7093%2038.2263%2040.4202%2034.4455C44.1311%2030.6648%2046.2134%2025.5808%2046.2209%2020.2832Z'%20fill='%23D7A39E'/%3e%3cpath%20d='M25.9773%2030.5293H0V40.5237H25.9773V30.5293Z'%20fill='url(%23paint1_linear_250_16424)'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_250_16424'%20x1='6.53714'%20y1='35.5252'%20x2='47.0198'%20y2='35.5252'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%236C798F'/%3e%3cstop%20offset='1'%20stop-color='%236C798F'%20stop-opacity='0.1'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_250_16424'%20x1='0'%20y1='36'%20x2='26'%20y2='36'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23E8D4D3'%20stop-opacity='0'/%3e%3cstop%20offset='1'%20stop-color='%23E2A39F'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",ea=(h,x,M={})=>St({queryKey:E(()=>["sprint-list",g(h),g(x)]),queryFn:({signal:A})=>we({url:`sprints/${g(h)}`,method:"GET",signal:A,params:{sprintType:g(x)}}),...M}),ta=(h,x={})=>St({queryKey:["sprint-cards",h],queryFn:({signal:M})=>we({url:`sprints/${g(h)}/backlog`,method:"GET",signal:M}),...x}),la=(h,x={})=>St({queryKey:["sprint-kanban",h],queryFn:({signal:M})=>we({url:`workspace/cards/sprintgrouped?sprint_id=${g(h)}&variable_id=68b6c96e0a95eef7d14e6981`,method:"GET",signal:M}),...x}),aa=(h,x={})=>at({key:["sprint-complete"]},{mutationFn:M=>we({url:`sprints/${g(h)}/complete`,method:"POST",data:M.payload}),...x}),sa=(h,x={})=>St({queryKey:["sprint-detail",h],queryFn:({signal:M})=>we({url:`sprints/detail/${g(h)}?include_cards=true`,method:"GET",signal:M}),...x}),Jt=(h,x,M={})=>St({queryKey:["backlog-list",h,g(x)],queryFn:({signal:A})=>we({url:`sprints/workspace/${g(h)}/cards`,method:"GET",signal:A,params:{include_sprint_cards:!1,sprintType:g(x)}}),...M}),na=(h={})=>at({key:["add-sprint"]},{mutationFn:x=>we({url:"/sprints",method:"POST",data:x.payload}),...h}),Sl=(h={})=>at({key:["move-card-to-sprint"]},{mutationFn:x=>we({url:`/sprints/${x.id}/cards`,method:"POST",data:x.payload}),...h}),cl=(h={})=>at({key:["add-sprint"]},{mutationFn:x=>we({url:`/sprints/${x.id}`,method:"PUT",data:x.payload}),...h}),oa=(h={})=>at({key:["start-sprint"]},{mutationFn:x=>we({url:`/sprints/${x.id}/start`,method:"POST",data:x.payload}),...h}),ra=(h={})=>at({key:["delete-sprint"]},{mutationFn:x=>we({url:`/sprints/${x}`,method:"DELETE"}),...h}),ia=(h={})=>at({key:["remove-card-from-sprint"]},{mutationFn:x=>we({url:`sprints/${g(x.sprintId)}/cards/remove `,method:"POST",data:{card_ids:[x.cardId]}}),...h}),wl="jira-like:";function pl(h="id"){return`${h}_${Math.random().toString(36).slice(2,9)}`}function fl(h,x){try{localStorage.setItem(wl+h,JSON.stringify(x))}catch{}}function vl(h,x){try{const M=localStorage.getItem(wl+h);return M?JSON.parse(M):x}catch{return x}}function da(h){switch(h){case"Highest":return"rounded-md bg-red-50 px-2 py-0.5 text-xs text-red-700";case"High":return"rounded-md bg-orange-50 px-2 py-0.5 text-xs text-orange-700";case"Medium":return"rounded-md bg-amber-50 px-2 py-0.5 text-xs text-amber-700";case"Low":return"rounded-md bg-gray-100 px-2 py-0.5 text-xs text-gray-600"}}function ua(){const h=y(vl("backlog",[])),x=y(vl("sprints",[]));if(x.value.length===0)x.value.push({id:pl("sprint"),name:"Sprint 1",goal:"",start:"",end:"",started:!1,tickets:[]});else if(x.value.length>1){for(let f=1;f<x.value.length;f++)h.value.push(...x.value[f].tickets);x.value=[x.value[0]]}const M=y(x.value[0].id);R([h,x],()=>{fl("backlog",h.value),fl("sprints",x.value)},{deep:!0});const A=y([]),H=lt({}),C=E(()=>h.value.length>0&&A.value.length===h.value.length),d=f=>{var s;const l=x.value.find(o=>o.id===f);return!!l&&l.tickets.length>0&&(((s=H[f])==null?void 0:s.length)||0)===l.tickets.length};function T(f,l,s){const o=l.target.checked;if(f==="backlog")A.value=o?h.value.map(_=>_.id):[];else if(s){const _=x.value.find(D=>D.id===s);H[s]=o&&_?_.tickets.map(D=>D.id):[]}}function W(f,l,s,o){const _=s.target.checked,D=f==="backlog"?A.value:H[o]||(H[o]=[]);if(_&&!D.includes(l)&&D.push(l),!_){const q=D.indexOf(l);q>=0&&D.splice(q,1)}}function B(){return x.value.find(f=>f.id===M.value)||x.value[0]}function Q(){const l=[...h.value,...x.value.flatMap(o=>o.tickets)].map(o=>Number(String(o.key).replace(/[^0-9]/g,""))).filter(o=>!Number.isNaN(o));return`PRJ-${l.length?Math.max(...l)+1:1}`}const{mutate:P}=Sl({onSuccess:()=>{vt.success("Cards moved to sprint successfully")},onError:f=>{vt.error("Failed to move cards: "+(f.message||"Unknown error"))}});function z(){var o,_;const f=B();if(!f||!A.value.length)return;const l=[],s=[];for(const D of h.value)(A.value.includes(D.id)?s:l).push(D);h.value=l,f.tickets.push(...s),A.value=[],s.length>0&&P({id:f.id,payload:{card_ids:s.map(D=>D.id),priority:((_=(o=s[0])==null?void 0:o.priority)==null?void 0:_.toLowerCase())||"medium",story_points:s.reduce((D,q)=>D+(q.storyPoints||0),0)}})}function U(f){const l=x.value.find(D=>D.id===f);if(!l)return;const s=H[f]||[],o=[],_=[];for(const D of l.tickets)(s.includes(D.id)?_:o).push(D);l.tickets=o,h.value.push(..._),H[f]=[]}function O(f,l){if(f==="backlog")h.value=h.value.filter(s=>!A.value.includes(s.id)),A.value=[];else if(l){const s=H[l]||[],o=x.value.find(_=>_.id===l);if(!o)return;o.tickets=o.tickets.filter(_=>!s.includes(_.id)),H[l]=[]}}function G(f,l){const s={id:pl("T"),key:Q(),createdAt:new Date().toISOString(),...l};if(f==="backlog")h.value.push(s);else{const o=B();o==null||o.tickets.push(s)}}function le(f){const l=B();l&&(l.name=f.name??l.name,l.goal=f.goal??l.goal,l.start=f.start??l.start,l.end=f.end??l.end)}function se(){const f=B();f&&(f.started=!f.started)}function $(f){return f.tickets.reduce((l,s)=>l+(s.storyPoints||0),0)}return{backlog:h,sprints:x,activeSprintId:M,selectedBacklogIds:A,selectedSprintIds:H,allBacklogChecked:C,allSprintChecked:d,toggleAll:T,toggleOne:W,getActiveSprint:B,createTicket:G,saveSprintMeta:le,toggleStartSprint:se,sprintPoints:$,moveSelectedToSprint:z,moveSelectedToBacklog:U,deleteSelected:O,priorityClass:da}}const ca={class:"h-full min-h-0"},pa={key:0,class:"empty-state flex flex-col justify-center items-center h-full"},fa=["disabled"],va={key:1,class:"overflow-y-auto h-[calc(100%-50px)] tickets-scroll"},ma={class:"flex flex-col flex-1 gap-[4px] min-w-0 me-1"},ga=["onDragstart","onClick"],ba=["checked","onChange"],ya={class:"flex items-center text-[14px] font-sans font-medium capitalize text-text-secondary flex-1 min-w-0"},xa={class:"truncate"},_a={class:"flex-shrink-0"},ha={key:0,class:"flex justify-center text-gray-500 items-center text-[11px] aspect-square w-[24px] h-[24px] bg-bg-body rounded-full border-border-input border-2"},ka={key:1,class:"w-6 h-6 rounded-full"},Sa=["src"],wa={key:2,class:"text-[11px] aspect-square w-24px flex justify-center items-center h-[24px] bg-accent/30 text-accent border-accent border rounded-full"},Ca=st({__name:"BacklogTable",props:{searchQuery:{type:String,default:""},sprintType:{type:String,default:""},checkedAll:{type:Boolean,default:!1}},emits:["ticket-dragged-to-sprint","open-ticket","ticket-moved-to-backlog","open-create-ticket"],setup(h,{emit:x}){const{theme:M}=al(),{canCreateCard:A}=Zt(),H=x,C=h,{workspaceId:d}=ml(),{data:T,isPending:W}=Jt(d,C.sprintType),B=y([]),Q=y(!1),P=y([]),z=y([]);R(T,l=>{l!=null&&l.cards&&(B.value=l.cards.map(s=>{var k,V,ve,Pe;const o=((k=s.card)==null?void 0:k.variables)??{},_=((V=s.card)==null?void 0:V._id)??s.card_id,D=String(o["card-status"]??"").trim(),q=String(o.priority??"").trim();return{id:_,key:o["card-code"]||(_==null?void 0:_.slice(-6))||"PRJ-?",summary:o["card-title"]||"(untitled)",type:"Story",status:D,assignee:((ve=s.card)==null?void 0:ve.assigned_to)??"Unassigned",storyPoints:Number(s.story_points??0)||0,priority:O(q),createdAt:((Pe=s.card)==null?void 0:Pe.created_at)??new Date().toISOString(),description:o["card-description"]||""}}))},{immediate:!0}),R(B,l=>{const s=new Set(l.map(o=>o.id));z.value=z.value.filter(o=>s.has(o))});const U=E(()=>{if(console.log(C.searchQuery,"this is query"),!C.searchQuery)return B.value;const l=C.searchQuery.toLowerCase();return B.value.filter(s=>{var _;const o=typeof s.assignee=="string"?s.assignee:((_=s.assignee)==null?void 0:_.u_full_name)||"";return s.key.toLowerCase().includes(l)||s.summary.toLowerCase().includes(l)||o.toLowerCase().includes(l)})});function O(l){const s=String(l??"").toLowerCase();return["highest","blocker","critical"].includes(s)?"Highest":["high","major"].includes(s)?"High":["medium","normal"].includes(s)?"Medium":"Low"}function G(l,s,o){var k;const _=z.value.includes(s.id)?[...z.value]:[s.id],D=_.map(V=>B.value.find(ve=>ve.id===V)).filter(Boolean);P.value=_;const q=JSON.stringify({id:s.id,ids:_,from:o,tickets:D});(k=l.dataTransfer)==null||k.setData("text/plain",q),l.dataTransfer&&(l.dataTransfer.effectAllowed="move")}function le(l){var s;Q.value=!1,((s=l.dataTransfer)==null?void 0:s.dropEffect)!=="none"&&P.value.length&&(B.value=B.value.filter(o=>!P.value.includes(o.id)),z.value=z.value.filter(o=>!P.value.includes(o))),P.value=[]}function se(l){var s;l.preventDefault(),Q.value=!1;try{const o=(s=l.dataTransfer)==null?void 0:s.getData("text/plain");if(!o)return;const _=JSON.parse(o);if(_.from!=="sprint")return;const q=(_.tickets&&_.tickets.length?_.tickets:_.ticket?[_.ticket]:[]).filter(Boolean).filter(V=>!B.value.some(ve=>ve.id===V.id));q.length&&B.value.push(...q);const k=_.ids&&_.ids.length?_.ids:_.id?[_.id]:[];k.length&&H("ticket-moved-to-backlog",k,_.sprintId),console.log(_.sprintId,"sprintId ....")}catch(o){console.error("Drop error:",o)}}function $(l,s){s?z.value.includes(l)||z.value.push(l):z.value=z.value.filter(o=>o!==l)}function f(l,s){const o=s.target.checked;$(l,o)}return R(()=>C.checkedAll,l=>{l?(z.value=B.value.map(s=>s.id),console.log(z.value)):z.value=[]}),(l,s)=>(u(),m("section",ca,[t("div",{class:J(["rounded-lg flex flex-col h-full",Q.value?"ring-2 ring-blue-400":""]),onDragover:s[3]||(s[3]=Se(()=>{},["prevent"])),onDragenter:s[4]||(s[4]=o=>Q.value=!0),onDragleave:s[5]||(s[5]=o=>Q.value=!1),onDrop:s[6]||(s[6]=o=>se(o))},[!g(W)&&U.value.length===0?(u(),m("div",pa,[s[7]||(s[7]=t("img",{src:Yl,class:"mb-4",alt:"backlog-plan"},null,-1)),s[8]||(s[8]=t("h6",{class:"text-sm text-text-primary font-semibold mb-1"}," Get started in the backlog ",-1)),s[9]||(s[9]=t("p",{class:"text-sm text-text-primary/90 mb-4"}," Plan and start a sprint to see issues here. ",-1)),t("button",{disabled:!g(A),onClick:s[0]||(s[0]=o=>l.$emit("open-create-ticket")),class:J(["relative inline-flex items-center justify-center font-medium py-1.5 px-3 text-sm rounded-md focus:outline-none transition text-xs px-3 py-1.5 h-[34px] bg-accent text-white hover:bg-accent-hover border-border-input border",g(A)?"cursor-pointer":"cursor-not-allowed"])}," Create Ticket ",10,fa)])):(u(),m("div",va,[t("div",ma,[(u(!0),m(fe,null,_e(U.value,o=>{var _,D;return u(),m("div",{key:o.id,draggable:"true",class:J(["flex items-center  gap-3 p-[8px] cursor-pointer transition-colors rounded-[8px]",z.value.includes(o.id)?"border-2 border-[#5a2d7f]":"border border-border-input",g(M)==="dark"?"bg-bg-body hover:bg-bg-surface":"bg-bg-charcoal hover:bg-bg-body"]),onDragstart:q=>G(q,o,"backlog"),onDragend:s[2]||(s[2]=q=>le(q)),onClick:q=>l.$emit("open-ticket",o)},[t("input",{type:"checkbox",class:"custom-checkbox bg-bg-body border border-border-input flex-shrink-0",checked:z.value.includes(o.id),onClick:s[1]||(s[1]=Se(()=>{},["stop"])),onChange:q=>f(o.id,q)},null,40,ba),t("div",ya,[t("span",xa,N(o.summary),1)]),t("div",_a,[(o==null?void 0:o.assignee)==="Unassigned"?(u(),m("span",ha,"UA")):(_=o==null?void 0:o.assignee)!=null&&_.u_profile_image?(u(),m("div",ka,[t("img",{src:o.assignee.u_profile_image,alt:""},null,8,Sa)])):(u(),m("span",wa,N(g(Xt)((D=o==null?void 0:o.assignee)==null?void 0:D.u_full_name)),1))])],42,ga)}),128))])]))],34)]))}}),$a=Ut(Ca,[["__scopeId","data-v-f9c3c8f2"]]),Da="data:image/svg+xml,%3csvg%20width='60'%20height='60'%20viewBox='0%200%2060%2060'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M9.375%2030C11.6402%2030%2013.4766%2028.1637%2013.4766%2025.8984C13.4766%2023.6332%2011.6402%2021.7969%209.375%2021.7969C7.10977%2021.7969%205.27344%2023.6332%205.27344%2025.8984C5.27344%2028.1637%207.10977%2030%209.375%2030Z'%20fill='%23AE2A19'/%3e%3cpath%20d='M26.25%2024.375C28.5152%2024.375%2030.3516%2022.5387%2030.3516%2020.2734C30.3516%2018.0082%2028.5152%2016.1719%2026.25%2016.1719C23.9848%2016.1719%2022.1484%2018.0082%2022.1484%2020.2734C22.1484%2022.5387%2023.9848%2024.375%2026.25%2024.375Z'%20fill='%23BF63F3'/%3e%3cpath%20d='M15.3931%2035.8594H11.0159V33.0938C9.93587%2033.3387%208.81469%2033.3387%207.73465%2033.0938V35.8594H1.87528C1.55115%2035.8601%201.2345%2035.9568%200.965283%2036.1373C0.696064%2036.3178%200.486343%2036.574%200.362583%2036.8736C0.238824%2037.1731%200.206573%2037.5027%200.269899%2037.8205C0.333226%2038.1384%200.489292%2038.4304%200.718404%2038.6597L7.05872%2045L0.718404%2051.3403C0.489292%2051.5696%200.333226%2051.8616%200.269899%2052.1795C0.206573%2052.4973%200.238824%2052.8269%200.362583%2053.1264C0.486343%2053.426%200.696064%2053.6822%200.965283%2053.8627C1.2345%2054.0432%201.55115%2054.1399%201.87528%2054.1406H15.3931L21.7503%2045L15.3931%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M34.4562%2035.8594H27.8937V27.4688C26.8137%2027.7138%2025.6925%2027.7138%2024.6125%2027.4688V35.8594H19.3896L25.7487%2045L19.3896%2054.1406H34.4562L40.8143%2045L34.4562%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M43.8281%2019.6875H55.3125C55.7475%2019.6873%2056.1647%2019.5143%2056.4723%2019.2067C56.7799%2018.8991%2056.9529%2018.4819%2056.9531%2018.0469V9.375C56.9529%208.93996%2056.7799%208.5228%2056.4723%208.21518C56.1647%207.90755%2055.7475%207.73462%2055.3125%207.73438H43.8281V7.5C43.8281%207.06488%2043.6553%206.64758%2043.3476%206.3399C43.0399%206.03223%2042.6226%205.85938%2042.1875%205.85938C41.7524%205.85938%2041.3351%206.03223%2041.0274%206.3399C40.7197%206.64758%2040.5469%207.06488%2040.5469%207.5V32.5781H43.8281V19.6875Z'%20fill='%23FCA700'/%3e%3cpath%20d='M59.2843%2043.8403L51.7843%2036.3403C51.6322%2036.1878%2051.4514%2036.0668%2051.2524%2035.9842C51.0534%2035.9017%2050.8401%2035.8593%2050.6246%2035.8594H38.4521L44.8121%2045L38.4531%2054.1406H50.6246C50.8401%2054.1407%2051.0534%2054.0983%2051.2524%2054.0158C51.4514%2053.9332%2051.6322%2053.8122%2051.7843%2053.6597L59.2843%2046.1597C59.4368%2046.0075%2059.5577%2045.8267%2059.6402%2045.6277C59.7228%2045.4287%2059.7652%2045.2154%2059.7652%2045C59.7652%2044.7846%2059.7228%2044.5713%2059.6402%2044.3723C59.5577%2044.1733%2059.4368%2043.9925%2059.2843%2043.8403Z'%20fill='%2382B536'/%3e%3c/g%3e%3c/svg%3e",Ta={key:0,class:"overflow-y-auto h-[calc(100%-50px)] tickets-scroll"},Va={class:"flex flex-col flex-1 gap-[4px] min-w-0 me-1"},Ea=["onDragstart","onClick"],La=["checked","onChange"],Aa={class:"flex items-center text-[14px] font-sans font-medium capitalize text-text-secondary flex-1 min-w-0"},Ma={class:"truncate"},Ba={class:"flex-shrink-0"},Ia={key:0,class:"flex justify-center text-gray-500 items-center text-[11px] aspect-square w-[24px] h-[24px] bg-bg-body rounded-full border-border-input border-2"},Fa={key:1,class:"w-6 h-6 rounded-full"},Ua=["src"],Oa={key:2,class:"text-[11px] aspect-square w-[24px] flex justify-center items-center h-[24px] bg-accent/30 text-accent border-accent border rounded-full"},Na={key:1,class:"empty-state flex flex-col justify-center items-center border-dashed border-3 p-2 border-border h-[calc(100%-50px)] min-h-0"},Pa=st({__name:"SprintCard",props:{sprint:{},sprintId:{},searchQuery:{},checkedSprintAll:{type:Boolean}},emits:["edit-sprint","toggle-start","open-ticket","move-selected-to-backlog","delete-selected-sprint","refresh"],setup(h,{emit:x}){const{theme:M}=al(),A=h,H=x,C=y([]),d=y([]);R(()=>A.sprint&&A.sprint.tickets,$=>{C.value=[...$||[]];const f=new Set(C.value.map(l=>l.id));d.value=d.value.filter(l=>f.has(l))},{immediate:!0,deep:!0});const T=E(()=>{var f;const $=((f=A.searchQuery)==null?void 0:f.toLowerCase())||"";return $?C.value.filter(l=>{var o;const s=((o=l.assignee)==null?void 0:o.u_full_name)??"";return l.key.toLowerCase().includes($)||l.summary.toLowerCase().includes($)||s.toLowerCase().includes($)}):C.value}),W=y(!1),B=y([]),{mutate:Q}=Sl({onSuccess:()=>{vt.success("Card moved to sprint successfully"),H("refresh")},onError:$=>{vt.error("Failed to move card: "+($.message||"Unknown error"))}});function P($,f,l,s){var q;const o=d.value.includes(f.id)?[...d.value]:[f.id],_=o.map(k=>C.value.find(V=>V.id===k)).filter(Boolean);B.value=o;const D=JSON.stringify({id:f.id,ids:o,from:l,sprintId:s,ticket:f,tickets:_});(q=$.dataTransfer)==null||q.setData("text/plain",D),$.dataTransfer&&($.dataTransfer.effectAllowed="move")}function z($){var f;W.value=!1,((f=$.dataTransfer)==null?void 0:f.dropEffect)!=="none"&&B.value.length&&(C.value=C.value.filter(l=>!B.value.includes(l.id)),d.value=d.value.filter(l=>!B.value.includes(l))),B.value=[]}function U(){W.value=!0}function O(){W.value=!1}function G($){var f;$.preventDefault(),W.value=!1;try{const l=(f=$.dataTransfer)==null?void 0:f.getData("text/plain");if(!l)return;const s=JSON.parse(l);if(s.from!=="backlog")return;const _=(s.tickets&&s.tickets.length?s.tickets:s.ticket?[s.ticket]:[]).filter(Boolean).filter(D=>!C.value.some(q=>q.id===D.id));if(!_.length)return;C.value.push(..._),_.forEach(D=>{Q({id:A.sprintId,payload:{card_ids:[D.id],priority:(D.priority||"Medium").toLowerCase(),story_points:D.storyPoints||0}})})}catch(l){console.error("Drop error:",l)}}function le($,f){f?d.value.includes($)||d.value.push($):d.value=d.value.filter(l=>l!==$)}function se($,f){const l=f.target.checked;le($,l)}return R(()=>A.checkedSprintAll,$=>{$?(d.value=T.value.map(f=>f.id),console.log(T.value)):d.value=[]}),($,f)=>(u(),m("div",{class:J(["h-full min-h-0 px-2",g(M)==="dark"?"bg-bg-surface":"bg-bg-surface/30"])},[t("div",{class:J([W.value?"ring-2 ring-blue-400 rounded-lg":"","h-full box-border"]),onDragover:f[2]||(f[2]=Se(()=>{},["prevent"])),onDragenter:U,onDragleave:O,onDrop:G},[T.value.length>0&&$.sprint?(u(),m("div",Ta,[t("div",Va,[(u(!0),m(fe,null,_e(T.value,l=>{var s,o;return u(),m("div",{key:l.id,draggable:"true",class:J(["flex items-center  gap-3 p-[8px] cursor-pointer transition-colors rounded-[8px]",d.value.includes(l.id)?"border-2 border-[#5a2d7f]":"border border-border-input",g(M)==="dark"?"bg-bg-body hover:bg-bg-surface":"bg-bg-charcoal hover:bg-bg-body"]),onDragstart:_=>P(_,l,"sprint",$.sprint.id),onDragend:f[1]||(f[1]=_=>z(_)),onClick:_=>$.$emit("open-ticket",l)},[t("input",{type:"checkbox",class:J(["custom-checkbox border border-border-input flex-shrink-0",g(M)==="dark"?"bg-bg-charcoal":"bg-bg-body "]),checked:d.value.includes(l.id),onClick:f[0]||(f[0]=Se(()=>{},["stop"])),onChange:_=>se(l.id,_)},null,42,La),t("div",Aa,[t("span",Ma,N(l.summary),1)]),t("div",Ba,[(l==null?void 0:l.assignee)=="Unassigned"?(u(),m("span",Ia,"UA")):(s=l.assignee)!=null&&s.u_profile_image?(u(),m("div",Fa,[t("img",{src:l.assignee.u_profile_image,alt:""},null,8,Ua)])):(u(),m("span",Oa,N(g(Xt)(((o=l.assignee)==null?void 0:o.u_full_name)??"")),1))])],42,Ea)}),128))])])):(u(),m("div",Na,f[3]||(f[3]=[Cl('<img src="'+Da+'" class="mb-4" alt="backlog-plan" data-v-f3c6afa6><h6 class="text-sm text-text-primary font-semibold mb-1 text-center" data-v-f3c6afa6> Plan your sprint </h6><p class="text-sm text-text-primary/90 mb-3 max-w-120 text-center" data-v-f3c6afa6> Drag work items from the <span class="font-bold" data-v-f3c6afa6>Backlog</span> section or create new ones to plan the work for this sprint. Select <span class="font-bold" data-v-f3c6afa6>Start sprint</span> when you&#39;re ready. </p>',3)])))],34)],2))}}),qa=Ut(Pa,[["__scopeId","data-v-f3c6afa6"]]),za={class:"px-6 gap-4 bg-bg-input pt-5 pb-8"},ja={class:"mt-3"},Ra={class:"flex justify-end gap-2 p-6 sticky bottom-0 bg-bg-input border-t border-border"},Ha=st({__name:"SprintModal",props:{modelValue:{type:Boolean,default:!1},sprint:{},creatingSprint:{type:Boolean}},emits:["update:modelValue","save","close"],setup(h,{emit:x}){const M=x,A=h,H=E({get:()=>A.modelValue,set:U=>M("update:modelValue",U)}),C=lt({name:"",sprintType:"",description:""}),d=lt({name:!1,sprintType:!1,description:!1}),T=E(()=>d.name&&!String(C.name||"").trim()?"Name is required":""),W=E(()=>!!String(C.name||"").trim()&&!T.value);function B(){H.value=!1,M("close")}function Q(){d.name=!0,W.value&&M("save",{name:String(C.name||"").trim(),value:String(C.sprintType||"").trim(),description:String(C.description||"").trim()})}function P(){d.name=!1,d.sprintType=!1,d.description=!1}R(()=>A.sprint,U=>{if(!U){C.name="";return}C.name=U.name??(U==null?void 0:U.title)??"",C.sprintType=U.sprintType??(U==null?void 0:U.sprintType)??"",C.description=U.description??"",P()},{immediate:!0});const z=[{title:"Milestone",_id:"milestone",dot:"#2e9bda"},{title:"Sprint",_id:"sprint",dot:"#7d68c8"},{title:"Huddle",_id:"huddle",dot:"#eea832"}];return(U,O)=>(u(),ce(Yt,{modelValue:H.value,"onUpdate:modelValue":O[5]||(O[5]=G=>H.value=G),modalClass:"!py-0",size:"md"},{default:oe(()=>[O[8]||(O[8]=t("div",{class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-input pb-4"},[t("h2",{class:"text-xl font-semibold"},"Add New Sprint")],-1)),t("div",za,[F(el,{class:"rounded-1",modelValue:C.name,"onUpdate:modelValue":O[0]||(O[0]=G=>C.name=G),label:"Name",placeholder:"Sprint 1",error:!!T.value,message:T.value,onBlur:O[1]||(O[1]=G=>d.name=!0)},null,8,["modelValue","error","message"]),F(Ft,{class:"rounded-1 mt-3",modelValue:C.sprintType,"onUpdate:modelValue":O[2]||(O[2]=G=>C.sprintType=G),label:"Sprint Type",options:z,error:!!T.value,message:T.value,onBlur:O[3]||(O[3]=G=>d.name=!0)},null,8,["modelValue","error","message"]),t("div",ja,[F(Hl,{modelValue:C.description,"onUpdate:modelValue":O[4]||(O[4]=G=>C.description=G),label:"Description",placeholder:"Sprint description...",type:"textarea",rows:4},null,8,["modelValue"])]),O[6]||(O[6]=t("div",null,null,-1))]),t("div",Ra,[F(Ne,{variant:"secondary",onClick:B},{default:oe(()=>O[7]||(O[7]=[ie("Cancel")])),_:1,__:[7]}),F(Ne,{variant:"primary",disabled:!W.value,onClick:Q},{default:oe(()=>[ie(N(U.creatingSprint?"Saving...":"Save"),1)]),_:1},8,["disabled"])])]),_:1,__:[8]},8,["modelValue"]))}}),Wa="/assets/filter-JX25xO5j.svg",Ka={class:"px-6 grid grid-cols-2 gap-4 bg-bg-input pt-5"},Qa={class:"flex flex-col col-span-2"},Ga={class:"flex flex-col col-span-2"},Ja={class:"flex gap-1 flex-col col-span-2 sm:col-span-1"},Za={key:0,class:"text-xs text-red-500"},Xa={class:"flex gap-1 flex-col col-span-2 sm:col-span-1"},Ya={key:0,class:"text-xs text-red-500"},es={class:"flex flex-col col-span-2"},ts={class:"flex flex-col col-span-2"},ls={class:"bg-bg-body wfull px-4 py-3 rounded-lg text-xs text-text-secondary"},as={class:"flex justify-end gap-2 p-6 sticky bottom-0 bg-bg-input"},ss=st({__name:"StartSprintModal",props:{modelValue:{type:Boolean,default:!1},sprint:{},creatingSprint:{type:Boolean}},emits:["update:modelValue","save","close"],setup(h,{emit:x}){const M=x,A=h,H=[{_id:1,title:"1 Week"},{_id:2,title:"2 Weeks"},{_id:3,title:"3 Weeks"},{_id:4,title:"4 Weeks"},{_id:5,title:"Custom"}],C=E({get:()=>A.modelValue,set:l=>M("update:modelValue",l)}),d=lt({goal:"",start:new Date().toISOString().slice(0,10),end:"",sprint_name:"",duration:null}),T=lt({start:!1,end:!1}),W=E(()=>!d.start&&T.start?"Start date is required":""),B=E(()=>{if(!d.end&&T.end)return"End date is required";if(d.start&&d.end){const l=le(d.start),s=le(d.end);if(Number.isFinite(l)&&Number.isFinite(s)&&s<l)return"End date cannot be before start date"}return""}),Q=E(()=>!W.value&&!B.value);function P(l){d.start=l||"",T.start=!0}function z(l){d.end=l||"",T.end=!0}function U(){C.value=!1,M("close")}function O(){T.start=!0,T.end=!0,Q.value&&(M("save",{title:d.sprint_name||"new sprint",duration:String(f.value)||null,start:d.start||"",end:d.end||"",goal:d.goal??""}),C.value=!1,M("close"))}function G(){T.start=!1,T.end=!1}function le(l){return l?new Date(`${l}T00:00:00`).getTime():NaN}const se=E(()=>d.duration===5);R(()=>d.duration,l=>{if(!l)return;const s=typeof l=="object"?l._id:l;if(s!==5&&d.start){const o=$(d.start,s*7);d.end=o}}),R(()=>d.start,l=>{l&&(d.duration&&d.duration!==5&&(d.end=$(d.start,d.duration*7)),d.end&&le(d.end)<le(d.start)&&(d.end=d.start))});function $(l,s){const o=new Date(l);return o.setDate(o.getDate()+s),o.toISOString().slice(0,10)}const f=E(()=>!d.start||!d.end?0:d.duration!==5?d.duration*7:(le(d.end)-le(d.start))/864e5);return R(()=>A.sprint,l=>{if(!l){d.start=new Date().toISOString().slice(0,10),d.end="",d.sprint_name="",d.goal="",G();return}d.goal=l.goal??"",d.start=l.start??new Date().toISOString().slice(0,10),d.end=l.end??"",d.sprint_name=l.title??"",G()},{immediate:!0}),(l,s)=>(u(),ce(Yt,{modelValue:C.value,"onUpdate:modelValue":s[3]||(s[3]=o=>C.value=o),modalClass:"!py-0",size:"md"},{default:oe(()=>[t("div",{class:"sticky top-0 z-10 flex justify-between items-center py-6 px-6 border-b border-border bg-bg-input"},[s[5]||(s[5]=t("h2",{class:"text-xl font-semibold"},"Start Sprint",-1)),t("span",{onClick:U,class:"text-sm text-text-secondary cursor-pointer"},s[4]||(s[4]=[t("i",{class:"fa-solid fa-xmark text-text-primary text-[19px]"},null,-1)]))]),t("div",Ka,[t("div",Qa,[F(el,{modelValue:d.sprint_name,"onUpdate:modelValue":s[0]||(s[0]=o=>d.sprint_name=o),label:"Sprint Name",placeholder:"Enter sprint name",size:"md",class:"rounded-1"},null,8,["modelValue"])]),t("div",Ga,[F(Ft,{modelValue:d.duration,"onUpdate:modelValue":s[1]||(s[1]=o=>d.duration=o),options:H,label:"Duration",placeholder:"Select duration"},null,8,["modelValue"])]),t("div",Ja,[s[7]||(s[7]=t("label",{class:"text-sm font-medium"},"Start date",-1)),t("div",{class:J(["border relative flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",W.value?"border-red-500":""])},[F(kt,{placeholder:"Set start date",class:"w-full z-1","model-value":d.start,"emit-as":"ymd","onUpdate:modelValue":P},null,8,["model-value"]),s[6]||(s[6]=t("i",{class:"fa-regular fa-calendar absolute right-2 top-3 z-0"},null,-1))],2),W.value?(u(),m("p",Za,N(W.value),1)):I("",!0)]),t("div",Xa,[s[8]||(s[8]=t("label",{class:"text-sm font-medium"},"End date",-1)),t("div",{class:J(["border relative flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",B.value?"border-red-500":""])},[F(kt,{placeholder:"Set end date",class:"w-full","model-value":d.end,"emit-as":"ymd",disabled:!se.value,"onUpdate:modelValue":z,"min-date":d.start},null,8,["model-value","disabled","min-date"]),t("i",{class:J(["fa-regular fa-calendar absolute right-2 top-3 z-0",{"text-text-secondary/30 pointer-events-none":!se.value,"text-text-primary":se.value}])},null,2)],2),B.value?(u(),m("p",Ya,N(B.value),1)):I("",!0)]),t("div",es,[s[9]||(s[9]=t("label",{class:"text-sm font-medium pb-1"},"Goal (optional)",-1)),tt(t("textarea",{"onUpdate:modelValue":s[2]||(s[2]=o=>d.goal=o),class:"w-full text-sm rounded-md border border-border px-3 py-2 bg-bg-input",rows:"2",placeholder:"Ship onboarding flow"},null,512),[[tl,d.goal]])]),t("div",ts,[t("p",ls," Duration: "+N(d.start?f.value+" days":""),1)])]),t("div",as,[F(Ne,{variant:"secondary",onClick:U},{default:oe(()=>s[10]||(s[10]=[ie("Cancel")])),_:1,__:[10]}),F(Ne,{variant:"primary",disabled:!Q.value,onClick:O},{default:oe(()=>[ie(N(l.creatingSprint?"Starting...":"Start"),1)]),_:1},8,["disabled"])])]),_:1},8,["modelValue"]))}}),ns={class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-body pb-4 mb-4"},os={class:"text-sm text-text-secondary mt-1"},rs={class:"flex items-center gap-2 mt-4 w-full"},is={class:"flex items-center gap-2 flex-1"},ds={class:"px-6 min-h-[400px]"},us={key:0},cs={key:0,class:"flex items-center justify-center py-12"},ps={key:1,class:"text-center py-12 text-text-secondary"},fs={key:2,class:"grid grid-cols-2 gap-3"},vs=["onClick"],ms={class:"flex items-center gap-3"},gs={class:"w-10 h-10 rounded-lg bg-bg-input flex items-center justify-center group-hover:bg-primary/10 transition-colors"},bs={class:"font-medium"},ys={key:1},xs={key:0,class:"flex items-center justify-center py-12"},_s={key:1,class:"text-center py-12 text-text-secondary"},hs={key:2,class:"grid grid-cols-2 gap-3"},ks=["onClick"],Ss={class:"flex items-center gap-3"},ws={class:"w-10 h-10 rounded-lg bg-bg-input flex items-center justify-center group-hover:bg-primary/10 transition-colors"},Cs={class:"font-medium"},$s={key:2},Ds={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ts={key:0,class:"flex flex-col"},Vs={class:"flex gap-1 flex-col"},Es={key:0,class:"text-xs text-red-500"},Ls={class:"flex gap-1 flex-col"},As={key:0,class:"text-xs text-red-500"},Ms={class:"flex flex-col gap-1"},Bs={class:"mt-2"},Is={class:"mt-4"},Fs={key:0,class:"text-xs text-red-500 mt-1 px-1"},Us={class:"flex justify-between gap-2 p-6 mt-8 sticky bottom-0 bg-bg-body border-t border-border"},Os={key:1},Ns={class:"flex gap-2"},Ps=st({__name:"CreateBacklogTicketWithModuleSelection",props:{modelValue:{type:Boolean,default:!1},listId:{},selectedVariable:{}},emits:["update:modelValue","created"],setup(h,{emit:x}){const M=x,A=h,H=ll(),{workspaceId:C}=gl(),d=y(1),T=y(null),W=y(null),{data:B,isLoading:Q}=bl(C.value),P=E(()=>{var S;return((S=B.value)==null?void 0:S.modules)||[]}),{data:z,isFetching:U,refetch:O}=yl({workspace_module_id:T,workspace_id:C},{enabled:E(()=>!!T.value)});R(()=>T.value,()=>{O()});const G=E(()=>z.value||[]),{data:le}=xl(C.value),{data:se}=_l(C.value,T,{enabled:E(()=>!!T.value)}),{mutate:$,isPending:f}=hl({onSuccess:()=>{ze(),H.invalidateQueries({queryKey:["sheet-list"]}),H.invalidateQueries({queryKey:["backlog-list"]}),l.value=!1}}),l=E({get:()=>A.modelValue,set:S=>M("update:modelValue",S)}),s=E(()=>{switch(d.value){case 1:return"Select a module to create the ticket in";case 2:return"Select a sheet within the module";case 3:return"Provide the ticket details below and click Add Ticket";default:return""}}),o=E(()=>((se==null?void 0:se.value)??[]).filter(S=>{var b;return((b=S==null?void 0:S.type)==null?void 0:b.title)==="Select"})),_=S=>S.map(b=>({_id:b,title:b})),D=E(()=>((le==null?void 0:le.value)??[]).map(S=>{var b;return{_id:S._id,title:((b=S==null?void 0:S.variables)==null?void 0:b["lane-title"])??String(S._id)}})),q=S=>S.slug,k=lt({title:"",description:"",startDate:null,endDate:null,lane_id:null,assignee:null,variables:{}});R(o,S=>{for(const b of S){const w=q(b);w in k.variables||(k.variables[w]=null)}},{immediate:!0});const V=lt({title:!1,description:!1,startDate:!1,endDate:!1,lane:!1}),ve=E(()=>!!k.title.trim()&&!!k.lane_id&&!!k.startDate&&!!k.endDate&&!ae.value&&!Ee.value&&!je.value&&!re.value&&!Re.value);function Pe(S){k.startDate=S,V.startDate=!0}function qe(S){k.endDate=S,V.endDate=!0}function de(S){k.lane_id=S,V.lane=!0}function Te(S){k.assignee=S}function mt(S){T.value=S._id,d.value=2}function nt(S){W.value=S._id,d.value=3}function Ve(){d.value>1&&d.value--}function Ge(){l.value=!1,ze()}function ze(){d.value=1,T.value=null,W.value=null,k.title="",k.description="",k.startDate=null,k.endDate=null,k.lane_id=null,k.assignee=null,k.variables={},V.title=!1,V.description=!1,V.startDate=!1,V.endDate=!1,V.lane=!1}const ot=E(()=>{var S;return(S=se==null?void 0:se.value)==null?void 0:S.find(b=>(b==null?void 0:b._id)==A.selectedVariable)}),ae=E(()=>V.title&&!k.title.trim()?"Title is required":""),Ee=E(()=>V.startDate?k.startDate?"":"Start date is required":""),je=E(()=>V.endDate?k.endDate?k.startDate&&k.endDate&&k.endDate<k.startDate?"End date cannot be before start date":"":"End date is required":""),re=E(()=>V.lane?k.lane_id?"":"Lane is required":""),Re=E(()=>V.description&&!k.description.trim()?"Description is required":""),K=new Date().toISOString().split("T")[0];function Ie(){var b,w;if(V.title=!0,V.lane=!0,V.description=!0,V.startDate=!0,V.endDate=!0,!ve.value||f.value)return;const S={sheet_list_id:A.listId,workspace_id:C.value,sheet_id:W.value,workspace_lane_id:k.lane_id,variables:{...k.variables,[`${(b=ot.value)==null?void 0:b.slug}`]:A.listId,"card-title":k.title.trim(),"card-description":k.description.trim(),"start-date":k.startDate,"end-date":k.endDate},seat_id:((w=k.assignee)==null?void 0:w._id)??null,createdAt:new Date().toISOString()};$(S)}return R(()=>k.title,S=>{S!=null&&S.trim()&&V.title&&(V.title=!1)}),R(()=>k.lane_id,S=>{S&&V.lane&&(V.lane=!1)}),R(()=>k.startDate,S=>{S&&V.startDate&&(V.startDate=!1)}),R(()=>k.endDate,S=>{S&&V.endDate&&(V.endDate=!1)}),R(()=>k.description,S=>{S!=null&&S.trim()&&V.description&&(V.description=!1)}),(S,b)=>(u(),ce(Yt,{modelValue:l.value,"onUpdate:modelValue":b[5]||(b[5]=w=>l.value=w),modalClass:"!py-0",size:"lg"},{default:oe(()=>[t("div",ns,[b[6]||(b[6]=t("h2",{class:"text-xl font-semibold"},"Create Backlog Ticket",-1)),t("p",os,N(s.value),1),t("div",rs,[(u(),m(fe,null,_e(3,w=>t("div",{key:w,class:"flex items-center flex-1"},[t("div",is,[t("div",{class:J(["h-1 flex-1 rounded-full transition-colors",d.value>=w?"bg-primary":"bg-border"])},null,2)])])),64))])]),t("div",ds,[d.value===1?(u(),m("div",us,[b[8]||(b[8]=t("h3",{class:"text-lg font-medium mb-4"},"Select Module",-1)),g(Q)?(u(),m("div",cs,b[7]||(b[7]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):!P.value||P.value.length===0?(u(),m("div",ps," No modules available ")):(u(),m("div",fs,[(u(!0),m(fe,null,_e(P.value,w=>{var ne,be,Le,me,rt;return u(),m("button",{key:w._id,onClick:wt=>mt(w),class:J(["p-4 border rounded-lg hover:border-primary transition-all text-left group",T.value===w._id?"border-primary bg-primary/5":"border-border"])},[t("div",ms,[t("div",gs,[t("i",{class:J([`${(be=(ne=w==null?void 0:w.variables)==null?void 0:ne["module-icon"])==null?void 0:be.prefix} ${(me=(Le=w==null?void 0:w.variables)==null?void 0:Le["module-icon"])==null?void 0:me.iconName}`,"text-lg"])},null,2)]),t("div",null,[t("p",bs,N(((rt=w.variables)==null?void 0:rt["module-title"])||"Untitled"),1)])])],10,vs)}),128))]))])):d.value===2?(u(),m("div",ys,[b[10]||(b[10]=t("h3",{class:"text-lg font-medium mb-4"},"Select Sheet",-1)),g(U)?(u(),m("div",xs,b[9]||(b[9]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):!G.value||G.value.length===0?(u(),m("div",_s," No sheets available for this module ")):(u(),m("div",hs,[(u(!0),m(fe,null,_e(G.value,w=>{var ne,be;return u(),m("button",{key:w._id,onClick:Le=>nt(w),class:J(["p-4 border rounded-lg hover:border-primary transition-all text-left group",W.value===w._id?"border-primary bg-primary/5":"border-border"])},[t("div",Ss,[t("div",ws,[t("i",{class:J(`${(ne=w==null?void 0:w.variables["sheet-icon"])==null?void 0:ne.prefix} ${(be=w==null?void 0:w.variables["sheet-icon"])==null?void 0:be.iconName} text-lg`)},null,2)]),t("div",null,[t("p",Cs,N((w==null?void 0:w.variables["sheet-title"])||"Untitled Sheet"),1)])])],10,ks)}),128))]))])):d.value===3?(u(),m("div",$s,[b[14]||(b[14]=t("h3",{class:"text-lg font-medium mb-4"},"Ticket Details",-1)),t("div",Ds,[F(el,{modelValue:k.title,"onUpdate:modelValue":b[0]||(b[0]=w=>k.title=w),label:"Ticket Title",placeholder:"e.g., Implement real-time notifications",error:!!ae.value,message:ae.value,onBlur:b[1]||(b[1]=w=>V.title=!0)},null,8,["modelValue","error","message"]),D.value.length>0?(u(),m("div",Ts,[F(Ft,{size:"md",label:"Lane",options:D.value,placeholder:"Select lane",allowCustom:!1,"model-value":k.lane_id,"onUpdate:modelValue":de,error:!!re.value,message:re.value},null,8,["options","model-value","error","message"])])):I("",!0),(u(!0),m(fe,null,_e(o.value,w=>tt((u(),ce(Ft,{size:"md",key:q(w),modelValue:k.variables[w.slug],"onUpdate:modelValue":ne=>k.variables[w.slug]=ne,options:_(w.data),label:w.title,placeholder:"Select value",allowCustom:!0},null,8,["modelValue","onUpdate:modelValue","options","label"])),[[Qt,(w==null?void 0:w._id)!=S.selectedVariable]])),128)),t("div",Vs,[b[11]||(b[11]=t("label",{class:"text-sm"},"Start date",-1)),t("div",{class:J(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",Ee.value?"border-red-500":""])},[F(kt,{placeholder:"Set start date",class:"w-full","model-value":k.startDate,"emit-as":"ymd","onUpdate:modelValue":Pe,"min-date":g(K)},null,8,["model-value","min-date"])],2),Ee.value?(u(),m("p",Es,N(Ee.value),1)):I("",!0)]),t("div",Ls,[b[12]||(b[12]=t("label",{class:"text-sm"},"End date",-1)),t("div",{class:J(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",je.value?"border-red-500":""])},[F(kt,{placeholder:"Set end date",class:"w-full","model-value":k.endDate,"emit-as":"ymd","onUpdate:modelValue":qe,"min-date":k.startDate||g(K)},null,8,["model-value","min-date"])],2),je.value?(u(),m("p",As,N(je.value),1)):I("",!0)]),t("div",Ms,[b[13]||(b[13]=t("label",{class:"text-sm"},"Assignee",-1)),t("div",Bs,[F($l,{name:!0,workspaceId:g(C),onAssign:Te,onUnassign:b[2]||(b[2]=w=>Te(null)),assigneeId:k.assignee,seat:null,disabled:!1,skipPermissionCheck:!0,class:"w-full"},null,8,["workspaceId","assigneeId"])])])]),t("div",Is,[F(Dl,{label:"Description",placeholder:"What needs to be done, acceptance criteria, links…",modelValue:k.description,"onUpdate:modelValue":b[3]||(b[3]=w=>k.description=w),onBlur:b[4]||(b[4]=w=>V.description=!0)},null,8,["modelValue"]),Re.value?(u(),m("p",Fs,N(Re.value),1)):I("",!0)])])):I("",!0)]),t("div",Us,[d.value>1?(u(),ce(Ne,{key:0,variant:"secondary",onClick:Ve},{default:oe(()=>b[15]||(b[15]=[ie("Back")])),_:1,__:[15]})):(u(),m("div",Os)),t("div",Ns,[F(Ne,{variant:"secondary",onClick:Ge},{default:oe(()=>b[16]||(b[16]=[ie("Cancel")])),_:1,__:[16]}),d.value===3?(u(),ce(Ne,{key:0,variant:"primary",disabled:!ve.value||g(f),onClick:Ie},{default:oe(()=>[ie(N(g(f)?"Adding…":"Add Ticket"),1)]),_:1},8,["disabled"])):I("",!0)])])]),_:1},8,["modelValue"]))}}),qs={class:"flex-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur rounded-[6px] shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] flex-grow h-full bg-bg-card border border-border overflow-x-auto flex-col flex scrollbar-visible"},zs={class:"header px-4 py-3 flex items-center justify-between gap-1 w-[100%]"},js={class:"flex gap-4"},Rs={class:"flex gap-3 items-center"},Hs={class:"flex items-center gap-3 bg-bg-surface/50 h-[32px] px-2 rounded-md"},Ws={class:"overflow-y-hidden"},Ks={key:0,class:"flex-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] flex-grow h-full bg-bg-card border border-border overflow-x-auto flex"},Qs={class:"flex overflow-x-auto gap-3 p-4"},Gs={key:0,class:"mx-auto text-text-secondary/80 m-2 w-[90%] h-full justify-center flex items-center border border-dashed border-border"},Js={class:"relative w-full h-full flex overflow-hidden"},Zs={key:0,class:"format-sidebar h-full py-4 px-4 w-[320px] border-l bg-bg-card overflow-hidden flex flex-col"},Xs={class:"flex items-center justify-between pb-3 mb-4 border-b"},Ys={class:"format-content space-y-6"},en={class:"format-group relative mb-3"},tn={class:"text-xs text-secondary"},ln={key:0,class:"absolute z-50 mt-2 p-3 bg-bg-card rounded-lg shadow-lg border w-[240px]"},an={class:"grid grid-cols-10 gap-1 mb-3"},sn=["onClick"],nn={class:"flex items-center gap-2"},on=["value"],rn=["value"],dn={class:"format-group relative mb-3"},un={class:"text-xs text-secondary"},cn={key:0,class:"absolute z-50 mt-2 p-3 bg-bg-card rounded-lg shadow-lg border w-[240px]"},pn={class:"grid grid-cols-10 gap-1 mb-3"},fn=["onClick"],vn={class:"flex items-center gap-2"},mn=["value"],gn=["value"],bn={class:"grid grid-cols-1 gap-3"},yn=["value"],xn={class:"mt-6 pt-4"},_n=["disabled"],hn={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},kn={key:0,class:"fixed inset-0 bg-black/30 flex items-center justify-center"},Sn={class:"bg-white p-6 rounded-xl w-80"},wn={class:"flex justify-end gap-2 mt-4"},Cn=["disabled"],$n={class:"flex items-center mt-3 gap-3"},Dn=st({__name:"ActiveSprint",props:{sptint_id:{},searchQuery:{}},setup(h){const x=h,M=At(()=>Mt(()=>import("./CreateTaskModal-B8T8kQVS.js"),__vite__mapDeps([0,1,2,3]))),A=At(()=>Mt(()=>import("./ConfirmDeleteModal-D5yvjzcO.js"),__vite__mapDeps([4,5,2,3]))),H=At(()=>Mt(()=>import("./SidePanel-ClYigjNH.js"),__vite__mapDeps([6,2,3,7]))),C=At(()=>Mt(()=>import("./KanbanBoard-BEiFDO8A.js"),__vite__mapDeps([8,9,2,3,10,5,11]))),d=y(!1),T=y(""),W=y(null),B=y(null),Q=y(null),P=y("");function z(a){T.value="",d.value=!0,W.value=a}function U(){W.value&&W.value(T.value),d.value=!1}function O(){d.value=!1}const{mutate:G}=hl({onSuccess:()=>{}});function le(){const a=ut.value.trim();a&&ot(a)}function se(){dt.value=!dt.value}const $=Ul(),f=y("kanban"),{workspaceId:l,moduleId:s}=gl(),o=y(""),_=y(!1),D=y(!0),{canEditSheet:q,canDeleteSheet:k,canCreateVariable:V,canCreateSheet:ve,canCreateCard:Pe,canEditCard:qe,canAssignCard:de}=Zt(),{data:Te}=bl(l.value),mt=y(Te.value.modules||[]),nt=E(()=>(mt.value||[]).map(a=>{var e,r;return{_id:a._id,title:((e=a.variables)==null?void 0:e["module-title"])??"Untitled module",description:((r=a.variables)==null?void 0:r["module-description"])??"",icon:a.icon??null,status:a.status??null}})),Ve=ll(),{mutate:Ge,isPending:ze}=Tl({onSuccess:()=>{Ve.invalidateQueries({queryKey:["sheet-list"]}),ut.value="",Fe.value=!1,dt.value=!1,Fe.value=!1}}),ot=a=>{Ge({workspace_id:l.value,module_id:s.value,variable_id:K.value,value:a})};R(nt,a=>{if(!a.length)return;const e=a.find(r=>r.title==="Tasks")||a[0];o.value=e._id},{immediate:!0});const{data:ae,refetch:Ee}=yl({workspace_id:l.value,workspace_module_id:E(()=>o.value)});R(o,a=>{a&&Ee()});const je=E(()=>{var a;return ae.value?(a=ae.value[0])==null?void 0:a._id:""}),re=y(je),Re=E(()=>{var a;return Je.value?(a=Je.value[0])==null?void 0:a._id:""}),K=y(Re),Ie=Vl(),S=E(()=>x.sptint_id),{data:b,isPending:w}=la(S),ne=y(!1),be=y(),Le=a=>{be.value=a},me=El(),rt=Ll();function wt(a){a.type=="column"?me.mutate({payload:{workspace_id:l.value,workspace_module_id:s.value,variable_id:K.value,moved_value:a.meta.id,new_index:a.meta.newIndex}}):rt.mutate({payload:{workspace_id:l.value,card_id:a.meta.moved._id,group_value:a.meta.fromColumnId,group_variable_id:K.value,new_index:a.meta.newIndex,sheet_id:re.value}})}const Ot=a=>{},{mutate:Nt}=Al({onSuccess:()=>{Ee(),pt.value=!1}}),it=E(()=>!ae.value||!ae.value.length?[]:ae.value.map(a=>{var e,r;return{_id:a._id,title:((e=a.variables)==null?void 0:e["sheet-title"])||"Untitled Sheet",description:((r=a.variables)==null?void 0:r["sheet-description"])||"",icon:a.icon||null,status:a.generation_status||null}}));R(it,a=>{a.length>0&&!re.value&&(re.value=a[0]._id)},{immediate:!0}),R(it,a=>{a.length>0?P.value=a[0].title:P.value=""},{immediate:!0}),R(ae,a=>{var e;(a==null?void 0:a.length)>0&&(re.value=(e=a[0])==null?void 0:e._id)});const dt=y(!1),ut=y(""),gt=a=>{Ge({workspace_id:$.params.id,module_id:$.params.module_id,new_value:a.title,value:a.oldTitle,variable_id:K.value})},Fe=y(!1),Ae=y(),He=()=>{Ge({value:Ae.value.title,workspace_id:l.value,module_id:s.value,newValue:Ae.value.title,variable_id:K.value,is_trash:!0})},Pt=a=>{Fe.value=!0,Ae.value=a},bt=a=>{ne.value=!0,Ae.value=a},ct=E(()=>x.searchQuery),qt=y("");R(ct,Xl.debounce(a=>{qt.value=a},200));const Ct=E(()=>{const a=b.value.flatMap(e=>e.cards.map(r=>({...r,columnId:e.title})));return new Zl(a,{keys:["card-title","card-description","card-key"],threshold:.3})}),$t=E(()=>{if(!ct.value)return b.value;const a=Ct.value.search(ct.value).map(e=>e.item);return b.value.map(e=>({...e,cards:a.filter(r=>r.columnId===e.title)}))}),pt=y(!1);function Dt(a){xt.value=!0,yt.value=a}const yt=y();function zt(a){pt.value=!0,yt.value=a}const xt=y(!1),jt=()=>{yt.value={},xt.value=!xt.value},{data:Je,isPending:Tt}=_l(l.value,o,re),{mutate:Ze}=Ml(),Xe=(a,e)=>{Ze({payload:{sheet_id:re.value,workspace_id:l.value,variable_slug:a,is_visible:e}})},{data:Ye}=xl(l),Vt=E(()=>((Ye==null?void 0:Ye.value)??[]).map(a=>{var e;return{_id:a._id,title:((e=a==null?void 0:a.variables)==null?void 0:e["lane-title"])??String(a._id)}})),Et=a=>a.map(e=>({_id:e.value??e,title:e.value??e})),We=Bl({onSuccess:()=>{Ve.invalidateQueries({queryKey:["get-sheets"]}),Ve.invalidateQueries({queryKey:["sheet-list"]}),Ve.invalidateQueries({queryKey:["roles"]})}}),Me=(a,e)=>{if(!b.value)return;const r=b.value.findIndex(p=>p.cards.some(v=>v._id===a));if(r!==-1){const p=b.value[r].cards.findIndex(v=>v._id===a);if(p!==-1){const v={...b.value[r].cards[p]};e(v),b.value[r].cards[p]=v,rl(b)}}};function Rt(a,e){Me(a,r=>{const p=Vt.value.find(v=>v._id===e);p&&(r.lane=p)}),rl(b),We.mutate({card_id:a,workspace_lane_id:e})}const Lt=(a,e)=>{Me(a,r=>{r.seat=e}),We.mutate({card_id:a,seat_id:e==null?void 0:e._id})},Ht=E(()=>{var a;return[{key:"card-title",label:"Title",render:({row:e,value:r})=>ge("div",{class:"flex items-center gap-1 w-full"},[ge("a",{onClick:()=>be.value=e,class:"text-[12px] underline text-blue-500 shrink-0 overflow-ellipsis cursor-pointer"},e["card-code"]),ge("div",{class:"flex-1 min-w-0"},[ge("input",{onFocusout:p=>{var v;_t(e==null?void 0:e._id,"card-title",(v=p==null?void 0:p.target)==null?void 0:v.value)},class:"text-[12px] w-full overflow-ellipsis capitalize p-1 w-full p-1 focus:border border-accent/60 rounded-sm focus:outline-none focus:ring-1 focus:ring-accent bg-transparent focus:bg-bg-body text-[12px] h-8",defaultValue:r,disabled:!qe.value})])])},{key:"end-date",label:"Due Date",render:({row:e,value:r})=>{const p=y(r);return ge(kt,{class:" capitalize flex items-center gap-2 text-[12px]",placeholder:"Set start date",tableInputClass:!0,modelValue:p.value,disabled:!qe.value,"onUpdate:modelValue":v=>ht(e==null?void 0:e._id,v),emptyText:"Date"})}},{key:"lane",label:"Lane",render:({row:e})=>{var r;return ge(ul,{options:Vt.value??[],placeholder:"Select lane",modelValue:((r=e.lane)==null?void 0:r._id)||null,disabled:!qe.value,"onUpdate:modelValue":p=>Rt(e==null?void 0:e._id,p),displayField:"title",emptyText:"Lane"})}},{key:"created_by",label:"Owner",render:({value:e})=>ge("div",{class:"capitalize flex items-center gap-2  px-3"},[ge("div",{class:" rounded-full  "},[e!=null&&e.u_profile_image?ge("img",{class:"w-6 h-6 rounded-full",src:e==null?void 0:e.u_profile_image}):ge("div",{class:"w-5 h-5 rounded-full flex justify-center items-center text-[11px] ",style:`background:${e!=null&&e.u_full_name?Nl({name:e.u_full_name,email:e.u_email}):""}`},Xt(e==null?void 0:e.u_full_name))]),ge("span",{class:"text-[12px]"},e?e==null?void 0:e.u_full_name:"")])},{key:"seat",label:"Assignee",render:({row:e,value:r})=>ge(Ql,{class:"capitalize flex items-center gap-2 ",onAssign:p=>Lt(e==null?void 0:e._id,p),assigneeId:r,seat:r,name:!0,disabled:!de.value,emptyText:"Assignee"})},...((a=Je.value)==null?void 0:a.filter(e=>{var r;return((r=e==null?void 0:e.type)==null?void 0:r.title)==="Select"}).map(e=>({key:e==null?void 0:e.slug,label:e==null?void 0:e.slug,render:({row:r,value:p})=>{var ee;let v=p;if(Array.isArray(r==null?void 0:r.variables)){const L=r.variables.find(j=>j.slug===e.slug);L&&(v=L.value)}else v=((ee=r==null?void 0:r.variables)==null?void 0:ee[e.slug])??(r==null?void 0:r[e.slug])??p;return ge("div",{class:"capitalize flex items-center gap-2"},[ge(ul,{options:Et(e.data??[]),modelValue:v,disabled:!qe.value,emptyText:e.slug,"onUpdate:modelValue":L=>{_t(r==null?void 0:r._id,e.slug,L)},columnName:e.slug})])},visible:e==null?void 0:e.is_visible})))??[]]});function _t(a,e,r){Me(a,p=>{if(e==="card-title"&&(p[e]=r),Array.isArray(p.variables)){const v=p.variables.find(ee=>ee.slug===e);v?v.value=r:p.variables.push({slug:e,value:r,type:"Select"})}else p.variables&&typeof p.variables=="object"?p.variables[e]=r:p[e]=r}),We.mutate({card_id:a,variables:{[e]:r.trim()}})}function et(a){if(a["card-title"]){const e={sheet_list_id:"To Do",workspace_id:l.value,sheet_id:re.value,variables:{"card-title":a["card-title"].trim()},createdAt:new Date().toISOString()};G(e)}}const ht=(a,e)=>{const r=b.value.findIndex(p=>p.cards.some(v=>v._id===a));if(r!==-1){const p=b.value[r].cards.findIndex(v=>v._id===a);p!==-1&&(b.value[r].cards[p]["end-date"]=e)}We.mutate({card_id:a,variables:{"start-date":e}})},Ue=y(null),Ke=y(!1),ft=["#FFFFFF","#F2F2F2","#D9D9D9","#BFBFBF","#A6A6A6","#808080","#404040","#000000","#FFE066","#FF9AA2","#8EE4AF","#00EAD3","#90DBF4","#4D96FF","#6C63FF","#C77DFF","#F7A1C4","#FFC300","#FF5733","#2ECC71","#00B894","#17A2B8","#0984E3","#3F51B5","#9C27B0","#E84393","#FF8C00","#E74C3C","#1E8449","#006D6F","#004C6D","#0057A8","#1A237E","#4A148C","#7D3C98"],Ce=y(!1);R(Ke,a=>{a&&(Ce.value=!1)}),R(Ce,a=>{a&&(Ke.value=!1)});const he=E(()=>{var a,e;return(e=(a=Ue.value)==null?void 0:a.nodeObj)!=null&&e.style?Ue.value.nodeObj.style:De(pe)});function ke(a,e,r){return a!==void 0?a:e!==void 0?e:r}function Be(a,e){var L;if(!((L=Ue.value)!=null&&L.nodeObj))return;const r=Ue.value.nodeObj;r.style||(r.style={});const p=e.target,v=p.type==="number"?Number(p.value):p.value;switch(a){case"bg_color":r.style.background=v;break;case"color":r.style.color=v;break;case"font_size":r.style.fontSize=`${v}px`;break;case"font_weight":r.style.fontWeight=v;break;case"font_style":r.style.fontStyle=v;break;case"font_family":r.style.fontFamily=v;break;case"border_color":r.style.borderColor=v;break;case"border_width":r.style.borderWidth=`${v}px`;break;case"border_radius":r.style.borderRadius=`${v}px`;break;case"padding":r.style.padding=`${v}px`;break}const ee=document.getElementById(r.id);ee&&$e(r,ee)}const pe={bg_color:"#ffffff",color:"#000000",font_size:14,font_weight:"normal",font_style:"normal",font_family:"Inter",border_color:"#cccccc",border_width:0,border_radius:0,padding:0},c=y(!1);async function n(){var e;const a=(e=Ue.value)==null?void 0:e.nodeObj;if(!(!a||c.value)){c.value=!0;try{const r=Ol(a);r._originalStyle||(r._originalStyle={});const p=r.style||{},v=r._originalStyle,ee={bg_color:ke(p.background,v.bg_color,pe.bg_color),color:ke(p.color,v.color,pe.color),font_size:ke(p.fontSize?parseInt(p.fontSize):void 0,v.font_size,pe.font_size),font_weight:ke(p.fontWeight,v.font_weight,pe.font_weight),font_style:ke(p.fontStyle,v.font_style,pe.font_style),font_family:ke(p.fontFamily,v.font_family,pe.font_family),border_color:ke(p.borderColor,v.border_color,pe.border_color),border_width:ke(p.borderWidth?parseInt(p.borderWidth):void 0,v.border_width,pe.border_width),border_radius:ke(p.borderRadius?parseInt(p.borderRadius):void 0,v.border_radius,pe.border_radius),padding:ke(p.padding?parseInt(p.padding):void 0,v.padding,pe.padding),hyperLink:T.value||r.hyperLink||""};r._originalStyle={...ee};const L=r.unique_name==="sheet"?{sheet_id:r.id,workspace_id:l.value,workspace_module_id:s.value,style:ee}:{card_id:r.id,seat_id:r.seat_id,style:ee};r.unique_name==="sheet"?await Nt(L):await We.mutateAsync(L)}finally{c.value=!1}}}const X=y([]);function ye(a){const e={id:"root",topic:localStorage.getItem("currentName")??"",isRoot:!0,children:[],style:{},_originalStyle:{},unique_name:"root"};if(!Array.isArray(a))return e;const r={};return a.forEach(p=>{var j;const v=P.value,ee=((j=p.style)==null?void 0:j.hyperLink)||"";r[v]||(r[v]={id:p._id,topic:v,variables:p==null?void 0:p.variables,children:[],style:p==null?void 0:p.style,_originalStyle:(p==null?void 0:p.style)||{},unique_name:"sheet",hyperLink:ee||""},e.children.push(r[v]));const L={id:p==null?void 0:p._id,topic:p.title,children:[],style:De(p==null?void 0:p.style),_originalStyle:p.style||{},unique_name:"List",hyperLink:ee||""};(p.cards||[]).forEach((Z,xe)=>{var ue;const i=((ue=Z.style)==null?void 0:ue.hyperLink)||"",te={id:Z._id||`card-${xe}`,seat_id:Z.seat_id,topic:Z["card-title"],style:De(Z.style),_originalStyle:Z.style||{},children:[],unique_name:"card",hyperLink:i||""};L.children.push(te),X.value=te}),r[v].children.push(L)}),e}const{mutateAsync:Y}=Il({onSuccess:()=>{Ve.invalidateQueries({queryKey:["sheets"]}),Ve.invalidateQueries({queryKey:["sheet-list"]}),close()}});Fl(()=>{f.value!=="mindmap"||!B.value||!b.value||Pl(()=>{var v,ee;const a=ye(b.value);Q.value&&((ee=(v=Q.value).destroy)==null||ee.call(v),Q.value=null);const e=new Gl({el:B.value,theme:void 0,draggable:!0,contextMenu:!0,contextMenuOption:{Update:!0,extend:[{name:"Update Node",onclick:()=>{var j;D.value&&(D.value=!1);const L=(j=Ue.value)==null?void 0:j.nodeObj;L&&Le(L)}},{name:"Add Hyperlink",onclick:()=>{z(async()=>{await n()})}}]}});Q.value=e,e.init({nodeData:a}),e.bus.addListener("selectNode",L=>{L&&(Ue.value={nodeObj:L},D.value=!0)}),e.bus.addListener("renderNode",L=>{!(L!=null&&L.nodeObj)||!(L!=null&&L.element)||$e(L.nodeObj,L.element)});const r=new Set;e.bus.addListener("operation",async L=>{var xe,i,te;if(!L||L.name!=="insertSibling"&&L.name!=="addChild")return;const j=L.obj;if(!j||!j.id||r.has(j.id))return;r.add(j.id);let Z;if(L.name==="addChild"?Z=(xe=e.currentNode)==null?void 0:xe.nodeObj:Z=(te=(i=e.currentNode)==null?void 0:i.nodeObj)==null?void 0:te.parent,!(!Z||!("unique_name"in Z))&&Z.unique_name==="List")try{const ue=Qe({topic:j.topic??"New Card",id:j.id},Z);await G(ue)}catch(ue){console.error("Error creating card or refetching sheets:",ue)}});const p=new Set;e.bus.addListener("operation",async L=>{var xe,i;if(!L)return;const j=L.obj;if(!(j!=null&&j.id))return;const Z=j.parent??((i=(xe=e.currentNode)==null?void 0:xe.nodeObj)==null?void 0:i.parent);if(!(!Z||!("unique_name"in Z))){if(L.name==="addChild"&&Z.unique_name==="root"&&!p.has(j.id)){p.add(j.id);try{await Y({variables:{"sheet-title":j.topic??"New Sheet","sheet-description":"This is custom description"},is_ai_generated:!1,workspace_id:l.value,workspace_module_id:s.value})}catch(te){console.error("Error creating workspace sheet:",te)}return}if(Z.unique_name==="List")try{const te=Qe({topic:j.topic??"New Card",id:j.id},Z);await G(te)}catch(te){console.error("Error creating card or refetching sheets:",te)}}})})});function $e(a,e){if(!a||!e||!a.style)return;const r=e.querySelector(".topic"),p=e.querySelector(".node")??e,v=a.style;v.background&&(p.style.background=v.background),v.color&&r&&(r.style.color=v.color),r&&(v.fontSize&&(r.style.fontSize=v.fontSize),v.fontFamily&&(r.style.fontFamily=v.fontFamily),v.fontWeight&&(r.style.fontWeight=v.fontWeight),v.fontStyle&&(r.style.fontStyle=v.fontStyle)),v.borderColor&&(p.style.borderColor=v.borderColor),v.borderWidth&&(p.style.borderWidth=v.borderWidth),v.borderRadius&&(p.style.borderRadius=v.borderRadius),v.padding&&(p.style.padding=v.padding)}function De(a={}){return{background:a.bg_color,color:a.color,fontSize:a.font_size!=null?`${a.font_size}px`:void 0,fontWeight:a.font_weight,fontStyle:a.font_style,fontFamily:a.font_family,borderColor:a.border_color,borderWidth:a.border_width!=null?`${a.border_width}px`:void 0,borderRadius:a.border_radius!=null?`${a.border_radius}px`:void 0,padding:a.padding!=null?`${a.padding}px`:void 0,hyperLink:a.hyperLink||void 0}}function Qe(a,e){const r=new Date,p=r.toISOString().split("T")[0],v=new Date(r.getTime()+3*24*60*60*1e3).toISOString().split("T")[0];return{sheet_list_id:(e==null?void 0:e.topic)||"In Progress",workspace_id:l.value,sheet_id:re.value,workspace_lane_id:(a==null?void 0:a.workspace_lane_id)||null,variables:{"card-status":(e==null?void 0:e.topic)||"In Progress","card-type":null,priority:null,process:null,"card-title":a.topic||"New Card","card-description":"","start-date":p,"end-date":v},createdAt:new Date().toISOString()}}return(a,e)=>{var ee,L,j,Z,xe;const r=Wt("Searchbar"),p=Wt("BaseTextField"),v=Wt("Button");return u(),m("div",qs,[t("div",zs,[t("div",js,[t("button",{class:"cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white flex items-center justify-center gap-1 px-2 py-1 rounded-md text-sm font-medium hover:shadow-md disabled:opacity-60",onClick:e[0]||(e[0]=i=>a.$emit("go-back"))},e[28]||(e[28]=[t("i",{class:"fa-solid fa-chevron-left text-xs"},null,-1),ie(" Go Back")])),F(Kt,{modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=i=>o.value=i),options:nt.value,variant:"secondary",customClasses:"fixed w-auto"},null,8,["modelValue","options"]),o.value?(u(),ce(Kt,{key:0,onEditOption:Dt,modelValue:re.value,"onUpdate:modelValue":e[3]||(e[3]=i=>re.value=i),canEdit:g(q),canDelete:g(k),onDeleteOption:zt,options:it.value,variant:"secondary",customClasses:"fixed w-auto"},{more:oe(()=>[g(ve)?(u(),m("div",{key:0,onClick:e[2]||(e[2]=i=>jt()),class:"capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},e[29]||(e[29]=[t("i",{class:"fa-solid fa-plus"},null,-1),ie(" Add new ")]))):I("",!0)]),_:1},8,["modelValue","canEdit","canDelete","options"])):I("",!0)]),t("div",Rs,[o.value?(u(),ce(Kt,{key:0,actions:!1,modelValue:K.value,"onUpdate:modelValue":e[5]||(e[5]=i=>K.value=i),options:g(Je),variant:"secondary",customClasses:"fixed w-auto"},{more:oe(()=>[g(V)?(u(),m("div",{key:0,onClick:e[4]||(e[4]=()=>{_.value=!0}),class:"sticky bottom-0 bg-bg-dropdown shadow-md shadow-border capitalize border-t border-border px-4 py-2 hover:bg-bg-dropdown-menu-hover cursor-pointer flex items-center gap-1 overflow-hidden overflow-ellipsis text-nowrap"},e[30]||(e[30]=[t("i",{class:"fa-solid fa-plus"},null,-1),ie(" Add new ")]))):I("",!0)]),_:1},8,["modelValue","options"])):I("",!0),F(r,{onOnChange:e[6]||(e[6]=i=>{ct.value=i}),placeholder:"Search in Orchit AI space"}),t("div",Hs,[t("button",{class:J(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",f.value==="kanban"?"text-accent bg-accent-text":" hover:bg-border/50 backdrop-blur-2xl  transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"List view",onClick:e[7]||(e[7]=i=>f.value="kanban")},e[31]||(e[31]=[t("i",{class:"fa-solid fa-chart-kanban"},null,-1)]),2),t("button",{onClick:e[8]||(e[8]=i=>f.value="table"),class:J(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",f.value==="table"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gallery view"},e[32]||(e[32]=[t("i",{class:"fa-solid fa-align-left"},null,-1)]),2),t("button",{onClick:e[9]||(e[9]=i=>f.value="mindmap"),class:J(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",f.value==="mindmap"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"MindMap view"},e[33]||(e[33]=[t("i",{class:"fa-solid fa-chart-diagram"},null,-1)]),2)])])]),t("div",Ws,[f.value=="kanban"?(u(),m("div",Ks,[tt(F(kl,null,null,512),[[Qt,g(w)]]),tt(t("div",Qs,[F(g(C),{onOnPlus:bt,"onDelete:column":e[10]||(e[10]=i=>Pt(i)),"onUpdate:column":e[11]||(e[11]=i=>gt(i)),onReorder:wt,onAddColumn:ot,"onSelect:ticket":Le,board:$t.value,onOnBoardUpdate:Ot,variable_id:K.value,sheet_id:re.value},{"column-footer":oe(i=>{var te,ue,sl,nl,ol;return[(ue=(te=g(Ie))==null?void 0:te.transitions)!=null&&ue.all_allowed&&!((ol=(nl=(sl=g(Ie))==null?void 0:sl.transitions)==null?void 0:nl.all_allowed)!=null&&ol.includes(i.column.title))&&g(Ie).transitions.currentColumn!=i.column.title?(u(),m("div",Gs," Disbale ( you can't drop here )")):I("",!0)]}),ticket:oe(({ticket:i})=>[F(Jl,{selectedVar:K.value,onSelect:()=>{Le(i)},ticket:i},null,8,["selectedVar","onSelect","ticket"])]),_:1},8,["board","variable_id","sheet_id"])],512),[[Qt,!g(w)]])])):I("",!0),f.value=="table"?(u(),ce(Kl,{key:1,onToggleVisibility:Xe,onAddVar:e[12]||(e[12]=()=>{_.value=!0}),isPending:g(w)||g(Tt),columns:Ht.value,rows:$t.value,canCreate:g(Pe),canCreateVariable:g(V),onCreate:et},null,8,["isPending","columns","rows","canCreate","canCreateVariable"])):I("",!0),f.value==="mindmap"?(u(),m(fe,{key:2},[t("div",Js,[t("div",{ref_key:"mindMapRef",ref:B,class:"flex-1 h-full overflow-y-hidden rounded-md relative"},null,512),D.value?(u(),m("div",Zs,[t("div",Xs,[e[35]||(e[35]=t("h3",{class:"text-sm font-semibold text-secondary"},"Format Node",-1)),t("button",{onClick:e[13]||(e[13]=i=>D.value=!1),class:"text-gray-400 hover:text-gray-700"},e[34]||(e[34]=[t("i",{class:"fa-solid fa-times"},null,-1)]))]),t("div",Ys,[t("div",null,[e[38]||(e[38]=t("h4",{class:"text-xs font-semibold text-secondary uppercase mb-3"}," Colors ",-1)),t("div",en,[e[36]||(e[36]=t("label",{class:"block text-xs text-secondary mb-1"},"Background",-1)),t("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[14]||(e[14]=i=>Ke.value=!Ke.value)},[t("div",{class:"w-full h-7 rounded border",style:Oe({background:he.value.background})},null,4),t("span",tn,N(he.value.background),1)]),Ke.value?(u(),m("div",ln,[t("div",an,[(u(),m(fe,null,_e(ft,i=>t("button",{key:i,class:"w-5 h-5 rounded border",style:Oe({background:i}),onClick:te=>{Be("bg_color",{target:{value:i}}),Ke.value=!1}},null,12,sn)),64))]),t("div",nn,[t("input",{type:"color",value:he.value.background,class:"w-8 h-8 cursor-pointer",onInput:e[15]||(e[15]=i=>Be("bg_color",i))},null,40,on),t("input",{type:"text",class:"flex-1 text-xs border rounded px-2 py-1",value:he.value.background,readonly:""},null,8,rn)])])):I("",!0)]),t("div",dn,[e[37]||(e[37]=t("label",{class:"block text-xs text-secondary mb-1"},"Text",-1)),t("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[16]||(e[16]=i=>Ce.value=!Ce.value)},[t("div",{class:"w-full h-7 rounded border",style:Oe({background:he.value.color})},null,4),t("span",un,N(he.value.color),1)]),Ce.value?(u(),m("div",cn,[t("div",pn,[(u(),m(fe,null,_e(ft,i=>t("button",{key:i,class:"w-5 h-5 rounded border",style:Oe({background:i}),onClick:te=>{Be("color",{target:{value:i}}),Ce.value=!1}},null,12,fn)),64))]),t("div",vn,[t("input",{type:"color",value:he.value.color,class:"w-8 h-8 cursor-pointer",onInput:e[17]||(e[17]=i=>Be("color",i))},null,40,mn),t("input",{type:"text",class:"flex-1 text-xs border rounded px-2 py-1",value:he.value.color,readonly:""},null,8,gn)])])):I("",!0)])]),t("div",null,[t("div",bn,[t("div",null,[e[40]||(e[40]=t("label",{class:"block text-xs text-secondary mb-1"},"Weight",-1)),t("select",{class:"w-full h-8 border rounded px-2 text-sm",value:he.value.fontWeight,onChange:e[18]||(e[18]=i=>Be("font_weight",i))},e[39]||(e[39]=[t("option",{value:"lighter"},"Light",-1),t("option",{value:"normal"},"Normal",-1),t("option",{value:"bold"},"Bold",-1),t("option",{value:"bolder"},"Extra Bold",-1)]),40,yn)])])])]),t("div",xn,[t("button",{class:"w-full cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm font-medium hover:shadow-md disabled:opacity-60",disabled:c.value,onClick:n},[c.value?(u(),m("span",hn)):I("",!0),t("span",null,N(c.value?"Updating...":"Update"),1)],8,_n)])])):I("",!0)]),d.value?(u(),m("div",kn,[t("div",Sn,[e[41]||(e[41]=t("h3",{class:"text-lg font-semibold mb-4"},"Insert Web Link",-1)),tt(t("input",{"onUpdate:modelValue":e[19]||(e[19]=i=>T.value=i),type:"text",placeholder:"Enter or paste a URL",class:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[tl,T.value]]),t("div",wn,[t("button",{onClick:O,class:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300"}," Cancel "),t("button",{disabled:!T.value,onClick:U,class:J(["px-4 py-2 rounded-md text-white",T.value?"bg-blue-500 hover:bg-blue-600":"bg-blue-300 cursor-not-allowed"])}," Insert ",10,Cn)])])])):I("",!0),dt.value?(u(),m("div",{key:1,class:"absolute top-40 left-70 bg-bg-body rounded-lg p-4 shadow-lg z-100 min-w-[328px] border",onClick:e[21]||(e[21]=Se(()=>{},["stop"]))},[F(p,{autofocus:!0,modelValue:ut.value,"onUpdate:modelValue":e[20]||(e[20]=i=>ut.value=i),placeholder:"Add New list",onKeyup:Gt(le,["enter"])},null,8,["modelValue"]),e[42]||(e[42]=t("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),t("div",$n,[F(v,{onClick:le,varaint:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:oe(()=>[ie(N(g(ze)?"Adding...":"Add list"),1)]),_:1}),t("i",{class:"fa-solid fa-close cursor-pointer",onClick:se})])])):I("",!0)],64)):I("",!0),F(g(A),{onClick:e[22]||(e[22]=Se(()=>{},["stop"])),modelValue:Fe.value,"onUpdate:modelValue":e[23]||(e[23]=i=>Fe.value=i),title:"Delete List",itemLabel:"list",itemName:(ee=Ae.value)==null?void 0:ee.title,requireMatchText:(L=Ae.value)==null?void 0:L.title,confirmText:"Delete workspace",cancelText:"Cancel",size:"md",loading:g(ze),onConfirm:He,onCancel:e[24]||(e[24]=()=>{Fe.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),ne.value?(u(),ce(g(M),{selectedVariable:K.value,listId:(j=Ae.value)==null?void 0:j.title,sheet_id:re.value,key:"createTaskModalKey",modelValue:ne.value,"onUpdate:modelValue":e[25]||(e[25]=i=>ne.value=i),onSubmit:e[26]||(e[26]=()=>{})},null,8,["selectedVariable","listId","sheet_id","modelValue"])):I("",!0),(Z=be.value)!=null&&Z._id?(u(),ce(g(H),{key:4,details:be.value,onClose:e[27]||(e[27]=()=>{Le({variables:{}})}),showPanel:!!((xe=be.value)!=null&&xe._id)},null,8,["details","showPanel"])):I("",!0)])])}}}),Tn=Ut(Dn,[["__scopeId","data-v-fdea7e92"]]),Vn={class:"flex-auto flex-grow h-full min-h-0 bg-bg-card rounded-[6px] border border-border overflow-x-auto flex-col flex"},En={key:1},Ln={key:1,class:"p-4 w-full min-w-0 box-border h-full min-h-0"},An={class:"flex items-center justify-between"},Mn={class:"text-sm font-semibold flex gap-2 items-center"},Bn={class:"flex items-center gap-2 relative",ref:"filterDropdownRef"},In={key:0,class:"flex items-center gap-2 overflow-x-auto no-scrollbar py-1"},Fn=["onClick"],Un={key:1,class:"relative flex items-center gap-3"},On={class:"relative flex-shrink-0"},Nn={class:"flex items-center gap-2 truncate"},Pn=["src"],qn={class:"truncate"},zn={key:0,class:"absolute left-0 top-full mt-1 w-44 bg-white border border-gray-200 rounded-lg shadow-lg z-[9999]"},jn={class:"flex flex-col"},Rn=["onClick"],Hn={class:"flex gap-2 overflow-x-auto no-scrollbar flex-1"},Wn=["onClick"],Kn={key:0,class:"w-full h-full min-h-[250px] flex justify-center items-center"},Qn={class:"flex justify-between px-3"},Gn={class:"flex items-center gap-2 bg-transparent min-w-0 pe-2"},Jn=["onClick"],Zn={class:"flex items-center gap-2 max-w-full"},Xn={class:"flex items-center gap-2 max-w-full"},Yn={class:"truncate max-w-[160px]"},eo={key:1,class:"absolute left-0 mt-2 w-60 bg-white border border-gray-200 rounded-xl shadow-lg z-50 max-h-64 overflow-y-auto overflow-x-hidden"},to={class:"relative flex-1"},lo=["onClick"],ao=["onBlur","onKeyup"],so={class:"relative ml-2 flex gap-2"},no=["onClick"],oo=["onClick"],ro={class:"flex gap-3 items-center"},io={class:"hidden sm:flex flex-1"},uo={class:"gap-2 hidden lg:flex"},co={key:0,class:"flex gap-2"},po={key:0,class:"flex gap-2 lg:hidden"},fo={key:0,class:"border border-red-600"},vo=["title"],mo=["disabled"],go={key:0,class:"fixed inset-0 z-50 -top-30 flex items-center justify-center"},bo={class:"bg-white rounded-lg w-11/12 max-w-md p-4"},yo={class:"flex items-center gap-2"},xo={key:0,class:"w-full h-full min-h-[250px] flex justify-center items-center"},It=400,_o=st({__name:"Plan",setup(h){const{theme:x}=al(),M=y(!1),A=y(""),H=y(!1),C=y(!1),{canCreateCard:d}=Zt(),T=y(!1),W=y(null),B=y(!1),Q=y(!1),P=E(()=>U.value.value),z=[{label:"Milestone",value:"milestone",dot:"#2e9bda"},{label:"Sprint",value:"sprint",dot:"#7d68c8"},{label:"Huddle",value:"huddle",dot:"#eea832"}],U=y(z[0]),O=y(null),G=y(!1);Bt(O,()=>{G.value=!1});const le=()=>{M.value=!1},se=()=>{T.value=!0},{workspaceId:$}=ml(),f=y(!1),{moveSelectedToSprint:l,moveSelectedToBacklog:s,deleteSelected:o,saveSprintMeta:_,toggleStartSprint:D}=ua(),{data:q,refetch:k}=Jt($,P,{}),{data:V}=ql($),ve=E(()=>{var c;return((c=V.value)==null?void 0:c.modules.filter(n=>{var X;return((X=n==null?void 0:n.variables)==null?void 0:X["module-title"])!=="Pin"}))||[]});R(()=>P.value,(c,n)=>{c!==n&&k()});const{mutate:Pe,isPending:qe}=ra({onSuccess:()=>{bt.invalidateQueries({queryKey:["sprint-list"]}),Te.value=!1}}),de=y(null),Te=y(!1),mt=()=>{var c;Pe((c=de.value)==null?void 0:c._id)},{mutate:nt,isPending:Ve}=cl({onSuccess:c=>{_({name:c.title}),console.log(c,"this is testing data"),Ge({id:K.value,payload:{title:c.title,start_date:c.start_date,end_date:c.end_date,goal:c.goal,duration:Number(c.duration_days)}}),b.value=!1}}),{mutate:Ge,isPending:ze}=oa({onSuccess:()=>{S()}}),ot=c=>{console.log("helo",de.value,c),nt({id:K.value,payload:{title:c.title,duration:c.duration,start_date:c.start,end_date:c.end,goal:c.goal}})},{data:ae,refetch:Ee}=ea($.value,P);R(()=>P.value,(c,n)=>{c!==n&&Ee()});const{refetch:je,isPending:re}=Jt($,P),Re=E(()=>{var c,n;return(n=(c=ae==null?void 0:ae.value)==null?void 0:c.sprints[0])==null?void 0:n._id}),K=y(Re.value);R(()=>Re.value,c=>{K.value=c}),R(()=>K.value,c=>{var n;de.value=((n=ae.value)==null?void 0:n.sprints.find(X=>X._id===c))||null});const{data:Ie,refetch:S}=sa(K),b=y(!1),w=()=>{console.log(me.value,"this is sprint"),b.value=!0},{data:ne,isPending:be,refetch:Le}=ta(K);R(()=>K.value,()=>{S()});const me=E(()=>{var X,ye;const c=(X=ne==null?void 0:ne.value)==null?void 0:X.backlog_items;if(!c)return null;const n=(((ye=ne==null?void 0:ne.value)==null?void 0:ye.backlog_items)||[]).map(Y=>{var Qe,a,e,r,p;const $e=((Qe=Y==null?void 0:Y.card)==null?void 0:Qe.variables)||{},De=((a=Y==null?void 0:Y.card)==null?void 0:a._id)||Y.card_id;return{id:De,key:$e["card-code"]||(De==null?void 0:De.slice(-6))||"PRJ-?",summary:$e["card-title"]||"(untitled)",type:"Story",status:wt(String($e["card-status"]||"").trim()),assignee:((r=(e=Y==null?void 0:Y.card)==null?void 0:e.assigned_to)==null?void 0:r.name)||"Unassigned",storyPoints:Number(Y.story_points||0),priority:Ot(String($e.priority||"").trim()),createdAt:((p=Y==null?void 0:Y.card)==null?void 0:p.created_at)||new Date().toISOString(),description:$e["card-description"]||""}});return{id:c._id,name:c.title||"Sprint 1",title:c.title,goal:"",start:"",end:"",started:!1,tickets:n}});function rt(c){K.value=c._id,et.value=!1}function wt(c){const n=c.toLowerCase();return n.includes("progress")?"In Progress":n.includes("done")||n.includes("complete")?"Done":"Todo"}function Ot(c){const n=c.toLowerCase();return n==="highest"||n==="blocker"||n==="critical"?"Highest":n==="high"||n==="major"?"High":n==="medium"||n==="normal"?"Medium":"Low"}const{mutate:Nt}=ia({onSuccess:()=>{vt.success("Card removed from sprint successfully"),it()},onError:c=>{vt.error("Failed to remove card from sprint"),console.error("Failed to remove card from sprint:",c)}});function it(){Le(),Ee(),je(),S()}function dt(c,n){const X=Array.isArray(c)?c:[c],ye=n||K.value;!ye||!X.length||X.forEach(Y=>{Nt({sprintId:ye,cardId:Y})})}const ut=y(!1),gt=y(null);function Fe(){f.value=!0,gt.value=null}function Ae(c){gt.value=c,M.value=!0,ut.value=!0}const He=y(!1);function Pt(){He.value=!0}const bt=ll(),{mutate:ct,isPending:qt}=na({onSuccess:c=>{_({name:c.title}),bt.invalidateQueries({queryKey:["sprint-list"]}),He.value=!1}}),{mutate:Ct,isPending:$t}=cl({onSuccess:c=>{_({name:c.title}),bt.invalidateQueries({queryKey:["sprint-list"]}),He.value=!1}}),pt=y("");function Dt(c){const n=pt.value.trim();if(!n||n===c.title){Lt();return}Ct({id:c._id,payload:{workspace_id:$.value,title:n}}),Me.value=null}function yt(c){var n;de.value?Ct({id:(n=de.value)==null?void 0:n._id,payload:{workspace_id:$.value,title:c.name,sprintType:c.value,description:c.description}}):ct({payload:{workspace_id:$.value,title:c.name,sprintType:c.value,description:c.description}})}function zt(){de.value=null,He.value=!0}function xt(c){de.value=c,Te.value=!0}const{mutate:jt,isPending:Je}=aa(K,{onSuccess:()=>{S()}}),Tt=()=>{jt({})},Ze=y(null),Xe=y(0);let Ye=!1;zl(()=>{if(!Ze.value)return;const c=Ze.value.offsetWidth;Xe.value=c/3});function Vt(){Ye=!0,document.addEventListener("mousemove",Et),document.addEventListener("mouseup",We)}function Et(c){if(!Ye||!Ze.value)return;const n=Ze.value.getBoundingClientRect(),X=c.clientX-n.left;X<It?Xe.value=It:X>n.width-It?Xe.value=n.width-It:Xe.value=X}function We(){Ye=!1,document.removeEventListener("mousemove",Et),document.removeEventListener("mouseup",We)}const Me=y(null);function Rt(c){Me.value=c._id,c.tempTitle=c.title}function Lt(){var n;const c=(n=ae.value)==null?void 0:n.sprints.find(X=>X._id===Me.value);c&&(c.tempTitle=c.title),Me.value=null}Bt(W,()=>{Q.value=!1});const Ht=c=>{U.value=c,B.value=!1};Bt(O,()=>{B.value=!1});const _t=y(null),et=y(!1);Bt(_t,()=>{et.value=!1});const ht=y(!1),Ue=()=>{ht.value=!0},Ke=()=>{ht.value=!1},ft=y("all"),Ce=y(!1);function he(c){ft.value=c,Ce.value=!1,console.log("Selected Huddle Module:",c)}const ke=E(()=>{var n,X,ye;if(ft.value==="all")return"All Milestones";const c=(X=(n=V.value)==null?void 0:n.modules)==null?void 0:X.find(Y=>Y._id===ft.value);return((ye=c==null?void 0:c.variables)==null?void 0:ye["module-title"])||"Select Module"}),Be=y("all");function pe(c){Be.value=c}return(c,n)=>{var X,ye,Y,$e,De,Qe,a,e,r,p,v,ee,L,j,Z,xe;return u(),m("div",Vn,[T.value?(u(),ce(Tn,{key:0,sptint_id:K.value,searchQuery:A.value,onGoBack:n[0]||(n[0]=i=>T.value=!1)},null,8,["sptint_id","searchQuery"])):I("",!0),T.value?I("",!0):(u(),m("div",En,[g(ze)?(u(),ce(kl,{key:0})):(u(),m("div",Ln,[t("div",{class:"flex gap-2 h-full max-h-screen min-h-0 box-border overflow-x-auto group",ref_key:"containerRef",ref:Ze},[t("section",{class:J(["space-y-4 p-4 rounded-md relative group overflow-hidden box-border h-full min-h-0 min-w-[400px]",g(x)==="dark"?"bg-bg-surface":"bg-bg-surface/30"]),style:Oe({width:Xe.value+"px"})},[t("div",An,[t("h2",Mn,[tt(t("input",{type:"checkbox",class:"custom-checkbox bg-bg-body border border-border-input flex-shrink-0","onUpdate:modelValue":n[1]||(n[1]=i=>H.value=i)},null,512),[[jl,H.value]]),ie(" Tickets ("+N((ye=(X=g(q))==null?void 0:X.cards)==null?void 0:ye.length)+" "+N((($e=(Y=g(q))==null?void 0:Y.cards)==null?void 0:$e.length)>1?"Tasks":"Task")+") ",1)]),t("div",Bn,[g(d)?(u(),m("button",{key:0,class:"w-8 h-8 rounded cursor-pointer text-sm hover:bg-bg-body flex items-center justify-center",onClick:Fe},n[22]||(n[22]=[t("i",{class:"text-text-primary fa-regular fa-plus"},null,-1)]))):I("",!0)],512)]),t("div",null,[P.value==="milestone"?(u(),m("div",In,[t("button",{onClick:n[2]||(n[2]=i=>pe("all")),class:J(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium transition-colors whitespace-nowrap",Be.value==="all"?"bg-accent text-white border-none":"bg-transparent text-accent border border-accent"])}," All Modules ",2),(u(!0),m(fe,null,_e(ve.value,i=>(u(),m("button",{key:i._id,onClick:te=>pe(i._id),class:J(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",Be.value===i._id?"bg-accent text-white border-none":"bg-transparent text-accent border border-accent"])},N(i.variables["module-title"]),11,Fn))),128))])):P.value==="huddle"||P.value==="sprint"?(u(),m("div",Un,[t("div",On,[t("button",{class:"h-8 min-w-[160px] flex items-center justify-between px-2 rounded-md border text-sm border-border hover:bg-bg-body",onClick:n[3]||(n[3]=i=>Ce.value=!Ce.value)},[t("span",Nn,[t("img",{src:g(Wa),alt:"filter",class:"w-4 h-4"},null,8,Pn),t("span",qn,N(ke.value||"All Milestones"),1)]),n[23]||(n[23]=t("i",{class:"fas fa-chevron-down text-xs ml-2"},null,-1))]),Ce.value?(u(),m("div",zn,[t("ul",jn,[t("li",{class:"px-3 py-2 cursor-pointer hover:bg-gray-100",onClick:n[4]||(n[4]=i=>he("all"))}," All Milestones "),(u(!0),m(fe,null,_e(ve.value,i=>(u(),m("li",{key:i._id,class:"px-3 py-2 cursor-pointer hover:bg-gray-100",onClick:te=>he(i._id)},N(i.variables["module-title"]),9,Rn))),128))])])):I("",!0)]),t("div",Hn,[(u(!0),m(fe,null,_e((De=g(ae))==null?void 0:De.sprints,i=>(u(),m("button",{key:i._id,onClick:te=>pe(i._id),class:J(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium whitespace-nowrap transition-colors",Be.value===i._id?"bg-accent text-white":"bg-transparent text-accent border border-accent"])},N(i.title),11,Wn))),128))])])):I("",!0)]),g(re)?(u(),m("div",Kn,n[24]||(n[24]=[t("div",{role:"status","aria-label":"Loading",class:"h-10 w-10 rounded-full border-4 border-neutral-700 border-t-transparent animate-spin"},null,-1)]))):(u(),ce($a,{key:1,checkedAll:H.value,"sprint-type":P.value,searchQuery:A.value,onMoveSelectedToSprint:g(l),onDeleteSelectedBacklog:n[5]||(n[5]=i=>g(o)("backlog")),onOpenTicket:Ae,onTicketMovedToBacklog:dt,onOpenCreateTicket:Fe},null,8,["checkedAll","sprint-type","searchQuery","onMoveSelectedToSprint"]))],6),t("div",{class:"h-full w-[3px] relative z-10 opacity-0 group-hover:opacity-100 bg-red hover:bg-accent cursor-col-resize transition",onMousedown:Vt},null,32),t("section",{class:J(["space-y-4 rounded-md relative group pt-2 ovrflow-hidden flex-1 h-full min-h-0 box-border min-w-[400px] border border-border-input overflow-x-hidden",g(x)==="dark"?"bg-bg-surface":"bg-bg-surface/30"])},[t("div",Qn,[t("div",Gn,[t("div",{ref_key:"elipseWrapperSprint",ref:W,class:"relative inline-block"},[t("button",{onClick:n[6]||(n[6]=Se(i=>Q.value=!Q.value,["stop"])),class:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium bg-transparent rounded-lg",style:Oe({border:"1px solid "+U.value.dot})},[t("span",{class:"w-2 h-2 rounded-full",style:Oe({backgroundColor:U.value.dot})},null,4),ie(" "+N(U.value.label)+" ",1),n[25]||(n[25]=t("i",{class:"fas fa-chevron-down text-xs"},null,-1))],4),F(il,{name:"fade"},{default:oe(()=>[Q.value?(u(),m("ul",{key:0,onClick:n[7]||(n[7]=Se(()=>{},["stop"])),class:"absolute left-0 mt-2 w-44 bg-bg-dropdown border border-border rounded-xl shadow-lg z-50"},[(u(),m(fe,null,_e(z,i=>t("li",{key:i.value,onClick:te=>(Ht(i),Q.value=!Q.value),class:"flex items-center gap-3 px-4 py-2 text-sm cursor-pointer"},[t("span",{class:"w-2 h-2 rounded-full",style:Oe({backgroundColor:i.dot})},null,4),ie(" "+N(i.label),1)],8,Jn)),64))])):I("",!0)]),_:1})],512),t("div",Zn,[t("div",Xn,[t("div",{ref_key:"sprintDropdownWrapperRef",ref:_t,class:"relative min-w-0"},[(Qe=g(ae))!=null&&Qe.sprints.length?(u(),m("button",{key:0,onClick:n[8]||(n[8]=i=>et.value=!et.value),class:J(["flex items-center gap-3 lg:px-6 px-2 py-1.5 rounded-lg text-sm font-medium transition-all",K.value?"text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"]),style:Oe(K.value?{backgroundColor:U.value.dot}:{})},[t("span",Yn,N((r=(e=(a=g(ae))==null?void 0:a.sprints)==null?void 0:e.find(i=>i._id===K.value))==null?void 0:r.title),1),n[26]||(n[26]=t("i",{class:"fas fa-chevron-down text-xs"},null,-1))],6)):I("",!0),et.value?(u(),m("div",eo,[(u(!0),m(fe,null,_e((p=g(ae))==null?void 0:p.sprints,i=>{var te;return u(),m("div",{key:i._id,class:"relative px-4 py-2 flex items-center justify-between text-sm cursor-pointer transition-colors hover:bg-gray-100"},[t("div",to,[Me.value!==i._id?(u(),m("button",{key:0,class:"text-left truncate w-full",onClick:ue=>rt(i)},N(i.title),9,lo)):tt((u(),m("input",{key:1,ref_for:!0,ref:"editingInputRef","onUpdate:modelValue":n[9]||(n[9]=ue=>pt.value=ue),class:"w-full px-1 py-1 text-sm rounded outline-none bg-white border border-[#7d68c8]",placeholder:"Enter new name",onClick:n[10]||(n[10]=Se(()=>{},["stop"])),onBlur:ue=>Dt(i),onKeyup:[Gt(ue=>Dt(i),["enter"]),Gt(Lt,["esc"])]},null,40,ao)),[[tl,pt.value]])]),t("div",so,[t("button",{class:"ml-2 text-xs text-gray-400 hover:text-accent",onClick:Se(ue=>Rt(i),["stop"])},n[27]||(n[27]=[t("i",{class:"fas fa-pen"},null,-1)]),8,no),((te=g(ae))==null?void 0:te.sprints.length)>1&&Me.value!==i._id?(u(),m("button",{key:0,onClick:Se(ue=>xt(i),["stop"]),class:"w-4 h-4 rounded-full flex items-center justify-center text-gray-400 hover:text-red-500"},n[28]||(n[28]=[t("i",{class:"fas fa-times text-xs"},null,-1)]),8,oo)):I("",!0)])])}),128))])):I("",!0)],512)]),t("button",{onClick:n[11]||(n[11]=i=>zt()),class:"w-7 h-7 flex items-center justify-center rounded-full bg-accent border text-white transition-colors shrink-0"},n[29]||(n[29]=[t("i",{class:"fa-solid fa-plus text-xs"},null,-1)]))])]),t("div",ro,[t("div",io,[F(dl,{placeholder:"Search in sprint",modelValue:A.value,"onUpdate:modelValue":n[12]||(n[12]=i=>A.value=i)},null,8,["modelValue"])]),t("button",{class:"sm:hidden flex items-center justify-center w-7 h-7 ms-10 rounded-full bg-accent border",onClick:Ue},n[30]||(n[30]=[t("i",{class:"fa-solid fa-magnifying-glass text-white"},null,-1)])),t("div",uo,[((v=g(Ie))==null?void 0:v.status)==="active"?(u(),m("div",co,[F(Ne,{size:"sm",onClick:Tt,variant:(g(x)==="dark","primary"),class:"border-border-input border"},{default:oe(()=>[ie(N(g(Je)?"Ending...":"End"),1)]),_:1},8,["variant"]),t("button",{class:"cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white flex items-center justify-center gap-1 px-2 py-1 rounded-md text-sm font-medium",onClick:se},n[31]||(n[31]=[t("i",{class:"fa-regular fa-eye text-sm"},null,-1),ie(" Preview")]))])):(u(),ce(Ne,{key:1,size:"sm",variant:(g(x)==="dark","primary"),class:"border-border-input border",onClick:w,disabled:!me.value||me.value.tickets.length===0},{default:oe(()=>n[32]||(n[32]=[ie(" Start Sprint ")])),_:1,__:[32]},8,["variant","disabled"]))]),me.value&&me.value.tickets.length?(u(),m("div",po,[ie(N((ee=g(Ie))==null?void 0:ee.status)+" ",1),((L=g(Ie))==null?void 0:L.status)==="active"?(u(),m("div",fo,[t("button",{onClick:Tt,class:"w-8 h-8 flex items-center justify-center rounded-full bg-accent border",title:g(Je)?"Ending...":"End Sprint"},n[33]||(n[33]=[t("i",{class:"fa-solid fa-flag-checkered text-gray-700"},null,-1)]),8,vo)])):(u(),m("button",{key:1,onClick:w,disabled:!me.value||me.value.tickets.length===0,class:"w-7 h-7 flex items-center justify-center rounded-full bg-accent border disabled:opacity-50 disabled:cursor-not-allowed",title:"Start Sprint"},n[34]||(n[34]=[t("i",{class:"fa-solid fa-play"},null,-1)]),8,mo))])):I("",!0)]),F(il,{name:"fade"},{default:oe(()=>[ht.value?(u(),m("div",go,[t("div",bo,[t("div",yo,[F(dl,{placeholder:"Search in sprint",modelValue:A.value,"onUpdate:modelValue":n[13]||(n[13]=i=>A.value=i),class:"flex-1"},null,8,["modelValue"]),t("button",{onClick:Ke,class:"p-2 rounded hover:bg-gray-100 text-accent"},n[35]||(n[35]=[t("i",{class:"fa-solid fa-xmark"},null,-1)]))])])])):I("",!0)]),_:1})]),g(be)?(u(),m("div",xo,n[36]||(n[36]=[t("div",{role:"status","aria-label":"Loading",class:"h-10 w-10 rounded-full border-4 border-neutral-700 border-t-transparent animate-spin"},null,-1)]))):(u(),m(fe,{key:1},[me.value?(u(),ce(qa,{key:0,searchQuery:A.value,sprintId:K.value,checkedSprintAll:C.value,sprint:me.value,onOpenTicket:Ae,onEditSprint:Pt,onToggleStart:g(D),onMoveSelectedToBacklog:g(s),onDeleteSelectedSprint:n[14]||(n[14]=i=>g(o)("sprint",i)),onRefresh:it},null,8,["searchQuery","sprintId","checkedSprintAll","sprint","onToggleStart","onMoveSelectedToBacklog"])):I("",!0)],64))],2)],512)]))])),F(Wl,{onClick:n[15]||(n[15]=Se(()=>{},["stop"])),modelValue:Te.value,"onUpdate:modelValue":n[16]||(n[16]=i=>Te.value=i),title:"Delete Sprint",itemLabel:"Sprint",itemName:(j=de.value)==null?void 0:j.title,requireMatchText:(Z=de.value)==null?void 0:Z.title,confirmText:"Delete Sprint",cancelText:"Cancel",size:"md",loading:g(qe),onConfirm:mt,onCancel:n[17]||(n[17]=()=>{de.value=null,Te.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),F(Ha,{modelValue:He.value,"onUpdate:modelValue":n[18]||(n[18]=i=>He.value=i),onSave:yt,sprint:de.value,creatingSprint:de.value?g($t):g(qt)},null,8,["modelValue","sprint","creatingSprint"]),F(ss,{sprint:de.value,modelValue:b.value,"onUpdate:modelValue":n[19]||(n[19]=i=>b.value=i),onSave:ot,creatingSprint:g(ze)||g(Ve)},null,8,["sprint","modelValue","creatingSprint"]),F(Rl,{modelValue:M.value,"onUpdate:modelValue":n[20]||(n[20]=i=>M.value=i),cardId:(xe=gt.value)==null?void 0:xe.id,onClose:le},null,8,["modelValue","cardId"]),F(Ps,{modelValue:f.value,"onUpdate:modelValue":n[21]||(n[21]=i=>f.value=i)},null,8,["modelValue"])])}}}),Ao=Ut(_o,[["__scopeId","data-v-59647917"]]);export{Ao as default};
