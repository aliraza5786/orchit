const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KanbanBoard-Cd2e-cRD.js","assets/index-CEH2ONcs.js","assets/index-BerHL6iJ.css","assets/DropMenu.vue_vue_type_script_setup_true_lang-CxyUhKMa.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-C95vBMmk.js","assets/workspace-CUUCyNhW.js","assets/KanbanBoard-CJVPdV8K.css","assets/KanbanCard-D4FR0CsC.js","assets/usePeople-CatQoW-E.js"])))=>i.map(i=>d[i]);
import{d as me,M as fe,r as u,m as G,c as xe,a as pe,aa as ye,i as d,y as ge,e as a,h as v,j as _,ac as be,n as y,b1 as _e,f as N,t as f,P as ke,aB as Ce,A as le,V as he,a9 as de,g as D,F as Z,x as se,b as ve,G as we,af as De,o as i,H as Ve,W as Ae,q as Pe,b2 as Se,k as $e,C as ne,w as Y,B as re,a5 as ue,_ as Te,a6 as ce}from"./index-CEH2ONcs.js";import{D as Le,K as Ue}from"./KanbanSkeleton-LlNSYaki.js";import{b as Ne,c as Ee,d as Ie,e as Be,f as Oe,g as Ke}from"./usePeople-CatQoW-E.js";import{_ as qe}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-C95vBMmk.js";import{_ as je}from"./BaseEmailChip.vue_vue_type_script_setup_true_lang-TkXN6k7m.js";import{_ as ze}from"./ProgressBar.vue_vue_type_script_setup_true_lang-C0TDawLk.js";const Me={class:"py-4 flex justify-between items-center border-b border-border px-5 sticky top-0 bg-bg-card z-1"},We={class:"py-4 px-5"},Qe={class:"bg-bg-surface/50 p-2 rounded-lg flex gap-2 items-center"},Re=["src"],Je={key:0,class:"fa-solid fa-user text-white"},Fe={class:"text-base font-medium text-text-primary cursor-pointer"},He={class:"text-sm font-medium text-text-secondary cursor-pointer"},Ye={class:"flex flex-col mt-2"},Ge={class:"text-sm text-text-secondary mt-2"},Ze={key:0},Xe={class:"mb-2 capitalize"},et=["onKeydown"],tt={key:1,class:"mt-3"},at={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},st={class:"text-sm text-text-primary"},lt={key:2,class:"mt-3"},ot={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},it={class:"text-sm text-text-primary"},dt=me({__name:"DetailPanel",props:{showPanel:{type:Boolean,default:!0},details:{type:Object,default:()=>({})}},emits:["close","update:details","comment:post","priority:change"],setup(r,{emit:oe}){const X=fe({}),k=u("details"),A=[{label:"Details",value:"details"},{label:"Tasks",value:"tasks"},{label:"History",value:"history"}],{data:C}=Ne(),{mutate:g}=Ee(),l=r,n=u(!1),x=u(l.details["card-title"]??""),ee=u(l.details.workspace_lane_id??"");G(()=>l.details["card-title"],c=>{x.value=c,ee.value=l.details.workspace_lane_id});const P=u(l.details["card-description"]);G(()=>l.details,()=>{P.value=l.details["card-description"]});const V=u(null);function te(){n.value=!0,De(()=>{var c,s;(c=V.value)==null||c.focus(),(s=V.value)==null||s.select()})}function h(){x.value.trim()||(x.value=l.details["card-title"]??""),w.mutate({card_id:l.details._id,variables:{"card-title":x.value.trim()}}),n.value=!1}function E(){x.value=l.details["card-title"]??"",n.value=!1}const I=u({startDate:l.details["start-date"],endDate:l.details["end-date"]}),ae=xe(()=>l.details["start-date"]);G(ae,c=>{I.value={...I.value,startDate:c}});const b=pe(),w=ye({onSuccess:()=>{b.invalidateQueries({queryKey:["get-sheets"]}),b.invalidateQueries({queryKey:["sheet-list"]}),b.invalidateQueries({queryKey:["roles"]})}}),B=(c,s)=>{console.log(s,"slug",c),g({id:l.details._id,payload:{variable_values:[{module_variable_id:s,value:c}]}})};return(c,s)=>{var S,$,O,K,q,j,z,M,W,T,Q,L,R,J;return i(),d("div",{class:ge(`max-w-[358px] bg-bg-card  rounded-lg overflow-y-auto overflow-x-hidden relative ${r.showPanel?"!translate-x-0 w-full h-full min-w-[350px] overflow-y-auto":"!translate-x-100 w-0 h-0"} transition-all`)},[a("div",Me,[s[4]||(s[4]=a("h5",{class:"text-[16px] font-medium"},"Profile",-1)),a("i",{class:"cursor-pointer text-text-primary fa-solid fa-close",onClick:s[0]||(s[0]=()=>{c.$emit("close")})})]),a("div",We,[a("div",Qe,[(S=r.details)!=null&&S.avatar?(i(),d("img",{key:0,src:($=r.details)==null?void 0:$.avatar,class:"w-10 h-10 rounded-full",alt:"avartar"},null,8,Re)):(i(),d("div",{key:1,class:"min-w-10 max-h-10 aspect-square bg-bg-surface flex justify-center items-center rounded-full",style:be({backgroundColor:(O=r.details)!=null&&O.name?y(_e)({email:(K=r.details)==null?void 0:K.email}):""})},[N(f(y(ke)((q=r.details)==null?void 0:q.name))+" ",1),(j=r.details)!=null&&j.name?_("",!0):(i(),d("i",Je))],4)),a("div",null,[a("h1",Fe,f(r.details.name??r.details.title),1),a("p",He,f(r.details.email),1)])]),v(Ce,{modelValue:k.value,"onUpdate:modelValue":s[1]||(s[1]=e=>k.value=e),class:"my-2",options:A},null,8,["modelValue"]),a("div",Ye,[s[5]||(s[5]=a("h1",{class:"text-base font-medium text-text-primary cursor-pointer"}," Task Progress ",-1)),v(ze,{class:"mt-2",progress:(z=l==null?void 0:l.details)==null?void 0:z.assigned_cards_count,fillColor:"bg-accent ",indeterminate:!0},null,8,["progress"]),a("span",Ge,"Completed 10 tasks out of "+f((M=l==null?void 0:l.details)==null?void 0:M.assigned_cards_count),1)]),k.value=="details"?(i(),d("section",Ze,[a("div",Xe,[n.value?le((i(),d("input",{key:0,ref_key:"titleInput",ref:V,"onUpdate:modelValue":s[2]||(s[2]=e=>x.value=e),onBlur:h,onKeydown:[de(D(h,["prevent"]),["enter"]),de(D(E,["prevent"]),["esc"])],class:"border border-border rounded px-2 py-1 w-full text-xl font-medium",type:"text"},null,40,et)),[[he,x.value]]):(i(),d("h1",{key:1,class:"text-xl font-medium text-text-primary cursor-pointer",onClick:te},f(x.value),1))]),a("div",null,[(i(!0),d(Z,null,se(y(C),(e,t)=>{var m;return i(),d("div",{key:t,class:"grid grid-cols-2 capitalize items-center gap-2 text-sm mt-4"},[N(f(e.title)+" ",1),(i(),ve(we,{size:"sm","model-value":X[e.slug],key:t,placeholder:` ${e.title}`,onClick:s[3]||(s[3]=D(()=>{},["stop"])),default:(e==null?void 0:e.value)??`select ${e.title}`,options:e==null?void 0:e.data.map(p=>({_id:p,title:p})),cardId:(m=r.details)==null?void 0:m._id,"onUpdate:modelValue":p=>B(p,e._id)},null,8,["model-value","placeholder","default","options","cardId","onUpdate:modelValue"]))])}),128))])])):_("",!0),k.value=="tasks"?(i(),d("section",tt,[s[7]||(s[7]=a("span",{class:"text-base text-text-primary"},"Worked On",-1)),((T=(W=r.details)==null?void 0:W.assigned_cards)==null?void 0:T.length)>0?(i(),d("ul",at,[(i(!0),d(Z,null,se((Q=r.details)==null?void 0:Q.assigned_cards,(e,t)=>(i(),d("li",{class:"p-2",key:t},[a("h1",st,f(e==null?void 0:e.title),1),s[6]||(s[6]=a("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):_("",!0)])):_("",!0),k.value=="history"?(i(),d("section",lt,[s[9]||(s[9]=a("span",{class:"text-base text-text-primary"},"history",-1)),((R=(L=r.details)==null?void 0:L.assignment_history)==null?void 0:R.length)>0?(i(),d("ul",ot,[(i(!0),d(Z,null,se((J=r.details)==null?void 0:J.assignment_history,(e,t)=>(i(),d("li",{class:"p-2",key:t},[a("h1",it,f(e==null?void 0:e.title),1),s[8]||(s[8]=a("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):_("",!0)])):_("",!0)])],2)}}}),nt=Ve(dt,[["__scopeId","data-v-92b42b0e"]]),rt={class:"flex-auto flex-grow h-full bg-bg-card rounded-lg border border-border overflow-x-auto flex-col flex"},ut={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},ct={class:"flex gap-3 items-center"},mt={class:"flex p-4 overflow-x-auto gap-3 custom_scroll_bar"},pt=["onClick"],vt={key:1,class:"p-4 space-y-2 bg-bg-surface m-4 rounded-md"},ft={class:"text-sm text-text-primary"},xt=["onClick"],yt={class:"flex items-center mt-3 gap-3"},wt=me({__name:"People",setup(r){const oe=ue(()=>ce(()=>import("./KanbanBoard-Cd2e-cRD.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),X=ue(()=>ce(()=>import("./KanbanCard-D4FR0CsC.js"),__vite__mapDeps([7,1,2,3,4,8]))),k=[{title:"Role",_id:"role"},{title:"Team",_id:"team"},{title:"Status",_id:"status"}],A=u("role"),C=u(!1),g=u(),{workspaceId:l}=Ae(),n=u([]),{mutate:x,isPending:ee}=Ie({onSuccess:e=>{n.value=[...n.value||[],e],w.value="",b.value=!1}}),{data:P,isPending:V}=Be(l.value,A);G(P,e=>{n.value=e?JSON.parse(JSON.stringify(e)):[]}),Pe(()=>{n.value=P.value?JSON.parse(JSON.stringify(P.value)):[]});const te=u("kanban"),h=u(),E=e=>{h.value=e};function I(e){e.type==="column"||$.mutate({id:e.meta.moved._id,payload:{roleId:e.meta.toColumnId}})}const ae=e=>{},b=u(!1),w=u("");function B(){b.value=!b.value}function c(){console.log(">>> clicking on adding pepople ");const e=w.value.trim();s(e)}const s=e=>{console.log(">>> clicking on adding pepople ");const t={workspace_id:l.value,title:e,max_num_people:1};x({payload:t})},S=pe(),$=Se({onSuccess:()=>{S.invalidateQueries({queryKey:["people-lists"]})}}),O=e=>{const t={workspace_id:l.value,title:e==null?void 0:e.title,max_num_people:1};$.mutate({id:e._id,payload:t})},{mutate:K,isPending:q}=Oe({onSuccess:e=>{C.value=!1,n.value=n.value.filter(t=>{var m;return t._id!==((m=e.deletedRole)==null?void 0:m._id)})}}),j=()=>{var e;K({id:(e=g.value)==null?void 0:e.columnId})},z=e=>{C.value=!0,g.value=e},{mutate:M,isPending:W}=Ke({onSuccess:e=>{w.value="",b.value=!1,console.log(g.value,">>>. id local column");const t=n.value.findIndex(H=>H._id===g.value._id);if(t===-1)return;console.log(t,"index>>>");const m=n.value[t],p=[...m.cards??[],e==null?void 0:e.assigned_seat],F={...m,cards:p};n.value=[...n.value.slice(0,t),F,...n.value.slice(t+1)],S.invalidateQueries({queryKey:["people-lists"]})}}),T=e=>{g.value=e;const t={name:e!=null&&e.email?Q(e==null?void 0:e.email[0]):"",email:e!=null&&e.email?e==null?void 0:e.email[0]:"",role_id:e==null?void 0:e._id,workspace_id:l==null?void 0:l.value,additional_seats:1};M({id:e._id,payload:t})};function Q(e){const m=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return m.length?m.map(p=>p.charAt(0).toUpperCase()+p.slice(1).toLowerCase()).join(" "):e}const L=e=>{window.dispatchEvent(new CustomEvent("close-all-showADDNEW")),e.showADDNEW=!e.showADDNEW},R=e=>{T(e)},J=e=>{h.value=e};return(e,t)=>{var p,F,H,ie;const m=$e("Searchbar");return i(),d(Z,null,[a("div",rt,[a("div",ut,[v(Le,{actions:!1,prefix:"View By",modelValue:A.value,"onUpdate:modelValue":t[0]||(t[0]=o=>A.value=o),options:k,variant:"secondary"},null,8,["modelValue"]),a("div",ct,[v(m,{placeholder:"Search in Orchit AI space"})])]),le(v(Ue,null,null,512),[[ne,y(V)]]),le(a("div",mt,[((p=n.value)==null?void 0:p.length)>0?(i(),ve(y(oe),{key:0,plusIcon:!1,onOnPlus:t[1]||(t[1]=o=>T(o)),"onDelete:column":t[2]||(t[2]=o=>z(o)),"onUpdate:column":t[3]||(t[3]=o=>O(o)),onReorder:I,onAddColumn:s,"onSelect:ticket":E,board:n.value,onOnBoardUpdate:ae,variable_id:"",sheet_id:"selected_sheet_id"},{ticket:Y(({ticket:o})=>[v(y(X),{onClick:U=>J(o),ticket:o},null,8,["onClick","ticket"])]),"column-footer":Y(({column:o})=>[o.showADDNEW?o.showADDNEW?(i(),d("div",vt,[a("p",ft,f(o.title)+" "+f(o.cards.length+1),1),v(je,{maxEmails:1,placeholder:"team member email",modelValue:o.email,"onUpdate:modelValue":U=>o.email=U},null,8,["modelValue","onUpdate:modelValue"]),t[12]||(t[12]=a("p",{class:"text-sm text-text-secondary"},"You can assign user later",-1)),v(re,{size:"md",onClick:U=>R(o)},{default:Y(()=>[N(f(y(W)?"Adding...":"Add Seat"),1)]),_:2},1032,["onClick"]),a("i",{class:"fa-solid fa-close cursor-pointer ml-2",onClick:U=>L(o)},null,8,xt)])):_("",!0):(i(),d("div",{key:0,onClick:U=>L(o),class:"flex py-3 px-3 justify-center text-sm text-text-primary items-center gap-3 border border-text-primary cursor-pointer border-dashed mb-4 mx-4 rounded-md"},t[11]||(t[11]=[a("i",{class:"fa-solid fa-plus"},null,-1),N(" Add Seat ")]),8,pt))]),_:1},8,["board"])):_("",!0),a("div",{class:"min-w-[328px]",onClick:t[6]||(t[6]=D(()=>{},["stop"]))},[b.value?(i(),d("form",{key:0,onSubmit:t[5]||(t[5]=D(()=>{},["prevent"])),class:"bg-bg-body rounded-lg p-4"},[v(Te,{autofocus:!0,modelValue:w.value,"onUpdate:modelValue":t[4]||(t[4]=o=>w.value=o),placeholder:"Add New list"},null,8,["modelValue"]),t[13]||(t[13]=a("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),a("div",yt,[v(re,{onClick:c,type:"submit",variant:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:Y(()=>[N(f(y(ee)?"Adding...":"Add Team"),1)]),_:1}),a("i",{class:"fa-solid fa-close cursor-pointer",onClick:B})])],32)):(i(),d("button",{key:1,class:"text-sm text-text-primary py-2.5 cursor-pointer font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",onClick:D(B,["stop"])}," + Add Team "))])],512),[[ne,te.value=="kanban"&&!y(V)]])]),v(qe,{onClick:t[7]||(t[7]=D(()=>{},["stop"])),modelValue:C.value,"onUpdate:modelValue":t[8]||(t[8]=o=>C.value=o),title:"Delete List",itemLabel:"list",itemName:(F=g.value)==null?void 0:F.title,requireMatchText:(H=g.value)==null?void 0:H.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:y(q),onConfirm:j,onCancel:t[9]||(t[9]=()=>{C.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),v(nt,{details:h.value,onClose:t[10]||(t[10]=()=>{E({variables:{}})}),showPanel:!!((ie=h.value)!=null&&ie.title)},null,8,["details","showPanel"])],64)}}});export{wt as default};
