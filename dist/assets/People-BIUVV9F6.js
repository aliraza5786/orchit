const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KanbanBoard-CzH0HGp6.js","assets/index-DSbTV3UV.js","assets/index-FBalhsKL.css","assets/DropMenu.vue_vue_type_script_setup_true_lang-BNbqASWG.js","assets/index-Bx1VtJ09.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-CE09bwEK.js","assets/workspace-BXe2SBd1.js","assets/KanbanBoard-KhpXq64F.css","assets/KanbanCard-DilOcNPE.js","assets/usePeople-BXDm7WOn.js"])))=>i.map(i=>d[i]);
import{d as me,M as fe,r as u,m as Z,c as xe,a as pe,a5 as ye,i as d,y as ge,e as a,h as v,j as b,a7 as _e,n as y,aZ as be,f as N,t as f,P as ke,aw as Ce,A as le,V as he,a4 as oe,g as D,F as G,x as se,b as ve,G as we,aa as Ve,o as i,H as De,W as Ae,q as Pe,a_ as $e,k as Se,C as ne,w as Y,B as re,a1 as ue,_ as Te,a2 as ce}from"./index-DSbTV3UV.js";import{D as Ue,K as Le}from"./KanbanSkeleton-vmnSWcBi.js";import{b as Ne,c as Ie,d as Oe,e as Be,f as Ke,g as Ee}from"./usePeople-BXDm7WOn.js";import{_ as qe}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-CE09bwEK.js";import{_ as je}from"./BaseEmailChip.vue_vue_type_script_setup_true_lang-DglZaTlE.js";import{_ as ze}from"./ProgressBar.vue_vue_type_script_setup_true_lang-QSgi4fdk.js";import"./index-Bx1VtJ09.js";const Me={class:"py-4 flex justify-between items-center border-b border-border px-5 sticky top-0 bg-bg-card z-1"},We={class:"py-4 px-5"},Qe={class:"bg-bg-surface/50 p-2 rounded-lg flex gap-2 items-center"},Re=["src"],Je={key:0,class:"fa-solid fa-user text-white"},Fe={class:"text-base font-medium text-text-primary cursor-pointer"},He={class:"text-sm font-medium text-text-secondary cursor-pointer"},Ye={class:"flex flex-col mt-2"},Ze={class:"text-sm text-text-secondary mt-2"},Ge={key:0},Xe={class:"mb-2 capitalize"},et=["onKeydown"],tt={key:1,class:"mt-3"},at={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},st={class:"text-sm text-text-primary"},lt={key:2,class:"mt-3"},ot={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},it={class:"text-sm text-text-primary"},dt=me({__name:"DetailPanel",props:{showPanel:{type:Boolean,default:!0},details:{type:Object,default:()=>({})}},emits:["close","update:details","comment:post","priority:change"],setup(r,{emit:ie}){const X=fe({}),k=u("details"),A=[{label:"Details",value:"details"},{label:"Tasks",value:"tasks"},{label:"History",value:"history"}],{data:C}=Ne(),{mutate:g}=Ie(),l=r,n=u(!1),x=u(l.details["card-title"]??""),ee=u(l.details.workspace_lane_id??"");Z(()=>l.details["card-title"],c=>{x.value=c,ee.value=l.details.workspace_lane_id});const P=u(l.details["card-description"]);Z(()=>l.details,()=>{P.value=l.details["card-description"]});const V=u(null);function te(){n.value=!0,Ve(()=>{var c,s;(c=V.value)==null||c.focus(),(s=V.value)==null||s.select()})}function h(){x.value.trim()||(x.value=l.details["card-title"]??""),w.mutate({card_id:l.details._id,variables:{"card-title":x.value.trim()}}),n.value=!1}function I(){x.value=l.details["card-title"]??"",n.value=!1}const O=u({startDate:l.details["start-date"],endDate:l.details["end-date"]}),ae=xe(()=>l.details["start-date"]);Z(ae,c=>{O.value={...O.value,startDate:c}});const _=pe(),w=ye({onSuccess:()=>{_.invalidateQueries({queryKey:["get-sheets"]}),_.invalidateQueries({queryKey:["sheet-list"]}),_.invalidateQueries({queryKey:["roles"]})}}),B=(c,s)=>{console.log(s,"slug",c),g({id:l.details._id,payload:{variable_values:[{module_variable_id:s,value:c}]}})};return(c,s)=>{var $,S,K,E,q,j,z,M,W,T,Q,U,R,J;return i(),d("div",{class:ge(`max-w-[358px] bg-bg-card  rounded-lg overflow-y-auto overflow-x-hidden relative ${r.showPanel?"!translate-x-0 w-full h-full min-w-[350px] overflow-y-auto":"!translate-x-100 w-0 h-0"} transition-all`)},[a("div",Me,[s[4]||(s[4]=a("h5",{class:"text-[16px] font-medium"},"Profile",-1)),a("i",{class:"cursor-pointer text-text-primary fa-solid fa-close",onClick:s[0]||(s[0]=()=>{c.$emit("close")})})]),a("div",We,[a("div",Qe,[($=r.details)!=null&&$.avatar?(i(),d("img",{key:0,src:(S=r.details)==null?void 0:S.avatar,class:"w-10 h-10 rounded-full",alt:"avartar"},null,8,Re)):(i(),d("div",{key:1,class:"min-w-10 max-h-10 aspect-square bg-bg-surface flex justify-center items-center rounded-full",style:_e({backgroundColor:(K=r.details)!=null&&K.name?y(be)({email:(E=r.details)==null?void 0:E.email}):""})},[N(f(y(ke)((q=r.details)==null?void 0:q.name))+" ",1),(j=r.details)!=null&&j.name?b("",!0):(i(),d("i",Je))],4)),a("div",null,[a("h1",Fe,f(r.details.name??r.details.title),1),a("p",He,f(r.details.email),1)])]),v(Ce,{modelValue:k.value,"onUpdate:modelValue":s[1]||(s[1]=e=>k.value=e),class:"my-2",options:A},null,8,["modelValue"]),a("div",Ye,[s[5]||(s[5]=a("h1",{class:"text-base font-medium text-text-primary cursor-pointer"}," Task Progress ",-1)),v(ze,{class:"mt-2",progress:(z=l==null?void 0:l.details)==null?void 0:z.assigned_cards_count,fillColor:"bg-accent ",indeterminate:!0},null,8,["progress"]),a("span",Ze,"Completed 10 tasks out of "+f((M=l==null?void 0:l.details)==null?void 0:M.assigned_cards_count),1)]),k.value=="details"?(i(),d("section",Ge,[a("div",Xe,[n.value?le((i(),d("input",{key:0,ref_key:"titleInput",ref:V,"onUpdate:modelValue":s[2]||(s[2]=e=>x.value=e),onBlur:h,onKeydown:[oe(D(h,["prevent"]),["enter"]),oe(D(I,["prevent"]),["esc"])],class:"border border-border rounded px-2 py-1 w-full text-xl font-medium",type:"text"},null,40,et)),[[he,x.value]]):(i(),d("h1",{key:1,class:"text-xl font-medium text-text-primary cursor-pointer",onClick:te},f(x.value),1))]),a("div",null,[(i(!0),d(G,null,se(y(C),(e,t)=>{var m;return i(),d("div",{key:t,class:"grid grid-cols-2 capitalize items-center gap-2 text-sm mt-4"},[N(f(e.title)+" ",1),(i(),ve(we,{size:"sm","model-value":X[e.slug],key:t,placeholder:` ${e.title}`,onClick:s[3]||(s[3]=D(()=>{},["stop"])),default:(e==null?void 0:e.value)??`select ${e.title}`,options:e==null?void 0:e.data.map(p=>({_id:p,title:p})),cardId:(m=r.details)==null?void 0:m._id,"onUpdate:modelValue":p=>B(p,e._id)},null,8,["model-value","placeholder","default","options","cardId","onUpdate:modelValue"]))])}),128))])])):b("",!0),k.value=="tasks"?(i(),d("section",tt,[s[7]||(s[7]=a("span",{class:"text-base text-text-primary"},"Worked On",-1)),((T=(W=r.details)==null?void 0:W.assigned_cards)==null?void 0:T.length)>0?(i(),d("ul",at,[(i(!0),d(G,null,se((Q=r.details)==null?void 0:Q.assigned_cards,(e,t)=>(i(),d("li",{class:"p-2",key:t},[a("h1",st,f(e==null?void 0:e.title),1),s[6]||(s[6]=a("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):b("",!0)])):b("",!0),k.value=="history"?(i(),d("section",lt,[s[9]||(s[9]=a("span",{class:"text-base text-text-primary"},"history",-1)),((R=(U=r.details)==null?void 0:U.assignment_history)==null?void 0:R.length)>0?(i(),d("ul",ot,[(i(!0),d(G,null,se((J=r.details)==null?void 0:J.assignment_history,(e,t)=>(i(),d("li",{class:"p-2",key:t},[a("h1",it,f(e==null?void 0:e.title),1),s[8]||(s[8]=a("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):b("",!0)])):b("",!0)])],2)}}}),nt=De(dt,[["__scopeId","data-v-92b42b0e"]]),rt={class:"flex-auto flex-grow h-full bg-bg-card rounded-lg border border-border overflow-x-auto flex-col flex"},ut={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},ct={class:"flex gap-3 items-center"},mt={class:"flex p-4 overflow-x-auto gap-3 custom_scroll_bar"},pt=["onClick"],vt={key:1,class:"p-4 space-y-2 bg-bg-surface m-4 rounded-md"},ft={class:"text-sm text-text-primary"},xt=["onClick"],yt={key:0,class:"bg-bg-body rounded-lg p-4"},gt={class:"flex items-center mt-3 gap-3"},Dt=me({__name:"People",setup(r){const ie=ue(()=>ce(()=>import("./KanbanBoard-CzH0HGp6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),X=ue(()=>ce(()=>import("./KanbanCard-DilOcNPE.js"),__vite__mapDeps([8,1,2,3,4,9,5]))),k=[{title:"Role",_id:"role"},{title:"Team",_id:"team"},{title:"Status",_id:"status"}],A=u("role"),C=u(!1),g=u(),{workspaceId:l}=Ae(),n=u([]),{mutate:x,isPending:ee}=Oe({onSuccess:e=>{n.value=[...n.value||[],e],w.value="",_.value=!1}}),{data:P,isPending:V}=Be(l.value,A);Z(P,e=>{n.value=e?JSON.parse(JSON.stringify(e)):[]}),Pe(()=>{n.value=P.value?JSON.parse(JSON.stringify(P.value)):[]});const te=u("kanban"),h=u(),I=e=>{h.value=e};function O(e){e.type==="column"||S.mutate({id:e.meta.moved._id,payload:{roleId:e.meta.toColumnId}})}const ae=e=>{},_=u(!1),w=u("");function B(){_.value=!_.value}function c(){console.log(">>> clicking on adding pepople ");const e=w.value.trim();s(e)}const s=e=>{console.log(">>> clicking on adding pepople ");const t={workspace_id:l.value,title:e,max_num_people:1};x({payload:t})},$=pe(),S=$e({onSuccess:()=>{$.invalidateQueries({queryKey:["people-lists"]})}}),K=e=>{const t={workspace_id:l.value,title:e==null?void 0:e.title,max_num_people:1};S.mutate({id:e._id,payload:t})},{mutate:E,isPending:q}=Ke({onSuccess:e=>{C.value=!1,n.value=n.value.filter(t=>{var m;return t._id!==((m=e.deletedRole)==null?void 0:m._id)})}}),j=()=>{var e;E({id:(e=g.value)==null?void 0:e.columnId})},z=e=>{C.value=!0,g.value=e},{mutate:M,isPending:W}=Ee({onSuccess:e=>{w.value="",_.value=!1,console.log(g.value,">>>. id local column");const t=n.value.findIndex(H=>H._id===g.value._id);if(t===-1)return;const m=n.value[t],p=[...m.cards??[],e==null?void 0:e.added_seats[0]],F={...m,cards:p};n.value=[...n.value.slice(0,t),F,...n.value.slice(t+1)],$.invalidateQueries({queryKey:["people-lists"]})}}),T=e=>{g.value=e;const t={name:e!=null&&e.email?Q(e==null?void 0:e.email[0]):"",email:e!=null&&e.email?e==null?void 0:e.email[0]:"",role_id:e==null?void 0:e._id,workspace_id:l==null?void 0:l.value,additional_seats:1};M({id:e._id,payload:t})};function Q(e){const m=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return m.length?m.map(p=>p.charAt(0).toUpperCase()+p.slice(1).toLowerCase()).join(" "):e}const U=e=>{e.showADDNEW=!e.showADDNEW},R=e=>{T(e)},J=e=>{h.value=e};return(e,t)=>{var p,F,H,de;const m=Se("Searchbar");return i(),d(G,null,[a("div",rt,[a("div",ut,[v(Ue,{actions:!1,prefix:"View By",modelValue:A.value,"onUpdate:modelValue":t[0]||(t[0]=o=>A.value=o),options:k,variant:"secondary"},null,8,["modelValue"]),a("div",ct,[v(m,{placeholder:"Search in Orchit AI space"})])]),le(v(Le,null,null,512),[[ne,y(V)]]),le(a("div",mt,[((p=n.value)==null?void 0:p.length)>0?(i(),ve(y(ie),{key:0,plusIcon:!1,onOnPlus:t[1]||(t[1]=o=>T(o)),"onDelete:column":t[2]||(t[2]=o=>z(o)),"onUpdate:column":t[3]||(t[3]=o=>K(o)),onReorder:O,onAddColumn:s,"onSelect:ticket":I,board:n.value,onOnBoardUpdate:ae,variable_id:"",sheet_id:"selected_sheet_id"},{ticket:Y(({ticket:o})=>[v(y(X),{onClick:L=>J(o),ticket:o},null,8,["onClick","ticket"])]),"column-footer":Y(({column:o})=>[o.showADDNEW?o.showADDNEW?(i(),d("div",vt,[a("p",ft,f(o.title)+" "+f(o.cards.length+1),1),v(je,{maxEmails:1,placeholder:"team member email",modelValue:o.email,"onUpdate:modelValue":L=>o.email=L},null,8,["modelValue","onUpdate:modelValue"]),t[11]||(t[11]=a("p",{class:"text-sm text-text-secondary"},"You can assign user later",-1)),v(re,{size:"md",onClick:L=>R(o)},{default:Y(()=>[N(f(y(W)?"Adding...":"Add Seat"),1)]),_:2},1032,["onClick"]),a("i",{class:"fa-solid fa-close cursor-pointer ml-2",onClick:L=>U(o)},null,8,xt)])):b("",!0):(i(),d("div",{key:0,onClick:L=>U(o),class:"flex py-3 px-3 justify-center text-sm text-text-primary items-center gap-3 border border-text-primary cursor-pointer border-dashed mb-4 mx-4 rounded-md"},t[10]||(t[10]=[a("i",{class:"fa-solid fa-plus"},null,-1),N(" Add Seat ")]),8,pt))]),_:1},8,["board"])):b("",!0),a("div",{class:"min-w-[328px]",onClick:t[5]||(t[5]=D(()=>{},["stop"]))},[_.value?(i(),d("div",yt,[v(Te,{autofocus:!0,modelValue:w.value,"onUpdate:modelValue":t[4]||(t[4]=o=>w.value=o),placeholder:"Add New list",onKeyup:oe(c,["enter"])},null,8,["modelValue"]),t[12]||(t[12]=a("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),a("div",gt,[v(re,{onClick:c,variant:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:Y(()=>[N(f(y(ee)?"Adding...":"Add Team"),1)]),_:1}),a("i",{class:"fa-solid fa-close cursor-pointer",onClick:B})])])):(i(),d("button",{key:1,class:"text-sm text-text-primary py-2.5 cursor-pointer font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",onClick:D(B,["stop"])}," + Add Team "))])],512),[[ne,te.value=="kanban"&&!y(V)]])]),v(qe,{onClick:t[6]||(t[6]=D(()=>{},["stop"])),modelValue:C.value,"onUpdate:modelValue":t[7]||(t[7]=o=>C.value=o),title:"Delete List",itemLabel:"list",itemName:(F=g.value)==null?void 0:F.title,requireMatchText:(H=g.value)==null?void 0:H.title,confirmText:"Delete workspace",cancelText:"Cancel",size:"md",loading:y(q),onConfirm:j,onCancel:t[8]||(t[8]=()=>{C.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),v(nt,{details:h.value,onClose:t[9]||(t[9]=()=>{I({variables:{}})}),showPanel:!!((de=h.value)!=null&&de.title)},null,8,["details","showPanel"])],64)}}});export{Dt as default};
