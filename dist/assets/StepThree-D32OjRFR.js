import{_ as B}from"./whitePlus-Cs_P7rE9.js";import{d as S,r as b,K as D,q as P,i as o,e as a,t as l,F as y,x as w,j as g,f as c,h as m,w as d,B as u,o as i}from"./index-By-MWQyp.js";import{_ as U}from"./BaseTextField.vue_vue_type_script_setup_true_lang-D0tVbb66.js";import{_ as q}from"./BaseTextAreaField.vue_vue_type_script_setup_true_lang-D4KFqdA4.js";import{_ as F}from"./BaseEmailChip.vue_vue_type_script_setup_true_lang-DfxGUOM4.js";import{u as H}from"./workspace-jQGMSF7j.js";import"./info-DjaLHeD_.js";const K={class:"w-full pt-4"},G={class:"text-sm md:text-lg text-text-secondary"},J={class:"space-y-3 w-full pb-4"},O={class:"flex items-center justify-between mb-2"},Q={class:"flex gap-4 items-center text-2xl justify-between w-full"},X={class:"flex flex-col text-text-primary text-lg font-semibold"},Y={key:0,class:"text-xl mr-2"},Z={class:"text-sm text-text-secondary"},ee={class:"flex items-center gap-3 text-text-primary"},te=["onClick"],se={class:"text-lg"},ae=["onClick"],ne={class:"text-text-primary"},oe={class:"text-sm font-medium text-text-secondary mb-2 flex justify-between items-center gap-2.5"},ie={class:"flex items-center gap-2"},le={class:"text-xs text-text-secondary"},pe={key:0,class:"text-sm text-text-secondary mb-3"},me={class:"text-sm font-medium capitalize"},ce={class:"text-xs text-text-secondary"},re=["onClick"],de={key:1,class:"mt-2 space-y-2"},ue={class:"flex items-center justify-end gap-2"},xe={key:1,class:"bg-bg-surface mt-2 cursor-pointer rounded-xl p-6"},_e={class:"flex gap-2 mt-6 justify-end"},Ee=S({__name:"StepThree",props:{ai:{type:Boolean}},setup(fe,{expose:h}){const f=H(),x=b(!1),p=b({name:"",description:""}),_=D({roles:[]}),k=/^[^\s@]+@[^\s@]+\.[^\s@]+$/i,C=e=>k.test(e);function E(e){e.showInput=!0,e.capacityWarning=e.people.length>=e.max_num_people}function v(e){for(;e.people.length>e.max_num_people;)e.people.pop();e.capacityWarning=e.people.length>=e.max_num_people}function j(e,s){e.people.some(t=>t.email.toLowerCase()===s.toLowerCase())||e.people.push({name:s.split("@")[0],email:s})}function I(e,s){const[t]=e.people.splice(s,1),n=e.emailList.findIndex(r=>r.toLowerCase()===t.email.toLowerCase());n!==-1&&e.emailList.splice(n,1),e.capacityWarning=e.people.length>=e.max_num_people}function L(e,s){e.emailError=s.length?`Invalid: ${s.join(", ")}`:""}function V(e,s){s.forEach(t=>{C(t)&&(e.people.length<e.max_num_people?j(e,t):e.capacityWarning=!0)})}function W(e,s){const t=e.people.findIndex(n=>n.email.toLowerCase()===s.toLowerCase());t!==-1&&e.people.splice(t,1),e.capacityWarning=e.people.length>=e.max_num_people}function $(e){e.showInput=!1,e.capacityWarning=e.people.length>=e.max_num_people}function T(e){e.showInput=!1,e.emailError="",e.capacityWarning=e.people.length>=e.max_num_people}function N(){const e={id:`role-${Date.now()}`,title:p.value.name,description:p.value.description,people:[],showInput:!1,max_num_people:1,role_emoji:"",emailList:[],emailError:"",capacityWarning:!1};_.roles.push(e),p.value.name="",p.value.description="",x.value=!1}function A(){const e=f.workspace,s=e||{variables:{roles:[]}};s.variables.roles=_.roles,f.setWorkspace(s)}P(()=>{try{const e=f.workspace;if(e){const s=e;_.roles=(s.variables.roles||[]).map(t=>{var n;return{...t,showInput:t.showInput??!1,emailList:t.emailList??((n=t.people)==null?void 0:n.map(r=>r.email))??[],emailError:"",capacityWarning:!1,max_num_people:typeof t.max_num_people=="number"?t.max_num_people:1,role_emoji:t.role_emoji??""}})}}catch(e){console.error("Error parsing workspace from localStorage",e)}});function z(e){e.max_num_people>1&&(e.max_num_people--,v(e))}function R(e){e.max_num_people++,v(e)}function M(){A()}return h({continueHandler:M}),(e,s)=>(i(),o(y,null,[a("div",K,[s[4]||(s[4]=a("h2",{class:"text-xl md:text-4xl font-semibold text-text-primary mb-1"},"Team Resources",-1)),a("p",G,l(e.ai?" AI-recommended team composition for your project":"Team composition for your project"),1)]),a("div",J,[(i(!0),o(y,null,w(_.roles,t=>(i(),o("div",{key:t.id,class:"bg-bg-surface rounded-xl p-6"},[a("div",O,[a("div",Q,[a("div",X,[a("span",null,[t!=null&&t.role_emoji?(i(),o("span",Y,l(t.role_emoji),1)):g("",!0),c(" "+l(t.title),1)]),a("p",Z,l(t.description),1)]),a("div",ee,[a("button",{onClick:n=>z(t),class:"w-8 h-8 aspect-square rounded-full bg-bg-card flex items-center justify-center text-xl"},"−",8,te),a("span",se,l(t.max_num_people),1),a("button",{onClick:n=>R(t),class:"w-8 h-8 aspect-square rounded-full bg-bg-card flex items-center justify-center text-xl"},"+",8,ae)])])]),a("div",ne,[a("p",oe,[s[6]||(s[6]=c(" Team Members ")),a("span",ie,[a("span",le,l(t.people.length)+"/"+l(t.max_num_people),1),m(u,{size:"sm",variant:"secondary",onClick:n=>E(t),disabled:t.people.length>=t.max_num_people,title:"Add people by email"},{default:d(()=>s[5]||(s[5]=[c(" Add people ")])),_:2,__:[5]},1032,["onClick","disabled"])])]),t.people.length===0?(i(),o("div",pe," No team members assigned yet ")):g("",!0),(i(!0),o(y,null,w(t.people,(n,r)=>(i(),o("div",{key:r,class:"flex justify-between items-center mb-3"},[a("div",null,[a("p",me,l(n.name),1),a("p",ce,l(n.email),1)]),a("button",{onClick:ye=>I(t,r),class:"text-text-primary w-8 h-8 bg-bg-card rounded-md cursor-pointer"},"✕",8,re)]))),128)),t.showInput?(i(),o("div",de,[m(F,{modelValue:t.emailList,"onUpdate:modelValue":n=>t.emailList=n,error:!!t.emailError||t.capacityWarning,message:t.capacityWarning?`Reached role capacity (${t.max_num_people}).`:t.emailError||"Press Enter, comma, semicolon, or space to add. Invalid entries won’t be added.",showName:"",onInvalid:n=>L(t,n),onAdd:n=>V(t,n),onRemove:n=>W(t,n)},null,8,["modelValue","onUpdate:modelValue","error","message","onInvalid","onAdd","onRemove"]),a("div",ue,[m(u,{onClick:n=>$(t),variant:"primary"},{default:d(()=>s[7]||(s[7]=[c("Done")])),_:2,__:[7]},1032,["onClick"]),m(u,{onClick:n=>T(t),variant:"secondary"},{default:d(()=>s[8]||(s[8]=[c("Cancel")])),_:2,__:[8]},1032,["onClick"])])])):g("",!0)])]))),128)),x.value?(i(),o("div",xe,[s[12]||(s[12]=a("h1",{class:"text-lg text-text-primary font-semibold"},"Add New Team",-1)),s[13]||(s[13]=a("br",null,null,-1)),m(U,{label:"Team Name",modelValue:p.value.name,"onUpdate:modelValue":s[1]||(s[1]=t=>p.value.name=t),placeholder:"Enter Team Name",size:"lg"},null,8,["modelValue"]),m(q,{label:"Description",class:"mt-4",modelValue:p.value.description,"onUpdate:modelValue":s[2]||(s[2]=t=>p.value.description=t),placeholder:"Enter Description",size:"lg"},null,8,["modelValue"]),a("div",_e,[m(u,{size:"md",variant:"primary",onClick:N},{default:d(()=>s[10]||(s[10]=[c(" Add Team ")])),_:1,__:[10]}),m(u,{size:"md",variant:"secondary",onClick:s[3]||(s[3]=t=>x.value=!1)},{default:d(()=>s[11]||(s[11]=[c("Cancel")])),_:1,__:[11]})])])):(i(),o("div",{key:0,class:"bg-bg-surface mt-2 cursor-pointer rounded-xl p-6 flex flex-col justify-center items-center",onClick:s[0]||(s[0]=t=>x.value=!0)},s[9]||(s[9]=[a("div",{class:"p-2.5 bg-accent w-8 h-8 rounded-full"},[a("img",{class:"w-3",src:B,alt:""})],-1),a("h3",{class:"font-medium text-text-primary capitalize text-sm mt-4"},"Add New Team",-1),a("p",{class:"text-[11px] text-text-secondary mt-1 text-start line-clamp-1"},"Create a custom resource type",-1)])))])],64))}});export{Ee as default};
