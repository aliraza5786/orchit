const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CreateTaskModal-B-GC_yP-.js","assets/CreateTaskModal.vue_vue_type_script_setup_true_lang-BX01yzL5.js","assets/index-DIW8MM4b.js","assets/index-DEzUxGza.css","assets/ConfirmDeleteModal-D0lFRzHD.js","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-KW33MPby.js","assets/SidePanel-BNwQ9NsL.js","assets/sidePanelStore-Sjk6tnyA.js","assets/SidePanel-DVxqp8Jw.css","assets/KanbanBoard-BC-Rq9kg.js","assets/vuedraggable.umd-DjbKo0AE.js","assets/_commonjsHelpers-_d1bhYXs.js","assets/DropMenu.vue_vue_type_script_setup_true_lang-BFmKZOFV.js","assets/index-CaSiHMPx.js","assets/KanbanBoard-Bp34uok7.css","assets/TableSearchCell-US7VN8Sq.js","assets/TableAssigneeCell-GoNGAzBJ.js","assets/CalendarView-Bmcwmdb9.js","assets/CalendarView-BkzIJC_N.css","assets/GanttChartView-Bx7xfvY3.js","assets/TimelineView-CXjgmx1d.js","assets/TimelineView-BsFP6voT.css","assets/BaseTextField-DF6nu0V2.js"])))=>i.map(i=>d[i]);
import{V as yt,W as At,i as f,X as Se,c as L,r as b,x as U,O as bt,Y as st,d as xt,a as Jt,Z as gl,$ as Zl,m,g as e,l as Be,F as ee,G as Te,E as Oe,o as p,t as V,U as bl,N as Xt,k as se,f as ye,w as pe,a0 as yl,h as j,_ as xl,B as We,M as vl,n as P,a1 as Zt,y as lt,T as hl,S as _l,Q as Gl,a2 as Jl,a3 as Xl,a4 as Yl,a5 as es,a6 as ts,J as Gt,a7 as as,a8 as ns,a9 as rs,u as os,aa as is,ab as ds,ac as us,ad as cs,ae as ps,af as we,ag as fs,ah as Ae,ai as vs,aj as ms,ak as be,al as Qt,A as gs,am as zl,an as bs,H as Ie,ao as Ul,ap as ys,aq as xs,C as jl,z as hs,ar as Fl,as as _s}from"./index-DIW8MM4b.js";import{_ as ks}from"./BaseTextAreaField.vue_vue_type_script_setup_true_lang-BYlX9s15.js";import{_ as ws}from"./SearchBar.vue_vue_type_script_setup_true_lang-B-vVilV3.js";import{_ as Ss}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-KW33MPby.js";import{_ as Cs}from"./TableView.vue_vue_type_script_setup_true_lang-BoBir_NK.js";import{k as Mt}from"./MindElixir-Ch35iPok.js";import $s from"./KanbanSkeleton-BGPPDrur.js";import Ts from"./KanbanTicket-Bn0_n3R8.js";import{F as Rl}from"./fuse-Ch1WBRTM.js";import{l as Ds}from"./lodash-CQYOKM_D.js";import{o as Wt}from"./index-CaSiHMPx.js";import"./DropMenu.vue_vue_type_script_setup_true_lang-BFmKZOFV.js";import"./_commonjsHelpers-_d1bhYXs.js";const Vs="data:image/svg+xml,%3csvg%20width='60'%20height='46'%20viewBox='0%200%2060%2046'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M59.7443%2034.8967L50.5682%2025.7206C50.4457%2025.5984%2050.2897%2025.5152%2050.1199%2025.4816C49.9501%2025.4479%2049.7742%2025.4653%2049.6143%2025.5315C49.4544%2025.5976%2049.3176%2025.7097%2049.2213%2025.8535C49.125%2025.9973%2049.0734%2026.1664%2049.073%2026.3394V30.517H25.9775V40.5114H49.0755V44.689C49.0759%2044.8621%2049.1275%2045.0312%2049.2238%2045.175C49.3201%2045.3187%2049.4569%2045.4308%2049.6168%2045.497C49.7767%2045.5632%2049.9527%2045.5805%2050.1224%2045.5468C50.2922%2045.5132%2050.4482%2045.43%2050.5708%2045.3078L59.7468%2036.1318C59.9095%2035.9672%2060.0005%2035.7451%2060.0001%2035.5137C59.9996%2035.2823%2059.9076%2035.0605%2059.7443%2034.8967Z'%20fill='%23C6DBA9'/%3e%3cpath%20d='M32.3149%2030.5293C30.664%2031.5967%2028.7394%2032.1633%2026.7734%2032.1609V40.5237H34.7295C39.2829%2038.5638%2042.9649%2035.0102%2045.0851%2030.5293H32.3149Z'%20fill='url(%23paint0_linear_250_16424)'/%3e%3cpath%20d='M46.2209%2020.2832C46.2317%2015.0884%2044.2448%2010.0884%2040.6714%206.3179C37.0981%202.54738%2032.2119%200.295026%2027.024%200.0269855C21.8362%20-0.241055%2016.7439%201.49574%2012.801%204.87791C8.85809%208.26009%206.36647%2013.0287%205.84178%2018.1969L2.46233%2017.8913C2.31055%2017.8782%202.15829%2017.9103%202.02467%2017.9835C1.89106%2018.0566%201.78205%2018.1677%201.71134%2018.3026C1.64063%2018.4376%201.61138%2018.5904%201.62726%2018.7419C1.64313%2018.8934%201.70343%2019.0368%201.80058%2019.1542L9.51927%2028.406C9.79205%2028.7344%2010.277%2028.7773%2010.378%2028.5045L19.6298%2020.7833C20.3876%2020.3413%2020.1173%2019.4825%2019.4328%2019.4194L15.8008%2019.091C16.0297%2017.1283%2016.8213%2015.2735%2018.0802%2013.7503C19.3391%2012.2271%2021.0115%2011.1004%2022.8961%2010.5059C24.7806%209.9114%2026.7969%209.8745%2028.7019%2010.3996C30.6069%2010.9248%2032.3195%2011.9896%2033.6332%2013.4657C34.947%2014.9419%2035.8059%2016.7664%2036.1065%2018.7195C36.4071%2020.6726%2036.1365%2022.6709%2035.3274%2024.4738C34.5183%2026.2766%2033.2051%2027.8071%2031.5462%2028.8807C29.8872%2029.9544%2027.9531%2030.5254%2025.977%2030.5251H25.9283V40.5094C31.2249%2040.4031%2036.7093%2038.2263%2040.4202%2034.4455C44.1311%2030.6648%2046.2134%2025.5808%2046.2209%2020.2832Z'%20fill='%23D7A39E'/%3e%3cpath%20d='M25.9773%2030.5293H0V40.5237H25.9773V30.5293Z'%20fill='url(%23paint1_linear_250_16424)'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_250_16424'%20x1='6.53714'%20y1='35.5252'%20x2='47.0198'%20y2='35.5252'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%236C798F'/%3e%3cstop%20offset='1'%20stop-color='%236C798F'%20stop-opacity='0.1'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_250_16424'%20x1='0'%20y1='36'%20x2='26'%20y2='36'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23E8D4D3'%20stop-opacity='0'/%3e%3cstop%20offset='1'%20stop-color='%23E2A39F'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",Ls=(k,x,N={})=>At({queryKey:L(()=>["sprint-list",f(k),f(x)]),queryFn:({signal:T})=>Se({url:`sprints/${f(k)}`,method:"GET",signal:T,params:{sprintType:f(x)}}),...N}),Es=(k,x={})=>{const N=L(()=>!!f(k));return At({queryKey:["sprint-cards",k],queryFn:({signal:T})=>Se({url:`sprints/${f(k)}/backlog`,method:"GET",signal:T}),enabled:N,...x})},Ms=(k,x={})=>At({queryKey:["sprint-kanban",k],queryFn:({signal:N})=>Se({url:"workspace/cards/sprintgrouped",method:"GET",signal:N,params:{sprint_id:f(k),variable_id:"68b6c96e0a95eef7d14e6981"}}),...x}),As=(k,x={})=>yt({key:["sprint-complete"]},{mutationFn:N=>Se({url:`sprints/${f(k)}/complete`,method:"POST",data:N.payload}),...x}),Is=(k,x={})=>{const N=L(()=>!!f(k));return At({queryKey:["sprint-detail",k],queryFn:({signal:T})=>Se({url:`sprints/detail/${f(k)}?include_cards=true`,method:"GET",signal:T}),enabled:N,...x})},ml=(k,x,N=null,T={})=>At({queryKey:["backlog-list",k,f(x),f(N)],queryFn:({signal:X})=>Se({url:`sprints/workspace/${f(k)}/cards`,method:"GET",signal:X,params:{include_sprint_cards:!1,sprintType:f(x),module_id:f(N)}}),...T}),Bs=(k={})=>yt({key:["add-sprint"]},{mutationFn:x=>Se({url:"/sprints",method:"POST",data:x.payload}),...k}),ls=(k={})=>yt({key:["move-card-to-sprint"]},{mutationFn:x=>Se({url:`/sprints/${x.id}/cards`,method:"POST",data:x.payload}),...k}),Hl=(k={})=>yt({key:["add-sprint"]},{mutationFn:x=>Se({url:`/sprints/${x.id}`,method:"PUT",data:x.payload}),...k}),Os=(k={})=>yt({key:["start-sprint"]},{mutationFn:x=>Se({url:`/sprints/${x.id}/start`,method:"POST",data:x.payload}),...k}),Ns=(k={})=>yt({key:["delete-sprint"]},{mutationFn:x=>Se({url:`/sprints/${x}`,method:"DELETE"}),...k}),Ps=(k={})=>yt({key:["remove-card-from-sprint"]},{mutationFn:x=>Se({url:`sprints/${f(x.sprintId)}/cards/remove `,method:"POST",data:{card_ids:[x.cardId]}}),...k}),ss="jira-like:";function Wl(k="id"){return`${k}_${Math.random().toString(36).slice(2,9)}`}function Kl(k,x){try{localStorage.setItem(ss+k,JSON.stringify(x))}catch{}}function Ql(k,x){try{const N=localStorage.getItem(ss+k);return N?JSON.parse(N):x}catch{return x}}function qs(k){switch(k){case"Highest":return"rounded-md bg-red-50 px-2 py-0.5 text-xs text-red-700";case"High":return"rounded-md bg-orange-50 px-2 py-0.5 text-xs text-orange-700";case"Medium":return"rounded-md bg-amber-50 px-2 py-0.5 text-xs text-amber-700";case"Low":return"rounded-md bg-gray-100 px-2 py-0.5 text-xs text-gray-600"}}function zs(){const k=b(Ql("backlog",[])),x=b(Ql("sprints",[]));if(x.value.length===0)x.value.push({id:Wl("sprint"),name:"Sprint 1",goal:"",start:"",end:"",started:!1,tickets:[]});else if(x.value.length>1){for(let g=1;g<x.value.length;g++)k.value.push(...x.value[g].tickets);x.value=[x.value[0]]}const N=b(x.value[0].id);U([k,x],()=>{Kl("backlog",k.value),Kl("sprints",x.value)},{deep:!0});const T=b([]),X=bt({}),q=L(()=>k.value.length>0&&T.value.length===k.value.length),d=g=>{var r;const v=x.value.find(a=>a.id===g);return!!v&&v.tickets.length>0&&(((r=X[g])==null?void 0:r.length)||0)===v.tickets.length};function Z(g,v,r){const a=v.target.checked;if(g==="backlog")T.value=a?k.value.map(u=>u.id):[];else if(r){const u=x.value.find(w=>w.id===r);X[r]=a&&u?u.tickets.map(w=>w.id):[]}}function H(g,v,r,a){const u=r.target.checked,w=g==="backlog"?T.value:X[a]||(X[a]=[]);if(u&&!w.includes(v)&&w.push(v),!u){const ae=w.indexOf(v);ae>=0&&w.splice(ae,1)}}function W(){return x.value.find(g=>g.id===N.value)||x.value[0]}function K(){const v=[...k.value,...x.value.flatMap(a=>a.tickets)].map(a=>Number(String(a.key).replace(/[^0-9]/g,""))).filter(a=>!Number.isNaN(a));return`PRJ-${v.length?Math.max(...v)+1:1}`}const{mutate:I}=ls({onSuccess:()=>{st.success("Cards moved to sprint successfully")},onError:g=>{st.error("Failed to move cards: "+(g.message||"Unknown error"))}});function Q(){var a,u;const g=W();if(!g||!T.value.length)return;const v=[],r=[];for(const w of k.value)(T.value.includes(w.id)?r:v).push(w);k.value=v,g.tickets.push(...r),T.value=[],r.length>0&&I({id:g.id,payload:{card_ids:r.map(w=>w.id),priority:((u=(a=r[0])==null?void 0:a.priority)==null?void 0:u.toLowerCase())||"medium",story_points:r.reduce((w,ae)=>w+(ae.storyPoints||0),0)}})}function R(g){const v=x.value.find(w=>w.id===g);if(!v)return;const r=X[g]||[],a=[],u=[];for(const w of v.tickets)(r.includes(w.id)?u:a).push(w);v.tickets=a,k.value.push(...u),X[g]=[]}function re(g,v){if(g==="backlog")k.value=k.value.filter(r=>!T.value.includes(r.id)),T.value=[];else if(v){const r=X[v]||[],a=x.value.find(u=>u.id===v);if(!a)return;a.tickets=a.tickets.filter(u=>!r.includes(u.id)),X[v]=[]}}function ne(g,v){const r={id:Wl("T"),key:K(),createdAt:new Date().toISOString(),...v};if(g==="backlog")k.value.push(r);else{const a=W();a==null||a.tickets.push(r)}}function A(g){const v=W();v&&(v.name=g.name??v.name,v.goal=g.goal??v.goal,v.start=g.start??v.start,v.end=g.end??v.end)}function O(){const g=W();g&&(g.started=!g.started)}function _(g){return g.tickets.reduce((v,r)=>v+(r.storyPoints||0),0)}return{backlog:k,sprints:x,activeSprintId:N,selectedBacklogIds:T,selectedSprintIds:X,allBacklogChecked:q,allSprintChecked:d,toggleAll:Z,toggleOne:H,getActiveSprint:W,createTicket:ne,saveSprintMeta:A,toggleStartSprint:O,sprintPoints:_,moveSelectedToSprint:Q,moveSelectedToBacklog:R,deleteSelected:re,priorityClass:qs}}const Us={class:"h-full min-h-0 mt-2"},js={key:0,class:"empty-state flex flex-col justify-center items-center h-full"},Fs=["disabled"],Rs={key:1,class:"overflow-y-auto h-[calc(100%-50px)] tickets-scroll mt-2"},Hs={class:"flex flex-col flex-1 gap-[4px] min-w-0 me-1"},Ws={key:0,class:"flex items-center justify-center py-10"},Ks=["onDragstart","onClick"],Qs=["checked","onChange"],Zs={class:"flex items-center text-[14px] font-sans font-medium capitalize text-text-secondary flex-1 min-w-0"},Gs={class:"truncate"},Js={class:"flex-shrink-0"},Xs={key:0,class:"flex justify-center text-gray-500 items-center text-[11px] aspect-square w-[24px] h-[24px] bg-bg-body rounded-full border-border-input border-2"},Ys={key:1,class:"w-6 h-6 rounded-full"},ea=["src"],ta={key:2,class:"text-[11px] aspect-square w-[24px] h-[24px] flex justify-center items-center bg-accent/30 text-accent border-accent border rounded-full"},la=xt({__name:"BacklogTable",props:{searchQuery:{type:String,default:""},sprintType:{type:String,default:""},checkedAll:{type:Boolean,default:!1},moduleId:{type:String,default:""}},emits:["ticket-dragged-to-sprint","open-ticket","ticket-moved-to-backlog","open-create-ticket"],setup(k,{emit:x}){const{isDark:N}=Jt(),{canCreateCard:T}=gl(),X=x,q=k,{workspaceId:d}=Zl(),Z=b(q.moduleId??null),{data:H,isPending:W}=ml(d,q.sprintType,Z),K=b([]),I=b(!1),Q=b([]),R=b([]);U(H,r=>{r!=null&&r.cards&&(K.value=r.cards.map(a=>{var B,me,Ce,Y;const u=((B=a.card)==null?void 0:B.variables)??{},w=((me=a.card)==null?void 0:me._id)??a.card_id,ae=String(u["card-status"]??"").trim(),h=String(u.priority??"").trim();return{id:w,key:u["card-code"]||(w==null?void 0:w.slice(-6))||"PRJ-?",summary:u["card-title"]||"(untitled)",type:"Story",status:ae,assignee:((Ce=a.card)==null?void 0:Ce.assigned_to)??"Unassigned",storyPoints:Number(a.story_points??0)||0,priority:ne(h),createdAt:((Y=a.card)==null?void 0:Y.created_at)??new Date().toISOString(),description:u["card-description"]||""}}))},{immediate:!0}),U(K,r=>{const a=new Set(r.map(u=>u.id));R.value=R.value.filter(u=>a.has(u))});const re=L(()=>{if(!q.searchQuery)return K.value;const r=q.searchQuery.toLowerCase();return K.value.filter(a=>{var w;const u=typeof a.assignee=="string"?a.assignee:((w=a.assignee)==null?void 0:w.u_full_name)||"";return a.key.toLowerCase().includes(r)||a.summary.toLowerCase().includes(r)||u.toLowerCase().includes(r)})});function ne(r){const a=String(r??"").toLowerCase();return["highest","blocker","critical"].includes(a)?"Highest":["high","major"].includes(a)?"High":["medium","normal"].includes(a)?"Medium":"Low"}function A(r,a,u){var B;const w=R.value.includes(a.id)?[...R.value]:[a.id],ae=w.map(me=>K.value.find(Ce=>Ce.id===me)).filter(Boolean);Q.value=w;const h=JSON.stringify({id:a.id,ids:w,from:u,tickets:ae});(B=r.dataTransfer)==null||B.setData("text/plain",h),r.dataTransfer&&(r.dataTransfer.effectAllowed="move")}function O(r){var a;I.value=!1,((a=r.dataTransfer)==null?void 0:a.dropEffect)!=="none"&&Q.value.length&&(K.value=K.value.filter(u=>!Q.value.includes(u.id)),R.value=R.value.filter(u=>!Q.value.includes(u))),Q.value=[]}function _(r){var a;r.preventDefault(),I.value=!1;try{const u=(a=r.dataTransfer)==null?void 0:a.getData("text/plain");if(!u)return;const w=JSON.parse(u);if(w.from!=="sprint")return;const h=(w.tickets&&w.tickets.length?w.tickets:w.ticket?[w.ticket]:[]).filter(Boolean).filter(me=>!K.value.some(Ce=>Ce.id===me.id));h.length&&K.value.push(...h);const B=w.ids&&w.ids.length?w.ids:w.id?[w.id]:[];B.length&&X("ticket-moved-to-backlog",B,w.sprintId),console.log(w.sprintId,"sprintId ....")}catch(u){console.error("Drop error:",u)}}function g(r,a){a?R.value.includes(r)||R.value.push(r):R.value=R.value.filter(u=>u!==r)}function v(r,a){const u=a.target.checked;g(r,u)}return U(()=>q.checkedAll,r=>{r?(R.value=K.value.map(a=>a.id),console.log(R.value)):R.value=[]}),(r,a)=>(p(),m("section",Us,[e("div",{class:ee(["rounded-lg flex flex-col h-full",I.value?"ring-2 ring-blue-400":""]),onDragover:a[3]||(a[3]=Be(()=>{},["prevent"])),onDragenter:a[4]||(a[4]=u=>I.value=!0),onDragleave:a[5]||(a[5]=u=>I.value=!1),onDrop:a[6]||(a[6]=u=>_(u))},[!f(W)&&re.value.length===0?(p(),m("div",js,[a[7]||(a[7]=e("img",{src:Vs,class:"mb-4",alt:"backlog-plan"},null,-1)),a[8]||(a[8]=e("h6",{class:"text-sm text-text-primary font-semibold mb-1"}," Get started in the backlog ",-1)),a[9]||(a[9]=e("p",{class:"text-sm text-text-primary/90 mb-4"}," Plan and start a sprint to see issues here. ",-1)),e("button",{disabled:!f(T),onClick:a[0]||(a[0]=u=>r.$emit("open-create-ticket")),class:ee(["relative inline-flex items-center justify-center font-medium py-1.5 px-3 text-sm rounded-md focus:outline-none transition h-[34px] bg-accent text-white hover:bg-accent-hover border-border-input border",f(T)?"cursor-pointer":"cursor-not-allowed"])}," Create Ticket ",10,Fs)])):(p(),m("div",Rs,[e("div",Hs,[f(W)?(p(),m("div",Ws,a[10]||(a[10]=[e("div",{role:"status","aria-label":"Loading",class:"h-10 w-10 rounded-full border-4 border-accent border-t-transparent animate-spin"},null,-1)]))):(p(!0),m(Te,{key:1},Oe(re.value,u=>{var w,ae;return p(),m("div",{key:u.id,draggable:"true",class:ee(["flex items-center gap-3 p-[8px] cursor-pointer transition-colors rounded-[8px]",R.value.includes(u.id)?"border-2 border-[#5a2d7f]":"border border-border-input",f(N)?"bg-bg-body hover:bg-bg-surface":"bg-bg-charcoal hover:bg-bg-body"]),onDragstart:h=>A(h,u,"backlog"),onDragend:a[2]||(a[2]=h=>O(h)),onClick:h=>r.$emit("open-ticket",u)},[e("input",{type:"checkbox",class:"custom-checkbox bg-bg-body border border-border-input flex-shrink-0",checked:R.value.includes(u.id),onClick:a[1]||(a[1]=Be(()=>{},["stop"])),onChange:h=>v(u.id,h)},null,40,Qs),e("div",Zs,[e("span",Gs,V(u.summary),1)]),e("div",Js,[(u==null?void 0:u.assignee)==="Unassigned"?(p(),m("span",Xs," UA ")):(w=u==null?void 0:u.assignee)!=null&&w.u_profile_image?(p(),m("div",Ys,[e("img",{src:u.assignee.u_profile_image,alt:"",class:"rounded-full"},null,8,ea)])):(p(),m("span",ta,V(f(bl)((ae=u==null?void 0:u.assignee)==null?void 0:ae.u_full_name)),1))])],42,Ks)}),128))])]))],34)]))}}),sa=Xt(la,[["__scopeId","data-v-88fd1b54"]]),aa="data:image/svg+xml,%3csvg%20width='60'%20height='60'%20viewBox='0%200%2060%2060'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20opacity='0.4'%3e%3cpath%20d='M9.375%2030C11.6402%2030%2013.4766%2028.1637%2013.4766%2025.8984C13.4766%2023.6332%2011.6402%2021.7969%209.375%2021.7969C7.10977%2021.7969%205.27344%2023.6332%205.27344%2025.8984C5.27344%2028.1637%207.10977%2030%209.375%2030Z'%20fill='%23AE2A19'/%3e%3cpath%20d='M26.25%2024.375C28.5152%2024.375%2030.3516%2022.5387%2030.3516%2020.2734C30.3516%2018.0082%2028.5152%2016.1719%2026.25%2016.1719C23.9848%2016.1719%2022.1484%2018.0082%2022.1484%2020.2734C22.1484%2022.5387%2023.9848%2024.375%2026.25%2024.375Z'%20fill='%23BF63F3'/%3e%3cpath%20d='M15.3931%2035.8594H11.0159V33.0938C9.93587%2033.3387%208.81469%2033.3387%207.73465%2033.0938V35.8594H1.87528C1.55115%2035.8601%201.2345%2035.9568%200.965283%2036.1373C0.696064%2036.3178%200.486343%2036.574%200.362583%2036.8736C0.238824%2037.1731%200.206573%2037.5027%200.269899%2037.8205C0.333226%2038.1384%200.489292%2038.4304%200.718404%2038.6597L7.05872%2045L0.718404%2051.3403C0.489292%2051.5696%200.333226%2051.8616%200.269899%2052.1795C0.206573%2052.4973%200.238824%2052.8269%200.362583%2053.1264C0.486343%2053.426%200.696064%2053.6822%200.965283%2053.8627C1.2345%2054.0432%201.55115%2054.1399%201.87528%2054.1406H15.3931L21.7503%2045L15.3931%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M34.4562%2035.8594H27.8937V27.4688C26.8137%2027.7138%2025.6925%2027.7138%2024.6125%2027.4688V35.8594H19.3896L25.7487%2045L19.3896%2054.1406H34.4562L40.8143%2045L34.4562%2035.8594Z'%20fill='%2382B536'/%3e%3cpath%20d='M43.8281%2019.6875H55.3125C55.7475%2019.6873%2056.1647%2019.5143%2056.4723%2019.2067C56.7799%2018.8991%2056.9529%2018.4819%2056.9531%2018.0469V9.375C56.9529%208.93996%2056.7799%208.5228%2056.4723%208.21518C56.1647%207.90755%2055.7475%207.73462%2055.3125%207.73438H43.8281V7.5C43.8281%207.06488%2043.6553%206.64758%2043.3476%206.3399C43.0399%206.03223%2042.6226%205.85938%2042.1875%205.85938C41.7524%205.85938%2041.3351%206.03223%2041.0274%206.3399C40.7197%206.64758%2040.5469%207.06488%2040.5469%207.5V32.5781H43.8281V19.6875Z'%20fill='%23FCA700'/%3e%3cpath%20d='M59.2843%2043.8403L51.7843%2036.3403C51.6322%2036.1878%2051.4514%2036.0668%2051.2524%2035.9842C51.0534%2035.9017%2050.8401%2035.8593%2050.6246%2035.8594H38.4521L44.8121%2045L38.4531%2054.1406H50.6246C50.8401%2054.1407%2051.0534%2054.0983%2051.2524%2054.0158C51.4514%2053.9332%2051.6322%2053.8122%2051.7843%2053.6597L59.2843%2046.1597C59.4368%2046.0075%2059.5577%2045.8267%2059.6402%2045.6277C59.7228%2045.4287%2059.7652%2045.2154%2059.7652%2045C59.7652%2044.7846%2059.7228%2044.5713%2059.6402%2044.3723C59.5577%2044.1733%2059.4368%2043.9925%2059.2843%2043.8403Z'%20fill='%2382B536'/%3e%3c/g%3e%3c/svg%3e",na={class:"h-full min-h-0 px-2"},ra={key:0,class:"overflow-y-auto h-[calc(100%-50px)] tickets-scroll"},oa={class:"flex flex-col flex-1 gap-[4px] min-w-0 me-1"},ia=["onDragstart","onClick"],da=["checked","onChange"],ua={class:"flex items-center text-[14px] font-sans font-medium capitalize text-text-secondary flex-1 min-w-0"},ca={class:"truncate"},pa={class:"flex-shrink-0"},fa={key:0,class:"flex justify-center text-gray-500 items-center text-[11px] aspect-square w-[24px] h-[24px] bg-bg-body rounded-full border-border-input border-2"},va={key:1,class:"w-6 h-6 rounded-full"},ma=["src"],ga={key:2,class:"text-[11px] aspect-square w-[24px] flex justify-center items-center h-[24px] bg-accent/30 text-accent border-accent border rounded-full"},ba={key:1,class:"empty-state flex flex-col justify-center items-center border-dashed border-3 p-2 border-border h-[calc(100%-50px)] min-h-0"},ya={class:"text-sm text-text-primary font-semibold mb-1 text-center"},xa={class:"text-sm text-text-primary/90 mb-3 max-w-120 text-center"},ha={class:"font-bold"},_a=xt({__name:"SprintCard",props:{sprint:{},sprintId:{},searchQuery:{},checkedSprintAll:{type:Boolean},searchedData:{},label:{}},emits:["edit-sprint","toggle-start","open-ticket","move-selected-to-backlog","delete-selected-sprint","refresh"],setup(k,{emit:x}){const{isDark:N}=Jt(),T=k,X=x,q=b([]),d=b([]);U(()=>T.sprint&&T.sprint.tickets,_=>{q.value=[..._||[]];const g=new Set(q.value.map(v=>v.id));d.value=d.value.filter(v=>g.has(v))},{immediate:!0,deep:!0});const Z=L(()=>{var g,v;if((g=T.searchedData)!=null&&g.length)return q.value.filter(r=>T.searchedData.some(a=>a.card_id===r.id));const _=((v=T.searchQuery)==null?void 0:v.toLowerCase())||"";return _?q.value.filter(r=>{var u;const a=((u=r.assignee)==null?void 0:u.u_full_name)??"";return r.key.toLowerCase().includes(_)||r.summary.toLowerCase().includes(_)||a.toLowerCase().includes(_)}):q.value}),H=b(!1),W=b([]),{mutate:K}=ls({onSuccess:()=>{st.success("Card moved to sprint successfully"),X("refresh")},onError:_=>{st.error("Failed to move card: "+(_.message||"Unknown error"))}});function I(_,g,v,r){var ae;const a=d.value.includes(g.id)?[...d.value]:[g.id],u=a.map(h=>q.value.find(B=>B.id===h)).filter(Boolean);W.value=a;const w=JSON.stringify({id:g.id,ids:a,from:v,sprintId:r,ticket:g,tickets:u});(ae=_.dataTransfer)==null||ae.setData("text/plain",w),_.dataTransfer&&(_.dataTransfer.effectAllowed="move")}function Q(_){var g;H.value=!1,((g=_.dataTransfer)==null?void 0:g.dropEffect)!=="none"&&W.value.length&&(q.value=q.value.filter(v=>!W.value.includes(v.id)),d.value=d.value.filter(v=>!W.value.includes(v))),W.value=[]}function R(){H.value=!0}function re(){H.value=!1}function ne(_){var g;_.preventDefault(),H.value=!1;try{const v=(g=_.dataTransfer)==null?void 0:g.getData("text/plain");if(!v)return;const r=JSON.parse(v);if(r.from!=="backlog")return;const u=(r.tickets&&r.tickets.length?r.tickets:r.ticket?[r.ticket]:[]).filter(Boolean).filter(w=>!q.value.some(ae=>ae.id===w.id));if(!u.length)return;q.value.push(...u),u.forEach(w=>{K({id:T.sprintId,payload:{card_ids:[w.id],priority:(w.priority||"Medium").toLowerCase(),story_points:w.storyPoints||0}})})}catch(v){console.error("Drop error:",v)}}function A(_,g){g?d.value.includes(_)||d.value.push(_):d.value=d.value.filter(v=>v!==_)}function O(_,g){const v=g.target.checked;A(_,v)}return U(()=>T.checkedSprintAll,_=>{_?(d.value=Z.value.map(g=>g.id),console.log(Z.value)):d.value=[]}),(_,g)=>(p(),m("div",na,[e("div",{class:ee([H.value?"ring-2 ring-blue-400 rounded-lg":"","h-full box-border mt-3"]),onDragover:g[2]||(g[2]=Be(()=>{},["prevent"])),onDragenter:R,onDragleave:re,onDrop:ne},[Z.value.length>0&&_.sprint?(p(),m("div",ra,[e("div",oa,[(p(!0),m(Te,null,Oe(Z.value,v=>{var r,a;return p(),m("div",{key:v.id,draggable:"true",class:ee(["flex items-center  gap-3 p-[8px] cursor-pointer transition-colors rounded-[8px]",d.value.includes(v.id)?"border-2 border-[#5a2d7f]":"border border-border-input",f(N)?"bg-bg-body hover:bg-bg-surface":"bg-bg-charcoal hover:bg-bg-body"]),onDragstart:u=>I(u,v,"sprint",_.sprint.id),onDragend:g[1]||(g[1]=u=>Q(u)),onClick:u=>_.$emit("open-ticket",v)},[e("input",{type:"checkbox",class:ee(["custom-checkbox border border-border-input flex-shrink-0",f(N)?"bg-bg-charcoal":"bg-bg-body "]),checked:d.value.includes(v.id),onClick:g[0]||(g[0]=Be(()=>{},["stop"])),onChange:u=>O(v.id,u)},null,42,da),e("div",ua,[e("span",ca,V(v.summary),1)]),e("div",pa,[(v==null?void 0:v.assignee)=="Unassigned"?(p(),m("span",fa,"UA")):(r=v.assignee)!=null&&r.u_profile_image?(p(),m("div",va,[e("img",{src:v.assignee.u_profile_image,alt:""},null,8,ma)])):(p(),m("span",ga,V(f(bl)(((a=v.assignee)==null?void 0:a.u_full_name)??"")),1))])],42,ia)}),128))])])):(p(),m("div",ba,[g[6]||(g[6]=e("img",{src:aa,class:"mb-4",alt:"backlog-plan"},null,-1)),e("h6",ya," Plan your "+V(_.label),1),e("p",xa,[g[3]||(g[3]=se(" Drag work items from the ")),g[4]||(g[4]=e("span",{class:"font-bold"},"Backlog",-1)),se(" section or create new ones to plan the work for this "+V(_.label)+". Select ",1),e("span",ha,"Start "+V(_.label),1),g[5]||(g[5]=se(" when you're ready. "))])]))],34)]))}}),ka=Xt(_a,[["__scopeId","data-v-2a11402d"]]),wa={class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-input pb-4"},Sa={class:"text-xl font-semibold"},Ca={class:"px-6 gap-4 bg-bg-input pt-5 pb-8"},$a={class:"mt-3"},Ta={class:"flex justify-end gap-2 p-6 sticky bottom-0 bg-bg-input border-t border-border"},Da=xt({__name:"SprintModal",props:{modelValue:{type:Boolean,default:!1},lable:{},sprint:{},creatingSprint:{type:Boolean},sprints:{}},emits:["update:modelValue","save","close"],setup(k,{emit:x}){const N=x,T=k,X=L(()=>T.lable?T.lable.charAt(0).toUpperCase()+T.lable.slice(1):""),q=L({get:()=>T.modelValue,set:A=>N("update:modelValue",A)}),d=bt({name:"",sprintType:"",description:""}),Z=bt({name:!1,sprintType:!1,description:!1}),H=L(()=>Z.name&&!String(d.name||"").trim()?"Name is required":""),W=L(()=>!!String(d.name||"").trim()&&!H.value);function K(){q.value=!1,N("close")}function I(){Z.name=!0,W.value&&N("save",{name:String(d.name||"").trim(),value:String(T.lable||"").trim(),description:String(d.description||"").trim()})}function Q(){Z.name=!1,Z.sprintType=!1,Z.description=!1}U(()=>T.sprint,A=>{if(!A){d.name="",d.sprintType=null;return}d.name="",d.description="",d.sprintType=A.sprintType??null,Q()},{immediate:!0});const R=[{title:"Milestone",_id:"milestone",dot:"#2e9bda"},{title:"Sprint",_id:"sprint",dot:"#7d68c8"},{title:"Huddle",_id:"huddle",dot:"#eea832"}],re=L(()=>R.map(A=>({...A})));U(()=>T.lable,A=>{if(!A)return;d.description="",d.sprintType="",Q();const O=re.value.find(_=>_.title===A);d.sprintType=(O==null?void 0:O._id)??"",ne()},{immediate:!0});function ne(){const A=T.sprints||[],O=T.lable,_=O.charAt(0).toUpperCase()+O.slice(1);d.name=`${_} ${A.length+1}`}return U(()=>T.sprints,()=>{(!d.name||d.name.trim()==="")&&ne()},{immediate:!0,deep:!0}),(A,O)=>(p(),ye(yl,{modelValue:q.value,"onUpdate:modelValue":O[3]||(O[3]=_=>q.value=_),modalClass:"!py-0",size:"md"},{default:pe(()=>[e("div",wa,[e("h2",Sa,"Add New "+V(X.value),1)]),e("div",Ca,[j(xl,{class:"rounded-1",modelValue:d.name,"onUpdate:modelValue":O[0]||(O[0]=_=>d.name=_),label:"Name",placeholder:A.lable,error:!!H.value,message:H.value,onBlur:O[1]||(O[1]=_=>Z.name=!0)},null,8,["modelValue","placeholder","error","message"]),e("div",$a,[j(ks,{modelValue:d.description,"onUpdate:modelValue":O[2]||(O[2]=_=>d.description=_),label:"Description",placeholder:`${X.value} description...`,type:"textarea",rows:4},null,8,["modelValue","placeholder"])]),O[4]||(O[4]=e("div",null,null,-1))]),e("div",Ta,[j(We,{variant:"secondary",onClick:K},{default:pe(()=>O[5]||(O[5]=[se("Cancel")])),_:1,__:[5]}),j(We,{variant:"primary",disabled:!W.value,onClick:I},{default:pe(()=>[se(V(A.creatingSprint?"Saving...":"Save"),1)]),_:1},8,["disabled"])])]),_:1},8,["modelValue"]))}}),Va="/assets/filter-JX25xO5j.svg",La={class:"sticky top-0 z-10 flex justify-between items-center py-6 px-6 border-b border-border bg-bg-input"},Ea={class:"text-xl font-semibold"},Ma={class:"px-6 grid grid-cols-2 gap-4 bg-bg-input pt-5"},Aa={class:"flex flex-col col-span-2"},Ia={class:"flex flex-col col-span-2"},Ba={class:"flex gap-1 flex-col col-span-2 sm:col-span-1"},Oa={key:0,class:"text-xs text-red-500"},Na={class:"flex gap-1 flex-col col-span-2 sm:col-span-1"},Pa={key:0,class:"text-xs text-red-500"},qa={class:"flex flex-col col-span-2"},za={class:"flex flex-col col-span-2"},Ua={class:"bg-bg-body wfull px-4 py-3 rounded-lg text-xs text-text-secondary"},ja={class:"flex justify-end gap-2 p-6 sticky bottom-0 bg-bg-input"},Fa=xt({__name:"StartSprintModal",props:{modelValue:{type:Boolean,default:!1},sprint:{},creatingSprint:{type:Boolean},sprintType:{}},emits:["update:modelValue","save","close"],setup(k,{emit:x}){const N=x,T=k,X=[{_id:1,title:"1 Week"},{_id:2,title:"2 Weeks"},{_id:3,title:"3 Weeks"},{_id:4,title:"4 Weeks"},{_id:5,title:"Custom"}],q=L({get:()=>T.modelValue,set:r=>N("update:modelValue",r)}),d=bt({goal:"",start:new Date().toISOString().slice(0,10),end:"",sprint_name:"",duration:null}),Z=L(()=>T.sprintType?T.sprintType.charAt(0).toUpperCase()+T.sprintType.slice(1):""),H=bt({start:!1,end:!1}),W=L(()=>!d.start&&H.start?"Start date is required":""),K=L(()=>{if(!d.end&&H.end)return"End date is required";if(d.start&&d.end){const r=O(d.start),a=O(d.end);if(Number.isFinite(r)&&Number.isFinite(a)&&a<r)return"End date cannot be before start date"}return""}),I=L(()=>!W.value&&!K.value);function Q(r){d.start=r||"",H.start=!0}function R(r){d.end=r||"",H.end=!0}function re(){q.value=!1,d.duration=null,N("close")}function ne(){H.start=!0,H.end=!0,I.value&&(N("save",{title:d.sprint_name||"new sprint",duration:String(v.value)||null,start:d.start||"",end:d.end||"",goal:d.goal??""}),d.duration=null)}function A(){H.start=!1,H.end=!1}function O(r){return r?new Date(`${r}T00:00:00`).getTime():NaN}const _=L(()=>d.duration===5);U(()=>d.duration,r=>{if(!r)return;const a=typeof r=="object"?r._id:r;if(a!==5&&d.start){const u=g(d.start,a*7);d.end=u}}),U(()=>d.start,r=>{r&&(d.duration&&d.duration!==5&&(d.end=g(d.start,d.duration*7)),d.end&&O(d.end)<O(d.start)&&(d.end=d.start))});function g(r,a){const u=new Date(r);return u.setDate(u.getDate()+a),u.toISOString().slice(0,10)}const v=L(()=>!d.start||!d.end?0:d.duration!==5?d.duration*7:(O(d.end)-O(d.start))/864e5);return U(()=>T.sprint,r=>{if(!r){d.start=new Date().toISOString().slice(0,10),d.end="",d.sprint_name="",d.goal="",A();return}d.goal=r.goal??"",d.start=r.start??new Date().toISOString().slice(0,10),d.end=r.end??"",d.sprint_name=r.title??"",A()},{immediate:!0}),(r,a)=>(p(),ye(yl,{modelValue:q.value,"onUpdate:modelValue":a[3]||(a[3]=u=>q.value=u),modalClass:"!py-0",size:"md"},{default:pe(()=>[e("div",La,[e("h2",Ea,"Start "+V(r.sprintType),1),e("span",{onClick:re,class:"text-sm text-text-secondary cursor-pointer"},a[4]||(a[4]=[e("i",{class:"fa-solid fa-xmark text-text-primary text-[19px]"},null,-1)]))]),e("div",Ma,[e("div",Aa,[j(xl,{modelValue:d.sprint_name,"onUpdate:modelValue":a[0]||(a[0]=u=>d.sprint_name=u),label:`${Z.value} Name`,placeholder:`Enter ${r.sprintType} name`,size:"md",class:"rounded-1"},null,8,["modelValue","label","placeholder"])]),e("div",Ia,[j(vl,{modelValue:d.duration,"onUpdate:modelValue":a[1]||(a[1]=u=>d.duration=u),options:X,label:"Duration",placeholder:"Select duration"},null,8,["modelValue"])]),e("div",Ba,[a[6]||(a[6]=e("label",{class:"text-sm font-medium"},"Start date",-1)),e("div",{class:ee(["border relative flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",W.value?"border-red-500":""])},[j(Zt,{placeholder:"Set start date",class:"w-full z-1","model-value":d.start,"emit-as":"ymd","onUpdate:modelValue":Q},null,8,["model-value"]),a[5]||(a[5]=e("i",{class:"fa-regular fa-calendar absolute right-2 top-3 z-0"},null,-1))],2),W.value?(p(),m("p",Oa,V(W.value),1)):P("",!0)]),e("div",Na,[a[7]||(a[7]=e("label",{class:"text-sm font-medium"},"End date",-1)),e("div",{class:ee(["border relative flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",K.value?"border-red-500":""])},[j(Zt,{placeholder:"Set end date",class:"w-full","model-value":d.end,"emit-as":"ymd",disabled:!_.value,"onUpdate:modelValue":R,"min-date":d.start},null,8,["model-value","disabled","min-date"]),e("i",{class:ee(["fa-regular fa-calendar absolute right-2 top-3 z-0",{"text-text-secondary/30 pointer-events-none":!_.value,"text-text-primary":_.value}])},null,2)],2),K.value?(p(),m("p",Pa,V(K.value),1)):P("",!0)]),e("div",qa,[a[8]||(a[8]=e("label",{class:"text-sm font-medium pb-1"},"Goal (optional)",-1)),lt(e("textarea",{"onUpdate:modelValue":a[2]||(a[2]=u=>d.goal=u),class:"w-full text-sm rounded-md border border-border px-3 py-2 bg-bg-input",rows:"2",placeholder:"Ship onboarding flow"},null,512),[[hl,d.goal]])]),e("div",za,[e("p",Ua," Duration: "+V(d.start?v.value+" days":""),1)])]),e("div",ja,[j(We,{variant:"secondary",onClick:re},{default:pe(()=>a[9]||(a[9]=[se("Cancel")])),_:1,__:[9]}),j(We,{variant:"primary",disabled:!I.value,onClick:ne},{default:pe(()=>[se(V(r.creatingSprint?"Starting...":"Start"),1)]),_:1},8,["disabled"])])]),_:1},8,["modelValue"]))}}),Ra={class:"sticky top-0 z-10 flex flex-col items-start pt-6 px-6 border-b border-border bg-bg-body pb-4 mb-4"},Ha={class:"w-full flex items-start justify-between"},Wa={class:"text-sm text-text-secondary mt-1"},Ka={class:"flex items-center gap-2 mt-4 w-full"},Qa={class:"flex items-center gap-2 flex-1"},Za={class:"px-6 min-h-[400px]"},Ga={key:0},Ja={key:0,class:"flex items-center justify-center py-12"},Xa={key:1,class:"text-center py-12 text-text-secondary"},Ya={key:2,class:"grid grid-cols-2 gap-3"},en=["onClick"],tn={class:"flex items-center gap-3"},ln={class:"w-10 h-10 rounded-lg bg-bg-input flex items-center justify-center group-hover:bg-primary/10 transition-colors"},sn={class:"font-medium"},an={key:1},nn={key:0,class:"flex items-center justify-center py-12"},rn={key:1,class:"text-center py-12 text-text-secondary"},on={key:2,class:"grid grid-cols-2 gap-3"},dn=["onClick"],un={class:"flex items-center gap-3"},cn={class:"w-10 h-10 rounded-lg bg-bg-input flex items-center justify-center group-hover:bg-primary/10 transition-colors"},pn={class:"font-medium"},fn={key:2},vn={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},mn={key:0,class:"flex flex-col"},gn={class:"flex gap-1 flex-col"},bn={key:0,class:"text-xs text-red-500"},yn={class:"flex gap-1 flex-col"},xn={key:0,class:"text-xs text-red-500"},hn={class:"flex flex-col gap-1"},_n={class:"mt-2"},kn={class:"mt-4"},wn={class:"flex justify-between gap-2 p-6 mt-8 sticky bottom-0 bg-bg-body border-t border-border"},Sn={key:1},Cn={class:"flex gap-2"},$n=xt({__name:"CreateBacklogTicketWithModuleSelection",props:{modelValue:{type:Boolean,default:!1},listId:{},selectedVariable:{}},emits:["update:modelValue","created"],setup(k,{emit:x}){const N=x,T=k,X=_l(),{workspaceId:q}=Gl(),d=b(1),Z=b(null),H=b(null),W=b(""),{data:K,isLoading:I}=Jl(q.value),Q=L(()=>{var S;return((S=K.value)==null?void 0:S.modules)||[]}),{data:R,isFetching:re,refetch:ne}=Xl({workspace_module_id:W,workspace_id:q},{enabled:L(()=>!!W)});U(()=>Z.value,()=>{ne()});const A=L(()=>R.value||[]),{data:O}=Yl(q.value);U(Z,S=>{W.value=S??""});const{data:_}=es(q,W,b("")),{mutate:g,isPending:v}=ts({onSuccess:()=>{Ke(),X.invalidateQueries({queryKey:["backlog-list"]}),r.value=!1}}),r=L({get:()=>T.modelValue,set:S=>N("update:modelValue",S)}),a=L(()=>{switch(d.value){case 1:return"Select a module to create the ticket in";case 2:return"Select a sheet within the module";case 3:return"Provide the ticket details below and click Add Ticket";default:return""}}),u=L(()=>((_==null?void 0:_.value)??[]).filter(S=>{var D;return((D=S==null?void 0:S.type)==null?void 0:D.title)==="Select"&&(S==null?void 0:S.slug)!=="process"})),w=L(()=>((O==null?void 0:O.value)??[]).map(S=>{var D;return{_id:S._id,title:((D=S==null?void 0:S.variables)==null?void 0:D["lane-title"])??String(S._id)}})),ae=S=>S.slug,h=bt({title:"",description:"",startDate:null,endDate:null,lane_id:null,assignee:null,variables:{}});U(u,S=>{for(const D of S){const y=ae(D);y in h.variables||(h.variables[y]=null)}},{immediate:!0});const B=bt({title:!1,description:!1,startDate:!1,endDate:!1,lane:!1}),me=L(()=>!!h.title.trim()&&!!h.lane_id&&!!h.startDate&&!!h.endDate&&!ie.value&&!Ve.value&&!Qe.value&&!nt.value);function Ce(S){h.startDate=S,B.startDate=!0}function Y(S){h.endDate=S,B.endDate=!0}function ue(S){h.lane_id=S,B.lane=!0}function Ne(S){h.assignee=S}function De(S){Z.value=S._id,d.value=2}function ht(S){H.value=S._id,d.value=3}function Pe(){d.value>1&&d.value--}function at(){r.value=!1,Ke()}function Ke(){d.value=1,Z.value=null,H.value=null,h.title="",h.description="",h.startDate=null,h.endDate=null,h.lane_id=null,h.assignee=null,h.variables={},B.title=!1,B.description=!1,B.startDate=!1,B.endDate=!1,B.lane=!1}const qe=L(()=>{var S;return(S=_==null?void 0:_.value)==null?void 0:S.find(D=>(D==null?void 0:D._id)==T.selectedVariable)}),ie=L(()=>B.title&&!h.title.trim()?"Title is required":""),Ve=L(()=>B.startDate?h.startDate?"":"Start date is required":""),Qe=L(()=>B.endDate?h.endDate?h.startDate&&h.endDate&&h.endDate<h.startDate?"End date cannot be before start date":"":"End date is required":""),nt=L(()=>B.lane?h.lane_id?"":"Lane is required":""),Le=new Date().toISOString().split("T")[0];function rt(){var D,y;if(B.title=!0,B.lane=!0,B.description=!0,B.startDate=!0,B.endDate=!0,!me.value||v.value)return;const S={sheet_list_id:T.listId,workspace_id:q.value,sheet_id:H.value,workspace_lane_id:h.lane_id,variables:{...h.variables,[`${(D=qe.value)==null?void 0:D.slug}`]:T.listId,"card-title":h.title.trim(),"card-description":h.description.trim(),"start-date":h.startDate,"end-date":h.endDate},seat_id:((y=h.assignee)==null?void 0:y._id)??null,createdAt:new Date().toISOString()};g(S)}return U(()=>h.title,S=>{S!=null&&S.trim()&&B.title&&(B.title=!1)}),U(()=>h.lane_id,S=>{S&&B.lane&&(B.lane=!1)}),U(()=>h.startDate,S=>{S&&B.startDate&&(B.startDate=!1)}),U(()=>h.endDate,S=>{S&&B.endDate&&(B.endDate=!1)}),U(()=>h.description,S=>{S!=null&&S.trim()&&B.description&&(B.description=!1)}),(S,D)=>(p(),ye(yl,{modelValue:r.value,"onUpdate:modelValue":D[5]||(D[5]=y=>r.value=y),modalClass:"!py-0",size:"lg"},{default:pe(()=>[e("div",Ra,[e("div",Ha,[e("div",null,[D[6]||(D[6]=e("h2",{class:"text-xl font-semibold"},"Create Backlog Ticket",-1)),e("p",Wa,V(a.value),1)]),e("button",{class:"ml-4 p-2 rounded-md hover:bg-border transition-colors cursor-pointer",onClick:at,"aria-label":"Close"},D[7]||(D[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 8.586l4.95-4.95a1 1 0 111.414 1.414L11.414 10l4.95 4.95a1 1 0 01-1.414 1.414L10 11.414l-4.95 4.95a1 1 0 01-1.414-1.414L8.586 10 3.636 5.05a1 1 0 011.414-1.414L10 8.586z","clip-rule":"evenodd"})],-1)]))]),e("div",Ka,[(p(),m(Te,null,Oe(3,y=>e("div",{key:y,class:"flex items-center flex-1"},[e("div",Qa,[e("div",{class:ee(["h-1 flex-1 rounded-full transition-colors",d.value>=y?"bg-primary":"bg-border"])},null,2)])])),64))])]),e("div",Za,[d.value===1?(p(),m("div",Ga,[D[9]||(D[9]=e("h3",{class:"text-lg font-medium mb-4"},"Select Module",-1)),f(I)?(p(),m("div",Ja,D[8]||(D[8]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):!Q.value||Q.value.length===0?(p(),m("div",Xa," No modules available ")):(p(),m("div",Ya,[(p(!0),m(Te,null,Oe(Q.value,y=>{var de,je,fe,_t,xe;return p(),m("button",{key:y._id,onClick:ot=>De(y),class:ee(["p-4 border rounded-lg hover:border-primary transition-all text-left group",Z.value===y._id?"border-primary bg-primary/5":"border-border"])},[e("div",tn,[e("div",ln,[e("i",{class:ee([`${(je=(de=y==null?void 0:y.variables)==null?void 0:de["module-icon"])==null?void 0:je.prefix} ${(_t=(fe=y==null?void 0:y.variables)==null?void 0:fe["module-icon"])==null?void 0:_t.iconName}`,"text-lg"])},null,2)]),e("div",null,[e("p",sn,V(((xe=y.variables)==null?void 0:xe["module-title"])||"Untitled"),1)])])],10,en)}),128))]))])):d.value===2?(p(),m("div",an,[D[11]||(D[11]=e("h3",{class:"text-lg font-medium mb-4"},"Select Sheet",-1)),f(re)?(p(),m("div",nn,D[10]||(D[10]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)]))):!A.value||A.value.length===0?(p(),m("div",rn," No sheets available for this module ")):(p(),m("div",on,[(p(!0),m(Te,null,Oe(A.value,y=>{var de,je;return p(),m("button",{key:y._id,onClick:fe=>ht(y),class:ee(["p-4 border rounded-lg hover:border-primary transition-all text-left group",H.value===y._id?"border-primary bg-primary/5":"border-border"])},[e("div",un,[e("div",cn,[e("i",{class:ee(`fa ${(de=y==null?void 0:y.variables["sheet-icon"])==null?void 0:de.prefix} ${(je=y==null?void 0:y.variables["sheet-icon"])==null?void 0:je.iconName} text-lg`)},null,2)]),e("div",null,[e("p",pn,V((y==null?void 0:y.variables["sheet-title"])||"Untitled Sheet"),1)])])],10,dn)}),128))]))])):d.value===3?(p(),m("div",fn,[D[15]||(D[15]=e("h3",{class:"text-lg font-medium mb-4"},"Ticket Details",-1)),e("div",vn,[j(xl,{modelValue:h.title,"onUpdate:modelValue":D[0]||(D[0]=y=>h.title=y),label:"Ticket Title",placeholder:"e.g., Implement real-time notifications",error:!!ie.value,message:ie.value,onBlur:D[1]||(D[1]=y=>B.title=!0)},null,8,["modelValue","error","message"]),w.value.length>0?(p(),m("div",mn,[j(vl,{size:"md",label:"Lane",options:w.value,placeholder:"Select lane",allowCustom:!1,"model-value":h.lane_id,"onUpdate:modelValue":ue,error:!!nt.value,message:nt.value},null,8,["options","model-value","error","message"])])):P("",!0),(p(!0),m(Te,null,Oe(u.value,y=>lt((p(),ye(vl,{size:"md",key:ae(y),modelValue:h.variables[y.slug],"onUpdate:modelValue":de=>h.variables[y.slug]=de,options:y.data.filter(de=>de!=="process").map(de=>({_id:de,title:de})),label:y.title,placeholder:"Select value",allowCustom:!0},null,8,["modelValue","onUpdate:modelValue","options","label"])),[[Gt,(y==null?void 0:y._id)!=S.selectedVariable]])),128)),e("div",gn,[D[12]||(D[12]=e("label",{class:"text-sm"},"Start date",-1)),e("div",{class:ee(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",Ve.value?"border-red-500":""])},[j(Zt,{placeholder:"Set start date",class:"w-full","model-value":h.startDate,"emit-as":"ymd","onUpdate:modelValue":Ce,"min-date":f(Le)},null,8,["model-value","min-date"])],2),Ve.value?(p(),m("p",bn,V(Ve.value),1)):P("",!0)]),e("div",yn,[D[13]||(D[13]=e("label",{class:"text-sm"},"End date",-1)),e("div",{class:ee(["border flex items-center border-border h-10 px-2 bg-bg-input rounded-lg",Qe.value?"border-red-500":""])},[j(Zt,{placeholder:"Set end date",class:"w-full","model-value":h.endDate,"emit-as":"ymd","onUpdate:modelValue":Y,"min-date":h.startDate||f(Le)},null,8,["model-value","min-date"])],2),Qe.value?(p(),m("p",xn,V(Qe.value),1)):P("",!0)]),e("div",hn,[D[14]||(D[14]=e("label",{class:"text-sm"},"Assignee",-1)),e("div",_n,[j(as,{name:!0,workspaceId:f(q),onAssign:Ne,onUnassign:D[2]||(D[2]=y=>Ne(null)),assigneeId:h.assignee,seat:null,disabled:!1,skipPermissionCheck:!0,class:"w-full"},null,8,["workspaceId","assigneeId"])])])]),e("div",kn,[j(ns,{label:"Description",placeholder:"What needs to be done, acceptance criteria, links…",modelValue:h.description,"onUpdate:modelValue":D[3]||(D[3]=y=>h.description=y),onBlur:D[4]||(D[4]=y=>B.description=!0)},null,8,["modelValue"])])])):P("",!0)]),e("div",wn,[d.value>1?(p(),ye(We,{key:0,variant:"secondary",onClick:Pe},{default:pe(()=>D[16]||(D[16]=[se("Back")])),_:1,__:[16]})):(p(),m("div",Sn)),e("div",Cn,[j(We,{variant:"secondary",onClick:at},{default:pe(()=>D[17]||(D[17]=[se("Cancel")])),_:1,__:[17]}),d.value===3?(p(),ye(We,{key:0,variant:"primary",disabled:!me.value||f(v),onClick:rt},{default:pe(()=>[se(V(f(v)?"Adding…":"Add Ticket"),1)]),_:1},8,["disabled"])):P("",!0)])])]),_:1},8,["modelValue"]))}}),Tn={class:"flex flex-col h-full"},Dn={class:"sticky top-0 z-20 bg-bg-card overflow-x-auto shrink-0"},Vn={class:"header lg:px-4 px-2 py-2 flex justify-between items-center gap-1 overflow-auto border-b border-border"},Ln={class:"flex lg:gap-4 gap-2 py-1"},En={class:"hidden sm:flex"},Mn={class:"flex sm:hidden"},An={class:"lg:px-4 px-2 py-1 h-8 mt-1 rounded-2xl bg-gradient-to-tr from-accent to-accent-hover text-white font-medium cursor-pointer"},In={class:"flex gap-3 items-center"},Bn={class:"flex items-center gap-3 bg-bg-surface/50 h-[32px] px-2 rounded-md"},On={class:"flex flex-1 overflow-hidden"},Nn={class:"flex-1 overflow-auto"},Pn={class:"overflow-x-auto"},qn={key:0,class:"flex-auto bg-gradient-to-b from-bg-card/95 to-bg-card/90 backdrop-blur shadow-[0_10px_40px_-10px_rgba(0,0,0,.5)] flex-grow h-full bg-bg-card border border-border overflow-x-auto flex scrollbar-visible"},zn={class:"flex overflow-x-auto gap-3 p-4 scrollbar-visible"},Un={key:0,class:"mx-auto text-text-secondary/80 m-2 w-[90%] h-full justify-center flex items-center border border-dashed border-border"},jn={class:"relative w-full h-full flex overflow-hidden"},Fn={key:0,class:"format-sidebar h-full py-4 px-4 w-[320px] border-l bg-bg-card overflow-x-hidden overflow-y-auto flex flex-col"},Rn={class:"flex items-center justify-between pb-3 mb-4 border-b"},Hn={class:"format-content space-y-6"},Wn={class:"format-group mb-3"},Kn={class:"flex items-center gap-2"},Qn=["value"],Zn={class:"format-group mb-3"},Gn={class:"flex items-center gap-2"},Jn=["value"],Xn={class:"grid grid-cols-1 gap-3"},Yn=["value"],er={class:"mt-6 pt-4"},tr=["disabled"],lr={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},sr={key:0,class:"fixed inset-0 bg-black/30 flex items-center justify-center"},ar={class:"bg-white p-6 rounded-xl w-80"},nr={class:"flex justify-end gap-2 mt-4"},rr=["disabled"],or={class:"flex items-center mt-3 gap-3"},ir=xt({__name:"ActiveSprint",props:{sptint_id:{},searchQuery:{},activeSprint:{}},setup(k){const x=k,N=Ae(()=>Ie(()=>import("./CreateTaskModal-B-GC_yP-.js"),__vite__mapDeps([0,1,2,3]))),T=Ae(()=>Ie(()=>import("./ConfirmDeleteModal-D0lFRzHD.js"),__vite__mapDeps([4,5,2,3]))),X=Ae(()=>Ie(()=>import("./SidePanel-BNwQ9NsL.js"),__vite__mapDeps([6,2,3,7,8]))),q=Ae(()=>Ie(()=>import("./KanbanBoard-BC-Rq9kg.js"),__vite__mapDeps([9,10,11,2,3,12,13,14]))),d=Ae(()=>Ie(()=>import("./index-DIW8MM4b.js").then(l=>l.ds),__vite__mapDeps([2,3]))),Z=Ae(()=>Ie(()=>import("./TableSearchCell-US7VN8Sq.js"),__vite__mapDeps([15,2,3]))),H=Ae(()=>Ie(()=>import("./TableAssigneeCell-GoNGAzBJ.js"),__vite__mapDeps([16,2,3]))),W=Ae(()=>Ie(()=>import("./CalendarView-Bmcwmdb9.js"),__vite__mapDeps([17,2,3,18]))),K=Ae(()=>Ie(()=>import("./GanttChartView-Bx7xfvY3.js"),__vite__mapDeps([19,2,3]))),I=Ae(()=>Ie(()=>import("./TimelineView-CXjgmx1d.js"),__vite__mapDeps([20,2,3,21]))),Q=Ae(()=>Ie(()=>import("./index-DIW8MM4b.js").then(l=>l.dq),__vite__mapDeps([2,3]))),R=Ae(()=>Ie(()=>import("./BaseTextField-DF6nu0V2.js"),__vite__mapDeps([22,2,3]))),re=b(!1),ne=b(""),A=b(null),O=b(null),_=b(null),g=b(""),{isDark:v}=Jt(),r=b(null),a=b(!1);function u(l){ne.value="",re.value=!0,A.value=l}function w(){A.value&&A.value(ne.value),re.value=!1}function ae(){re.value=!1}const{mutate:h}=ts({onSuccess:()=>{Le.invalidateQueries({queryKey:["sheet-list"]})}});function B(){const l=wt.value.trim();l&&D(l)}function me(){kt.value=!kt.value}const Ce=gs(),Y=b("kanban"),{workspaceId:ue,moduleId:Ne}=Gl(),De=b(""),ht=b(!1),Pe=b(!1),{canCreateVariable:at,canCreateCard:Ke,canEditCard:qe,canAssignCard:ie}=gl(),{data:Ve}=Jl(ue.value),Qe=b(Ve.value.modules||[]),nt=L(()=>(Qe.value||[]).map(l=>{var t,n;return{_id:l._id,title:((t=l.variables)==null?void 0:t["module-title"])??"Untitled module",description:((n=l.variables)==null?void 0:n["module-description"])??"",icon:l.icon??null,status:l.status??null}})),Le=_l(),{mutate:rt,isPending:S}=rs({onSuccess:()=>{Le.invalidateQueries({queryKey:["sheet-list"]}),wt.value="",Je.value=!1,kt.value=!1,Je.value=!1}}),D=l=>{rt({workspace_id:ue.value,module_id:Ne.value,variable_id:xe.value,value:l})};U(nt,l=>{if(l.length&&!De.value){const t=l.find(n=>n.title==="Tasks")||l[0];De.value=t._id}},{immediate:!0});const{data:y,refetch:de}=Xl({workspace_id:ue.value,workspace_module_id:Ne.value});U(De,l=>{l&&de()});const je=L(()=>{var l;return y.value?(l=y.value[0])==null?void 0:l._id:""}),fe=b(je),_t=L(()=>{var l;return Ct.value?(l=Ct.value[0])==null?void 0:l._id:""}),xe=b(_t),ot=os(),te=L(()=>x.sptint_id),{data:F,isPending:Ze,refetch:it}=Ms(te),dt=b(!1),ut=b(),ze=l=>{ut.value=l},ct=is(),Yt=ds();function el(l){l.type=="column"?ct.mutate({payload:{workspace_id:ue.value,workspace_module_id:Ne.value,variable_id:xe.value,moved_value:l.meta.id,new_index:l.meta.newIndex}}):Yt.mutate({payload:{workspace_id:ue.value,card_id:l.meta.moved._id,group_value:l.meta.fromColumnId,group_variable_id:xe.value,new_index:l.meta.newIndex,sheet_id:fe.value}})}const Fe=l=>{},{mutate:It}=us({onSuccess:()=>{de(),Nt.value=!1}}),Ge=L(()=>!y.value||!y.value.length?[]:y.value.map(l=>{var t,n;return{_id:l._id,title:((t=l.variables)==null?void 0:t["sheet-title"])||"Untitled Sheet",description:((n=l.variables)==null?void 0:n["sheet-description"])||"",icon:l.icon||null,status:l.generation_status||null}}));U(Ge,l=>{l.length>0&&!fe.value&&(fe.value=l[0]._id)},{immediate:!0}),U(Ge,l=>{l.length>0?g.value=l[0].title:g.value="Backlog"},{immediate:!0}),U(y,l=>{var t;(l==null?void 0:l.length)>0&&(fe.value=(t=l[0])==null?void 0:t._id)});const kt=b(!1),wt=b(""),tl=l=>{rt({workspace_id:Ce.params.id,module_id:Ce.params.module_id,new_value:l.title,value:l.oldTitle,variable_id:xe.value})},Je=b(!1),ve=b(),Bt=()=>{rt({value:ve.value.title,workspace_id:ue.value,module_id:Ne.value,newValue:ve.value.title,variable_id:xe.value,is_trash:!0})},ll=l=>{Je.value=!0,ve.value=l},sl=l=>{dt.value=!0,ve.value=l},St=L(()=>x.searchQuery),Ot=b("");U(St,Ds.debounce(l=>{Ot.value=l},200));const al=L(()=>{var t;const l=(t=F.value)==null?void 0:t.flatMap(n=>n.cards.map(o=>({...o,columnId:n.title})));return new Rl(l,{keys:["card-title","card-description"],threshold:.3})}),pt=L(()=>{var l,t;if(Y.value==="kanban"){if(!St.value)return F.value;const n=al.value.search(St.value).map(o=>o.item);return F.value.map(o=>({...o,cards:n.filter(c=>c.columnId===o.title)}))}else{const n=(l=St.value)==null?void 0:l.trim();if(!n){let c=[];return(t=F.value??[])==null||t.forEach(z=>{c=[...c,...z==null?void 0:z.cards]}),c}return new Rl($t.value,{keys:["card-title","card-description"],threshold:.3}).search(n).map(c=>c.item)}}),$t=L(()=>{let l=[];return(F.value??[]).forEach(t=>{l=[...l,...t==null?void 0:t.cards]}),l}),Nt=b(!1),{data:Ct,isPending:Xe}=es(ue,De,fe),{mutate:nl}=cs(),Tt=(l,t)=>{nl({payload:{sheet_id:fe.value,workspace_id:ue.value,variable_slug:l,is_visible:t}})},{data:Dt}=Yl(ue),Pt=L(()=>((Dt==null?void 0:Dt.value)??[]).map(l=>{var t;return{_id:l._id,title:((t=l==null?void 0:l.variables)==null?void 0:t["lane-title"])??String(l._id)}})),qt=l=>l.map(t=>({_id:t.value??t,title:t.value??t})),ft=ps({onSuccess:()=>{Le.invalidateQueries({queryKey:["get-sheets"]}),Le.invalidateQueries({queryKey:["sheet-list"]}),Le.invalidateQueries({queryKey:["roles"]})}}),Ye=(l,t)=>{if(!F.value)return;const n=F.value.findIndex(o=>o.cards.some(c=>c._id===l));if(n!==-1){const o=F.value[n].cards.findIndex(c=>c._id===l);if(o!==-1){const c={...F.value[n].cards[o]};t(c),F.value[n].cards[o]=c,zl(F)}}};function zt(l,t){Ye(l,n=>{const o=Pt.value.find(c=>c._id===t);o&&(n.lane=o)}),zl(F),ft.mutate({card_id:l,workspace_lane_id:t})}const rl=(l,t)=>{Ye(l,n=>{n.seat=t}),ft.mutate({card_id:l,seat_id:t==null?void 0:t._id})},Ut=L(()=>{var l;return[{key:"card-title",label:"Title",render:({row:t,value:n})=>we("div",{class:"flex items-center gap-1 w-full"},[we("a",{onClick:()=>ut.value=t,class:"text-[12px] underline text-blue-500 shrink-0 overflow-ellipsis cursor-pointer"},t["card-code"]),we("div",{class:"flex-1 min-w-0"},[we("input",{onFocusout:o=>{var c;jt(t==null?void 0:t._id,"card-title",(c=o==null?void 0:o.target)==null?void 0:c.value)},class:"text-[12px] w-full overflow-ellipsis capitalize p-1 w-full p-1 focus:border border-accent/60 rounded-sm focus:outline-none focus:ring-1 focus:ring-accent bg-transparent focus:bg-bg-body text-[12px] h-8",defaultValue:n,disabled:!qe.value})])])},{key:"end-date",label:"Due Date",render:({row:t,value:n})=>{const o=b(n);return we(d,{class:" capitalize flex items-center gap-2 text-[12px]",placeholder:"Set start date",tableInputClass:!0,modelValue:o.value,disabled:!qe.value,"onUpdate:modelValue":c=>il(t==null?void 0:t._id,c),emptyText:"Date"})}},{key:"lane",label:"Lane",render:({row:t})=>{var n;return we(Z,{options:Pt.value??[],placeholder:"Select lane",modelValue:((n=t.lane)==null?void 0:n._id)||null,disabled:!qe.value,"onUpdate:modelValue":o=>zt(t==null?void 0:t._id,o),displayField:"title",emptyText:"Lane"})}},{key:"created_by",label:"Owner",render:({value:t})=>we("div",{class:"capitalize flex items-center gap-2  px-3"},[we("div",{class:" rounded-full  "},[t!=null&&t.u_profile_image?we("img",{class:"w-6 h-6 rounded-full",src:t==null?void 0:t.u_profile_image}):we("div",{class:"w-5 h-5 rounded-full flex justify-center items-center text-[11px] ",style:`background:${t!=null&&t.u_full_name?fs({name:t.u_full_name,email:t.u_email}):""}`},bl(t==null?void 0:t.u_full_name))]),we("span",{class:"text-[12px]"},t?t==null?void 0:t.u_full_name:"")])},{key:"seat",label:"Assignee",render:({row:t,value:n})=>we(H,{class:"capitalize flex items-center gap-2 ",onAssign:o=>rl(t==null?void 0:t._id,o),assigneeId:n,seat:n,name:!0,disabled:!ie.value,emptyText:"Assignee"})},...((l=Ct.value)==null?void 0:l.filter(t=>{var n;return((n=t==null?void 0:t.type)==null?void 0:n.title)==="Select"}).map(t=>({key:t==null?void 0:t.slug,label:t==null?void 0:t.slug,render:({row:n,value:o})=>{var z;let c=o;if(Array.isArray(n==null?void 0:n.variables)){const J=n.variables.find(E=>E.slug===t.slug);J&&(c=J.value)}else c=((z=n==null?void 0:n.variables)==null?void 0:z[t.slug])??(n==null?void 0:n[t.slug])??o;return we("div",{class:"capitalize flex items-center gap-2"},[we(Z,{options:qt(t.data??[]),modelValue:c,disabled:!qe.value,emptyText:t.slug,"onUpdate:modelValue":J=>{jt(n==null?void 0:n._id,t.slug,J)},columnName:t.slug})])},visible:t==null?void 0:t.is_visible})))??[]]});function jt(l,t,n){Ye(l,o=>{if(t==="card-title"&&(o[t]=n),Array.isArray(o.variables)){const c=o.variables.find(z=>z.slug===t);c?c.value=n:o.variables.push({slug:t,value:n,type:"Select"})}else o.variables&&typeof o.variables=="object"?o.variables[t]=n:o[t]=n}),ft.mutate({card_id:l,variables:{[t]:n.trim()}})}function ol(l){if(l["card-title"]){const t={sheet_list_id:"To Do",workspace_id:ue.value,sheet_id:fe.value,variables:{"card-title":l["card-title"].trim()},createdAt:new Date().toISOString()};h(t)}}const il=(l,t)=>{const n=F.value.findIndex(o=>o.cards.some(c=>c._id===l));if(n!==-1){const o=F.value[n].cards.findIndex(c=>c._id===l);o!==-1&&(F.value[n].cards[o]["end-date"]=t)}ft.mutate({card_id:l,variables:{"start-date":t}})},Ue=b(null),Vt=b(!1),et=b(!1);U(Vt,l=>{l&&(et.value=!1)}),U(et,l=>{l&&(Vt.value=!1)});const $e=L(()=>{var l,t;return(t=(l=Ue.value)==null?void 0:l.nodeObj)!=null&&t.style?Ue.value.nodeObj.style:s(_e)});function he(l,t,n){return l!==void 0?l:t!==void 0?t:n}function Lt(l,t){var J;if(!((J=Ue.value)!=null&&J.nodeObj))return;const n=Ue.value.nodeObj;n.style||(n.style={});const o=t.target,c=o.type==="number"?Number(o.value):o.value;switch(l){case"bg_color":n.style.background=c;break;case"color":n.style.color=c;break;case"font_size":n.style.fontSize=`${c}px`;break;case"font_weight":n.style.fontWeight=c;break;case"font_style":n.style.fontStyle=c;break;case"font_family":n.style.fontFamily=c;break;case"border_color":n.style.borderColor=c;break;case"border_width":n.style.borderWidth=`${c}px`;break;case"border_radius":n.style.borderRadius=`${c}px`;break;case"padding":n.style.padding=`${c}px`;break}const z=document.getElementById(n.id);z&&i(n,z)}const _e={bg_color:"#ffffff",color:"#000000",font_size:14,font_weight:"normal",font_style:"normal",font_family:"Inter",border_color:"#cccccc",border_width:0,border_radius:0,padding:0},Re=b(!1);async function He(){var t;const l=(t=Ue.value)==null?void 0:t.nodeObj;if(!(!l||Re.value)){Re.value=!0;try{const n=bs(l);n._originalStyle||(n._originalStyle={});const o=n.style||{},c=n._originalStyle,z={bg_color:he(o.background,c.bg_color,_e.bg_color),color:he(o.color,c.color,_e.color),font_size:he(o.fontSize?parseInt(o.fontSize):void 0,c.font_size,_e.font_size),font_weight:he(o.fontWeight,c.font_weight,_e.font_weight),font_style:he(o.fontStyle,c.font_style,_e.font_style),font_family:he(o.fontFamily,c.font_family,_e.font_family),border_color:he(o.borderColor,c.border_color,_e.border_color),border_width:he(o.borderWidth?parseInt(o.borderWidth):void 0,c.border_width,_e.border_width),border_radius:he(o.borderRadius?parseInt(o.borderRadius):void 0,c.border_radius,_e.border_radius),padding:he(o.padding?parseInt(o.padding):void 0,c.padding,_e.padding),hyperLink:ne.value||n.hyperLink||""};n._originalStyle={...z};const J=n.unique_name==="sheet"?{sheet_id:n.id,workspace_id:ue.value,workspace_module_id:Ne.value,style:z}:{card_id:n.id,seat_id:n.seat_id,style:z};n.unique_name==="sheet"?await It(J):await ft.mutateAsync(J)}finally{Re.value=!1}}}const dl=b([]);function Ft(l){const t={id:"root",topic:localStorage.getItem("currentName")??"",isRoot:!0,children:[],style:{},_originalStyle:{},unique_name:"root"};if(!Array.isArray(l))return t;const n={};return l.forEach(o=>{var E;const c=g.value,z=((E=o.style)==null?void 0:E.hyperLink)||"";n[c]||(n[c]={id:o._id,topic:c,variables:o==null?void 0:o.variables,children:[],style:o==null?void 0:o.style,_originalStyle:(o==null?void 0:o.style)||{},unique_name:"sheet",hyperLink:z||""},t.children.push(n[c]));const J={id:o==null?void 0:o._id,topic:o.title,children:[],style:s(o==null?void 0:o.style),_originalStyle:o.style||{},unique_name:"List",hyperLink:z||""};(o.cards||[]).forEach((M,$)=>{var le;const oe=((le=M.style)==null?void 0:le.hyperLink)||"",ce={id:M._id||`card-${$}`,seat_id:M.seat_id,topic:M["card-title"],style:s(M.style),_originalStyle:M.style||{},children:[],unique_name:"card",hyperLink:oe||""};J.children.push(ce),dl.value=ce}),n[c].children.push(J)}),t}const{mutateAsync:ul}=vs({onSuccess:()=>{Le.invalidateQueries({queryKey:["sheets"]}),Le.invalidateQueries({queryKey:["sheet-list"]}),close()}}),Rt=l=>{var t,n;(n=(t=F.value)==null?void 0:t.sheets)==null||n.forEach(o=>{var c;(c=o.sheet_lists)==null||c.forEach(z=>{z.cards=z.cards.filter(J=>J._id!==l)})})},vt=b(!1),Et=b(null),cl=async()=>{if(r.value)try{a.value=!0,await Se({url:`workspace/card/${r.value}`,method:"DELETE"}),Rt(r.value),vt.value=!1,Et.value=null,st.success("Ticket deleted successfully"),await de(),await it()}catch(l){st.error(ys(l))}finally{a.value=!1}},Ht=async l=>{try{await Se({url:"workspace/cards/group-card-order",method:"PATCH",data:l}),de(),it()}catch(t){console.error("Failed to reorder card:",t)}};function mt(){var n;const l=(n=O.value)==null?void 0:n.querySelector(".mind-elixir-toolbar.rb");if(!l||l.querySelector(".open-sidebar-btn"))return;const t=document.createElement("button");t.className="open-sidebar-btn me-toolbar-btn ms-2",t.title="Open Formatting Sidebar",t.innerHTML='<i class="fa-solid fa-sidebar"></i>',t.addEventListener("click",()=>{Pe.value=!Pe.value}),l.appendChild(t)}let Ee=null;function pl(){var t,n;Ee&&(Ee.disconnect(),Ee=null);const l=(n=(t=O.value)==null?void 0:t.querySelector(".mind-elixir-toolbar.rb"))==null?void 0:n.parentElement;l&&(Ee=new MutationObserver(()=>{mt()}),Ee.observe(l,{childList:!0,subtree:!0}),mt())}ms(()=>{Y.value!=="mindmap"||!O.value||!F.value||Ul(()=>{var J,E;const l=Ft(F.value);_.value&&((E=(J=_.value).destroy)==null||E.call(J),_.value=null);const t=new Set,n=new Set,o=new Set,c=new Mt({el:O.value,theme:v.value?Mt.DARK_THEME:Mt.THEME,draggable:!0,contextMenu:!0,toolBar:!0,keypress:!0,locale:"en",overflowHidden:!1,contextMenuOption:{Update:!0,extend:[{name:"Update Node",onclick:()=>{var $;Pe.value&&(Pe.value=!1);const M=($=Ue.value)==null?void 0:$.nodeObj;M&&ze(M)}},{name:"Add Hyperlink",onclick:()=>{u(async()=>{await He()})}}]}});_.value=c,c.init({nodeData:l}),setTimeout(()=>{c.toCenter()},100),Ul(()=>{pl()}),c.bus.addListener("selectNode",M=>{M&&(Ue.value={nodeObj:M})}),c.bus.addListener("renderNode",M=>{!(M!=null&&M.nodeObj)||!(M!=null&&M.element)||i(M.nodeObj,M.element)});const z=M=>{let $=M;for(;$;){if($.unique_name==="sheet")return $;$=$.parent}return null};c.bus.addListener("operation",async M=>{if(M){if(M.name==="moveNode"||M.name==="moveNodeBefore"||M.name==="moveNodeAfter"){const $=M.obj,oe=M.target;if(!$||$.unique_name!=="card"||!oe)return;const ce=$._originalParent||$.parent;if(!ce||ce.unique_name!=="List")return;const le=oe.unique_name==="List"?oe:oe.parent;if(!le||le.unique_name!=="List")return;const ge=z(le);if(!ge)return;const tt=le.children.findIndex(gt=>gt.id===$.id);if(tt===-1)return;$._originalParent=le,await Ht({workspace_id:ue.value,card_id:$.id,group_value:le.topic,group_variable_id:xe.value,new_index:tt,sheet_id:ge.id});return}if(M.name==="removeNode"){const $=M.obj;if(!$||!$.id||$.unique_name!=="card")return;r.value=$.id,await cl();return}if(M.name==="addChild"||M.name==="insertSibling"){const $=M.obj;if(!$||!$.id)return;t.add($.id);return}if(M.name==="finishEdit"){const $=M.obj;if(!$||!$.id)return;const oe=t.has($.id),ce=n.has($.id);if(!oe&&!ce||ce)return;if(oe){t.delete($.id),n.add($.id);const le=$.parent;if(!le||!("unique_name"in le)){n.delete($.id);return}if(le.unique_name==="root"&&!o.has($.id)){o.add($.id);try{await ul({variables:{"sheet-title":$.topic??"New Sheet","sheet-description":"This is custom description"},is_ai_generated:!1,workspace_id:ue.value,workspace_module_id:Ne.value})}catch{n.delete($.id),o.delete($.id)}return}if(le.unique_name==="List"){try{const ge=G({topic:$.topic??"New Card",id:$.id},le);ge.variables&&(ge.variables["card-description"]="This is a default description"),await h(ge)}catch{n.delete($.id)}return}if(le.unique_name==="sheet"){try{console.log("Creating new list under sheet...")}catch{n.delete($.id)}return}}}}})})}),U(v,()=>{_.value&&_.value.changeTheme(v.value?Mt.DARK_THEME:Mt.THEME)},{immediate:!0});function i(l,t){if(!l||!t||!l.style)return;const n=t.querySelector(".topic"),o=t.querySelector(".node")??t,c=l.style;c.background&&(o.style.background=c.background),c.color&&n&&(n.style.color=c.color),n&&(c.fontSize&&(n.style.fontSize=c.fontSize),c.fontFamily&&(n.style.fontFamily=c.fontFamily),c.fontWeight&&(n.style.fontWeight=c.fontWeight),c.fontStyle&&(n.style.fontStyle=c.fontStyle)),c.borderColor&&(o.style.borderColor=c.borderColor),c.borderWidth&&(o.style.borderWidth=c.borderWidth),c.borderRadius&&(o.style.borderRadius=c.borderRadius),c.padding&&(o.style.padding=c.padding)}function s(l={}){return{background:l.bg_color,color:l.color,fontSize:l.font_size!=null?`${l.font_size}px`:void 0,fontWeight:l.font_weight,fontStyle:l.font_style,fontFamily:l.font_family,borderColor:l.border_color,borderWidth:l.border_width!=null?`${l.border_width}px`:void 0,borderRadius:l.border_radius!=null?`${l.border_radius}px`:void 0,padding:l.padding!=null?`${l.padding}px`:void 0,hyperLink:l.hyperLink||void 0}}function G(l,t){const n=new Date,o=n.toISOString().split("T")[0],c=new Date(n.getTime()+3*24*60*60*1e3).toISOString().split("T")[0];return{sheet_list_id:(t==null?void 0:t.topic)||"In Progress",workspace_id:ue.value,sheet_id:fe.value,workspace_lane_id:(l==null?void 0:l.workspace_lane_id)||null,variables:{"card-status":(t==null?void 0:t.topic)||"In Progress","card-type":null,priority:null,process:null,"card-title":l.topic||"New Card","card-description":"","start-date":o,"end-date":c},createdAt:new Date().toISOString()}}return(l,t)=>{var n,o,c,z,J;return p(),m("div",Tn,[e("div",Dn,[e("div",Vn,[e("div",Ln,[e("div",En,[e("button",{class:"cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white items-center justify-center gap-1 px-2 rounded-md text-xs font-medium",onClick:t[0]||(t[0]=E=>l.$emit("go-back"))},t[24]||(t[24]=[e("i",{class:"fa-solid fa-chevron-left"},null,-1),se(" Go Back ")]))]),e("div",Mn,[e("button",{class:"cursor-pointer bg-gradient-to-tr from-accent to-accent-hover px-2 text-white items-center justify-center py-1 rounded-md font-medium",onClick:t[1]||(t[1]=E=>l.$emit("go-back"))},t[25]||(t[25]=[e("i",{class:"fa-solid fa-chevron-left"},null,-1)]))]),e("div",An,V(l.activeSprint),1)]),e("div",In,[e("div",Bn,[e("button",{class:ee(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",Y.value==="kanban"?"text-accent bg-accent-text":" hover:bg-border/50 backdrop-blur-2xl  transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"List view",onClick:t[2]||(t[2]=E=>Y.value="kanban")},t[26]||(t[26]=[e("i",{class:"fa-solid fa-chart-kanban"},null,-1)]),2),e("button",{onClick:t[3]||(t[3]=E=>Y.value="table"),class:ee(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",Y.value==="table"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gallery view"},t[27]||(t[27]=[e("i",{class:"fa-solid fa-align-left"},null,-1)]),2),e("button",{onClick:t[4]||(t[4]=E=>Y.value="mindmap"),class:ee(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",Y.value==="mindmap"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"MindMap view"},t[28]||(t[28]=[e("i",{class:"fa-solid fa-chart-diagram"},null,-1)]),2),e("button",{onClick:t[5]||(t[5]=E=>Y.value="calendar"),class:ee(["aspect-square cursor-pointer rounded-sm p-0 px-0.5",Y.value==="calendar"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Calendar view"},t[29]||(t[29]=[e("i",{class:"fa-regular fa-calendar"},null,-1)]),2),e("button",{onClick:t[6]||(t[6]=E=>Y.value="gantt"),class:ee(["aspect-square cursor-pointer rounded-sm p-0",Y.value==="gantt"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Gantt Chart view"},t[30]||(t[30]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 6h2v12H4V6Zm4 4h10v2H8v-2Zm0 4h10v2H8v-2Zm0-8h10v2H8V6Z"})],-1)]),2),e("button",{onClick:t[7]||(t[7]=E=>Y.value="timeline"),class:ee(["aspect-square cursor-pointer rounded-sm p-0",Y.value==="timeline"?"text-accent bg-accent-text":"hover:bg-border/50 backdrop-blur-2xl transition-all duration-75 hover:outline-border hover:outline hover:text-accent"]),title:"Timeline view"},t[31]||(t[31]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 12a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm16 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm-8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm0-16a2 2 0 1 1 0-4 2 2 0 0 1 0 4Z",opacity:"0"}),e("path",{d:"M4 12h4m8 0h4M9 12h6M9 12v-6M15 12v6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),2)])])])]),e("div",On,[e("div",Nn,[e("div",Pn,[Y.value=="kanban"?(p(),m("div",qn,[lt(j($s,null,null,512),[[Gt,f(Ze)]]),lt(e("div",zn,[j(f(q),{onOnPlus:sl,"onDelete:column":t[8]||(t[8]=E=>ll(E)),"onUpdate:column":t[9]||(t[9]=E=>tl(E)),onReorder:el,onAddColumn:D,"onSelect:ticket":ze,board:pt.value,onOnBoardUpdate:Fe,variable_id:xe.value,sheet_id:fe.value},{"column-footer":pe(E=>{var M,$,oe,ce,le;return[($=(M=f(ot))==null?void 0:M.transitions)!=null&&$.all_allowed&&!((le=(ce=(oe=f(ot))==null?void 0:oe.transitions)==null?void 0:ce.all_allowed)!=null&&le.includes(E.column.title))&&f(ot).transitions.currentColumn!=E.column.title?(p(),m("div",Un," Disbale ( you can't drop here ) ")):P("",!0)]}),ticket:pe(({ticket:E})=>[j(Ts,{selectedVar:xe.value,onSelect:()=>{ze(E)},ticket:E},null,8,["selectedVar","onSelect","ticket"])]),_:1},8,["board","variable_id","sheet_id"])],512),[[Gt,!f(Ze)]])])):P("",!0),Y.value=="table"?(p(),ye(Cs,{key:1,onToggleVisibility:Tt,onAddVar:t[10]||(t[10]=()=>{ht.value=!0}),isPending:f(Ze)||f(Xe),columns:Ut.value,rows:pt.value,canCreate:f(Ke),canCreateVariable:f(at),onCreate:ol},null,8,["isPending","columns","rows","canCreate","canCreateVariable"])):P("",!0),Y.value==="mindmap"?(p(),m(Te,{key:2},[e("div",jn,[e("div",{ref_key:"mindMapRef",ref:O,class:"flex-1 h-full overflow-hidden rounded-md relative",style:{height:"600px",width:"100%"}},null,512),Pe.value&&f(ie)&&f(qe)&&f(Ke)?(p(),m("div",Fn,[e("div",Rn,[t[33]||(t[33]=e("h3",{class:"text-sm font-semibold text-secondary"},"Format Node",-1)),e("button",{onClick:t[11]||(t[11]=E=>Pe.value=!1),class:"text-gray-400 hover:text-gray-700"},t[32]||(t[32]=[e("i",{class:"fa-solid fa-times"},null,-1)]))]),e("div",Hn,[e("div",null,[t[36]||(t[36]=e("h4",{class:"text-xs font-semibold text-secondary uppercase mb-3"}," Colors ",-1)),e("div",Wn,[t[34]||(t[34]=e("label",{class:"block text-xs text-secondary mb-1"},"Background",-1)),e("div",Kn,[e("div",{class:"h-10 w-10 rounded-md border cursor-pointer relative",style:be({backgroundColor:$e.value.background})},[e("input",{type:"color",value:$e.value.background,class:"absolute inset-0 opacity-0 cursor-pointer",onInput:t[12]||(t[12]=E=>Lt("bg_color",E)),style:{"pointer-events":"all"}},null,40,Qn)],4),j(f(R),{modelValue:$e.value.background,placeholder:"#3b82f6",class:"flex-1",readonly:""},null,8,["modelValue"])])]),e("div",Zn,[t[35]||(t[35]=e("label",{class:"block text-xs text-secondary mb-1"},"Text",-1)),e("div",Gn,[e("div",{class:"h-10 w-10 rounded-md border cursor-pointer relative",style:be({backgroundColor:$e.value.color})},[e("input",{type:"color",value:$e.value.color,class:"absolute inset-0 opacity-0 cursor-pointer",onInput:t[13]||(t[13]=E=>Lt("color",E)),style:{"pointer-events":"all"}},null,40,Jn)],4),j(f(R),{modelValue:$e.value.color,placeholder:"#3b82f6",class:"flex-1",readonly:""},null,8,["modelValue"])])])]),e("div",null,[e("div",Xn,[e("div",null,[t[38]||(t[38]=e("label",{class:"block text-xs text-secondary mb-1"},"Weight",-1)),e("select",{class:"w-full h-8 border rounded px-2 text-sm",value:$e.value.fontWeight,onChange:t[14]||(t[14]=E=>Lt("font_weight",E))},t[37]||(t[37]=[e("option",{value:"lighter"},"Light",-1),e("option",{value:"normal"},"Normal",-1),e("option",{value:"bold"},"Bold",-1),e("option",{value:"bolder"},"Extra Bold",-1)]),40,Yn)])])])]),e("div",er,[e("button",{class:"w-full cursor-pointer bg-gradient-to-tr from-accent to-accent-hover text-white flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm font-medium hover:shadow-md disabled:opacity-60",disabled:Re.value,onClick:He},[Re.value?(p(),m("span",lr)):P("",!0),e("span",null,V(Re.value?"Updating...":"Update"),1)],8,tr)])])):P("",!0)]),re.value&&f(ie)&&f(qe)&&f(Ke)?(p(),m("div",sr,[e("div",ar,[t[39]||(t[39]=e("h3",{class:"text-lg font-semibold mb-4"},"Insert Web Link",-1)),lt(e("input",{"onUpdate:modelValue":t[15]||(t[15]=E=>ne.value=E),type:"text",placeholder:"Enter or paste a URL",class:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[hl,ne.value]]),e("div",nr,[e("button",{onClick:ae,class:"px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300"}," Cancel "),e("button",{disabled:!ne.value,onClick:w,class:ee(["px-4 py-2 rounded-md text-white",ne.value?"bg-blue-500 hover:bg-blue-600":"bg-blue-300 cursor-not-allowed"])}," Insert ",10,rr)])])])):P("",!0),kt.value?(p(),m("div",{key:1,class:"absolute top-40 left-70 bg-bg-body rounded-lg p-4 shadow-lg z-100 min-w-[328px] border",onClick:t[17]||(t[17]=Be(()=>{},["stop"]))},[j(f(R),{autofocus:!0,modelValue:wt.value,"onUpdate:modelValue":t[16]||(t[16]=E=>wt.value=E),placeholder:"Add New list",onKeyup:Qt(B,["enter"])},null,8,["modelValue"]),t[40]||(t[40]=e("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),e("div",or,[j(f(Q),{onClick:B,varaint:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:pe(()=>[se(V(f(S)?"Adding...":"Add list"),1)]),_:1}),e("i",{class:"fa-solid fa-close cursor-pointer",onClick:me})])])):P("",!0)],64)):P("",!0),Y.value==="calendar"?(p(),ye(f(W),{key:3,data:pt.value,"onSelect:ticket":ze,class:"min-h-[600px]"},null,8,["data"])):P("",!0),Y.value==="gantt"?(p(),ye(f(K),{key:4,data:pt.value,"onSelect:ticket":ze},null,8,["data"])):P("",!0),Y.value==="timeline"?(p(),ye(f(I),{key:5,data:pt.value,"onSelect:ticket":ze},null,8,["data"])):P("",!0),j(f(T),{onClick:t[18]||(t[18]=Be(()=>{},["stop"])),modelValue:Je.value,"onUpdate:modelValue":t[19]||(t[19]=E=>Je.value=E),title:"Delete List",itemLabel:"list",itemName:(n=ve.value)==null?void 0:n.title,requireMatchText:(o=ve.value)==null?void 0:o.title,confirmText:"Delete workspace",cancelText:"Cancel",size:"md",loading:f(S),onConfirm:Bt,onCancel:t[20]||(t[20]=()=>{Je.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),dt.value?(p(),ye(f(N),{selectedVariable:xe.value,listId:(c=ve.value)==null?void 0:c.title,sheet_id:fe.value,key:"createTaskModalKey",modelValue:dt.value,"onUpdate:modelValue":t[21]||(t[21]=E=>dt.value=E),onSubmit:t[22]||(t[22]=()=>{})},null,8,["selectedVariable","listId","sheet_id","modelValue"])):P("",!0)])]),(z=ut.value)!=null&&z._id?(p(),ye(f(X),{key:0,class:"w-[400px] flex-shrink-0",details:ut.value,onClose:t[23]||(t[23]=()=>ze({variables:{}})),showPanel:!!((J=ut.value)!=null&&J._id)},null,8,["details","showPanel"])):P("",!0)])])}}}),dr=Xt(ir,[["__scopeId","data-v-f6319263"]]),ur={class:"flex-auto min-h-0 rounded-[6px] overflow-x-auto flex-col flex backdrop-blur flex-grow h-full"},cr={key:1,class:"flex flex-col flex-1 min-h-0"},pr={class:"h-screen w-full flex flex-col -mt-3.5"},fr={class:"overflow-x-auto w-full flex-1"},vr={class:"min-w-[1200px] h-full flex flex-col"},mr={key:0,class:"px-0.5 py-4 w-full min-w-0 flex flex-col min-h-0 overflow-x-auto h-full"},gr={class:"flex items-center justify-between mt-2"},br={class:"text-sm font-semibold flex gap-2 items-center"},yr={class:"flex items-center gap-2 relative",ref:"filterDropdownRef"},xr={class:"mt-3"},hr={key:0,class:"flex items-center gap-2 overflow-x-auto no-scrollbar py-1"},_r={key:0,class:"ml-2 text-xs font-normal"},kr=["onClick"],wr={key:0,class:"ml-2 text-xs font-normal"},Sr={key:1,class:"relative flex items-center gap-3"},Cr={class:"relative flex-shrink-0"},$r={class:"flex items-center gap-2 truncate"},Tr=["src"],Dr={class:"truncate"},Vr={class:"ml-2 text-xs font-normal"},Lr={key:0,class:"absolute left-0 top-full mt-1 w-44 bg-bg-card border border-gray-200 rounded-lg shadow-lg z-[9999]"},Er={class:"flex flex-col"},Mr=["onClick"],Ar={class:"flex gap-2 overflow-x-auto no-scrollbar flex-1"},Ir=["onClick"],Br={key:0,class:"w-full h-full flex justify-center items-center"},Or={key:1,class:"flex-1 min-h-0 overflow-y-auto"},Nr={class:"relative z-10 group"},Pr={class:"rounded-md relative pt-2 flex flex-col flex-1 bg-bg-card min-h-0 border border-border"},qr={class:"flex justify-between gap-4 px-3 pb-2 border-b border-border-input"},zr={class:"flex items-center gap-2 min-w-0 py-1"},Ur=["onClick"],jr={class:"flex items-center lg:gap-2 max-w-full"},Fr={class:"flex items-center lg:gap-2 max-w-full"},Rr={class:"truncate max-w-[160px]"},Hr={key:1,class:"absolute left-0 mt-2 w-60 bg-bg-card border-accent-hover rounded-xl shadow-lg z-50 max-h-64 overflow-y-auto overflow-x-hidden"},Wr={class:"relative flex-1"},Kr=["onClick"],Qr=["onBlur","onKeyup"],Zr={class:"relative ml-2 flex gap-2"},Gr=["onClick"],Jr=["onClick"],Xr={class:"flex justify-end items-center"},Yr={class:"flex gap-2"},eo={class:"gap-2 hidden lg:flex"},to={key:0,class:"flex gap-2"},lo={key:1},so={key:0,class:"gap-2"},ao={class:"hidden lg:fxex bg-[#E6E1F5] text-accent px-3 py-1 rounded-2xl justify-center items-center"},no={key:0,class:"flex lg:hidden ms-2"},ro=["title"],oo=["disabled"],io={class:"absolute z-50 top-10 mb-2 -translate-x-2/3 bg-card border border-accent text-accent text-xs px-2 py-1 rounded whitespace-nowrap"},uo={key:0,class:"fixed inset-0 z-50 flex items-center justify-center w-full"},co={class:"relative bg-bg-card rounded-lg p-4 mx-3 w-full max-w-md lg:max-w-2xl xl:max-w-3xl"},po={class:"flex flex-col gap-2 mt-4"},fo={class:"text-sm text-muted mb-2"},vo={class:"flex gap-2 w-full"},mo={key:0,class:"mt-1 w-full bg-bg-card rounded-md max-h-64 overflow-y-auto"},go={class:"flex items-center justify-between"},bo={class:"font-medium"},yo={class:"text-muted text-xs ml-2"},xo={class:"flex gap-2 text-xs"},ho={class:"text-muted border border-border-input rounded-md px-3 py-1"},_o={key:1,class:"absolute top-full left-0 mt-1 w-full bg-bg-card border border-border-input rounded-md shadow-md p-4 z-50 text-center text-muted"},ko={key:0,class:"w-full h-full min-h-[250px] flex justify-center items-center"},wo={key:1,class:"flex-1 min-h-0 overflow-y-auto"},So={key:1,class:"bg-bg-card w-full p-6 flex flex-col justify-center h-full items-center text-center gap-4"},Co={class:"text-sm text-text-primary font-semibold mb-1 text-center"},$o={class:"text-sm text-text-primary/90 mb-3 max-w-120 text-center"},To={key:2,class:"w-full h-full min-h-[250px] flex flex-col items-center justify-center text-center gap-4 p-6"},Do={class:"text-sm text-text-primary font-semibold mb-1 text-center"},Vo={class:"text-sm text-text-primary/90 mb-3 max-w-120 text-center"},Kt=400,Lo=xt({__name:"Plan",setup(k){const{isDark:x}=Jt(),N=b(!1),T=b(""),X=b(!1),q=b(!1),{canCreateCard:d}=gl(),Z=b(!1),H=b(null),W=b(!1),K=b(!1),I=L(()=>A.value.value),Q=b(""),R=b(!1),re=[{label:"Milestone",value:"milestone",dot:"#7D68C8"},{label:"Sprint",value:"sprint",dot:"#7D68C8"},{label:"Huddle",value:"huddle",dot:"#7D68C8"}],ne=L(()=>I.value?I.value.charAt(0).toUpperCase()+I.value.slice(1):""),A=b(re[0]),O=b(null),_=b(!1);Wt(O,()=>{_.value=!1});const g=()=>{N.value=!1},v=()=>{Z.value=!0},r=b(!1),a=()=>{r.value=!r.value},{workspaceId:u}=Zl(),w=b(!1),{moveSelectedToSprint:ae,moveSelectedToBacklog:h,deleteSelected:B,saveSprintMeta:me,toggleStartSprint:Ce}=zs();function Y(i){Q.value=i,mt.value=i||"all",Ee.value=!1}function ue(i){Q.value=i,mt.value=i,Ee.value=!1}function Ne(i){Q.value=i,Ee.value=!1}const{data:De,refetch:ht}=ml(u,I,Q);U(Q,()=>{ht()});const{data:Pe}=xs(u),at=L(()=>{var i;return((i=Pe.value)==null?void 0:i.modules.filter(s=>{var G;return((G=s==null?void 0:s.variables)==null?void 0:G["module-title"])!=="Pin"}))||[]});U(()=>I.value,(i,s)=>{i!==s&&ht()});const{mutate:Ke,isPending:qe}=Ns({onSuccess:()=>{Tt.invalidateQueries({queryKey:["sprint-list"]}),Ve.value=!1}}),ie=b(null),Ve=b(!1),Qe=()=>{var i;Ke((i=ie.value)==null?void 0:i._id)},{mutate:nt,isPending:Le}=Hl({onSuccess:i=>{me({name:i.title}),rt({id:te.value,payload:{title:i.title,start_date:i.start_date,end_date:i.end_date,goal:i.goal,duration:Number(i.duration_days)}}),it.value=!1}}),{mutate:rt,isPending:S}=Os({onSuccess:()=>{Ze()}}),D=async i=>{R.value=!0;try{await nt({id:te.value,payload:{title:i.title,duration:i.duration,start_date:i.start,end_date:i.end,goal:i.goal}})}finally{R.value=!1}},{data:y,refetch:de,isLoading:je}=Ls(u.value,I),fe=L(()=>{var i;return((i=y.value)==null?void 0:i.sprints)??[]});U(()=>I.value,(i,s)=>{i!==s&&de()});const{refetch:_t,isPending:xe}=ml(u,I),ot=L(()=>{var i,s;return(s=(i=y==null?void 0:y.value)==null?void 0:i.sprints[0])==null?void 0:s._id}),te=b(ot.value);U(()=>ot.value,i=>{te.value=i}),U(()=>te.value,i=>{var s;ie.value=((s=y.value)==null?void 0:s.sprints.find(G=>G._id===i))||null});const{data:F,refetch:Ze}=Is(te,{enabled:L(()=>!!te.value)}),it=b(!1),dt=()=>{localStorage.setItem("asFirstTime",JSON.stringify(!0)),it.value=!0},ut=()=>JSON.parse(localStorage.getItem("asFirstTime")||"false"),ze=()=>{var i;((i=F.value)==null?void 0:i.status)==="active"&&ut()&&(Z.value=!0,localStorage.setItem("asFirstTime",JSON.stringify(!1)))};jl(()=>{ze()}),U(()=>{var i;return(i=F.value)==null?void 0:i.status},()=>{ze()});const{data:ct,refetch:Yt,isFetching:el}=Es(te);U(()=>te.value,()=>{te.value&&Ze()});const Fe=b(""),It=b(null),Ge=L(()=>{const i=ct.value;if(!Fe.value||!(i!=null&&i.backlog_items))return[];const s=Fe.value.toLowerCase().trim();return i.backlog_items.filter(G=>{var J,E,M,$,oe,ce,le,ge,tt,gt;const l=((M=(E=(J=G.card)==null?void 0:J.variables)==null?void 0:E["card-title"])==null?void 0:M.toLowerCase())||"",t=((ce=(oe=($=G.card)==null?void 0:$.variables)==null?void 0:oe["card-code"])==null?void 0:ce.toLowerCase())||"",n=((tt=(ge=(le=G.card)==null?void 0:le.variables)==null?void 0:ge["card-status"])==null?void 0:tt.toLowerCase())||"",o=((gt=G.priority)==null?void 0:gt.toLowerCase())||"",c=String(G._id||"").toLowerCase(),z=String(G.card_id||"").toLowerCase();return l.includes(s)||t.includes(s)||n.includes(s)||o.includes(s)||c.includes(s)||z.includes(s)})});function kt(i){Fe.value=i}function wt(){Ge.value.length===1&&Bt(Ge.value[0])}const tl={high:"bg-red-500/20 text-red-500",medium:"bg-yellow-500/20 text-yellow-500",low:"bg-green-500/20 text-green-500"};function Je(i){const s=i==null?void 0:i.toLowerCase();return tl[s]??"bg-gray-500/20 text-gray-500"}const ve=L(()=>{var G,l,t,n;const i=(G=ct.value)==null?void 0:G.backlog_items;if(!i)return null;const s=(i||[]).map(o=>{var J,E,M,$,oe;const c=((J=o==null?void 0:o.card)==null?void 0:J.variables)||{},z=((E=o==null?void 0:o.card)==null?void 0:E._id)||o.card_id;return{id:z,key:c["card-code"]||(z==null?void 0:z.slice(-6))||"PRJ-?",summary:c["card-title"]||"(untitled)",type:"Story",status:ll(String(c["card-status"]||"").trim()),assignee:(($=(M=o==null?void 0:o.card)==null?void 0:M.assigned_to)==null?void 0:$.name)||"Unassigned",storyPoints:Number(o.story_points||0),priority:sl(String(c.priority||"").trim()),createdAt:((oe=o==null?void 0:o.card)==null?void 0:oe.created_at)||new Date().toISOString(),description:c["card-description"]||""}});return{id:(l=ct.value)==null?void 0:l._id,name:((t=ct.value)==null?void 0:t.title)||"Sprint 1",title:(n=ct.value)==null?void 0:n.title,goal:"",start:"",end:"",started:!1,tickets:s}});function Bt(i){console.log("selected sprint id",i),te.value=i._id,vt.value=!1}function ll(i){const s=i.toLowerCase();return s.includes("progress")?"In Progress":s.includes("done")||s.includes("complete")?"Done":"Todo"}function sl(i){const s=i.toLowerCase();return s==="highest"||s==="blocker"||s==="critical"?"Highest":s==="high"||s==="major"?"High":s==="medium"||s==="normal"?"Medium":"Low"}const{mutate:St}=Ps({onSuccess:()=>{st.success("Card removed from sprint successfully"),Ot()},onError:i=>{st.error("Failed to remove card from sprint",i)}});function Ot(){Yt(),de(),_t(),Ze()}function al(i,s){const G=Array.isArray(i)?i:[i],l=s||te.value;!l||!G.length||G.forEach(t=>{St({sprintId:l,cardId:t})})}const pt=b(!1),$t=b(null);function Nt(){w.value=!0,$t.value=null}function Ct(i){$t.value=i,N.value=!0,pt.value=!0}const Xe=b(!1);function nl(){Xe.value=!0}const Tt=_l(),{mutate:Dt,isPending:Pt}=Bs({onSuccess:i=>{me({name:i.title}),Tt.invalidateQueries({queryKey:["sprint-list"]}),Xe.value=!1}}),{mutate:qt,isPending:ft}=Hl({onSuccess:i=>{me({name:i.title}),Tt.invalidateQueries({queryKey:["sprint-list"]}),Xe.value=!1}}),Ye=b("");function zt(i){const s=Ye.value.trim();if(!s||s===i.title){Ft();return}qt({id:i._id,payload:{workspace_id:u.value,title:s}}),He.value=null}function rl(i){var s;ie.value?qt({id:(s=ie.value)==null?void 0:s._id,payload:{workspace_id:u.value,title:i.name,sprintType:i.value,description:i.description}}):Dt({payload:{workspace_id:u.value,title:i.name,sprintType:i.value,description:i.description}})}const Ut=b([]);function jt(i){ie.value=null,Xe.value=!0,Ut.value=i}function ol(i){ie.value=i,Ve.value=!0}const{mutate:il,isPending:Ue}=As(te,{onSuccess:()=>{Ze()}}),Vt=()=>{il({})},et=b(null),$e=b(0);let he=!1;jl(()=>{if(!et.value)return;const i=et.value.offsetWidth;$e.value=i/3});function Lt(){he=!0,document.addEventListener("mousemove",_e),document.addEventListener("mouseup",Re)}function _e(i){if(!he||!et.value)return;const s=et.value.getBoundingClientRect(),G=i.clientX-s.left;G<Kt?$e.value=Kt:G>s.width-Kt?$e.value=s.width-Kt:$e.value=G}function Re(){he=!1,document.removeEventListener("mousemove",_e),document.removeEventListener("mouseup",Re)}const He=b(null);function dl(i){He.value=i._id,i.tempTitle=i.title,Ye.value=i.title}function Ft(){var s;const i=(s=y.value)==null?void 0:s.sprints.find(G=>G._id===He.value);i&&(i.tempTitle=i.title),He.value=null}Wt(H,()=>{K.value=!1});const ul=i=>{console.log("selected type",i),A.value=i,W.value=!1};Wt(O,()=>{W.value=!1});const Rt=b(null),vt=b(!1);Wt(Rt,()=>{vt.value=!1});const Et=b(!1),cl=()=>{Et.value=!0},Ht=()=>{Et.value=!1,Fe.value=""},mt=b("all"),Ee=b(!1),pl=L(()=>{var s,G,l;if(mt.value==="all")return"All Milestones";const i=(G=(s=Pe.value)==null?void 0:s.modules)==null?void 0:G.find(t=>t._id===mt.value);return((l=i==null?void 0:i.variables)==null?void 0:l["module-title"])??"All Milestones"});return(i,s)=>{var G,l,t,n,o,c,z,J,E,M,$,oe,ce,le,ge,tt,gt,kl,wl,Sl,Cl,$l,Tl,Dl,Vl,Ll,El,Ml,Al,Il,Bl,Ol;return p(),m("div",ur,[Z.value||R.value?(p(),ye(dr,{key:0,sptint_id:te.value,searchQuery:T.value,"active-sprint":I.value,onGoBack:s[0]||(s[0]=C=>Z.value=!1)},null,8,["sptint_id","searchQuery","active-sprint"])):(p(),m("div",cr,[e("div",pr,[e("div",fr,[e("div",vr,[f(S)?P("",!0):(p(),m("div",mr,[e("div",{ref_key:"containerRef",ref:et,class:"flex gap-1 min-h-0 overflow-x-auto group h-full"},[e("section",{class:"px-4 rounded-md relative flex flex-col min-h-0 bg-bg-card h-full border border-border",style:be({width:$e.value+"px"})},[e("div",gr,[e("h2",br,[lt(e("input",{type:"checkbox",class:"custom-checkbox bg-bg-body border border-border-input flex-shrink-0","onUpdate:modelValue":s[1]||(s[1]=C=>X.value=C)},null,512),[[hs,X.value]]),se(" Tickets ("+V((l=(G=f(De))==null?void 0:G.cards)==null?void 0:l.length)+" "+V(((n=(t=f(De))==null?void 0:t.cards)==null?void 0:n.length)>1?"Tasks":"Task")+") ",1)]),e("div",yr,[f(d)?(p(),m("button",{key:0,class:"w-8 h-8 rounded cursor-pointer text-sm hover:bg-bg-body flex items-center justify-center",onClick:Nt},s[22]||(s[22]=[e("i",{class:"text-text-primary fa-regular fa-plus"},null,-1)]))):P("",!0)],512)]),e("div",xr,[I.value==="milestone"?(p(),m("div",hr,[e("button",{onClick:s[2]||(s[2]=C=>Y("")),class:ee(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium transition-colors whitespace-nowrap",Q.value===""?"bg-accent text-white border-none":"bg-transparent text-accent border border-accent"])},[s[23]||(s[23]=se(" All Modules ")),Q.value===""?(p(),m("span",_r," ("+V((c=(o=f(De))==null?void 0:o.cards)==null?void 0:c.length)+") ",1)):P("",!0)],2),(p(!0),m(Te,null,Oe(at.value,C=>{var ke,Me;return p(),m("button",{key:C._id,onClick:fl=>Y(C._id),class:ee(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium transition-colors whitespace-nowrap cursor-pointer",Q.value===C._id?"bg-accent text-white border-none":"bg-transparent text-accent border border-accent"])},[se(V(C.variables["module-title"])+" ",1),Q.value===C._id?(p(),m("span",wr," ("+V((Me=(ke=f(De))==null?void 0:ke.cards)==null?void 0:Me.length)+") ",1)):P("",!0)],10,kr)}),128))])):I.value==="huddle"||I.value==="sprint"?(p(),m("div",Sr,[e("div",Cr,[e("button",{class:"h-8 min-w-[160px] flex items-center justify-between px-2 rounded-md border text-sm border-border hover:bg-bg-body",onClick:s[3]||(s[3]=C=>Ee.value=!Ee.value)},[e("span",$r,[e("img",{src:f(Va),alt:"filter",class:"w-4 h-4"},null,8,Tr),e("span",Dr,[se(V(pl.value||"All Milestones")+" ",1),e("span",Vr," ("+V((J=(z=f(De))==null?void 0:z.cards)==null?void 0:J.length)+") ",1)])]),s[24]||(s[24]=e("i",{class:"fas fa-chevron-down text-xs ml-2"},null,-1))]),Ee.value?(p(),m("div",Lr,[e("ul",Er,[e("li",{class:"px-3 py-2 cursor-pointer hover:bg-bg-body hover:text-primary",onClick:s[4]||(s[4]=C=>Y(""))}," All Milestones "),(p(!0),m(Te,null,Oe(at.value,C=>(p(),m("li",{key:C._id,class:"px-3 py-2 cursor-pointer hover:bg-bg-body hover:text-primary",onClick:ke=>ue(C._id)},V(C.variables["module-title"]),9,Mr))),128))])])):P("",!0)]),e("div",Ar,[(p(!0),m(Te,null,Oe(fe.value,C=>(p(),m("button",{key:C._id,onClick:ke=>Ne(C._id),class:ee(["flex-shrink-0 px-4 py-1 rounded-2xl text-sm font-medium whitespace-nowrap transition-colors",Q.value===C._id?"bg-accent text-white border-none":"bg-transparent text-accent border border-accent"])},V(C.title),11,Ir))),128))])])):P("",!0)]),f(xe)?(p(),m("div",Br,s[25]||(s[25]=[e("div",{role:"status","aria-label":"Loading",class:"h-10 w-10 rounded-full border-4 border-accent border-t-transparent animate-spin"},null,-1)]))):(p(),m("div",Or,[j(sa,{checkedAll:X.value,"sprint-type":I.value,searchQuery:T.value,"module-id":Q.value,onMoveSelectedToSprint:f(ae),onDeleteSelectedBacklog:s[5]||(s[5]=C=>f(B)("backlog")),onOpenTicket:Ct,onTicketMovedToBacklog:al,onOpenCreateTicket:Nt},null,8,["checkedAll","sprint-type","searchQuery","module-id","onMoveSelectedToSprint"])]))],4),e("div",Nr,[(p(),m("svg",{onMousedown:Lt,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 cursor-col-resize opacity-0 group-hover:opacity-100 transition",role:"img","aria-label":"Resize"},s[26]||(s[26]=[e("path",{fill:"currentColor",d:"M10 3h4v2h-4V3zm0 4h4v2h-4V7zm0 4h4v2h-4v-2zm0 4h4v2h-4v-2zm0 4h4v2h-4v-2z"},null,-1),e("path",{fill:"currentColor",d:"M4 2h2v20H4V2zm14 0h2v20h-2V2z",opacity:"0.4"},null,-1)]),32))]),e("section",Pr,[e("div",qr,[e("div",zr,[e("div",{ref_key:"elipseWrapperSprint",ref:H,class:"relative inline-block"},[e("button",{onClick:s[6]||(s[6]=Be(C=>K.value=!K.value,["stop"])),class:"flex items-center gap-2 lg:px-3 px-2 py-1.5 text-sm font-medium bg-transparent rounded-lg",style:be({border:"1px solid "+A.value.dot})},[e("span",{class:"w-2 h-2 rounded-full hidden lg:flex",style:be({backgroundColor:A.value.dot})},null,4),se(" "+V(A.value.label)+" ",1),s[27]||(s[27]=e("i",{class:"fas fa-chevron-down text-xs"},null,-1))],4),j(Fl,{name:"fade"},{default:pe(()=>[K.value?(p(),m("ul",{key:0,onClick:s[7]||(s[7]=Be(()=>{},["stop"])),class:"absolute left-0 mt-2 w-44 bg-bg-dropdown border border-border rounded-xl shadow-lg z-50"},[(p(),m(Te,null,Oe(re,C=>e("li",{key:C.value,onClick:ke=>(ul(C),K.value=!K.value),class:"flex items-center gap-3 px-4 py-2 text-sm cursor-pointer hover:bg-bg-body hover:text-primary"},[e("span",{class:"w-2 h-2 rounded-full",style:be({backgroundColor:C.dot})},null,4),se(" "+V(C.label),1)],8,Ur)),64))])):P("",!0)]),_:1})],512),e("div",jr,[e("div",Fr,[e("div",{ref_key:"sprintDropdownWrapperRef",ref:Rt,class:"relative min-w-0"},[(E=f(y))!=null&&E.sprints.length?(p(),m("button",{key:0,onClick:s[8]||(s[8]=C=>vt.value=!vt.value),class:ee(["flex items-center gap-3 lg:px-6 px-1 py-1.5 rounded-lg text-sm font-medium transition-all",te.value?"text-white":"bg-gray-100 hover:bg-card hover:text-primary"]),style:be(te.value?{backgroundColor:A.value.dot}:{})},[e("span",Rr,V((oe=($=(M=f(y))==null?void 0:M.sprints)==null?void 0:$.find(C=>C._id===te.value))==null?void 0:oe.title),1),s[28]||(s[28]=e("i",{class:"fas fa-chevron-down text-xs"},null,-1))],6)):P("",!0),vt.value?(p(),m("div",Hr,[(p(!0),m(Te,null,Oe((ce=f(y))==null?void 0:ce.sprints,C=>{var ke;return p(),m("div",{key:C._id,class:"relative px-4 py-2 flex items-center justify-between text-sm cursor-pointer transition-color"},[e("div",Wr,[He.value!==C._id?(p(),m("button",{key:0,class:"text-left truncate w-full",onClick:Me=>Bt(C)},V(C.title),9,Kr)):lt((p(),m("input",{key:1,ref_for:!0,ref:"editingInputRef","onUpdate:modelValue":s[9]||(s[9]=Me=>Ye.value=Me),class:"w-full px-1 py-1 text-sm rounded outline-none bg-bg-card border border-[#7d68c8]",placeholder:"Enter new name",onClick:s[10]||(s[10]=Be(()=>{},["stop"])),onBlur:Me=>zt(C),onKeyup:[Qt(Me=>zt(C),["enter"]),Qt(Ft,["esc"])]},null,40,Qr)),[[hl,Ye.value]])]),e("div",Zr,[e("button",{class:"ml-2 text-xs text-gray-400 hover:text-accent",onClick:Be(Me=>dl(C),["stop"])},s[29]||(s[29]=[e("i",{class:"fas fa-pen"},null,-1)]),8,Gr),(ke=f(y))!=null&&ke.sprints.length&&He.value!==C._id?(p(),m("button",{key:0,onClick:Be(Me=>ol(C),["stop"]),class:"w-4 h-4 rounded-full flex items-center justify-center text-red-500"},s[30]||(s[30]=[e("i",{class:"fas fa-times text-xs"},null,-1)]),8,Jr)):P("",!0)])])}),128))])):P("",!0)],512)])]),e("button",{onClick:s[11]||(s[11]=C=>{var ke;return jt((ke=f(y))==null?void 0:ke.sprints)}),class:ee(["w-8 h-8 lg:flex sm:hidden items-center justify-center rounded-full border text-white transition-colors shrink-0"]),style:be({backgroundColor:A.value.dot})},s[31]||(s[31]=[e("i",{class:"fa-solid fa-plus"},null,-1)]),4)]),e("div",Xr,[e("div",Yr,[(ge=(le=f(F))==null?void 0:le.cards)!=null&&ge.length?(p(),m("button",{key:0,class:"flex items-center justify-center w-8 h-8 me-2 rounded-full bg-accent",onClick:cl,style:be(te.value?{backgroundColor:A.value.dot}:{})},s[32]||(s[32]=[e("i",{class:"fa-solid fa-magnifying-glass text-white"},null,-1)]),4)):P("",!0),((tt=f(F))==null?void 0:tt.status)==="active"&&f(F).cards.length?(p(),m("button",{key:1,class:"flex lg:hidden cursor-pointer text-white items-center justify-center rounded-full ms-2 w-7 h-7 text-sm font-medium mt-0.5",onClick:v,style:be(te.value?{backgroundColor:A.value.dot}:{})},s[33]||(s[33]=[e("i",{class:"fa-regular fa-eye text-sm"},null,-1)]),4)):P("",!0)]),e("div",eo,[((gt=f(F))==null?void 0:gt.status)==="active"?(p(),m("div",to,[j(We,{size:"sm",onClick:Vt,variant:(f(x),"primary"),class:"border-border-input border",style:be(te.value?{backgroundColor:A.value.dot}:{})},{default:pe(()=>[se(V(f(Ue)?"Ending...":"End"),1)]),_:1},8,["variant","style"]),e("button",{class:"cursor-pointer text-white flex items-center justify-end gap-1 px-2 py-1 rounded-md text-sm font-medium",onClick:v,style:be(te.value?{backgroundColor:A.value.dot}:{})},s[34]||(s[34]=[e("i",{class:"fa-regular fa-eye text-sm"},null,-1),se(" Preview ")]),4)])):(p(),m("div",lo,[((kl=f(F))==null?void 0:kl.status)!=="completed"?(p(),ye(We,{key:0,size:"sm",variant:(f(x),"primary"),class:"border-border-input border",onClick:dt,disabled:!ve.value||ve.value.tickets.length===0||((wl=f(F))==null?void 0:wl.status)==="completed",style:be({backgroundColor:A.value.dot})},{default:pe(()=>[se(" Start "+V(A.value.label),1)]),_:1},8,["variant","disabled","style"])):P("",!0)]))]),ve.value&&ve.value.tickets.length?(p(),m("div",so,[e("span",ao,V((Sl=f(F))==null?void 0:Sl.status),1),((Cl=f(F))==null?void 0:Cl.status)==="active"?(p(),m("div",no,[e("button",{onClick:Vt,class:"w-7 h-7 flex items-center justify-center rounded-full bg-accent",title:f(Ue)?"Ending...":"End Sprint",style:be(te.value?{backgroundColor:A.value.dot}:{})},s[35]||(s[35]=[e("i",{class:"fa-solid fa-flag-checkered text-white"},null,-1)]),12,ro)])):(p(),m("button",{key:1,onClick:dt,disabled:!ve.value||ve.value.tickets.length===0||(($l=f(F))==null?void 0:$l.status)==="completed",class:"w-7 h-7 flex items-center justify-center rounded-full text-white bg-accent disabled:opacity-50 disabled:cursor-not-allowed lg:hidden",title:"Start Sprint",style:be(te.value?{backgroundColor:A.value.dot}:{})},s[36]||(s[36]=[e("i",{class:"fa-solid fa-play text-sm"},null,-1)]),12,oo))])):P("",!0),((Tl=f(F))==null?void 0:Tl.status)==="active"?(p(),m("div",{key:1,class:"relative inline-flex",onMouseenter:s[12]||(s[12]=C=>r.value=!0),onMouseleave:s[13]||(s[13]=C=>r.value=!1),onClick:a},[s[37]||(s[37]=e("span",{class:"flex lg:hidden bg-emerald-500 text-white w-7 h-7 rounded-full justify-center items-center cursor-pointer"},[e("i",{class:"fa-solid fa-check"})],-1)),lt(e("div",io," Sprint is active ",512),[[Gt,r.value]])],32)):P("",!0)]),j(Fl,{name:"fade"},{default:pe(()=>[Et.value?(p(),m("div",uo,[e("div",{class:"absolute inset-0 bg-black/10 backdrop-blur-sm",onClick:Ht}),e("div",co,[e("div",{class:"flex justify-end"},[e("button",{onClick:Ht,class:"px-2 py-1 rounded bg-bg-input border border-border-input text-accent"},s[38]||(s[38]=[e("i",{class:"fa-solid fa-xmark"},null,-1)]))]),e("div",po,[e("p",fo," Search for "+V(I.value)+" by name, status, or priority. Start typing to filter results. ",1),e("div",vo,[j(ws,{placeholder:`Search in ${I.value}`,onOnChange:kt,onKeyup:Qt(wt,["enter"]),class:"flex-1"},null,8,["placeholder"])]),Ge.value.length&&Fe.value?(p(),m("div",mo,[e("ul",null,[(p(!0),m(Te,null,Oe(Ge.value,C=>{var ke,Me,fl,Nl,Pl,ql;return p(),m("li",{key:C._id,class:"px-4 py-2 cursor-pointer hover:bg-bg-hover text-text-primary border-b border-border-input"},[e("div",go,[e("div",null,[e("span",bo,V((Me=(ke=C.card)==null?void 0:ke.variables)==null?void 0:Me["card-title"]),1),e("span",yo," ("+V((Nl=(fl=C.card)==null?void 0:fl.variables)==null?void 0:Nl["card-code"])+") ",1)]),e("div",xo,[e("span",{class:ee(["px-3 py-1 rounded text-md",Je(C.priority)])},V(C.priority),3),e("span",ho,V((ql=(Pl=C.card)==null?void 0:Pl.variables)==null?void 0:ql["card-status"]),1)])])])}),128))])])):Fe.value&&!Ge.value.length?(p(),m("div",_o," No "+V(I.value)+' found matching "'+V(Fe.value)+'" ',1)):P("",!0)])])])):P("",!0)]),_:1})]),f(je)||f(el)?(p(),m("div",ko,s[39]||(s[39]=[e("div",{role:"status","aria-label":"Loading",class:"h-10 w-10 rounded-full border-4 border-accent border-t-transparent animate-spin"},null,-1)]))):(p(),m("div",wo,[ve.value&&["planning","active"].includes((Vl=(Dl=f(F))==null?void 0:Dl.status)==null?void 0:Vl.toLowerCase())?(p(),ye(ka,{key:0,searchQuery:T.value,sprintId:te.value,searchedData:It.value?[It.value]:[],label:I.value,checkedSprintAll:q.value,sprint:ve.value,onOpenTicket:Ct,onEditSprint:nl,onToggleStart:f(Ce),onMoveSelectedToBacklog:f(h),onDeleteSelectedSprint:s[14]||(s[14]=C=>f(B)("sprint",C)),onRefresh:Ot},null,8,["searchQuery","sprintId","searchedData","label","checkedSprintAll","sprint","onToggleStart","onMoveSelectedToBacklog"])):P("",!0),((El=(Ll=f(F))==null?void 0:Ll.status)==null?void 0:El.toString().trim().toLowerCase())==="completed"?(p(),m("div",So,[s[42]||(s[42]=e("div",{class:"w-16 h-16 flex justify-center items-center text-white rounded-full text-3xl"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 117.72 117.72","aria-hidden":"true"},[e("path",{fill:"#42ba96",d:`M58.86,0c9.13,0,17.77,2.08,25.49,5.79c-3.16,2.5-6.09,4.9-8.82,7.21c-5.2-1.89-10.81-2.92-16.66-2.92\r
                  c-13.47,0-25.67,5.46-34.49,14.29c-8.83,8.83-14.29,21.02-14.29,34.49c0,13.47,5.46,25.66,14.29,34.49\r
                  c8.83,8.83,21.02,14.29,34.49,14.29s25.67-5.46,34.49-14.29c8.83-8.83,14.29-21.02,14.29-34.49\r
                  c0-3.2-0.31-6.34-0.9-9.37c2.53-3.3,5.12-6.59,7.77-9.85c2.08,6.02,3.21,12.49,3.21,19.22\r
                  c0,16.25-6.59,30.97-17.24,41.62c-10.65,10.65-25.37,17.24-41.62,17.24c-16.25,0-30.97-6.59-41.62-17.24\r
                  C6.59,89.83,0,75.11,0,58.86c0-16.25,6.59-30.97,17.24-41.62S42.61,0,58.86,0z\r
                  M31.44,49.19L45.8,49l1.07,0.28c2.9,1.67,5.63,3.58,8.18,5.74c1.84,1.56,3.6,3.26,5.27,5.1\r
                  c5.15-8.29,10.64-15.9,16.44-22.9c6.35-7.67,13.09-14.63,20.17-20.98l1.4-0.54H114l-3.16,3.51\r
                  C101.13,30,92.32,41.15,84.36,52.65C76.4,64.16,69.28,76.04,62.95,88.27l-1.97,3.8l-1.81-3.87\r
                  c-3.34-7.17-7.34-13.75-12.11-19.63c-4.77-5.88-10.32-11.1-16.79-15.54L31.44,49.19z`})])],-1)),e("h6",Co,V(ne.value)+" Completed ",1),e("p",$o,[se(" This "+V(I.value)+" has been successfully completed. To continue planning work, create a new "+V(I.value)+" by clicking the ",1),s[40]||(s[40]=e("strong",null,"plus (+)",-1)),s[41]||(s[41]=se(" button and start organizing upcoming tasks. "))])])):P("",!0),((Ml=f(F))==null?void 0:Ml.length)<1||((Al=f(y))==null?void 0:Al.sprints.length)<1?(p(),m("div",To,[s[45]||(s[45]=e("div",{class:"w-16 h-16 flex items-center justify-center rounded-full bg-muted/10 text-accent"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-20 h-20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("h6",Do," No "+V(I.value)+"s available ",1),e("p",Vo,[se(" You don’t have any "+V(I.value)+"s yet. Create a new "+V(I.value)+" to start planning and organizing your work. Click the ",1),s[43]||(s[43]=e("strong",null,"plus (+)",-1)),s[44]||(s[44]=se(" button to get started. "))])])):P("",!0)]))])],512)]))])])])])),j(Ss,{onClick:s[15]||(s[15]=Be(()=>{},["stop"])),modelValue:Ve.value,"onUpdate:modelValue":s[16]||(s[16]=C=>Ve.value=C),title:`Delete ${I.value}`,itemLabel:I.value,itemName:(Il=ie.value)==null?void 0:Il.title,requireMatchText:(Bl=ie.value)==null?void 0:Bl.title,confirmText:`Delete ${I.value}`,cancelText:"Cancel",size:"md",loading:f(qe),onConfirm:Qe,onCancel:s[17]||(s[17]=()=>{ie.value=null,Ve.value=!1})},null,8,["modelValue","title","itemLabel","itemName","requireMatchText","confirmText","loading"]),j(Da,{modelValue:Xe.value,"onUpdate:modelValue":s[18]||(s[18]=C=>Xe.value=C),onSave:rl,sprint:ie.value,lable:I.value,creatingSprint:ie.value?f(ft):f(Pt),sprints:Ut.value},null,8,["modelValue","sprint","lable","creatingSprint","sprints"]),j(Fa,{sprint:ie.value,modelValue:it.value,"onUpdate:modelValue":s[19]||(s[19]=C=>it.value=C),onSave:D,creatingSprint:f(S)||f(Le),sprintType:I.value},null,8,["sprint","modelValue","creatingSprint","sprintType"]),j(_s,{modelValue:N.value,"onUpdate:modelValue":s[20]||(s[20]=C=>N.value=C),cardId:(Ol=$t.value)==null?void 0:Ol.id,onClose:g},null,8,["modelValue","cardId"]),j($n,{modelValue:w.value,"onUpdate:modelValue":s[21]||(s[21]=C=>w.value=C)},null,8,["modelValue"])])}}}),Ro=Xt(Lo,[["__scopeId","data-v-8c524db5"]]);export{Ro as default};
