import{d as X,r as W,c as d,l as Q,h as i,b as r,g as te,x as c,i as x,a as J,ap as U,t as C,T as oe,w as le,H as de,F as A,v as z,o as l,_ as Y,D as h,P as S,m as b,E as y,A as ne,V as ie}from"./index-4VVrnSvV.js";import{o as ue}from"./index-D77Hbchx.js";const ce=["src"],me={key:0,class:"font-bold"},ve={class:"text-nowrap"},pe=["onClick"],fe=["src"],he={class:"flex flex-col gap-1 max-w-40"},ye={class:"overflow-hidden font-semibold overflow-ellipsis"},xe={key:0,class:"min-w-40 line-clamp-2 text-wrap text-text-secondary text-xs"},be=X({__name:"Dropdown",props:{prefix:{},options:{default:()=>[]},modelValue:{default:""},variant:{default:"primary"},icon:{},size:{default:"md"}},emits:["update:modelValue"],setup(e,{emit:a}){const t=e,u=a,m=W(!1),s=d({get:()=>t.modelValue,set:o=>u("update:modelValue",o)}),n=d(()=>t.options.find(o=>o._id===s.value)??null),w=W(null);function T(){m.value=!m.value}function f(o){s.value=o._id,m.value=!1}ue(w,()=>m.value=!1);const p=d(()=>t.size==="sm"),k=d(()=>p.value?"px-2 py-1 text-xs":"px-3 py-1.5 text-sm"),$=d(()=>p.value?"text-xs":"text-sm"),ee=d(()=>p.value?"text-xs":"text-sm"),ae=d(()=>p.value?"px-3 py-1":"px-4 py-2"),P=d(()=>p.value?"w-3.5 h-3.5":"w-4 h-4"),g=d(()=>p.value?"w-3.5 h-3.5":"w-4 h-4"),V=d(()=>p.value?"text-base ":"text-lg "),se=d(()=>p.value?"w-3.5 h-3.5":"w-4 h-4"),re=d(()=>"dark:border-light-black border-border-gray");function L(o){o!=null&&o.iconName}return Q(()=>t.icon,o=>L(o),{immediate:!0}),Q(()=>t.options,o=>o.forEach(_=>L(_.icon)),{immediate:!0,deep:!0}),(o,_)=>{var E,F,I,N,j,q,B,D,O,K,R;return l(),i("div",{ref_key:"dropdownRef",ref:w,class:"relative inline-block text-left"},[r("button",{onClick:T,type:"button",class:c(["text-nowrap inline-flex justify-between items-center gap-1 border rounded-md font-medium cursor-pointer transition bg-bg-surface",[k.value,o.variant==="secondary"?"!bg-bg-body border-0  ":"border-border"]])},[(E=n.value)!=null&&E.prefix?(l(),i("span",{key:0,class:c(P.value)},[typeof((F=n.value)==null?void 0:F.prefix)=="string"?(l(),i("img",{key:0,src:(I=n.value)==null?void 0:I.prefix,class:c(g.value)},null,10,ce)):(l(),J(U((N=n.value)==null?void 0:N.prefix),{key:1,class:c(g.value)},null,8,["class"]))],2)):x("",!0),r("i",{class:c(`${(q=(j=n.value)==null?void 0:j.icon)==null?void 0:q.prefix} ${(D=(B=n.value)==null?void 0:B.icon)!=null&&D.iconName?(K=(O=n.value)==null?void 0:O.icon)==null?void 0:K.iconName:"file"} ${V.value}`)},null,2),r("span",{class:c($.value)},[o.prefix?(l(),i("span",me,C(o.prefix)+":",1)):x("",!0),r("span",ve,C((R=n.value)==null?void 0:R.title),1)],2),(l(),i("svg",{class:c([se.value,"text-text-secondary "]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_[0]||(_[0]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))],2),te(oe,{name:"fade-scale","enter-active-class":"transition duration-200 ease-out","leave-active-class":"transition duration-150 ease-in","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:le(()=>[m.value?(l(),i("div",{key:0,class:c(["absolute max-h-[500px] overflow-y-auto z-12 mt-1 w-full min-w-fit rounded-md border border-border shadow-lg bg-bg-dropdown",re.value])},[r("ul",{class:c(["py-1 z-[2]",ee.value])},[(l(!0),i(A,null,z(o.options,v=>{var G,H,M;return l(),i("li",{key:v._id,onClick:Ce=>f(v),class:c(["cursor-pointer flex gap-2 overflow-hidden items-center text-nowrap hover:bg-bg-dropdown-menu-hover",ae.value])},[v.prefix?(l(),i("span",{key:0,class:c(P.value)},[typeof v.prefix=="string"?(l(),i("img",{key:0,src:v.prefix,class:c(g.value)},null,10,fe)):(l(),J(U(v.prefix),{key:1,class:c(["text-text-primary ",g.value])},null,8,["class"]))],2)):x("",!0),r("i",{class:c(` ${(G=v.icon)==null?void 0:G.prefix} ${(H=v.icon)!=null&&H.iconName?(M=v.icon)==null?void 0:M.iconName:"file"} ${V.value}`)},null,2),r("div",he,[r("span",ye,C(v.title),1),v.description?(l(),i("p",xe,C(v.description),1)):x("",!0)])],10,pe)}),128)),de(o.$slots,"more",{},void 0,!0)],2)],2)):x("",!0)]),_:3})],512)}}}),$e=Y(be,[["__scopeId","data-v-180859ba"]]),Z={sheets:(e,a)=>["sheets",e,a],sheetList:(e,a,t,u)=>["sheet-list",e,a,t,u]},Ae=(e={})=>h({key:["product-sheet"],url:"/sheets/add",method:"POST"},e),ze=(e={})=>h({key:["move-card"],url:"/workspace/cards/update",method:"PATCH"},e),Pe=(e={})=>h({key:["add-list"],url:"/workspace/catalog/variable/value",method:"POST"},e),Ve=(e={})=>h({key:["add-ticket"],url:"/workspace/cards/add",method:"POST"},e),Le=(e,a={})=>h({key:["delete-ticket"],url:`workspace/card/${e}`,method:"DELETE"},a),Ee=(e,a={})=>{const t=d(()=>b(e.workspace_module_id)),u=d(()=>b(e.workspace_id));return S({queryKey:Z.sheets(t.value,u.value),enabled:d(()=>!!t.value),queryFn:({signal:m})=>y({url:"/sheets",method:"GET",params:{workspace_module_id:t.value,workspace_id:u.value},signal:m}).then(s=>s),...a})},Fe=(e,a,t,u,m={})=>{const s=d(()=>{const n=b(t);return n==null?void 0:Array.isArray(n)?Array.from(new Set(n.map(f=>String(f).trim()).filter(Boolean))).join(",")||void 0:String(n).trim()||void 0});return S({queryKey:Z.sheetList(e,a,s.value,u),enabled:d(()=>!!e&&!!a&&!!u),queryFn:({signal:n})=>y({url:"/workspace/cards/grouped",method:"GET",params:{module_id:b(e),sheet_id:b(a),variable_id:b(u),...s.value?{lane_ids:s.value}:{}},signal:n}),...m})},Ie=(e,a,t={})=>S({queryKey:["all-module-variables"],queryFn:({signal:u})=>y({url:`/workspace/catalog/${e}/card-variables/${a}`,method:"GET",signal:u}),...t}),Ne=(e,a={})=>S({queryKey:["all-module-lanes"],queryFn:({signal:t})=>y({url:`/workspace/lane-by-workspace/${e}`,method:"GET",signal:t}),...a}),je=(e={})=>h({key:["addVariables"]},{mutationFn:a=>y({url:"workspace/catalog/variable/add",method:"POST",data:a.payload}),...e}),qe=(e={})=>h({key:["reorder-list"]},{mutationFn:a=>y({url:"workspace/cards/group-order",method:"PATCH",data:a.payload}),...e}),Be=(e={})=>h({key:["reorder-card"]},{mutationFn:a=>y({url:"workspace/cards/group-card-order",method:"PATCH",data:a.payload}),...e}),we={class:"p-4 overflow-x-auto flex-auto flex gap-6","aria-busy":"true","aria-live":"polite"},ke={class:"flex-1 w-full overflow-y-auto space-y-3 px-2 pb-2",role:"presentation"},ge={key:0,class:"min-w-[328px]",role:"presentation"},_e=X({__name:"KanbanSkeleton",props:{columns:{default:3},cardsPerColumn:{default:3},showAddList:{type:Boolean,default:!0}},setup(e){const a=e,t=d(()=>Array.from({length:a.columns},(m,s)=>s)),u=d(()=>Array.from({length:a.cardsPerColumn},(m,s)=>s));return(m,s)=>(l(),i("div",we,[(l(!0),i(A,null,z(t.value,(n,w,T,f)=>{const p=[a.cardsPerColumn];if(f&&f.key===n&&ne(f,p))return f;const k=(l(),i("div",{key:n,class:"kanban-col max-w-[328px] min-w-[328px] min-h-[555px] h-full bg-bg-body rounded-lg p-2 flex flex-col",role:"presentation"},[s[4]||(s[4]=r("div",{class:"flex justify-between items-center py-3 px-4 sticky top-0 bg-bg-body rounded-xl mb-2 z-10",role:"presentation"},[r("div",{class:"flex items-center gap-2"},[r("div",{class:"h-4 w-24 rounded shimmer","aria-hidden":"true"}),r("div",{class:"h-4 w-4 rounded-full shimmer","aria-hidden":"true"})]),r("div",{class:"flex items-center gap-2"},[r("div",{class:"h-4 w-4 rounded shimmer","aria-hidden":"true"}),r("div",{class:"h-4 w-4 rounded shimmer","aria-hidden":"true"})])],-1)),r("div",ke,[(l(!0),i(A,null,z(u.value,$=>(l(),i("div",{key:$,class:"bg-bg-card rounded-xl border border-border p-3 space-y-3 shadow-sm",role:"presentation"},s[2]||(s[2]=[ie('<div class="flex gap-2" data-v-5a4807f3><div class="h-5 w-14 rounded-full shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="h-5 w-10 rounded-full shimmer" aria-hidden="true" data-v-5a4807f3></div></div><div data-v-5a4807f3><div class="h-4 w-3/4 rounded shimmer mb-2" aria-hidden="true" data-v-5a4807f3></div><div class="h-3 w-full rounded shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="h-3 w-5/6 rounded shimmer mt-1" aria-hidden="true" data-v-5a4807f3></div></div><div class="flex justify-between items-center" data-v-5a4807f3><div class="h-4 w-20 rounded shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="flex -space-x-2" data-v-5a4807f3><div class="w-6 h-6 rounded-full border-2 border-border shimmer" aria-hidden="true" data-v-5a4807f3></div><div class="w-6 h-6 rounded-full border-2 border-border shimmer" aria-hidden="true" data-v-5a4807f3></div></div></div>',3)])))),128)),s[3]||(s[3]=r("div",{class:"h-9 rounded shimmer mt-3","aria-hidden":"true"},null,-1))])]));return k.memo=p,k},s,0),128)),a.showAddList?(l(),i("div",ge,s[5]||(s[5]=[r("div",{class:"bg-bg-body rounded-lg p-4"},[r("div",{class:"h-9 rounded shimmer","aria-hidden":"true"})],-1)]))):x("",!0)]))}}),De=Y(_e,[["__scopeId","data-v-5a4807f3"]]);export{$e as D,De as K,qe as R,Le as a,Ie as b,Pe as c,Ee as d,Fe as e,Be as f,Ve as g,Ne as h,Ae as i,je as j,ze as u};
