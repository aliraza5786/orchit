const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KanbanBoard-BTJGHvw7.js","assets/lodash-Dt_72mC4.js","assets/index-DKO9vpWs.js","assets/index-U_lIj89R.css","assets/ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-QiQIlSIU.js","assets/lodash-B_VDCJnj.css","assets/DropMenu.vue_vue_type_script_setup_true_lang-DqzadSif.js","assets/workspace-OrqjaA3b.js","assets/KanbanBoard-DlFwUlEB.css","assets/KanbanCard-CclsYvE8.js","assets/usePeople-DdK_gZWK.js"])))=>i.map(i=>d[i]);
import{d as ge,M as ke,r as m,m as K,c as re,a as be,aa as Ce,i as n,y as we,e as l,h as v,j as k,ac as he,n as b,b0 as De,f as q,t as f,P as Ve,aD as Ae,A as ue,V as Pe,a9 as pe,g as $,F as se,x as ne,b as _e,G as Se,af as $e,o as d,H as Le,W as Te,q as Ue,b1 as Ie,C as ve,w as ae,B as fe,a5 as xe,_ as Ne,a6 as ye}from"./index-DKO9vpWs.js";import{l as Oe,F as Ee,D as Be,K as Ke}from"./lodash-Dt_72mC4.js";import{b as qe,c as je,d as Qe,e as Re,f as ze,g as Me,R as We,h as Fe}from"./usePeople-DdK_gZWK.js";import{_ as Je}from"./ConfirmDeleteModal.vue_vue_type_script_setup_true_lang-QiQIlSIU.js";import{_ as He}from"./BaseEmailChip.vue_vue_type_script_setup_true_lang-DiN4jgjX.js";import{_ as Ye}from"./ProgressBar.vue_vue_type_script_setup_true_lang-SO7Ork-j.js";import{_ as Ge}from"./SearchBar.vue_vue_type_script_setup_true_lang-K_iaIn0L.js";const Ze={class:"py-4 flex justify-between items-center border-b border-border px-5 sticky top-0 bg-bg-card z-1"},Xe={class:"py-4 px-5"},et={class:"bg-bg-surface/50 p-2 rounded-lg flex gap-2 items-center"},tt=["src"],at={key:0,class:"fa-solid fa-user text-white"},st={class:"text-base font-medium text-text-primary cursor-pointer"},lt={class:"text-sm font-medium text-text-secondary cursor-pointer"},ot={class:"flex flex-col mt-2"},it={class:"text-sm text-text-secondary mt-2"},dt={key:0},nt={class:"mb-2 capitalize"},rt=["onKeydown"],ut={key:1,class:"mt-3"},ct={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},mt={class:"text-sm text-text-primary"},pt={key:2,class:"mt-3"},vt={key:0,class:"border border-border space-y-1 p-2.5 mt-1 rounded-lg"},ft={class:"text-sm text-text-primary"},xt=ge({__name:"DetailPanel",props:{showPanel:{type:Boolean,default:!0},details:{type:Object,default:()=>({})}},emits:["close","update:details","comment:post","priority:change"],setup(u,{emit:ce}){const le=ke({}),C=m("details"),I=[{label:"Details",value:"details"},{label:"Tasks",value:"tasks"},{label:"History",value:"history"}],{data:w}=qe(),{mutate:_}=je({onSuccess:()=>{g.invalidateQueries({queryKey:["people-lists"]})}}),a=u,r=m(!1),y=m(a.details["card-title"]??""),oe=m(a.details.workspace_lane_id??"");K(()=>a.details["card-title"],c=>{y.value=c,oe.value=a.details.workspace_lane_id});const N=m(a.details["card-description"]);K(()=>a.details,()=>{N.value=a.details["card-description"]});const L=m(null);function ie(){r.value=!0,$e(()=>{var c,s;(c=L.value)==null||c.focus(),(s=L.value)==null||s.select()})}function h(){y.value.trim()||(y.value=a.details["card-title"]??""),R.mutate({card_id:a.details._id,variables:{"card-title":y.value.trim()}}),r.value=!1}function j(){y.value=a.details["card-title"]??"",r.value=!1}const Q=m({startDate:a.details["start-date"],endDate:a.details["end-date"]}),D=re(()=>a.details["start-date"]);K(D,c=>{Q.value={...Q.value,startDate:c}});const g=be(),R=Ce({onSuccess:()=>{g.invalidateQueries({queryKey:["get-sheets"]}),g.invalidateQueries({queryKey:["sheet-list"]}),g.invalidateQueries({queryKey:["roles"]})}}),de=(c,s)=>{console.log(s,"slug",c),_({id:a.details._id,payload:{variable_values:[{module_variable_id:s,value:c}]}})};function z(c){var V,A,P;const s=(V=a==null?void 0:a.details)==null?void 0:V.variable_values.filter(T=>T.module_variable_id==c);return console.log((A=s[0])==null?void 0:A.value,">>>"),(P=s[0])==null?void 0:P.value}return(c,s)=>{var V,A,P,T,M,W,F,O,J,E,H,Y,G,Z;return d(),n("div",{class:we(`max-w-[358px] bg-bg-card  rounded-lg overflow-y-auto overflow-x-hidden relative ${u.showPanel?"!translate-x-0 w-full h-full min-w-[350px] overflow-y-auto":"!translate-x-100 w-0 h-0"} transition-all`)},[l("div",Ze,[s[4]||(s[4]=l("h5",{class:"text-[16px] font-medium"},"Profile",-1)),l("i",{class:"cursor-pointer text-text-primary fa-solid fa-close",onClick:s[0]||(s[0]=()=>{c.$emit("close")})})]),l("div",Xe,[l("div",et,[(V=u.details)!=null&&V.avatar?(d(),n("img",{key:0,src:(A=u.details)==null?void 0:A.avatar,class:"w-10 h-10 rounded-full",alt:"avartar"},null,8,tt)):(d(),n("div",{key:1,class:"min-w-10 max-h-10 aspect-square bg-bg-surface flex justify-center items-center rounded-full",style:he({backgroundColor:(P=u.details)!=null&&P.name?b(De)({email:(T=u.details)==null?void 0:T.email}):""})},[q(f(b(Ve)((M=u.details)==null?void 0:M.name))+" ",1),(W=u.details)!=null&&W.name?k("",!0):(d(),n("i",at))],4)),l("div",null,[l("h1",st,f(u.details.name??u.details.title),1),l("p",lt,f(u.details.email),1)])]),v(Ae,{modelValue:C.value,"onUpdate:modelValue":s[1]||(s[1]=i=>C.value=i),class:"my-2",options:I},null,8,["modelValue"]),l("div",ot,[s[5]||(s[5]=l("h1",{class:"text-base font-medium text-text-primary cursor-pointer"}," Task Progress ",-1)),v(Ye,{class:"mt-2",progress:(F=a==null?void 0:a.details)==null?void 0:F.assigned_cards_count,fillColor:"bg-accent ",indeterminate:!0},null,8,["progress"]),l("span",it,"Completed 10 tasks out of "+f((O=a==null?void 0:a.details)==null?void 0:O.assigned_cards_count),1)]),C.value=="details"?(d(),n("section",dt,[l("div",nt,[r.value?ue((d(),n("input",{key:0,ref_key:"titleInput",ref:L,"onUpdate:modelValue":s[2]||(s[2]=i=>y.value=i),onBlur:h,onKeydown:[pe($(h,["prevent"]),["enter"]),pe($(j,["prevent"]),["esc"])],class:"border border-border rounded px-2 py-1 w-full text-xl font-medium",type:"text"},null,40,rt)),[[Pe,y.value]]):(d(),n("h1",{key:1,class:"text-xl font-medium text-text-primary cursor-pointer",onClick:ie},f(y.value),1))]),l("div",null,[(d(!0),n(se,null,ne(b(w),(i,x)=>{var X;return d(),n("div",{key:x,class:"grid grid-cols-2 capitalize items-center gap-2 text-sm mt-4"},[q(f(i.title)+" ",1),(d(),_e(Se,{size:"sm","model-value":le[i.slug],key:x,placeholder:` ${i.title}`,onClick:s[3]||(s[3]=$(()=>{},["stop"])),defaultValue:z(i==null?void 0:i._id),options:i==null?void 0:i.data.map(U=>({_id:U,title:U})),cardId:(X=u.details)==null?void 0:X._id,"onUpdate:modelValue":U=>de(U,i._id)},null,8,["model-value","placeholder","defaultValue","options","cardId","onUpdate:modelValue"]))])}),128))])])):k("",!0),C.value=="tasks"?(d(),n("section",ut,[s[7]||(s[7]=l("span",{class:"text-base text-text-primary"},"Worked On",-1)),((E=(J=u.details)==null?void 0:J.assigned_cards)==null?void 0:E.length)>0?(d(),n("ul",ct,[(d(!0),n(se,null,ne((H=u.details)==null?void 0:H.assigned_cards,(i,x)=>(d(),n("li",{class:"p-2",key:x},[l("h1",mt,f(i==null?void 0:i.title),1),s[6]||(s[6]=l("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):k("",!0)])):k("",!0),C.value=="history"?(d(),n("section",pt,[s[9]||(s[9]=l("span",{class:"text-base text-text-primary"},"history",-1)),((G=(Y=u.details)==null?void 0:Y.assignment_history)==null?void 0:G.length)>0?(d(),n("ul",vt,[(d(!0),n(se,null,ne((Z=u.details)==null?void 0:Z.assignment_history,(i,x)=>(d(),n("li",{class:"p-2",key:x},[l("h1",ft,f(i==null?void 0:i.title),1),s[8]||(s[8]=l("p",{class:"text-xs text-text-secondary"},"Design Project . Olivia Updated on April 9, 2025",-1))]))),128))])):k("",!0)])):k("",!0)])],2)}}}),yt=Le(xt,[["__scopeId","data-v-9b1e0603"]]),gt={class:"flex-auto flex-grow h-full bg-bg-card rounded-lg border border-border overflow-x-auto flex-col flex"},bt={class:"header px-4 py-3 border-b border-border flex items-center justify-between gap-1"},_t={class:"flex gap-3 items-center"},kt={class:"flex p-4 overflow-x-auto gap-3 custom_scroll_bar"},Ct=["onClick"],wt={key:1,class:"p-4 space-y-2 bg-bg-surface m-4 rounded-md"},ht={class:"text-sm text-text-primary"},Dt={class:"flex items-center mt-3 gap-3"},Ut=ge({__name:"People",setup(u){const ce=xe(()=>ye(()=>import("./KanbanBoard-BTJGHvw7.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),le=xe(()=>ye(()=>import("./KanbanCard-CclsYvE8.js"),__vite__mapDeps([9,2,3,6,4,10]))),C=[{title:"Role",_id:"role"},{title:"Team",_id:"team"},{title:"Status",_id:"status"}],I=m("role"),w=m(!1),_=m(),{workspaceId:a}=Te(),r=m([]),{mutate:y,isPending:oe}=Qe({onSuccess:e=>{r.value=[...r.value||[],e],g.value="",D.value=!1}}),{data:N,isPending:L}=Re(a.value,I);K(N,e=>{r.value=e?JSON.parse(JSON.stringify(e)):[]}),Ue(()=>{r.value=N.value?JSON.parse(JSON.stringify(N.value)):[]});const ie=m("kanban"),h=m(),j=e=>{h.value=e},Q=e=>{},D=m(!1),g=m("");function R(){D.value=!D.value}function de(){console.log(">>> clicking on adding pepople ");const e=g.value.trim();z(e)}const z=e=>{console.log(">>> clicking on adding pepople ");const t={workspace_id:a.value,title:e,max_num_people:1};y({payload:t})},c=be(),s=Ie({onSuccess:()=>{c.invalidateQueries({queryKey:["people-lists"]})}}),V=e=>{const t={workspace_id:a.value,title:e==null?void 0:e.title,max_num_people:1};s.mutate({id:e._id,payload:t})},{mutate:A,isPending:P}=ze({onSuccess:e=>{w.value=!1,r.value=r.value.filter(t=>{var p;return t._id!==((p=e.deletedRole)==null?void 0:p._id)})}}),T=()=>{var e;A({id:(e=_.value)==null?void 0:e.columnId})},M=e=>{w.value=!0,_.value=e},{mutate:W,isPending:F}=Me({onSuccess:e=>{g.value="",D.value=!1,console.log(_.value,">>>. id local column");const t=r.value.findIndex(te=>te._id===_.value._id);if(t===-1)return;console.log(t,"index>>>");const p=r.value[t],S=[...p.cards??[],e==null?void 0:e.assigned_seat],ee={...p,cards:S};r.value=[...r.value.slice(0,t),ee,...r.value.slice(t+1)],c.invalidateQueries({queryKey:["people-lists"]}),c.invalidateQueries({queryKey:["workspaceRoles"]})}}),O=e=>{_.value=e;const t={name:e!=null&&e.email?J(e==null?void 0:e.email[0]):"",email:e!=null&&e.email?e==null?void 0:e.email[0]:"",role_id:e==null?void 0:e._id,workspace_id:a==null?void 0:a.value,additional_seats:1};W({id:e._id,payload:t})};function J(e){const p=(e.split("@")[0]||"").split("+")[0].split(/[^a-zA-Z]+/).filter(Boolean);return p.length?p.map(S=>S.charAt(0).toUpperCase()+S.slice(1).toLowerCase()).join(" "):e}const E=e=>{window.dispatchEvent(new CustomEvent("close-all-showADDNEW")),e.showADDNEW=!e.showADDNEW},H=e=>{O(e)},Y=e=>{h.value=e},G=We(),Z=Fe();function i(e){console.log(e,">>"),e.type=="column"?G.mutate({id:a.value,payload:{role_id:e.meta._id,new_sort_order:e.meta.newIndex}}):Z.mutate({id:e.meta.toColumnId,payload:{team_member_id:e.meta.moved._id,new_sort_order:e.meta.newIndex}})}const x=m(""),X=m("");K(x,Oe.debounce(e=>{X.value=e},200));const U=re(()=>{const e=r.value.flatMap(t=>t.cards.map(p=>({...p,columnId:t.title})));return new Ee(e,{keys:["title","name"],threshold:.3})}),me=re(()=>{if(!x.value)return r.value;const e=U.value.search(x.value).map(t=>t.item);return r.value.map(t=>({...t,cards:e.filter(p=>p.columnId===t.title)}))});return(e,t)=>{var p,S,ee,te;return d(),n(se,null,[l("div",gt,[l("div",bt,[v(Be,{actions:!1,prefix:"View By",modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=o=>I.value=o),options:C,variant:"secondary"},null,8,["modelValue"]),l("div",_t,[v(Ge,{class:"max-w-[250px]",onOnChange:t[1]||(t[1]=o=>{x.value=o}),placeholder:"Search in Orchit AI space"})])]),ue(v(Ke,null,null,512),[[ve,b(L)]]),ue(l("div",kt,[((p=me.value)==null?void 0:p.length)>0?(d(),_e(b(ce),{key:0,plusIcon:!1,onOnPlus:t[3]||(t[3]=o=>O(o)),"onDelete:column":t[4]||(t[4]=o=>M(o)),"onUpdate:column":t[5]||(t[5]=o=>V(o)),onReorder:i,onAddColumn:z,"onSelect:ticket":j,board:me.value,onOnBoardUpdate:Q,variable_id:"",sheet_id:"selected_sheet_id"},{ticket:ae(({ticket:o})=>[v(b(le),{onClick:B=>Y(o),ticket:o},null,8,["onClick","ticket"])]),"column-footer":ae(({column:o})=>[o.showADDNEW?o.showADDNEW?(d(),n("div",wt,[l("p",ht,f(o.title)+" "+f(o.cards.length+1),1),v(He,{maxEmails:1,placeholder:"team member email",modelValue:o.email,"onUpdate:modelValue":B=>o.email=B},null,8,["modelValue","onUpdate:modelValue"]),t[14]||(t[14]=l("p",{class:"text-sm text-text-secondary"},"You can assign user later",-1)),v(fe,{size:"md",onClick:B=>H(o)},{default:ae(()=>[q(f(b(F)?"Adding...":"Add Seat"),1)]),_:2},1032,["onClick"]),l("i",{class:"fa-solid fa-close cursor-pointer ml-2",onClick:t[2]||(t[2]=B=>E(""))})])):k("",!0):(d(),n("div",{key:0,onClick:B=>E(o),class:"flex py-3 px-3 justify-center text-sm text-text-primary items-center gap-3 border border-text-primary cursor-pointer border-dashed mb-4 mx-4 rounded-md"},t[13]||(t[13]=[l("i",{class:"fa-solid fa-plus"},null,-1),q(" Add Seat ")]),8,Ct))]),_:1},8,["board"])):k("",!0),l("div",{class:"min-w-[328px]",onClick:t[8]||(t[8]=$(()=>{},["stop"]))},[D.value?(d(),n("form",{key:0,onSubmit:t[7]||(t[7]=$(()=>{},["prevent"])),class:"bg-bg-body rounded-lg p-4"},[v(Ne,{autofocus:!0,modelValue:g.value,"onUpdate:modelValue":t[6]||(t[6]=o=>g.value=o),placeholder:"Add New list"},null,8,["modelValue"]),t[15]||(t[15]=l("p",{class:"text-xs mt-1.5"},"You can add details while editing",-1)),l("div",Dt,[v(fe,{onClick:de,type:"submit",variant:"primary",class:"px-3 py-1 bg-accent cursor-pointer text-white rounded"},{default:ae(()=>[q(f(b(oe)?"Adding...":"Add Team"),1)]),_:1}),l("i",{class:"fa-solid fa-close cursor-pointer",onClick:R})])],32)):(d(),n("button",{key:1,class:"text-sm text-text-primary py-2.5 cursor-pointer font-medium flex items-center justify-center w-full gap-2 bg-bg-body rounded-lg",onClick:$(R,["stop"])}," + Add Team "))])],512),[[ve,ie.value=="kanban"&&!b(L)]])]),v(Je,{onClick:t[9]||(t[9]=$(()=>{},["stop"])),modelValue:w.value,"onUpdate:modelValue":t[10]||(t[10]=o=>w.value=o),title:"Delete List",itemLabel:"list",itemName:(S=_.value)==null?void 0:S.title,requireMatchText:(ee=_.value)==null?void 0:ee.title,confirmText:"Delete List",cancelText:"Cancel",size:"md",loading:b(P),onConfirm:T,onCancel:t[11]||(t[11]=()=>{w.value=!1})},null,8,["modelValue","itemName","requireMatchText","loading"]),v(yt,{details:h.value,onClose:t[12]||(t[12]=()=>{j({variables:{}})}),showPanel:!!((te=h.value)!=null&&te.title)},null,8,["details","showPanel"])],64)}}});export{Ut as default};
